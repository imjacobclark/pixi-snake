!function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=87)}([function(t,e,r){"use strict";var i={};r.r(i),r.d(i,"assertParamsValid",(function(){return Sr})),r.d(i,"maskToAxes",(function(){return Ir})),r.d(i,"computeOutShape",(function(){return Ar})),r.d(i,"stridesWithElidedDims",(function(){return Cr})),r.d(i,"startIndicesWithElidedDims",(function(){return Or})),r.d(i,"stopIndicesWithElidedDims",(function(){return Rr})),r.d(i,"stridesForAxis",(function(){return Nr})),r.d(i,"startForAxis",(function(){return Pr})),r.d(i,"stopForAxis",(function(){return Mr})),r.d(i,"isSliceContinous",(function(){return Dr})),r.d(i,"computeFlatOffset",(function(){return Fr}));var n={};r.r(n),r.d(n,"copyModel",(function(){return ni})),r.d(n,"listModels",(function(){return ri})),r.d(n,"moveModel",(function(){return si})),r.d(n,"removeModel",(function(){return ii})),r.d(n,"browserFiles",(function(){return Si})),r.d(n,"browserHTTPRequest",(function(){return Fi})),r.d(n,"concatenateArrayBuffers",(function(){return Wr.d})),r.d(n,"decodeWeights",(function(){return Wr.e})),r.d(n,"encodeWeights",(function(){return Wr.f})),r.d(n,"fromMemory",(function(){return Ui})),r.d(n,"getLoadHandlers",(function(){return Jr})),r.d(n,"getModelArtifactsInfoForJSON",(function(){return Wr.g})),r.d(n,"getSaveHandlers",(function(){return Zr})),r.d(n,"http",(function(){return Di})),r.d(n,"isHTTPScheme",(function(){return Pi})),r.d(n,"loadWeights",(function(){return Oi})),r.d(n,"registerLoadRouter",(function(){return Kr})),r.d(n,"registerSaveRouter",(function(){return qr})),r.d(n,"weightsLoaderFactory",(function(){return Ri})),r.d(n,"withSaveHandler",(function(){return Bi}));var s={};r.r(s),r.d(s,"toPixels",(function(){return Gi})),r.d(s,"fromPixels",(function(){return zi}));var o={};r.r(o),r.d(o,"Serializable",(function(){return Yi})),r.d(o,"SerializationMap",(function(){return qi})),r.d(o,"registerClass",(function(){return Ki}));var a={};r.r(a),r.d(a,"segOpComputeOptimalWindowSize",(function(){return vs})),r.d(a,"computeOutShape",(function(){return _s})),r.d(a,"collectGatherOpShapeInfo",(function(){return bs}));var h={};r.r(h),r.d(h,"fft",(function(){return eo})),r.d(h,"ifft",(function(){return ro})),r.d(h,"rfft",(function(){return io})),r.d(h,"irfft",(function(){return no}));var u={};r.r(u),r.d(u,"hannWindow",(function(){return uo})),r.d(u,"hammingWindow",(function(){return lo})),r.d(u,"frame",(function(){return co})),r.d(u,"stft",(function(){return po}));var l={};r.r(l),r.d(l,"Reduction",(function(){return mo})),r.d(l,"absoluteDifference",(function(){return go})),r.d(l,"computeWeightedLoss",(function(){return yo})),r.d(l,"cosineDistance",(function(){return vo})),r.d(l,"hingeLoss",(function(){return _o})),r.d(l,"huberLoss",(function(){return bo})),r.d(l,"logLoss",(function(){return xo})),r.d(l,"meanSquaredError",(function(){return To})),r.d(l,"sigmoidCrossEntropy",(function(){return Eo})),r.d(l,"softmaxCrossEntropy",(function(){return wo}));var c={};r.r(c),r.d(c,"bandPart",(function(){return Io})),r.d(c,"gramSchmidt",(function(){return Ao})),r.d(c,"qr",(function(){return Co}));var d={};r.r(d),r.d(d,"nonMaxSuppression",(function(){return Uo})),r.d(d,"resizeBilinear",(function(){return Bo})),r.d(d,"resizeNearestNeighbor",(function(){return jo})),r.d(d,"nonMaxSuppressionAsync",(function(){return Xo})),r.d(d,"nonMaxSuppressionWithScore",(function(){return Go})),r.d(d,"nonMaxSuppressionWithScoreAsync",(function(){return zo})),r.d(d,"cropAndResize",(function(){return Vo}));var p={};r.r(p),r.d(p,"matMul",(function(){return qo})),r.d(p,"conv2d",(function(){return Ko})),r.d(p,"depthwiseConv2d",(function(){return Zo}));var f={};r.r(f),r.d(f,"add",(function(){return A})),r.d(f,"addN",(function(){return an})),r.d(f,"atan2",(function(){return hn})),r.d(f,"avgPool",(function(){return un})),r.d(f,"avgPool3d",(function(){return ln})),r.d(f,"batchToSpaceND",(function(){return vr})),r.d(f,"batchNorm",(function(){return dn})),r.d(f,"batchNorm2d",(function(){return pn})),r.d(f,"batchNorm3d",(function(){return fn})),r.d(f,"batchNorm4d",(function(){return mn})),r.d(f,"broadcastTo",(function(){return yn})),r.d(f,"clone",(function(){return gn})),r.d(f,"complex",(function(){return vn.a})),r.d(f,"concat",(function(){return M})),r.d(f,"concat1d",(function(){return _n})),r.d(f,"concat2d",(function(){return bn})),r.d(f,"concat3d",(function(){return xn})),r.d(f,"concat4d",(function(){return Tn})),r.d(f,"conv1d",(function(){return En})),r.d(f,"conv2d",(function(){return xe})),r.d(f,"conv2dTranspose",(function(){return wn})),r.d(f,"conv3d",(function(){return Sn})),r.d(f,"conv3dTranspose",(function(){return In})),r.d(f,"cumsum",(function(){return Ae})),r.d(f,"depthToSpace",(function(){return An})),r.d(f,"depthwiseConv2d",(function(){return Cn})),r.d(f,"diag",(function(){return On})),r.d(f,"div",(function(){return V})),r.d(f,"divNoNan",(function(){return Rn})),r.d(f,"dot",(function(){return Nn})),r.d(f,"elu",(function(){return Pn})),r.d(f,"equal",(function(){return Mn})),r.d(f,"eye",(function(){return Dn})),r.d(f,"fill",(function(){return Fn})),r.d(f,"floorDiv",(function(){return z})),r.d(f,"greater",(function(){return Ke})),r.d(f,"greaterEqual",(function(){return ze})),r.d(f,"imag",(function(){return Ln.a})),r.d(f,"leakyRelu",(function(){return Un})),r.d(f,"less",(function(){return Ve})),r.d(f,"lessEqual",(function(){return Ze})),r.d(f,"localResponseNormalization",(function(){return Bn})),r.d(f,"matMul",(function(){return ce})),r.d(f,"max",(function(){return jn})),r.d(f,"maxPool",(function(){return Xn})),r.d(f,"maxPool3d",(function(){return Gn})),r.d(f,"maxPoolWithArgmax",(function(){return zn})),r.d(f,"maximum",(function(){return kn})),r.d(f,"minimum",(function(){return Vn})),r.d(f,"mod",(function(){return Hn})),r.d(f,"mul",(function(){return H})),r.d(f,"multinomial",(function(){return $n})),r.d(f,"notEqual",(function(){return Wn})),r.d(f,"oneHot",(function(){return ji})),r.d(f,"outerProduct",(function(){return Yn})),r.d(f,"pad",(function(){return wr})),r.d(f,"pad1d",(function(){return qn})),r.d(f,"pad2d",(function(){return Kn})),r.d(f,"pad3d",(function(){return Zn})),r.d(f,"pad4d",(function(){return Jn})),r.d(f,"pool",(function(){return Qn})),r.d(f,"pow",(function(){return lr})),r.d(f,"prelu",(function(){return ts})),r.d(f,"rand",(function(){return es})),r.d(f,"randomGamma",(function(){return os})),r.d(f,"randomNormal",(function(){return as})),r.d(f,"randomUniform",(function(){return hs})),r.d(f,"real",(function(){return us.a})),r.d(f,"relu",(function(){return ls})),r.d(f,"relu6",(function(){return cs})),r.d(f,"selu",(function(){return ds})),r.d(f,"separableConv2d",(function(){return ps})),r.d(f,"spaceToBatchND",(function(){return pe})),r.d(f,"split",(function(){return ge})),r.d(f,"square",(function(){return pt})),r.d(f,"squaredDifference",(function(){return fs})),r.d(f,"sub",(function(){return Fe})),r.d(f,"tile",(function(){return Le})),r.d(f,"truncatedNormal",(function(){return ms})),r.d(f,"booleanMaskAsync",(function(){return Ss})),r.d(f,"reverse",(function(){return Is})),r.d(f,"reverse1d",(function(){return As})),r.d(f,"reverse2d",(function(){return Cs})),r.d(f,"reverse3d",(function(){return Os})),r.d(f,"reverse4d",(function(){return Rs})),r.d(f,"slice",(function(){return Lr})),r.d(f,"slice1d",(function(){return kr})),r.d(f,"slice2d",(function(){return Ur})),r.d(f,"slice3d",(function(){return Br})),r.d(f,"slice4d",(function(){return jr})),r.d(f,"abs",(function(){return ft})),r.d(f,"acos",(function(){return mt})),r.d(f,"acosh",(function(){return gt})),r.d(f,"asin",(function(){return yt})),r.d(f,"asinh",(function(){return vt})),r.d(f,"atan",(function(){return _t})),r.d(f,"atanh",(function(){return bt})),r.d(f,"ceil",(function(){return xt})),r.d(f,"clipByValue",(function(){return Tt})),r.d(f,"cos",(function(){return Et})),r.d(f,"cosh",(function(){return wt})),r.d(f,"erf",(function(){return St})),r.d(f,"exp",(function(){return It})),r.d(f,"expm1",(function(){return At})),r.d(f,"floor",(function(){return Ct})),r.d(f,"log",(function(){return Ot})),r.d(f,"log1p",(function(){return Rt})),r.d(f,"logSigmoid",(function(){return Nt})),r.d(f,"neg",(function(){return Pt})),r.d(f,"reciprocal",(function(){return Mt})),r.d(f,"round",(function(){return Dt})),r.d(f,"rsqrt",(function(){return Ft})),r.d(f,"sigmoid",(function(){return Lt})),r.d(f,"sign",(function(){return kt})),r.d(f,"isNaN",(function(){return Ut})),r.d(f,"isInf",(function(){return Bt})),r.d(f,"isFinite",(function(){return jt})),r.d(f,"sin",(function(){return Xt})),r.d(f,"sinh",(function(){return Gt})),r.d(f,"softplus",(function(){return zt})),r.d(f,"sqrt",(function(){return Vt})),r.d(f,"step",(function(){return Ht})),r.d(f,"tan",(function(){return $t})),r.d(f,"tanh",(function(){return Wt})),r.d(f,"all",(function(){return it})),r.d(f,"any",(function(){return nt})),r.d(f,"argMax",(function(){return st})),r.d(f,"argMin",(function(){return ot})),r.d(f,"logSumExp",(function(){return at})),r.d(f,"mean",(function(){return ht})),r.d(f,"min",(function(){return ut})),r.d(f,"moments",(function(){return lt})),r.d(f,"sum",(function(){return ct})),r.d(f,"prod",(function(){return dt})),r.d(f,"equalStrict",(function(){return Ns})),r.d(f,"greaterEqualStrict",(function(){return Ps})),r.d(f,"greaterStrict",(function(){return Ms})),r.d(f,"lessEqualStrict",(function(){return Ds})),r.d(f,"lessStrict",(function(){return Fs})),r.d(f,"notEqualStrict",(function(){return Ls})),r.d(f,"addStrict",(function(){return ks})),r.d(f,"divStrict",(function(){return Us})),r.d(f,"maximumStrict",(function(){return Bs})),r.d(f,"minimumStrict",(function(){return js})),r.d(f,"modStrict",(function(){return Xs})),r.d(f,"mulStrict",(function(){return Gs})),r.d(f,"powStrict",(function(){return zs})),r.d(f,"squaredDifferenceStrict",(function(){return Vs})),r.d(f,"subStrict",(function(){return Hs})),r.d(f,"logicalAnd",(function(){return nr})),r.d(f,"logicalNot",(function(){return sr})),r.d(f,"logicalOr",(function(){return or})),r.d(f,"logicalXor",(function(){return ar})),r.d(f,"where",(function(){return hr})),r.d(f,"whereAsync",(function(){return ur})),r.d(f,"buffer",(function(){return D})),r.d(f,"print",(function(){return F})),r.d(f,"cast",(function(){return L})),r.d(f,"expandDims",(function(){return k})),r.d(f,"reshape",(function(){return U})),r.d(f,"squeeze",(function(){return B})),r.d(f,"stack",(function(){return j})),r.d(f,"unstack",(function(){return X})),r.d(f,"setdiff1dAsync",(function(){return G})),r.d(f,"linspace",(function(){return P.a})),r.d(f,"ones",(function(){return P.b})),r.d(f,"range",(function(){return P.d})),r.d(f,"scalar",(function(){return P.e})),r.d(f,"tensor",(function(){return P.f})),r.d(f,"tensor1d",(function(){return P.g})),r.d(f,"tensor2d",(function(){return P.h})),r.d(f,"tensor3d",(function(){return P.i})),r.d(f,"tensor4d",(function(){return P.j})),r.d(f,"tensor5d",(function(){return P.k})),r.d(f,"tensor6d",(function(){return P.l})),r.d(f,"variable",(function(){return P.m})),r.d(f,"zeros",(function(){return P.n})),r.d(f,"onesLike",(function(){return P.c})),r.d(f,"zerosLike",(function(){return P.o})),r.d(f,"transpose",(function(){return Ie})),r.d(f,"softmax",(function(){return $s})),r.d(f,"logSoftmax",(function(){return Ws})),r.d(f,"norm",(function(){return Ys})),r.d(f,"gather",(function(){return Es})),r.d(f,"unsortedSegmentSum",(function(){return ws})),r.d(f,"basicLSTMCell",(function(){return qs})),r.d(f,"multiRNNCell",(function(){return Ks})),r.d(f,"movingAverage",(function(){return Zs})),r.d(f,"stridedSlice",(function(){return Js})),r.d(f,"topk",(function(){return Qs})),r.d(f,"scatterND",(function(){return to})),r.d(f,"fft",(function(){return eo})),r.d(f,"ifft",(function(){return ro})),r.d(f,"rfft",(function(){return io})),r.d(f,"irfft",(function(){return no})),r.d(f,"sparseToDense",(function(){return so})),r.d(f,"gatherND",(function(){return oo})),r.d(f,"dropout",(function(){return ao})),r.d(f,"hannWindow",(function(){return uo})),r.d(f,"hammingWindow",(function(){return lo})),r.d(f,"frame",(function(){return co})),r.d(f,"stft",(function(){return po})),r.d(f,"inTopKAsync",(function(){return fo})),r.d(f,"op",(function(){return I.a})),r.d(f,"image",(function(){return d})),r.d(f,"linalg",(function(){return c})),r.d(f,"losses",(function(){return l})),r.d(f,"spectral",(function(){return h})),r.d(f,"fused",(function(){return p})),r.d(f,"signal",(function(){return u}));var m={};r.r(m),r.d(m,"axesAreInnerMostDims",(function(){return Y})),r.d(m,"combineLocations",(function(){return q})),r.d(m,"computeOutAndReduceShapes",(function(){return K})),r.d(m,"expandShapeToKeepDim",(function(){return Z})),r.d(m,"assertAxesAreInnerMostDims",(function(){return J})),r.d(m,"getAxesPermutation",(function(){return Q})),r.d(m,"getUndoAxesPermutation",(function(){return tt})),r.d(m,"getInnerMostAxes",(function(){return et})),r.d(m,"getBroadcastDims",(function(){return _})),r.d(m,"getReductionAxes",(function(){return b})),r.d(m,"assertAndGetBroadcastShape",(function(){return x})),r.d(m,"assertParamsConsistent",(function(){return R})),r.d(m,"computeOutShape",(function(){return N})),r.d(m,"computePool2DInfo",(function(){return qt})),r.d(m,"computePool3DInfo",(function(){return Kt})),r.d(m,"computeConv2DInfo",(function(){return Zt})),r.d(m,"computeConv3DInfo",(function(){return Jt})),r.d(m,"computeDefaultPad",(function(){return Qt})),r.d(m,"tupleValuesAreOne",(function(){return ne})),r.d(m,"eitherStridesOrDilationsAreOne",(function(){return se})),r.d(m,"convertConv2DDataFormat",(function(){return oe})),r.d(m,"PARALLELIZE_THRESHOLD",(function(){return gs})),r.d(m,"computeOptimalWindowSize",(function(){return ys})),r.d(m,"nonMaxSuppressionV3",(function(){return No})),r.d(m,"nonMaxSuppressionV5",(function(){return Po})),r.d(m,"upcastType",(function(){return oa.b})),r.d(m,"getReshaped",(function(){return la})),r.d(m,"getPermuted",(function(){return ca})),r.d(m,"getReshapedPermuted",(function(){return da})),r.d(m,"getSliceBeginCoords",(function(){return pa})),r.d(m,"getSliceSize",(function(){return fa})),r.d(m,"prepareAndValidate",(function(){return Vi})),r.d(m,"validateUpdateShape",(function(){return Hi})),r.d(m,"validateInput",(function(){return $i})),r.d(m,"calculateShapes",(function(){return Wi})),r.d(m,"SELU_SCALEALPHA",(function(){return mr})),r.d(m,"SELU_SCALE",(function(){return gr})),r.d(m,"shouldFuse",(function(){return Ho})),r.d(m,"ERF_P",(function(){return ma})),r.d(m,"ERF_A1",(function(){return ga})),r.d(m,"ERF_A2",(function(){return ya})),r.d(m,"ERF_A3",(function(){return va})),r.d(m,"ERF_A4",(function(){return _a})),r.d(m,"ERF_A5",(function(){return ba})),r.d(m,"warn",(function(){return xa})),r.d(m,"log",(function(){return Ta})),r.d(m,"mergeRealAndImagArrays",(function(){return Ea})),r.d(m,"splitRealAndImagArrays",(function(){return wa})),r.d(m,"complexWithEvenIndex",(function(){return Sa})),r.d(m,"complexWithOddIndex",(function(){return Ia})),r.d(m,"getComplexWithIndex",(function(){return Aa})),r.d(m,"assignToTypedArray",(function(){return Ca})),r.d(m,"exponents",(function(){return Oa})),r.d(m,"exponent",(function(){return Ra})),r.d(m,"segment_util",(function(){return a})),r.d(m,"castTensor",(function(){return Na})),r.d(m,"reshapeTensor",(function(){return Pa})),r.d(m,"linspaceImpl",(function(){return Ma}));var g={};r.r(g),r.d(g,"nonMaxSuppressionV3",(function(){return No})),r.d(g,"nonMaxSuppressionV5",(function(){return Po})),r.d(g,"split",(function(){return Fa})),r.d(g,"tile",(function(){return La})),r.d(g,"topkImpl",(function(){return ka})),r.d(g,"whereImpl",(function(){return ir}));var y=r(5),v=(r(67),r(6));
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _(t,e){const r=t.length,i=[];for(let n=0;n<r;n++){const s=r-1-n,o=t[s]||1;(e[e.length-1-n]||1)>1&&1===o&&i.unshift(s)}return i}function b(t,e){const r=[];for(let i=0;i<e.length;i++){const n=t[t.length-i-1],s=e.length-i-1,o=e[s];(null==n||1===n&&o>1)&&r.unshift(s)}return r}function x(t,e){const r=[],i=Math.max(t.length,e.length);for(let n=0;n<i;n++){let i=t[t.length-n-1];null==i&&(i=1);let s=e[e.length-n-1];if(null==s&&(s=1),1===i)r.unshift(s);else if(1===s)r.unshift(i);else{if(i!==s){throw Error("Operands could not be broadcast together with shapes "+`${t} and ${e}.`)}r.unshift(i)}}return r}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T={kernelName:v.a,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e,n=x(r.shape,i.shape);return{a:()=>{let e=t;const i=b(r.shape,n);return i.length>0&&(e=e.sum(i)),e.reshape(r.shape)},b:()=>{let e=t;const r=b(i.shape,n);return r.length>0&&(e=e.sum(r)),e.reshape(i.shape)}}}},E={kernelName:v.b,saveAllInputs:!0,gradFunc:(t,e)=>{const r={};return e.forEach((e,i)=>{r[i]=()=>t.clone()}),r}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var w=r(10),S=r(3),I=r(4);const A=Object(I.a)({add_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let r=Object(S.a)(t,"a","add"),i=Object(S.a)(e,"b","add");[r,i]=Object(w.makeTypesMatch)(r,i);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.add(r,i);return e([r,i]),n},n,null,v.a)}});var C=r(7),O=r(1);
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function R(t,e){const r=t[0].length;t.forEach((t,e)=>{O.assert(t.length===r,()=>`Error in concat${r}D: rank of tensors[${e}] must be the same `+`as the rank of the rest (${r})`)}),O.assert(e>=0&&e<r,()=>`Error in concat${r}D: axis must be between 0 and ${r-1}.`);const i=t[0];t.forEach((t,n)=>{for(let s=0;s<r;s++)O.assert(s===e||t[s]===i[s],()=>`Error in concat${r}D: Shape of tensors[${n}] (${t}) `+`does not match the shape of the rest (${i}) `+`along the non-concatenated axis ${n}.`)})}function N(t,e){const r=t[0].slice();for(let i=1;i<t.length;i++)r[e]+=t[i][e];return r}var P=r(8);
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M=Object(I.a)({concat_:function(t,e=0){Object(O.assert)(t.length>=1,()=>"Pass at least one tensor to concat");let r=Object(S.b)(t,"tensors","concat");"complex64"===r[0].dtype&&r.forEach(t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)});const i=Object(O.parseAxisParam)(e,r[0].shape)[0],n=N(r.map(t=>t.shape),i);if(0===Object(O.sizeFromShape)(n))return Object(P.f)([],n);if(r=r.filter(t=>t.size>0),1===r.length)return r[0];R(r.map(t=>t.shape),i);const s=r,o={axis:e};return y.a.runKernelFunc((t,e)=>{const n=t.concat(r,i);return e(r),n},s,null,v.l,o)}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D(t,e="float32",r){return e=e||"float32",O.assertNonNegativeIntegerDimensions(t),new C.b(t,e,r)}function F(t,e=!1){console.log(t.toString(e))}const L=Object(I.a)({cast_:function(t,e){const r=Object(S.a)(t,"x","cast");if(!O.isValidDtype(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if("string"===e&&"string"!==r.dtype||"string"!==e&&"string"===r.dtype)throw new Error("Only strings can be casted to strings");const i={dtype:e};return y.a.runKernelFunc(t=>t.cast(r,e),{x:r},t=>({x:()=>t.clone()}),"Cast",i)}}),k=Object(I.a)({expandDims_:function(t,e=0){const r=Object(S.a)(t,"x","expandDims",null);O.assert(e<=r.rank,()=>"Axis must be <= rank of the tensor");const i=r.shape.slice();return e<0&&(O.assert(-(r.rank+1)<=e,()=>`Axis must be in the interval [${-(r.rank+1)}, ${r.rank}]`),e=r.rank+e+1),i.splice(e,0,1),U(r,i)}}),U=Object(I.a)({reshape_:function(t,e){const r=Object(S.a)(t,"x","reshape",null);e=O.inferFromImplicitShape(e,r.size),O.assert(r.size===O.sizeFromShape(e),()=>"new shape and old shape must have the same number of elements.");const i={shape:e};return y.a.runKernelFunc(t=>t.reshape(r,e),{x:r},t=>({x:()=>t.reshape(r.shape)}),"Reshape",i)}}),B=Object(I.a)({squeeze_:function(t,e){const r=Object(S.a)(t,"x","squeeze");return U(r,O.squeezeShape(r.shape,e).newShape)}}),j=Object(I.a)({stack_:function(t,e=0){const r=Object(S.b)(t,"tensors","stack");if(O.assert(r.length>=1,()=>"Pass at least one tensor to tf.stack"),1===r.length)return r[0].expandDims(e);const i=r[0].rank,n=r[0].shape,s=r[0].dtype;O.assert(e<=i,()=>"Axis must be <= rank of the tensor"),r.forEach(t=>{O.assertShapesMatch(n,t.shape,"All tensors passed to stack must have matching shapes")}),r.forEach(t=>{O.assert(s===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=r.map(t=>t.expandDims(e));return M(o,e)}}),X=Object(I.a)({unstack_:function(t,e=0){e=e||0;const r=Object(S.a)(t,"x","unstack");O.assert(e>=-r.shape.length&&e<r.shape.length,()=>`Axis = ${e} is not in [-${r.shape.length}, ${r.shape.length})`),e<0&&(e+=r.shape.length);const i={axis:e};return y.a.runKernelFunc(t=>t.unstack(r,e),{x:r},t=>({x:()=>j(t,e)}),"Unpack",i)}}),G=async function(t,e){const r=Object(S.a)(t,"x","setdiff1d"),i=Object(S.a)(e,"y","setdiff1d");O.assert(r.dtype===i.dtype,()=>`x and y should have the same dtype, but got x (${r.dtype}) and y (${i.dtype}).`),O.assert(1===r.rank,()=>`x should be 1D tensor, but got x (${r.shape}).`),O.assert(1===i.rank,()=>`y should be 1D tensor, but got y (${i.shape}).`);const n=await r.data(),s=await i.data(),o=new Set(s);let a=0;for(let t=0;t<n.length;t++)o.has(n[t])||a++;const h=new C.b([a],r.dtype),u=new C.b([a],"int32");for(let t=0,e=0;t<n.length;t++)o.has(n[t])||(h.values[e]=n[t],u.values[e]=t,e++);return[h.toTensor(),u.toTensor()]};const z=Object(I.a)({floorDiv_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let r=Object(S.a)(t,"a","floorDiv"),i=Object(S.a)(e,"b","floorDiv");[r,i]=Object(w.makeTypesMatch)(r,i);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.floorDiv(r,i);return e([r,i]),n},n,null,v.D)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V=Object(I.a)({div_:function(t,e){let r=Object(S.a)(t,"a","div"),i=Object(S.a)(e,"b","div");if([r,i]=Object(w.makeTypesMatch)(r,i),"int32"===r.dtype&&"int32"===i.dtype)return z(r,i);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.realDivide(r,i);return e([r,i]),n},n,null,v.y,{})}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H=Object(I.a)({mul_:function(t,e){let r=Object(S.a)(t,"a","mul"),i=Object(S.a)(e,"b","mul");[r,i]=Object(w.makeTypesMatch)(r,i);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.multiply(r,i);return e([r,i]),n},n,null,v.Y)}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $(t,e){O.assert(O.isFunction(t),()=>"The f passed in variableGrads(f) must be a function"),O.assert(null==e||Array.isArray(e)&&e.every(t=>t instanceof C.c),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const r=null!=e;if(!r){e=[];for(const t in y.a.registeredVariables)e.push(y.a.registeredVariables[t])}const i=r?e.filter(t=>!t.trainable):null,n=e.length;e=e.filter(t=>t.trainable),O.assert(e.length>0,()=>"variableGrads() expects at least one of the input variables to "+`be trainable, but none of the ${n} variables is `+"trainable.");const{value:s,grads:o}=y.a.gradients(t,e,null,!0);O.assert(o.some(t=>null!=t),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),O.assert(0===s.rank,()=>"The f passed in variableGrads(f) must return a scalar, but it "+`returned a rank-${s.rank} tensor`);const a={};return e.forEach((t,e)=>{null!=o[e]&&(a[t.name]=o[e])}),null!=i&&i.forEach(t=>a[t.name]=null),{value:s,grads:a}}function W(t){return y.a.customGrad(t)}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Y(t,e){for(let r=0;r<t.length;++r)if(t[t.length-r-1]!==e-1-r)return!1;return!0}function q(t,e,r){const i=t.length+e.length,n=[];let s=0,o=0;for(let a=0;a<i;a++)-1===r.indexOf(a)?n.push(t[s++]):n.push(e[o++]);return n}function K(t,e){const r=[],i=t.length;for(let n=0;n<i;n++)-1===e.indexOf(n)&&r.push(t[n]);return[r,e.map(e=>t[e])]}function Z(t,e){return q(t,e.map(t=>1),e)}function J(t,e,r){O.assert(Y(e,r),()=>`${t} supports only inner-most axes for now. `+`Got axes ${e} and rank-${r} input.`)}function Q(t,e){if(Y(t,e))return null;const r=[];for(let i=0;i<e;++i)-1===t.indexOf(i)&&r.push(i);return t.forEach(t=>r.push(t)),r}function tt(t){return t.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function et(t,e){const r=[];for(let i=e-t;i<e;++i)r.push(i);return r}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rt(t,e,r,i,n){return e.rank<r.rank&&(e=e.reshape(Z(e.shape,i))),t.rank<r.rank&&(t=t.reshape(Z(t.shape,i))),{x:()=>{const i=t.mul(r.equal(e).cast(t.dtype));return null==n?i:i.transpose(n)}}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const it=Object(I.a)({all_:function(t,e=null,r=!1){let i=Object(S.a)(t,"x","all","bool");const n=O.parseAxisParam(e,i.shape);let s=n;const o=Q(s,i.rank);null!=o&&(i=i.transpose(o),s=et(s.length,i.rank));const a=y.a.runKernelFunc(t=>t.all(i,s),{$x:i});if(r){const t=Z(a.shape,n);return a.reshape(t)}return a}}),nt=Object(I.a)({any_:function(t,e=null,r=!1){let i=Object(S.a)(t,"x","any","bool");const n=O.parseAxisParam(e,i.shape);let s=n;const o=Q(s,i.rank);null!=o&&(i=i.transpose(o),s=et(s.length,i.rank));const a=y.a.runKernelFunc(t=>t.any(i,s),{$x:i});if(r){const t=Z(a.shape,n);return a.reshape(t)}return a}}),st=Object(I.a)({argMax_:function(t,e=0){let r=Object(S.a)(t,"x","argMax");null==e&&(e=0);let i=O.parseAxisParam(e,r.shape);const n=Q(i,r.rank);null!=n&&(r=r.transpose(n),i=et(i.length,r.rank));const s={axis:i[0]},o=[r];return y.a.runKernelFunc((t,e)=>{const n=t.argMax(r,i[0]);return e([r]),n},{x:r},(t,e)=>{const[r]=e;return{x:()=>Object(P.o)(r)}},"ArgMax",s,o)}}),ot=Object(I.a)({argMin_:function(t,e=0){let r=Object(S.a)(t,"x","argMin");null==e&&(e=0);let i=O.parseAxisParam(e,r.shape);const n=Q(i,r.rank);return null!=n&&(r=r.transpose(n),i=et(i.length,r.rank)),y.a.runKernelFunc((t,e)=>{const n=t.argMin(r,i[0]);return e([r]),n},{$x:r},(t,e)=>{const[r]=e;return{$x:()=>Object(P.o)(r)}})}}),at=Object(I.a)({logSumExp_:function(t,e=null,r=!1){const i=Object(S.a)(t,"x","logSumExp"),n=O.parseAxisParam(e,i.shape),s=i.max(n,!0),o=i.sub(s).exp().sum(n).log(),a=s.reshape(o.shape).add(o);if(r){const t=Z(a.shape,n);return a.reshape(t)}return a}}),ht=Object(I.a)({mean_:function(t,e=null,r=!1){const i=Object(S.a)(t,"x","mean"),n=O.parseAxisParam(e,i.shape),s=K(i.shape,n)[1],o=O.sizeFromShape(s);return W(t=>{const i=Object(P.e)(o);return{value:(i.dtype===t.dtype?t:t.cast(i.dtype)).div(i).sum(e,r),gradFunc:e=>{const r=t.shape.slice();return n.forEach(t=>{r[t]=1}),e.reshape(r).mul(Object(P.b)(t.shape,"float32")).div(o)}}})(i)}}),ut=Object(I.a)({min_:function(t,e=null,r=!1){let i=Object(S.a)(t,"x","min");const n=i,s=O.parseAxisParam(e,i.shape);let o=s;const a=Q(o,i.rank);null!=a&&(i=i.transpose(a),o=et(o.length,i.rank));const h=[i];let u=y.a.runKernelFunc((t,e)=>{const r=t.min(i,o);return e([n,r]),r},{x:i},(t,e)=>rt(t,e[1],e[0],s,a),"Min",{axes:o},h,[!0]);if(r){const t=Z(u.shape,s);u=u.reshape(t)}return u}}),lt=Object(I.a)({moments_:function(t,e=null,r=!1){t=Object(S.a)(t,"x","moments");const i=O.parseAxisParam(e,t.shape),n=t.mean(i,r);let s=n.shape;r||(s=Z(n.shape,i));const o=t.toFloat().sub(n.reshape(s)).square();return{mean:n,variance:o.mean(i,r)}}}),ct=Object(I.a)({sum_:function(t,e=null,r=!1){let i=Object(S.a)(t,"x","sum");"bool"===i.dtype&&(i=i.toInt());const n=O.parseAxisParam(e,i.shape);return W(t=>{const e=Q(n,t.rank);let i=n,s=t;null!=e&&(s=t.transpose(e),i=et(i.length,t.rank));const o=e=>{const r=t.shape.slice();return n.forEach(t=>{r[t]=1}),e.reshape(r).mul(Object(P.b)(t.shape,"float32"))},a={axes:i};let h=y.a.runKernelFunc(t=>t.sum(s,i),{x:s},t=>({x:()=>o(t)}),"Sum",a);if(r){const t=Z(h.shape,n);h=h.reshape(t)}return{value:h,gradFunc:o}})(i)}}),dt=Object(I.a)({prod_:function(t,e=null,r=!1){let i=Object(S.a)(t,"x","prod");"bool"===i.dtype&&(i=i.toInt());const n=O.parseAxisParam(e,i.shape),s=Q(n,i.rank);let o=n,a=i;null!=s&&(a=i.transpose(s),o=et(o.length,i.rank));let h=y.a.runKernelFunc(t=>t.prod(a,o),{permutedX:a});if(r){const t=Z(h.shape,n);h=h.reshape(t)}return h}});const pt=Object(I.a)({square_:
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e=Object(S.a)(t,"x","square"),r=[e];return y.a.runKernelFunc((t,r)=>(r([e]),t.square(e)),{x:e},null,"Square",{},r,[])}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ft=Object(I.a)({abs_:function(t){const e=Object(S.a)(t,"x","abs");return"complex64"===e.dtype?y.a.runKernelFunc(t=>t.complexAbs(e),{$x:e}):y.a.runKernelFunc((t,r)=>{const i=t.abs(e);return r([e]),i},{x:e},(t,e)=>{const[r]=e;return{x:()=>t.mul(r.toFloat().step(-1))}},"Abs")}}),mt=Object(I.a)({acos_:function(t){const e=Object(S.a)(t,"x","acos");return y.a.runKernelFunc((t,r)=>{const i=t.acos(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>{const e=r.toFloat().square(),i=Object(P.e)(1).sub(e).sqrt();return t.div(i).neg()}}})}}),gt=Object(I.a)({acosh_:function(t){const e=Object(S.a)(t,"x","acosh");return y.a.runKernelFunc((t,r)=>{const i=t.acosh(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>{const e=r.toFloat().square().sub(1).sqrt();return t.div(e)}}})}}),yt=Object(I.a)({asin_:function(t){const e=Object(S.a)(t,"x","asin");return y.a.runKernelFunc((t,r)=>{const i=t.asin(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.div(Object(P.e)(1).sub(r.toFloat().square()).sqrt())}})}}),vt=Object(I.a)({asinh_:function(t){const e=Object(S.a)(t,"x","asinh");return y.a.runKernelFunc((t,r)=>{const i=t.asinh(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>{const e=Object(P.e)(1).add(r.toFloat().square()).sqrt();return t.div(e)}}})}}),_t=Object(I.a)({atan_:function(t){const e=Object(S.a)(t,"x","atan");return y.a.runKernelFunc((t,r)=>{const i=t.atan(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.div(r.toFloat().square().add(1))}})}}),bt=Object(I.a)({atanh_:function(t){const e=Object(S.a)(t,"x","atanh");return y.a.runKernelFunc((t,r)=>{const i=t.atanh(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.div(Object(P.e)(1).sub(r.toFloat().square()))}})}}),xt=Object(I.a)({ceil_:function(t){const e=Object(S.a)(t,"x","ceil");return y.a.runKernelFunc(t=>t.ceil(e),{$x:e},t=>({$x:()=>Object(P.o)(t)}))}}),Tt=Object(I.a)({clipByValue_:function(t,e,r){const i=Object(S.a)(t,"x","clipByValue");O.assert(e<=r,()=>`Error in clip: min (${e}) must be `+`less than or equal to max (${r}).`);const n=[i],s={min:e,max:r};return y.a.runKernelFunc((t,n)=>{const s=t.clip(i,e,r);return n([i]),s},{x:i},(t,i)=>{const[n]=i;return{x:()=>t.where(n.greaterEqual(e).logicalAnd(n.lessEqual(r)),Object(P.o)(t))}},"ClipByValue",s,n)}}),Et=Object(I.a)({cos_:function(t){const e=Object(S.a)(t,"x","cos"),r=[e];return y.a.runKernelFunc((t,r)=>{const i=t.cos(e);return r([e]),i},{x:e},(t,e)=>{const[r]=e;return{x:()=>r.toFloat().sin().neg().mul(t)}},"Cos",{},r)}}),wt=Object(I.a)({cosh_:function(t){const e=Object(S.a)(t,"x","cosh");return y.a.runKernelFunc((t,r)=>{const i=t.cosh(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>r.toFloat().sinh().mul(t)}})}}),St=Object(I.a)({erf_:function(t){let e=Object(S.a)(t,"x","erf");return O.assert("int32"===e.dtype||"float32"===e.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===e.dtype&&(e=e.toFloat()),y.a.runKernelFunc((t,r)=>{const i=t.erf(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.mul(r.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}})}}),It=Object(I.a)({exp_:function(t){const e=Object(S.a)(t,"x","exp");return y.a.runKernelFunc((t,r)=>{const i=t.exp(e);return r([i]),i},{x:e},(t,e)=>({x:()=>t.mul(e[0])}),"Exp",{},[],[!0])}}),At=Object(I.a)({expm1_:function(t){const e=Object(S.a)(t,"x","expm1");return y.a.runKernelFunc((t,r)=>{const i=t.expm1(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.mul(r.exp())}})}}),Ct=Object(I.a)({floor_:function(t){const e=Object(S.a)(t,"x","floor");return y.a.runKernelFunc(t=>t.floor(e),{$x:e},t=>({$x:()=>Object(P.o)(t)}))}}),Ot=Object(I.a)({log_:function(t){const e=Object(S.a)(t,"x","log"),r=[e];return y.a.runKernelFunc((t,r)=>{const i=t.log(e);return r([e]),i},{x:e},(t,e)=>{const[r]=e;return{x:()=>t.div(r.toFloat())}},"Log",{},r)}}),Rt=Object(I.a)({log1p_:function(t){const e=Object(S.a)(t,"x","log1p");return y.a.runKernelFunc((t,r)=>{const i=t.log1p(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.div(r.add(1))}})}}),Nt=Object(I.a)({logSigmoid_:function(t){const e=Object(S.a)(t,"x","logSigmoid");return y.a.runKernelFunc((t,r)=>{const i=t.softplus(e.neg()).neg();return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.mul(r.neg().sigmoid())}})}}),Pt=Object(I.a)({neg_:function(t){const e=Object(S.a)(t,"x","neg"),r=[e];return y.a.runKernelFunc(t=>t.neg(e),{x:e},t=>({x:()=>t.neg()}),"Neg",{},r)}}),Mt=Object(I.a)({reciprocal_:function(t){const e=Object(S.a)(t,"x","reciprocal");return y.a.runKernelFunc((t,r)=>{const i=t.reciprocal(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.div(r.square().neg())}})}}),Dt=Object(I.a)({round_:function(t){const e=Object(S.a)(t,"x","round");return y.a.runKernelFunc(t=>t.round(e),{$x:e},t=>({$x:()=>Object(P.o)(t)}))}}),Ft=Object(I.a)({rsqrt_:function(t){const e=Object(S.a)(t,"x","rsqrt"),r=[e];return y.a.runKernelFunc((t,r)=>{const i=t.rsqrt(e);return r([e]),i},{x:e},(t,e)=>{const[r]=e;return{x:()=>t.div(r.pow(1.5).mul(2)).neg()}},"Rsqrt",{},r)}}),Lt=Object(I.a)({sigmoid_:function(t){const e=Object(S.a)(t,"x","sigmoid");return y.a.runKernelFunc((t,r)=>{const i=t.sigmoid(e);return r([i]),i},{x:e},(t,e)=>{const[r]=e;return{x:()=>t.mul(r.mul(Object(P.e)(1).sub(r)))}},"Sigmoid")}}),kt=Object(I.a)({sign_:function(t){const e=Object(S.a)(t,"x","sign");return y.a.runKernelFunc(t=>t.sign(e),{$x:e},t=>({$x:()=>Object(P.o)(t)}))}}),Ut=Object(I.a)({isNaN_:function(t){const e=Object(S.a)(t,"x","isNaN");return y.a.runKernelFunc(t=>t.isNaN(e),{$x:e},t=>({$x:()=>Object(P.o)(t)}))}}),Bt=Object(I.a)({isInf_:function(t){const e=Object(S.a)(t,"x","isInf");return y.a.runKernelFunc(t=>t.isInf(e),{$x:e},t=>({$x:()=>Object(P.o)(t)}))}}),jt=Object(I.a)({isFinite_:function(t){const e=Object(S.a)(t,"x","isFinite");return y.a.runKernelFunc(t=>t.isFinite(e),{$x:e},t=>({$x:()=>Object(P.o)(t)}))}}),Xt=Object(I.a)({sin_:function(t){const e=Object(S.a)(t,"x","sin"),r=[e];return y.a.runKernelFunc((t,r)=>{const i=t.sin(e);return r([e]),i},{x:e},(t,e)=>{const[r]=e;return{x:()=>r.toFloat().cos().mul(t)}},"Sin",{},r)}}),Gt=Object(I.a)({sinh_:function(t){const e=Object(S.a)(t,"x","sinh");return y.a.runKernelFunc((t,r)=>{const i=t.sinh(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>r.toFloat().cosh().mul(t)}})}}),zt=Object(I.a)({softplus_:function(t){const e=Object(S.a)(t,"x","softplus");return y.a.runKernelFunc((t,r)=>{const i=t.softplus(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.mul(r.sigmoid())}})}}),Vt=Object(I.a)({sqrt_:function(t){const e=Object(S.a)(t,"x","sqrt");return y.a.runKernelFunc((t,r)=>{const i=t.sqrt(e);return r([e]),i},{x:e},(t,e)=>{const[r]=e;return{x:()=>t.div(r.toFloat().sqrt().mul(2))}},"Sqrt",{})}}),Ht=Object(I.a)({step_:function(t,e=0){const r=Object(S.a)(t,"x","step");return y.a.runKernelFunc(t=>t.step(r,e),{$x:r},t=>({$x:()=>Object(P.o)(t)}))}}),$t=Object(I.a)({tan_:function(t){const e=Object(S.a)(t,"x","tan");return y.a.runKernelFunc((t,r)=>{const i=t.tan(e);return r([e]),i},{$x:e},(t,e)=>{const[r]=e;return{$x:()=>t.div(r.cos().square())}})}}),Wt=Object(I.a)({tanh_:function(t){const e=Object(S.a)(t,"x","tanh");return y.a.runKernelFunc((t,r)=>{const i=t.tanh(e);return r([i]),i},{x:e},(t,e)=>{const[r]=e;return{x:()=>Object(P.e)(1).sub(r.square()).mul(t)}},"Tanh",{},null,[!0])}}),Yt={kernelName:v.c,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e,n=x(r.shape,i.shape);return{a:()=>{const e=A(pt(r),pt(i));let s=H(t,V(i,e));const o=b(r.shape,n);return o.length>0&&(s=ct(s,o)),U(s,r.shape)},b:()=>{const e=A(pt(r),pt(i));let s=Pt(H(t,V(r,e)));const o=b(i.shape,n);return o.length>0&&(s=ct(s,o)),U(s,i.shape)}}}};
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qt(t,e,r,i,n,s,o="channelsLast"){const[a,h]=te(e);let u;if("channelsLast"===o)u=[a,h,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);u=[a,h,t[1],t[1]]}return Zt(t,u,r,i,n,s,!1,o)}function Kt(t,e,r,i,n,s,o="NDHWC"){const[a,h,u]=ee(e);let l,c;if("NDHWC"===o)c="channelsLast",l=[a,h,u,t[4],t[4]];else{if("NCDHW"!==o)throw new Error(`Unknown dataFormat ${o}`);c="channelsFirst",l=[a,h,u,t[1],t[1]]}return Jt(t,l,r,i,n,!1,c,s)}function Zt(t,e,r,i,n,s,o=!1,a="channelsLast"){let[h,u,l,c]=[-1,-1,-1,-1];if("channelsLast"===a)[h,u,l,c]=t;else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);[h,c,u,l]=t}const[d,p,,f]=e,[m,g]=te(r),[y,v]=te(i),_=re(d,y),b=re(p,v),{padInfo:x,outHeight:T,outWidth:E}=function(t,e,r,i,n,s,o,a,h){let u,l,c;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const n=function(t,e,r,i,n){null==i&&(i=Qt(t,e,r));const s=t[0],o=t[1],a=ie((s-e+2*i)/r+1,n);O.assert(O.isInt(a),()=>`The output # of rows (${a}) must be an integer. `+"Change the stride and/or zero pad parameters");const h=ie((o-e+2*i)/r+1,n);return O.assert(O.isInt(h),()=>`The output # of columns (${h}) must be an integer. `+"Change the stride and/or zero pad parameters"),[a,h]}([e,r],s,i,t,a);l=n[0],c=n[1]}else if("same"===t){l=Math.ceil(e/i),c=Math.ceil(r/n);const t=Math.max(0,(l-1)*i+s-e),a=Math.max(0,(c-1)*n+o-r),h=Math.floor(t/2),d=t-h,p=Math.floor(a/2);u={top:h,bottom:d,left:p,right:a-p,type:"SAME"}}else if("valid"===t)u={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-s+1)/i),c=Math.ceil((r-o+1)/n);else{if("object"!=typeof t)throw Error(`Unknown padding parameter: ${t}`);{const d="channelsLast"===h?t[1][0]:t[2][0],p="channelsLast"===h?t[1][1]:t[2][1],f="channelsLast"===h?t[2][0]:t[3][0],m="channelsLast"===h?t[2][1]:t[3][1];u={top:d,bottom:p,left:f,right:m,type:0===d&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},l=ie((e-s+d+p)/i+1,a),c=ie((r-o+f+m)/n+1,a)}}return{padInfo:u,outHeight:l,outWidth:c}}(n,u,l,m,g,_,b,s,a),w=o?f*c:f;let S;return"channelsFirst"===a?S=[h,w,T,E]:"channelsLast"===a&&(S=[h,T,E,w]),{batchSize:h,dataFormat:a,inHeight:u,inWidth:l,inChannels:c,outHeight:T,outWidth:E,outChannels:w,padInfo:x,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:p,effectiveFilterHeight:_,effectiveFilterWidth:b,dilationHeight:y,dilationWidth:v,inShape:t,outShape:S,filterShape:e}}function Jt(t,e,r,i,n,s=!1,o="channelsLast",a){let[h,u,l,c,d]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[h,u,l,c,d]=t;else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);[h,d,u,l,c]=t}const[p,f,m,,g]=e,[y,v,_]=ee(r),[b,x,T]=ee(i),E=re(p,b),w=re(f,x),S=re(m,T),{padInfo:I,outDepth:A,outHeight:C,outWidth:R}=function(t,e,r,i,n,s,o,a,h,u,l){let c,d,p,f;if("number"==typeof t){c={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const s=function(t,e,r,i,n,s){null==n&&(n=Qt(t,e,i));const o=t[0],a=t[1],h=t[2],u=ie((o-e+2*n)/i+1,s);O.assert(O.isInt(u),()=>`The output # of depths (${u}) must be an integer. `+"Change the stride and/or zero pad parameters");const l=ie((a-e+2*n)/i+1,s);O.assert(O.isInt(l),()=>`The output # of rows (${l}) must be an integer. `+"Change the stride and/or zero pad parameters");const c=ie((h-e+2*n)/i+1,s);return O.assert(O.isInt(c),()=>`The output # of columns (${c}) must be an integer. `+"Change the stride and/or zero pad parameters"),[u,l,c,r]}([e,r,i,1],a,1,n,t,l);d=s[0],p=s[1],f=s[2]}else if("same"===t){d=Math.ceil(e/n),p=Math.ceil(r/s),f=Math.ceil(i/o);const t=(d-1)*n+a-e,l=(p-1)*s+h-r,m=(f-1)*o+u-i,g=Math.floor(t/2),y=t-g,v=Math.floor(l/2),_=l-v,b=Math.floor(m/2);c={top:v,bottom:_,left:b,right:m-b,front:g,back:y,type:"SAME"}}else{if("valid"!==t)throw Error(`Unknown padding parameter: ${t}`);c={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-a+1)/n),p=Math.ceil((r-h+1)/s),f=Math.ceil((i-u+1)/o)}return{padInfo:c,outDepth:d,outHeight:p,outWidth:f}}(n,u,l,c,y,v,_,E,w,S,a),N=s?g*d:g;let P;return"channelsFirst"===o?P=[h,N,A,C,R]:"channelsLast"===o&&(P=[h,A,C,R,N]),{batchSize:h,dataFormat:o,inDepth:u,inHeight:l,inWidth:c,inChannels:d,outDepth:A,outHeight:C,outWidth:R,outChannels:N,padInfo:I,strideDepth:y,strideHeight:v,strideWidth:_,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:E,effectiveFilterHeight:w,effectiveFilterWidth:S,dilationDepth:b,dilationHeight:x,dilationWidth:T,inShape:t,outShape:P,filterShape:e}}function Qt(t,e,r,i=1){const n=re(e,i);return Math.floor((t[0]*(r-1)-r+n)/2)}function te(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function ee(t){return"number"==typeof t?[t,t,t]:t}function re(t,e){return e<=1?t:t+(t-1)*(e-1)}function ie(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function ne(t){const[e,r,i]=te(t);return 1===e&&1===r&&1===i}function se(t,e){return ne(t)||ne(e)}function oe(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ae=Object(I.a)({avgPool3dBackprop_:function(t,e,r,i,n=[1,1,1],s,o){const a=Object(S.a)(t,"dy","avgPool3dBackprop"),h=Object(S.a)(e,"input","avgPool3dBackprop");let u=a,l=h,c=!1;4===h.rank&&(c=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),l=U(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),O.assert(5===u.rank,()=>"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+`${u.rank}.`),O.assert(5===l.rank,()=>"Error in avgPool3dBackprop: input must be rank 5 but got rank "+`${l.rank}.`),O.assert(se(i,n),()=>"Error in avgPool3dBackprop: Either strides or dilations "+`must be 1. Got strides ${i} and dilations '${n}'`),null!=o&&O.assert(O.isInt(s),()=>"Error in maxPool3dBackprop: pad must be an integer when "+`using, dimRoundingMode ${o} but got pad ${s}.`);const d={dy:u,input:l},p={filterSize:r,strides:i,dilations:n,pad:s,dimRoundingMode:o},f=y.a.runKernelFunc(t=>{const e=Kt(l.shape,r,i,n,s,o);return t.avgPool3dBackprop(u,l,e)},d,null,v.f,p);return c?U(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),he={kernelName:v.e,inputsToSave:["x"],gradFunc:(t,e,r)=>{const[i]=e,{filterSize:n,strides:s,dilations:o,pad:a,dimRoundingMode:h}=r,u=null==o?[1,1,1]:o;return{x:()=>ae(t,i,n,s,u,a,h)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ue=Object(I.a)({avgPoolBackprop_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i,n){const s=Object(S.a)(t,"dy","avgPoolBackprop"),o=Object(S.a)(e,"input","avgPoolBackprop");O.assert(o.rank===s.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${s.rank})`);let a=o,h=s,u=!1;3===o.rank&&(u=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2]]),h=U(s,[1,s.shape[0],s.shape[1],s.shape[2]])),O.assert(4===h.rank,()=>"Error in avgPoolBackprop: dy must be rank 4 but got rank "+`${h.rank}.`),O.assert(4===a.rank,()=>"Error in avgPoolBackprop: input must be rank 4 but got rank "+`${a.rank}.`);const l={dy:h,input:a},c={filterSize:r,strides:i,pad:n},d=y.a.runKernelFunc(t=>{const e=qt(a.shape,r,i,1,n);return t.avgPoolBackprop(h,a,e)},l,null,v.g,c);return u?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),le={kernelName:v.d,inputsToSave:["x"],gradFunc:(t,e,r)=>{const[i]=e,{filterSize:n,strides:s,pad:o}=r;return{x:()=>ue(t,i,n,s,o)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ce=Object(I.a)({matMul_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r=!1,i=!1){let n=Object(S.a)(t,"a","matMul"),s=Object(S.a)(e,"b","matMul");[n,s]=Object(w.makeTypesMatch)(n,s),O.assert(n.rank>=2&&s.rank>=2&&n.rank===s.rank,()=>"Error in matMul: inputs must have the same rank of at least 2, "+`got ranks ${n.rank} and ${s.rank}.`);const o=r?n.shape[n.rank-2]:n.shape[n.rank-1],a=i?s.shape[s.rank-1]:s.shape[s.rank-2],h=r?n.shape[n.rank-1]:n.shape[n.rank-2],u=i?s.shape[s.rank-2]:s.shape[s.rank-1],l=n.shape.slice(0,-2),c=s.shape.slice(0,-2),d=O.sizeFromShape(l),p=O.sizeFromShape(c);O.assert(O.arraysEqual(l,c),()=>`Error in matMul: outer dimensions (${l}) and (`+`${c}) of Tensors with shapes ${n.shape} and `+`${s.shape} must match.`),O.assert(o===a,()=>`Error in matMul: inner shapes (${o}) and (`+`${a}) of Tensors with shapes ${n.shape} and `+`${s.shape} and transposeA=${r}`+` and transposeB=${i} must match.`);const f=n.shape.slice(0,-2).concat([h,u]),m=U(n,r?[d,o,h]:[d,h,o]),g=U(s,i?[p,u,a]:[p,a,u]),_={a:m,b:g},b={transposeA:r,transposeB:i},x=y.a.runKernelFunc((t,e)=>(e([m,g]),t.batchMatMul(m,g,r,i)),_,null,v.h,b);return U(x,f)}}),de={kernelName:v.h,inputsToSave:["a","b"],gradFunc:(t,e,r)=>{const[i,n]=e,{transposeA:s,transposeB:o}=r;return s||o?!s&&o?{a:()=>ce(t,n,!1,!1),b:()=>ce(t,i,!0,!1)}:s&&!o?{a:()=>ce(n,t,!1,!0),b:()=>ce(i,t,!1,!1)}:{a:()=>ce(n,t,!0,!0),b:()=>ce(t,i,!0,!0)}:{a:()=>ce(t,n,!1,!0),b:()=>ce(i,t,!0,!1)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pe=Object(I.a)({spaceToBatchND_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r){const i=Object(S.a)(t,"x","spaceToBatchND");O.assert(i.rank>=1+e.length,()=>`input rank ${i.rank} should be > than [blockShape] ${e.length}`),O.assert(r.length===e.length,()=>`paddings.shape[0] ${r.length} must be equal to [blockShape] ${e.length}`),O.assert(i.shape.reduce((t,i,n)=>n>0&&n<=e.length?t&&(i+r[n-1][0]+r[n-1][1])%e[n-1]==0:t,!0),()=>`input spatial dimensions ${i.shape.slice(1)} with paddings ${r.toString()} must be divisible by blockShapes ${e.toString()}`);const n={x:i},s={blockShape:e,paddings:r};return y.a.runKernelFunc(t=>t.spaceToBatchND(i,e,r),n,null,v.lb,s)}}),fe={kernelName:v.i,gradFunc:(t,e,r)=>{const{blockShape:i,crops:n}=r;return{x:()=>pe(t,i,n)}}},me={kernelName:v.j,gradFunc:(t,e,r)=>{const i=r,n=i.inputShape,s=i.shape,o=Array.from(s);for(let t=n.length-1;t>=0;t--)if(n[t]===s[t])o[t]=1;else if(1!==n[t])throw new Error(`broadcastTo(): [${n}] cannot be broadcast to [${s}].`);const a=[];for(let t=0;t<o.length;t++)o[t]>1&&a.push(t);return{x:()=>ct(t,a,!0)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ge=Object(I.a)({split_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r=0){const i=Object(S.a)(t,"x","split"),n=Object(O.parseAxisParam)(r,i.shape)[0];let s;"number"==typeof e?(Object(O.assert)(i.shape[n]%e==0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(i.shape[n]/e)):(Object(O.assert)(i.shape[n]===e.reduce((t,e)=>t+e),()=>"The sum of sizes must match the size of the axis dimension."),s=e);const o={x:i},a={numOrSizeSplits:e,axis:r};return y.a.runKernelFunc((t,e)=>t.split(i,s,n),o,null,v.mb,a)}}),ye={kernelName:v.l,saveAllInputs:!0,gradFunc:(t,e,r)=>{const i=e.map(t=>t.shape),{axis:n}=r,s=Object(O.parseAxisParam)(n,e[0].shape)[0],o=i.map(t=>t[s]);return ge(t,o,s).map(t=>()=>t)}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ve=Object(I.a)({conv2DBackpropFilter_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i,n,s="NHWC",o){let a=t;3===t.rank&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let h=e;3===h.rank&&(h=U(e,[1,e.shape[0],e.shape[1],e.shape[2]])),O.assert(4===a.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+`${a.shape}.`),O.assert(4===h.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+`${h.shape}.`),O.assert(4===r.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+`${r}.`);const u="NHWC"===s?a.shape[3]:a.shape[1],l="NHWC"===s?h.shape[3]:h.shape[1];O.assert(u===r[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must `+`match input depth in filter (${r[2]}.`),O.assert(l===r[3],()=>`Error in conv2dDerFilter: depth of dy (${l}) must `+`match output depth for filter (${r[3]}).`),null!=o&&O.assert(O.isInt(n),()=>"Error in conv2dDerFilter: pad must be an integer when using, "+`dimRoundingMode ${o} but got pad ${n}.`);const c={x:a,dy:h},d={strides:i,pad:n,dataFormat:s,dimRoundingMode:o};return y.a.runKernelFunc(t=>{const e=oe(s),u=Zt(a.shape,r,i,1,n,o,!1,e);return t.conv2dDerFilter(a,h,u)},c,null,v.n,d)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _e=Object(I.a)({conv2DBackpropInput_:function(t,e,r,i,n,s="NHWC",o){O.assert(t.length===e.rank,()=>"Length of inShape "+`(${t.length}) and rank of dy (${e.rank}) must match`);let a=t,h=e,u=!1;3===e.rank&&(u=!0,h=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),O.assert(4===a.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+`${a.length}.`),O.assert(4===h.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got "+`rank ${h.rank}`),O.assert(4===r.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got "+`rank ${r.rank}`);const l="NHWC"===s?a[3]:a[1],c="NHWC"===s?h.shape[3]:h.shape[1];O.assert(l===r.shape[2],()=>`Error in conv2dDerInput: depth of input (${l}) must `+`match input depth for filter ${r.shape[2]}.`),O.assert(c===r.shape[3],()=>`Error in conv2dDerInput: depth of output (${c}) must `+`match output depth for filter ${r.shape[3]}.`),null!=o&&O.assert(O.isInt(n),()=>"Error in conv2dDerInput: pad must be an integer when using, "+`dimRoundingMode ${o} but got pad ${n}.`);const d={dy:h,filter:r},p={strides:i,pad:n,dataFormat:s,dimRoundingMode:o},f=y.a.runKernelFunc((t,e)=>{const u=oe(s),l=Zt(a,r.shape,i,1,n,o,!1,u),c=t.conv2dDerInput(h,r,l);return e([h,r]),c},d,null,v.o,p);return u?U(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),be={kernelName:v.m,inputsToSave:["x","filter"],gradFunc:(t,e,r)=>{const[i,n]=e,{dilations:s,strides:o,pad:a,dataFormat:h}=r;return O.assert(ne(s),()=>"Error in gradient of conv2D: dilation rates greater than 1 "+`are not yet supported in gradients. Got dilations '${s}'`),{x:()=>_e(i.shape,t,n,o,a,h),filter:()=>ve(i,t,n.shape,o,a,h)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xe=Object(I.a)({conv2d_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i,n="NHWC",s=[1,1],o){const a=Object(S.a)(t,"x","conv2d"),h=Object(S.a)(e,"filter","conv2d");let u=a,l=!1;3===a.rank&&(l=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O.assert(4===u.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),O.assert(4===h.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+`${h.rank}.`),null!=o&&O.assert(O.isInt(i),()=>"Error in conv2d: pad must be an integer when using, "+`dimRoundingMode ${o} but got pad ${i}.`);const c="NHWC"===n?u.shape[3]:u.shape[1];O.assert(c===h.shape[2],()=>`Error in conv2d: depth of input (${c}) must match `+`input depth for filter ${h.shape[2]}.`),O.assert(se(r,s),()=>"Error in conv2D: Either strides or dilations must be 1. "+`Got strides ${r} and dilations '${s}'`);const d={x:u,filter:h},p={strides:r,pad:i,dataFormat:n,dilations:s,dimRoundingMode:o},f=y.a.runKernelFunc((t,e)=>{const a=oe(n),l=Zt(u.shape,h.shape,r,s,i,o,!1,a),c=t.conv2d(u,h,l);return e([u,h]),c},d,null,v.m,p);return l?U(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),Te={kernelName:v.o,inputsToSave:["dy","filter"],gradFunc:(t,e,r)=>{const[i,n]=e,{strides:s,pad:o,dataFormat:a,dimRoundingMode:h}=r;return{dy:()=>xe(t,n,s,o,a,1,h),filter:()=>ve(t,i,n.shape,s,o,a,h)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ee=Object(I.a)({conv3DBackpropFilter_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i,n){let s=t;4===t.rank&&(s=U(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;4===o.rank&&(o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),O.assert(5===s.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+`${s.shape}.`),O.assert(5===o.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+`${o.shape}.`),O.assert(5===r.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+`${r}.`),O.assert(s.shape[4]===r[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must `+`match input depth in filter (${r[3]}.`),O.assert(o.shape[4]===r[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must `+`match output depth for filter (${r[4]}).`);const a={x:s,y:o},h={strides:i,pad:n};return y.a.runKernelFunc(t=>{const e=Jt(s.shape,r,i,1,n);return t.conv3dDerFilter(s,o,e)},a,null,v.q,h)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const we=Object(I.a)({conv3DBackpropInput_:function(t,e,r,i,n){O.assert(t.length===e.rank,()=>"Length of inShape "+`(${t.length}) and rank of dy (${e.rank}) must match`);let s=t,o=e,a=!1;4===e.rank&&(a=!0,o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);const h=s[4],u=o.shape[4];O.assert(5===s.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+`${s.length}.`),O.assert(5===o.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got "+`rank ${o.rank}`),O.assert(5===r.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got "+`rank ${r.rank}`),O.assert(h===r.shape[3],()=>`Error in conv3dDerInput: depth of input (${h}) must `+`match input depth for filter ${r.shape[3]}.`),O.assert(u===r.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must `+`match output depth for filter ${r.shape[4]}.`);const l={dy:o},c={pad:n},d=y.a.runKernelFunc(t=>{const e=Jt(s,r.shape,i,1,n);return t.conv3dDerInput(o,r,e)},l,null,v.r,c);return a?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),Se={kernelName:v.p,inputsToSave:["x","filter"],gradFunc:(t,e,r)=>{const{dilations:i,strides:n,pad:s}=r;O.assert(ne(i),()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+`not yet supported in gradients. Got dilations '${i}'`);const[o,a]=e;return{x:()=>we(o.shape,t,a,n,s),filter:()=>Ee(o,t,a.shape,n,s)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ie=Object(I.a)({transpose_:
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const r=Object(S.a)(t,"x","transpose");if(null==e&&(e=r.shape.map((t,e)=>e).reverse()),O.assert(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} `+`must match length of perm ${e}.`),e.forEach(t=>{O.assert(t>=0&&t<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1}`+` but got ${e}`)}),r.rank<=1)return r.clone();const i={perm:e};return y.a.runKernelFunc(t=>t.transpose(r,e),{x:r},null,"Transpose",i)}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ae=Object(I.a)({cumsum_:function(t,e=0,r=!1,i=!1){const n=Object(S.a)(t,"x","cumsum"),s={x:n},o={axis:e,exclusive:r,reverse:i};return y.a.runKernelFunc((t,s)=>{const o=Q([e],n.rank);let a=n;null!=o&&(a=Ie(n,o));const h=et(1,n.rank)[0];let u=t.cumsum(a,h,r,i);return s([n]),null!=o&&(u=Ie(u,o)),u},s,null,v.s,o)}}),Ce={kernelName:v.s,inputsToSave:["x"],gradFunc:(t,e,r)=>{const[i]=e,{axis:n,exclusive:s,reverse:o}=r;return{x:()=>{const e=Q([n],i.rank);let r=Ae(t,n,s,!o);return null!=e&&(r=Ie(r,e)),r}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oe=Object(I.a)({depthwiseConv2dNativeBackpropFilter_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i){let n=t;3===t.rank&&(n=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let s=e;3===s.rank&&(s=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const o={x:n,dy:s};return y.a.runKernelFunc(t=>t.depthwiseConv2DDerFilter(n,s,i),o,null,v.v)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Re=Object(I.a)({depthwiseConv2dNativeBackpropInput_:function(t,e,r,i){let n=e,s=!1;3===e.rank&&(s=!0,n=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const o={dy:n},a=y.a.runKernelFunc(t=>t.depthwiseConv2DDerInput(n,r,i),o,null,v.w);return s?U(a,[a.shape[1],a.shape[2],a.shape[3]]):a}}),Ne={kernelName:v.u,inputsToSave:["x","filter"],gradFunc:(t,e,r)=>{const{dilations:i,strides:n,pad:s,dimRoundingMode:o}=r,a=null==i?[1,1]:i;O.assert(ne(a),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+`'${a}'`);const[h,u]=e;O.assert(4===h.rank,()=>"Error in gradient of depthwiseConv2dNative: input must be "+`rank 4, but got rank ${h.rank}.`),O.assert(4===u.rank,()=>"Error in gradient of depthwiseConv2dNative: filter must be "+`rank 4, but got rank ${u.rank}.`),O.assert(h.shape[3]===u.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input "+`channels (${h.shape[3]}) must match the inChannels dimension `+`in filter ${u.shape[2]}.`),O.assert(se(n,a),()=>"Error in gradient of depthwiseConv2d: Either strides or "+`dilations must be  1. Got strides ${n} and dilations `+`'${a}'.`),null!=o&&O.assert(O.isInt(s),()=>"Error in depthwiseConv2d: pad must be an integer when using, "+`dimRoundingMode ${o} but got pad ${s}.`);const l=Zt(h.shape,u.shape,n,a,s,o,!0);return{x:()=>Re(h.shape,t,u,l),filter:()=>Oe(h,t,u.shape,l)}}},Pe={kernelName:v.y,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e,n=x(r.shape,i.shape);return{a:()=>{const e=V(t,i.toFloat()),s=b(r.shape,n);return s.length>0?ct(e,s).reshape(r.shape):e},b:()=>{let e=H(t,r.toFloat());const s=b(i.shape,n);s.length>0&&(e=U(ct(e,s),i.shape));const o=pt(i);return Pt(V(e,o.toFloat()))}}}},Me={kernelName:v.z,outputsToSave:[!0],gradFunc:(t,e)=>{const[r]=e,i=e=>e.eluDer(t,r),n={dy:t,y:r};return{x:()=>y.a.runKernelFunc(i,n,null,v.A)}}},De={kernelName:v.D,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e,n=x(r.shape,i.shape);return{a:()=>{const e=t.div(i.toFloat()),s=b(r.shape,n);return s.length>0?e.sum(s).reshape(r.shape):e},b:()=>{let e=t.mul(r.toFloat());const s=b(i.shape,n);s.length>0&&(e=e.sum(s).reshape(i.shape));const o=i.square();return e.div(o.toFloat()).neg()}}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fe=Object(I.a)({sub_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let r=Object(S.a)(t,"a","sub"),i=Object(S.a)(e,"b","sub");[r,i]=Object(w.makeTypesMatch)(r,i);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.subtract(r,i);return e([r,i]),n},n,null,v.pb)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Le=Object(I.a)({tile_:function(t,e){const r=Object(S.a)(t,"x","tile",null);O.assert(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} `+`must match length of reps ${e}.`);const i=[r],n={x:r},s={reps:e};return y.a.runKernelFunc((t,i)=>{const n=t.tile(r,e);return i([r]),n},n,null,v.qb,s,i)}}),ke={kernelName:v.F,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,r)=>{const{varianceEpsilon:i}=r,[n,s,o,a]=e,h=null==a?Object(P.e)(1):a,u=b(s.shape,n.shape),l=[];if(1===s.rank){for(let t=0;t<n.shape.length-1;++t)l.push(n.shape[t]);l.push(1)}const c=Fe(n,s),d=H(t,h),p=Ft(A(o,Object(P.e)(i))),f=H(H(H(p,p),p),Object(P.e)(-.5));return{x:()=>1===s.rank?U(H(H(t,Le(p.as4D(1,1,1,s.shape[0]),l)),h),n.shape):U(H(H(t,p),h),n.shape),mean:()=>{let t=H(H(p,Object(P.e)(-1)),d);return 1===s.rank&&(t=ct(t,u)),U(t,s.shape)},variance:()=>{let t=H(H(f,c),d);return 1===s.rank&&(t=ct(t,u)),U(t,s.shape)},scale:()=>{const e=H(c,p);let r=H(t,e);return 1===s.rank&&(r=ct(r,u)),U(r,s.shape)},offset:()=>{let e=t;return 1===s.rank&&(e=ct(e,u)),U(e,s.shape)}}}},Ue={kernelName:v.I,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e;return{a:()=>Object(P.o)(r),b:()=>Object(P.o)(i)}}},Be={kernelName:v.J,gradFunc:t=>({x:()=>t.toFloat()})};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const je=Object(I.a)({localResponseNormalizationBackprop_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i=5,n=1,s=1,o=.5){const a={x:t,y:e,dy:r},h={depthRadius:i,bias:n,alpha:s,beta:o};return y.a.runKernelFunc(a=>a.LRNGrad(r,t,e,i,n,s,o),a,null,v.M,h)}}),Xe={kernelName:v.L,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,r)=>{const[i,n]=e,{depthRadius:s,bias:o,alpha:a,beta:h}=r;return{x:()=>je(i,n,t,s,o,a,h)}}},Ge={kernelName:v.P,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,r)=>{const i=r,{reductionIndices:n}=i,[s,o]=e,a=O.parseAxisParam(n,s.shape),h=Q(a,s.rank),u=rt(t,o,s,a,h);return{x:()=>{let t=u.x();return null!=h&&(t=Ie(t)),t}}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ze=Object(I.a)({greaterEqual_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let r=Object(S.a)(t,"a","greaterEqual"),i=Object(S.a)(e,"b","greaterEqual");[r,i]=Object(w.makeTypesMatch)(r,i),x(r.shape,i.shape);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.greaterEqual(r,i);return e([r,i]),n},n,null,v.I)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ve=Object(I.a)({less_:function(t,e){let r=Object(S.a)(t,"a","less"),i=Object(S.a)(e,"b","less");[r,i]=Object(w.makeTypesMatch)(r,i),x(r.shape,i.shape);const n={a:r,b:i};return y.a.runKernelFunc(t=>t.less(r,i),n,null,v.N)}}),He={kernelName:v.V,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e;return{a:()=>H(t,L(ze(r,i),"float32")),b:()=>H(t,L(Ve(r,i),"float32"))}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $e=Object(I.a)({maxPool3dBackprop_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i,n,s=[1,1,1],o,a){const h=Object(S.a)(t,"dy","maxPool3dBackprop"),u=Object(S.a)(e,"input","maxPool3dBackprop"),l=Object(S.a)(r,"output","maxPool3dBackprop");let c=h,d=u,p=l,f=!1;4===u.rank&&(f=!0,c=U(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]]),d=U(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),p=U(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),O.assert(5===c.rank,()=>"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+`${c.rank}.`),O.assert(5===d.rank,()=>"Error in maxPool3dBackprop: input must be rank 5 but got rank "+`${d.rank}.`),O.assert(5===p.rank,()=>"Error in maxPool3dBackprop: output must be rank 5 but got rank "+`${p.rank}.`),O.assert(se(n,s),()=>"Error in maxPool3dBackprop: Either strides or dilations "+`must be 1. Got strides ${n} and dilations '${s}'`),null!=a&&O.assert(O.isInt(o),()=>"Error in maxPool3dBackprop: pad must be an integer when "+`using, dimRoundingMode ${a} but got pad ${o}.`);const m={dy:c,input:d,output:p},g={filterSize:i,strides:n,dilations:s,pad:o,dimRoundingMode:a},_=y.a.runKernelFunc(t=>{const e=Kt(d.shape,i,n,s,o,a);return t.maxPool3dBackprop(c,d,p,e)},m,null,v.S,g);return f?U(_,[_.shape[1],_.shape[2],_.shape[3],_.shape[4]]):_}}),We={kernelName:v.R,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,r)=>{const[i,n]=e,{filterSize:s,strides:o,dilations:a,pad:h,dimRoundingMode:u}=r,l=null==a?[1,1,1]:a;return{x:()=>$e(t,i,n,s,o,l,h,u)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ye=Object(I.a)({maxPoolBackprop_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i,n,s,o){const a=Object(S.a)(t,"dy","maxPoolBackprop"),h=Object(S.a)(e,"input","maxPoolBackprop"),u=Object(S.a)(r,"output","maxPoolBackprop");O.assert(h.rank===a.rank,()=>`Rank of input (${h.rank}) does not match rank of dy `+`(${a.rank})`),O.assert(4===a.rank,()=>"Error in maxPoolBackprop: dy must be rank 4 but got rank "+`${a.rank}.`),O.assert(4===h.rank,()=>"Error in maxPoolBackprop: input must be rank 4 but got rank "+`${h.rank}.`),null!=o&&O.assert(O.isInt(s),()=>"Error in maxPoolBackprop: pad must be an integer when using, "+`dimRoundingMode ${o} but got pad ${s}.`);const l={dy:a,input:h,output:u},c={filterSize:i,strides:n,pad:s,dimRoundingMode:o};return y.a.runKernelFunc(t=>{const e=qt(h.shape,i,n,1,s,o);return t.maxPoolBackprop(a,h,u,e)},l,null,v.T,c)}}),qe={kernelName:v.Q,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,r)=>{const[i,n]=e,{filterSize:s,strides:o,pad:a}=r;return{x:()=>Ye(t,i,n,s,o,a)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ke=Object(I.a)({greater_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let r=Object(S.a)(t,"a","greater"),i=Object(S.a)(e,"b","greater");[r,i]=Object(w.makeTypesMatch)(r,i),x(r.shape,i.shape);const n={a:r,b:i};return y.a.runKernelFunc(t=>t.greater(r,i),n,null,v.H)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ze=Object(I.a)({lessEqual_:function(t,e){let r=Object(S.a)(t,"a","lessEqual"),i=Object(S.a)(e,"b","lessEqual");[r,i]=Object(w.makeTypesMatch)(r,i),x(r.shape,i.shape);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.lessEqual(r,i);return e([r,i]),n},n,null,v.O)}}),Je={kernelName:v.W,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e;return{a:()=>H(t,L(Ze(r,i),"float32")),b:()=>H(t,L(Ke(r,i),"float32"))}}},Qe={kernelName:v.X,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e,n=x(r.shape,i.shape);return{a:()=>{const e=b(r.shape,n);return e.length>0?U(ct(t,e),r.shape):t},b:()=>{const e=H(t,Pt(Ct(V(r,i)))),s=b(i.shape,n);return s.length>0?U(ct(e,s),i.shape):e}}}},tr={kernelName:v.Y,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e,n=x(r.shape,i.shape);return{a:()=>{const e=H(t,L(i,"float32")),s=b(r.shape,n);return s.length>0?U(ct(e,s),r.shape):e},b:()=>{const e=H(t,L(r,"float32")),s=b(i.shape,n);return s.length>0?U(ct(e,s),i.shape):e}}}},er={kernelName:v.cb,inputsToSave:["indices"],gradFunc:(t,e)=>{const r=e[0];return{indices:()=>Object(P.n)(r.shape,"float32")}}},rr={kernelName:v.db,inputsToSave:["x"],gradFunc:(t,e,r)=>{const i=e[0],{paddings:n}=r,s=n.map(t=>t[0]);return{x:()=>t.slice(s,i.shape)}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ir(t,e){const r=[];for(let t=0;t<e.length;t++)e[t]&&r.push(t);const i=D(t,"int32"),n=D([r.length,t.length],"int32");for(let e=0;e<r.length;e++){const s=i.indexToLoc(r[e]),o=e*t.length;n.values.set(s,o)}return n.toTensor()}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nr=Object(I.a)({logicalAnd_:function(t,e){const r=Object(S.a)(t,"a","logicalAnd","bool"),i=Object(S.a)(e,"b","logicalAnd","bool");return x(r.shape,i.shape),y.a.runKernelFunc(t=>t.logicalAnd(r,i),{a:r,b:i},null,"LogicalAnd")}}),sr=Object(I.a)({logicalNot_:function(t){const e=Object(S.a)(t,"x","logicalNot","bool");return y.a.runKernelFunc(t=>t.logicalNot(e),{$x:e})}}),or=Object(I.a)({logicalOr_:function(t,e){const r=Object(S.a)(t,"a","logicalOr","bool"),i=Object(S.a)(e,"b","logicalOr","bool");return x(r.shape,i.shape),y.a.runKernelFunc(t=>t.logicalOr(r,i),{$a:r,$b:i})}}),ar=Object(I.a)({logicalXor_:function(t,e){const r=Object(S.a)(t,"a","logicalXor","bool"),i=Object(S.a)(e,"b","logicalXor","bool");return x(r.shape,i.shape),or(t,e).logicalAnd(nr(t,e).logicalNot())}}),hr=Object(I.a)({where_:function(t,e,r){const i=Object(S.a)(e,"a","where"),n=Object(S.a)(r,"b","where"),s=Object(S.a)(t,"condition","where","bool");Object(O.assertShapesMatch)(i.shape,n.shape,"Error in where: "),1===s.rank?Object(O.assert)(s.shape[0]===i.shape[0],()=>"The first dimension of `a` must match the size of `condition`."):Object(O.assertShapesMatch)(s.shape,n.shape,"Error in where: ");const o={condition:s,t:i,e:n};return y.a.runKernelFunc((t,e)=>{const r=t.select(s,i,n);return e([s]),r},o,(t,e)=>{const[r]=e;return{condition:()=>Object(P.o)(r).toFloat(),t:()=>t.mul(r.cast(t.dtype)),e:()=>t.mul(r.logicalNot().cast(t.dtype))}},v.jb)}}),ur=async function(t){const e=Object(S.a)(t,"condition","whereAsync","bool"),r=await e.data(),i=ir(e.shape,r);return t!==e&&e.dispose(),i};const lr=Object(I.a)({pow_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let r=Object(S.a)(t,"base","pow"),i=Object(S.a)(e,"exp","pow");[r,i]=Object(w.makeTypesMatch)(r,i);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.pow(r,i);return e([r,i,n]),n},n,null,v.eb)}}),cr={kernelName:v.eb,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[r,i,n]=e,s=r,o=i,a=x(s.shape,o.shape);return{a:()=>{const e=L(o,"float32");let r=H(t,H(e,lr(s,Fe(e,Object(P.e)(1)))));const i=b(s.shape,a);return i.length>0&&(r=ct(r,i)),U(r,s.shape)},b:()=>{const e=Ke(s,0),r=hr(e,Ot(s),Object(P.o)(s));let i=H(t,H(n,r));const h=b(o.shape,a);return h.length>0&&(i=ct(i,h)),U(i,o.shape)}}}},dr={kernelName:v.fb,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[r,i]=e,n=Ke(r,0);return{x:()=>hr(n,t,H(t,i)),alpha:()=>{let e=hr(n,Object(P.o)(t),H(t,r));const s=b(i.shape,t.shape);return s.length>0&&(e=ct(e,s)),U(e,i.shape)}}}},pr={kernelName:v.ib,inputsToSave:["x"],gradFunc:(t,e)=>{const[r]=e,i=H(Ze(r,6),Ht(r));return{x:()=>H(t,L(i,"float32"))}}},fr={kernelName:v.hb,inputsToSave:["x"],gradFunc:(t,e)=>{const[r]=e;return{x:()=>H(t,L(Ht(r),"float32"))}}},mr=1.7580993408473768,gr=1.0507009873554805,yr={kernelName:v.kb,inputsToSave:["x"],gradFunc:(t,e)=>{const[r]=e;return{x:()=>{const e=Ke(r,Object(P.e)(0)),i=Object(P.e)(mr),n=Object(P.e)(gr),s=H(t,n),o=H(H(t,i),It(L(r,"float32")));return hr(e,s,o)}}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vr=Object(I.a)({batchToSpaceND_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r){const i=Object(S.a)(t,"x","batchToSpaceND"),n=e.reduce((t,e)=>t*e);O.assert(i.rank>=1+e.length,()=>`input rank is ${i.rank} but should be > than blockShape.length ${e.length}`),O.assert(r.length===e.length,()=>`crops.length is ${r.length} but should be equal to blockShape.length  ${e.length}`),O.assert(i.shape[0]%n==0,()=>`input tensor batch is ${i.shape[0]} but is not divisible by the product of `+`the elements of blockShape ${e.join(" * ")} === ${n}`);const s={x:i},o={blockShape:e,crops:r};return y.a.runKernelFunc(t=>t.batchToSpaceND(i,e,r),s,null,v.i,o)}}),_r={kernelName:v.lb,gradFunc:(t,e,r)=>{const{blockShape:i,paddings:n}=r;return{x:()=>vr(t,i,n)}}},br={kernelName:v.mb,gradFunc:(t,e,r)=>{const{axis:i}=r;return{x:()=>M(t,i)}}},xr={kernelName:v.nb,inputsToSave:["x"],gradFunc:(t,e)=>{const[r]=e;return{x:()=>H(t,H(r.toFloat(),2))}}},Tr={kernelName:v.ob,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e,n=Object(P.e)(2);return{a:()=>H(t,H(n,Fe(r,i))),b:()=>H(t,H(n,Fe(i,r)))}}},Er={kernelName:v.pb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[r,i]=e,n=x(r.shape,i.shape);return{a:()=>{let e=t;const i=b(r.shape,n);return i.length>0&&(e=ct(e,i)),U(e,r.shape)},b:()=>{let e=t;const r=b(i.shape,n);return r.length>0&&(e=ct(e,r)),U(Pt(e),i.shape)}}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wr=Object(I.a)({pad_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r=0){const i=Object(S.a)(t,"x","pad");if(0===i.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const n={paddings:e,constantValue:r},s={x:i};return y.a.runKernelFunc((t,n)=>(n([i]),t.pad(i,e,r)),s,null,v.db,n)}});
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sr(t,e,r){O.assert(t.rank===e.length,()=>`Error in slice${t.rank}D: Length of begin ${e} must `+`match the rank of the array (${t.rank}).`),O.assert(t.rank===r.length,()=>`Error in slice${t.rank}D: Length of size ${r} must `+`match the rank of the array (${t.rank}).`);for(let i=0;i<t.rank;++i)O.assert(e[i]+r[i]<=t.shape[i],()=>`Error in slice${t.rank}D: begin[${i}] + size[${i}] `+`(${e[i]+r[i]}) would overflow input.shape[${i}] (${t.shape[i]})`)}function Ir(t){const e=[];let r=0;for(;t>0;)1&t&&e.push(r),t/=2,r++;return e}function Ar(t,e,r){const i=[];for(let n=0;n<t.length;n++)i[n]=Math.ceil((e[n]-t[n])/r[n]);return i}function Cr(t,e,r){const i=[...t];for(let t=0;t<r;t++)0===t?i[e]=1:(i.splice(e,0,1),i.pop());return i}function Or(t,e,r){const i=[...t];for(let t=0;t<r;t++)0===t?i[e]=0:(i.splice(e,0,0),i.pop());return i}function Rr(t,e,r,i){const n=[...t];for(let t=0;t<r;t++)0===t?n[e]=Number.MAX_SAFE_INTEGER:(n.splice(e,0,Number.MAX_SAFE_INTEGER),n.pop());for(let t=0;t<n.length;t++)n[t]=O.clamp(0,n[t],i[t]);return n}function Nr(t,e,r){let i=t[e];return(r&1<<e||null==i)&&(i=1),i}function Pr(t,e,r,i,n,s){let o=e[n];const a=r[n]||1;(t&1<<n||s&1<<n||null==o)&&(o=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const h=i[n];return o<0&&(o+=h),o=O.clamp(0,o,h-1),o}function Mr(t,e,r,i,n,s){let o=e[n];const a=r[n]||1;(t&1<<n||s&1<<n||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const h=i[n];return o<0&&(o+=h),o=a>0?O.clamp(0,o,h):O.clamp(-1,o,h-1),o}function Dr(t,e,r){let i=r.length;for(let t=0;t<r.length;t++)if(r[t]>1){i=t;break}for(let n=i+1;n<r.length;n++)if(e[n]>0||r[n]!==t[n])return!1;return!0}function Fr(t,e){let r=t.length>0?t[t.length-1]:1;for(let i=0;i<t.length-1;i++)r+=t[i]*e[i];return r}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lr=Object(I.a)({slice_:function(t,e,r){const i=Object(S.a)(t,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");let n,s;n="number"==typeof e?[e,...new Array(i.rank-1).fill(0)]:e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice(),n.forEach(t=>{O.assert(-1!==t,()=>"slice() does not support negative begin indexing.")}),s=null==r?new Array(i.rank).fill(-1):"number"==typeof r?[r,...new Array(i.rank-1).fill(-1)]:r.length<i.rank?r.concat(new Array(i.rank-r.length).fill(-1)):r,s=s.map((t,e)=>t>=0?t:(O.assert(-1===t,()=>"Negative size values should be exactly -1 but got "+`${t} for the slice() size at index ${e}.`),i.shape[e]-n[e])),Sr(i,n,s);const o=i.shape,a={begin:n,size:s};return y.a.runKernelFunc(t=>t.slice(i,n,s),{x:i},t=>{const e=[];for(let r=0;r<t.rank;r++)e.push([n[r],o[r]-n[r]-s[r]]);return{x:()=>wr(t,e)}},"Slice",a)}}),kr=Object(I.a)({slice1d_:function(t,e,r){const i=Object(S.a)(t,"x","slice1d");return O.assert(1===i.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${i.rank} tensor`),Lr(i,[e],[r])}}),Ur=Object(I.a)({slice2d_:function(t,e,r){const i=Object(S.a)(t,"x","slice2d");return O.assert(2===i.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${i.rank} tensor`),Lr(i,e,r)}}),Br=Object(I.a)({slice3d_:function(t,e,r){const i=Object(S.a)(t,"x","slice3d");return O.assert(3===i.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${i.rank} tensor`),Lr(i,e,r)}}),jr=Object(I.a)({slice4d_:function(t,e,r){const i=Object(S.a)(t,"x","slice4d");return O.assert(4===i.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${i.rank} tensor`),Lr(i,e,r)}}),Xr={kernelName:v.qb,inputsToSave:["x"],gradFunc:(t,e,r)=>{const[i]=e,{reps:n}=r;return{x:()=>{let e=Object(P.o)(i);if(1===i.rank)for(let r=0;r<n[0];++r)e=A(e,Lr(t,[r*i.shape[0]],[i.shape[0]]));else if(2===i.rank)for(let r=0;r<n[0];++r)for(let s=0;s<n[1];++s)e=A(e,Lr(t,[r*i.shape[0],s*i.shape[1]],[i.shape[0],i.shape[1]]));else if(3===i.rank)for(let r=0;r<n[0];++r)for(let s=0;s<n[1];++s)for(let o=0;o<n[2];++o)e=A(e,Lr(t,[r*i.shape[0],s*i.shape[1],o*i.shape[2]],[i.shape[0],i.shape[1],i.shape[2]]));else{if(4!==i.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+`${i.rank} tensors yet.`);for(let r=0;r<n[0];++r)for(let s=0;s<n[1];++s)for(let o=0;o<n[2];++o)for(let a=0;a<n[3];++a)e=A(e,Lr(t,[r*i.shape[0],s*i.shape[1],o*i.shape[2],a*i.shape[3]],[i.shape[0],i.shape[1],i.shape[2],i.shape[3]]))}return e}}}},Gr={kernelName:v.rb,gradFunc:(t,e,r)=>{const i=r,{perm:n}=i,s=tt(n);return{x:()=>Ie(t,s)}}};var zr=r(18);
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vr=[T,E,Yt,le,he,de,fe,me,ye,be,Te,Se,Ce,Ne,Pe,Me,De,ke,Ue,Be,Xe,er,rr,br,Ge,_r,Ge,He,qe,We,Je,Qe,tr,er,rr,cr,dr,fr,pr,yr,_r,br,xr,Tr,Xr,Gr,Er];for(const t of Vr)Object(zr.d)(t);var Hr=r(9);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $r{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}}Object(Hr.b)().get("IS_BROWSER")&&Object(Hr.b)().setPlatform("browser",new $r);r(68);var Wr=r(14);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Yr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Yr.instance&&(Yr.instance=new Yr),Yr.instance}static registerSaveRouter(t){Yr.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Yr.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Yr.getHandlers(t,"save")}static getLoadHandlers(t,e){return Yr.getHandlers(t,"load",e)}static getHandlers(t,e,r){const i=[];return("load"===e?Yr.getInstance().loadRouters:Yr.getInstance().saveRouters).forEach(e=>{const n=e(t,r);null!==n&&i.push(n)}),i}}const qr=t=>Yr.registerSaveRouter(t),Kr=t=>Yr.registerLoadRouter(t),Zr=t=>Yr.getSaveHandlers(t),Jr=(t,e)=>Yr.getLoadHandlers(t,e)
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */;class Qr{constructor(){this.managers={}}static getInstance(){return null==Qr.instance&&(Qr.instance=new Qr),Qr.instance}static registerManager(t,e){Object(O.assert)(null!=t,()=>"scheme must not be undefined or null."),t.endsWith("://")&&(t=t.slice(0,t.indexOf("://"))),Object(O.assert)(t.length>0,()=>"scheme must not be an empty string.");const r=Qr.getInstance();Object(O.assert)(null==r.managers[t],()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=e}static getManager(t){const e=this.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(this.getInstance().managers)}}function ti(t){if(-1===t.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+`${Qr.getSchemes().join(",")}`);return{scheme:t.split("://")[0],path:t.split("://")[1]}}async function ei(t,e,r=!1){Object(O.assert)(t!==e,()=>`Old path and new path are the same: '${t}'`);const i=Yr.getLoadHandlers(t);Object(O.assert)(i.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),Object(O.assert)(i.length<2,()=>`Copying failed because more than one (${i.length}) `+`load handlers for source URL ${t}.`);const n=i[0],s=Yr.getSaveHandlers(e);Object(O.assert)(s.length>0,()=>"Copying failed because no save handler is found for destination "+`URL ${e}.`),Object(O.assert)(s.length<2,()=>`Copying failed because more than one (${i.length}) `+`save handlers for destination URL ${e}.`);const o=s[0],a=ti(t).scheme,h=ti(t).path,u=a===ti(t).scheme,l=await n.load();r&&u&&await Qr.getManager(a).removeModel(h);const c=await o.save(l);return r&&!u&&await Qr.getManager(a).removeModel(h),c.modelArtifactsInfo}async function ri(){const t=Qr.getSchemes(),e={};for(const r of t){const t=await Qr.getManager(r).listModels();for(const i in t){e[r+"://"+i]=t[i]}}return e}async function ii(t){const e=ti(t);return Qr.getManager(e.scheme).removeModel(e.path)}async function ni(t,e){return ei(t,e,!1)}async function si(t,e){return ei(t,e,!0)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oi(){if(!Object(Hr.b)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"==typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function ai(t){const e=t.result;e.createObjectStore("models_store",{keyPath:"modelPath"}),e.createObjectStore("model_info_store",{keyPath:"modelPath"})}class hi{constructor(t){if(this.indexedDB=oi(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((t,r)=>{const i=this.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=()=>ai(i),i.onsuccess=()=>{const n=i.result;if(null==e){const e=n.transaction("models_store","readonly"),i=e.objectStore("models_store").get(this.modelPath);i.onsuccess=()=>{if(null==i.result)return n.close(),r(new Error(`Cannot find model with path '${this.modelPath}' `+"in IndexedDB."));t(i.result.modelArtifacts)},i.onerror=t=>(n.close(),r(i.error)),e.oncomplete=()=>n.close()}else{const i=Object(Wr.g)(e),s=n.transaction("model_info_store","readwrite");let o=s.objectStore("model_info_store");const a=o.put({modelPath:this.modelPath,modelArtifactsInfo:i});let h;a.onsuccess=()=>{h=n.transaction("models_store","readwrite");const a=h.objectStore("models_store").put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:i});a.onsuccess=()=>t({modelArtifactsInfo:i}),a.onerror=t=>{o=s.objectStore("model_info_store");const e=o.delete(this.modelPath);e.onsuccess=()=>(n.close(),r(a.error)),e.onerror=t=>(n.close(),r(a.error))}},a.onerror=t=>(n.close(),r(a.error)),s.oncomplete=()=>{null==h?n.close():h.oncomplete=()=>n.close()}}},i.onerror=t=>r(i.error)})}}hi.URL_SCHEME="indexeddb://";const ui=t=>{return Object(Hr.b)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(hi.URL_SCHEME)?(e=t.slice(hi.URL_SCHEME.length),new hi(e)):null;var e};Yr.registerSaveRouter(ui),Yr.registerLoadRouter(ui);class li{constructor(){this.indexedDB=oi()}async listModels(){return new Promise((t,e)=>{const r=this.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=()=>ai(r),r.onsuccess=()=>{const i=r.result,n=i.transaction("model_info_store","readonly"),s=n.objectStore("model_info_store").getAll();s.onsuccess=()=>{const e={};for(const t of s.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},s.onerror=t=>(i.close(),e(s.error)),n.oncomplete=()=>i.close()},r.onerror=t=>e(r.error)})}async removeModel(t){var e;return t=(e=t).startsWith(hi.URL_SCHEME)?e.slice(hi.URL_SCHEME.length):e,new Promise((e,r)=>{const i=this.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=()=>ai(i),i.onsuccess=()=>{const n=i.result,s=n.transaction("model_info_store","readwrite"),o=s.objectStore("model_info_store"),a=o.get(t);let h;a.onsuccess=()=>{if(null==a.result)return n.close(),r(new Error(`Cannot find model with path '${t}' `+"in IndexedDB."));{const i=o.delete(t),s=()=>{h=n.transaction("models_store","readwrite");const i=h.objectStore("models_store").delete(t);i.onsuccess=()=>e(a.result.modelArtifactsInfo),i.onerror=t=>r(a.error)};i.onsuccess=s,i.onerror=t=>(s(),n.close(),r(a.error))}},a.onerror=t=>(n.close(),r(a.error)),s.oncomplete=()=>{null==h?n.close():h.oncomplete=()=>n.close()}},i.onerror=t=>r(i.error)})}}if(Object(Hr.b)().getBool("IS_BROWSER"))try{Qr.registerManager(hi.URL_SCHEME,new li)}catch(t){}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ci="tensorflowjs_models",di="info",pi="model_topology",fi="weight_specs",mi="weight_data",gi="model_metadata";function yi(t){return{info:[ci,t,di].join("/"),topology:[ci,t,pi].join("/"),weightSpecs:[ci,t,fi].join("/"),weightData:[ci,t,mi].join("/"),modelMetadata:[ci,t,gi].join("/")}}function vi(t){const e=t.split("/");if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join("/")}class _i{constructor(t){if(!Object(Hr.b)().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=yi(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const e=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=Object(Wr.g)(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Object(Wr.a)(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),{modelArtifactsInfo:i}}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: `+"size quota being exceeded is a possible cause of this failure: "+`modelTopologyBytes=${i.modelTopologyBytes}, `+`weightSpecsBytes=${i.weightSpecsBytes}, `+`weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(null==r)throw new Error(`In local storage, the topology of model '${this.modelPath}' `+"is missing.");e.modelTopology=r;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==i)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' `+"are missing.");e.weightSpecs=i;const n=this.LS.getItem(this.keys.modelMetadata);if(null!=n){const t=JSON.parse(n);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,e.userDefinedMetadata=t.userDefinedMetadata}const s=this.LS.getItem(this.keys.weightData);if(null==s)throw new Error("In local storage, the binary weight values of model "+`'${this.modelPath}' are missing.`);return e.weightData=Object(Wr.b)(s),e}}_i.URL_SCHEME="localstorage://";const bi=t=>{return Object(Hr.b)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(_i.URL_SCHEME)?(e=t.slice(_i.URL_SCHEME.length),new _i(e)):null;var e};Yr.registerSaveRouter(bi),Yr.registerLoadRouter(bi);class xi{constructor(){Object(O.assert)(Object(Hr.b)().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Object(O.assert)("undefined"==typeof window||void 0!==window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},e=ci+"/",r="/"+di;for(let i=0;i<this.LS.length;++i){const n=this.LS.key(i);if(n.startsWith(e)&&n.endsWith(r)){t[vi(n)]=JSON.parse(this.LS.getItem(n))}}return t}async removeModel(t){var e;const r=yi(t=(e=t).startsWith(_i.URL_SCHEME)?e.slice(_i.URL_SCHEME.length):e);if(null==this.LS.getItem(r.info))throw new Error(`Cannot find model at path '${t}'`);const i=JSON.parse(this.LS.getItem(r.info));return this.LS.removeItem(r.info),this.LS.removeItem(r.topology),this.LS.removeItem(r.weightSpecs),this.LS.removeItem(r.weightData),i}}if(Object(Hr.b)().getBool("IS_BROWSER"))try{Qr.registerManager(_i.URL_SCHEME,new xi)}catch(t){}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ti(t){return new Promise(t=>setTimeout(t)).then(t)}class Ei{constructor(t){if(!Object(Hr.b)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Ei.URL_SCHEME)&&(t=t.slice(Ei.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},n=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),s=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor;if(s.download=this.modelTopologyFileName,s.href=n,await Ti(()=>s.dispatchEvent(new MouseEvent("click"))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await Ti(()=>t.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Object(Wr.g)(t)}}}}Ei.URL_SCHEME="downloads://";class wi{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+`but received ${t}`);this.files=t}async load(){const t=this.files[0],e=this.files.slice(1);return new Promise((r,i)=>{const n=new FileReader;n.onload=n=>{const s=JSON.parse(n.target.result),o=s.modelTopology;if(null==o)return void i(new Error(`modelTopology field is missing from file ${t.name}`));0===e.length&&r({modelTopology:o});const a=s.weightsManifest;if(null==a)return void i(new Error(`weightManifest field is missing from file ${t.name}`));let h;try{h=this.checkManifestAndWeightFiles(a,e)}catch(t){return void i(t)}const u=[],l=[],c=[];a.forEach(t=>{t.paths.forEach(t=>{l.push(t),c.push(null)}),u.push(...t.weights)}),a.forEach(t=>{t.paths.forEach(t=>{const e=new FileReader;e.onload=e=>{const i=e.target.result,n=l.indexOf(t);c[n]=i,-1===c.indexOf(null)&&r({modelTopology:o,weightSpecs:u,weightData:Object(Wr.d)(c),format:s.format,generatedBy:s.generatedBy,convertedBy:s.convertedBy,userDefinedMetadata:s.userDefinedMetadata})},e.onerror=e=>i(`Failed to weights data from file of path '${t}'.`),e.readAsArrayBuffer(h[t])})})},n.onerror=e=>i("Failed to read model topology and weights manifest JSON "+`from file '${t.name}'. BrowserFiles supports loading `+"Keras-style tf.Model artifacts only."),n.readAsText(t)})}checkManifestAndWeightFiles(t,e){const r=[],i=e.map(t=>Object(Wr.c)(t.name)),n={};for(const s of t)s.paths.forEach(t=>{const s=Object(Wr.c)(t);if(-1!==r.indexOf(s))throw new Error("Duplicate file basename found in weights manifest: "+`'${s}'`);if(r.push(s),-1===i.indexOf(s))throw new Error(`Weight file with basename '${s}' is not provided.`);n[t]=e[i.indexOf(s)]});if(r.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest "+`(${r.length}) and the number of weight files provided `+`(${e.length}).`);return n}}function Si(t){return new wi(t)}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ii(t,e,r,i){!function(t){Object(O.assert)(null!=t&&Array.isArray(t)&&t.length>0,()=>"promises must be a none empty array")}(t),function(t,e){Object(O.assert)(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but "+`got startFraction ${t}`),Object(O.assert)(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but "+`got endFraction ${e}`),Object(O.assert)(e>=t,()=>"startFraction must be no more than endFraction, but "+`got startFraction ${t} and endFraction `+`${e}`)}(r=null==r?0:r,i=null==i?1:i);let n=0;return Promise.all(t.map(s=>(s.then(s=>{const o=r+ ++n/t.length*(i-r);return e(o),s}),s)))}Yr.registerSaveRouter(t=>Object(Hr.b)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ei.URL_SCHEME)?function(t="model"){return new Ei(t)}(t.slice(Ei.URL_SCHEME.length)):null);var Ai=r(33);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ci(t,e){null==e&&(e={});const r=null==e.fetchFunc?Object(Hr.b)().platform.fetch:e.fetchFunc,i=t.map(t=>r(t,e.requestInit,{isBinary:!0})),n=(null==e.onProgress?await Promise.all(i):await Ii(i,e.onProgress,0,.5)).map(t=>t.arrayBuffer());return null==e.onProgress?await Promise.all(n):await Ii(n,e.onProgress,.5,1)}async function Oi(t,e="",r,i){return Ri(t=>Ci(t,{requestInit:i}))(t,e,r)}function Ri(t){return async(e,r="",i)=>{const n=e.map(()=>!1),s={},o=null!=i?i.map(()=>!1):[],a=[];if(e.forEach((t,e)=>{let r=0;t.weights.forEach(t=>{const h="quantization"in t?t.quantization.dtype:t.dtype,u=Ai.a[h]*O.sizeFromShape(t.shape),l=()=>{n[e]=!0,null==s[e]&&(s[e]=[]),s[e].push({manifestEntry:t,groupOffset:r,sizeBytes:u})};null!=i?i.forEach((e,r)=>{e===t.name&&(l(),o[r]=!0)}):l(),a.push(t.name),r+=u})}),!o.every(t=>t)){const t=i.filter((t,e)=>!o[e]);throw new Error("Could not find weights in manifest with names: "+`${t.join(", ")}. \n`+"Manifest JSON has weights with names: "+`${a.join(", ")}.`)}const h=n.reduce((t,e,r)=>(e&&t.push(r),t),[]),u=[];h.forEach(t=>{e[t].paths.forEach(t=>{const e=r+(r.endsWith("/")?"":"/")+t;u.push(e)})});const l=await t(u),c={};let d=0;return h.forEach(t=>{const r=e[t].paths.length;let i=0;for(let t=0;t<r;t++)i+=l[d+t].byteLength;const n=new ArrayBuffer(i),o=new Uint8Array(n);let a=0;for(let t=0;t<r;t++){const e=new Uint8Array(l[d+t]);o.set(e,a),a+=e.byteLength}s[t].forEach(t=>{const e=n.slice(t.groupOffset,t.groupOffset+t.sizeBytes),r=Object(Wr.e)(e,[t.manifestEntry]);for(const t in r)c[t]=r[t]}),d+=r}),c}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ni{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(Object(O.assert)("function"==typeof e.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=Object(Hr.b)().platform.fetch,Object(O.assert)(null!=t&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&Object(O.assert)(2===t.length,()=>"URL paths for http must have a length of 2, "+`(actual length is ${t.length}).`),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r};e.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin");const n=await this.fetch(this.path,e);if(n.ok)return{modelArtifactsInfo:Object(Wr.g)(t),responses:[n]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+`${n.status}.`)}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code `+`${t.status}. Please verify this URL points to `+"the model JSON of the model to load.");let e;try{e=await t.json()}catch(t){let e=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",new Error(e)}const r=e.modelTopology,i=e.weightsManifest,n=e.generatedBy,s=e.convertedBy,o=e.format,a=e.userDefinedMetadata;if(null==r&&null==i)throw new Error(`The JSON from HTTP path ${this.path} contains neither model `+"topology or manifest for weights.");let h,u;if(null!=i){const t=await this.loadWeights(i);[h,u]=t}return{modelTopology:r,weightSpecs:h,weightData:u,userDefinedMetadata:a,generatedBy:n,convertedBy:s,format:o}}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[r,i]=function(t){const e=t.lastIndexOf("/"),r=t.lastIndexOf("?"),i=t.substring(0,e),n=r>e?t.substring(r):"";return[i+"/",n]}(e),n=this.weightPathPrefix||r,s=[];for(const e of t)s.push(...e.weights);const o=[];t.forEach(t=>{t.paths.forEach(t=>{o.push(n+t+i)})});const a=await Ci(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[s,Object(Wr.d)(a)]}}function Pi(t){return null!=t.match(Ni.URL_SCHEME_REGEX)}Ni.URL_SCHEME_REGEX=/^https?:\/\//;const Mi=(t,e)=>{if("undefined"==typeof fetch&&(null==e||null==e.fetchFunc))return null;{let r=!0;if(r=Array.isArray(t)?t.every(t=>Pi(t)):Pi(t),r)return Di(t,e)}return null};function Di(t,e){return new Ni(t,e)}function Fi(t,e){return Di(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Yr.registerSaveRouter(Mi),Yr.registerLoadRouter(Mi);class Li{constructor(t){this.modelArtifacts=t}async load(){return this.modelArtifacts}}class ki{constructor(t){this.saveHandler=t}async save(t){return this.saveHandler(t)}}function Ui(t,e,r,i){if(1===arguments.length){return null!=t.modelTopology||null!=t.weightSpecs?new Li(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Li({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Li({modelTopology:t,weightSpecs:e,weightData:r,trainingConfig:i})}function Bi(t){return new ki(t)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ji=Object(I.a)({oneHot_:function(t,e,r=1,i=0){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);let n=Object(S.a)(t,"indices","oneHot","int32");const s=[...n.shape,e];n=n.flatten();const o={indices:n},a={depth:e,onValue:r,offValue:i};return y.a.runKernelFunc((t,o)=>(o([n]),U(t.oneHot(n,e,r,i),s)),o,null,v.cb,a)}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object(I.a)({confusionMatrix_:function(t,e,r){const i=Object(S.a)(t,"labels","confusionMatrix"),n=Object(S.a)(e,"predictions","confusionMatrix");O.assert(null==r||r>0&&Number.isInteger(r),()=>"If provided, numClasses must be a positive integer, "+`but got ${r}`),O.assert(1===i.rank,()=>`Expected the rank of labels to be 1, but got ${i.rank}`),O.assert(1===n.rank,()=>"Expected the rank of predictions to be 1, "+`but got ${n.rank}`),O.assert(i.shape[0]===n.shape[0],()=>"Mismatch in the number of examples: "+`${i.shape[0]} vs. ${n.shape[0]}. `+"Labels and predictions should have the same number of elements."),O.assert(r>0&&Number.isInteger(r),()=>"numClasses is required to be a positive integer, but got "+`${r}`);const s=ji(i.asType("int32"),r),o=ji(n.asType("int32"),r);return s.transpose().matMul(o).asType("int32")}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Xi;async function Gi(t,e){let r=Object(S.a)(t,"img","toPixels");if(!(t instanceof C.a)){const t=r;r=t.toInt(),t.dispose()}if(2!==r.rank&&3!==r.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${r.rank}.`);const[i,n]=r.shape.slice(0,2),s=2===r.rank?1:r.shape[2];if(s>4||2===s)throw new Error("toPixels only supports depth of size "+`1, 3 or 4 but got ${s}`);const o=await r.data(),a=r.min(),h=r.max(),u=await Promise.all([a.data(),h.data()]),l=u[0],c=u[1],d=l[0],p=c[0];if(a.dispose(),h.dispose(),"float32"===r.dtype){if(d<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the "+`range [0 - 1] but got range [${d} - ${p}].`)}else{if("int32"!==r.dtype)throw new Error(`Unsupported type for toPixels: ${r.dtype}.`+" Please use float32 or int32 tensors.");if(d<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the "+`range [0 - 255] but got range [${d} - ${p}].`)}const f="float32"===r.dtype?255:1,m=new Uint8ClampedArray(n*i*4);for(let t=0;t<i*n;++t){let e,r,i,n;1===s?(e=o[t]*f,r=o[t]*f,i=o[t]*f,n=255):3===s?(e=o[3*t]*f,r=o[3*t+1]*f,i=o[3*t+2]*f,n=255):4===s&&(e=o[4*t]*f,r=o[4*t+1]*f,i=o[4*t+2]*f,n=o[4*t+3]*f);const a=4*t;m[a+0]=Math.round(e),m[a+1]=Math.round(r),m[a+2]=Math.round(i),m[a+3]=Math.round(n)}if(null!=e){e.width=n,e.height=i;const t=e.getContext("2d"),r=new ImageData(m,n,i);t.putImageData(r,0,0)}return r!==t&&r.dispose(),m}const zi=Object(I.a)({fromPixels_:function(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let r=!1,i=!1,n=!1,s=!1,o=!1;if(t.data instanceof Uint8Array)r=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)i=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)n=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)s=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+`but was ${t.constructor.name}`);o=!0}if(n){const e=2;if(n&&t.readyState<e)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=Object(zr.b)(v.E,y.a.backendName)){const r={pixels:t},i={numChannels:e};return y.a.runKernel(v.E,r,i)}const[a,h]=n?[t.videoWidth,t.videoHeight]:[t.width,t.height];let u,l;if(o?u=t.getContext("2d").getImageData(0,0,a,h).data:i||r?u=t.data:(s||n)&&(null==Xi&&(Xi=document.createElement("canvas").getContext("2d")),Xi.canvas.width=a,Xi.canvas.height=h,Xi.drawImage(t,0,0,a,h),u=Xi.getImageData(0,0,a,h).data),4===e)l=new Int32Array(u);else{const t=a*h;l=new Int32Array(t*e);for(let r=0;r<t;r++)for(let t=0;t<e;++t)l[r*e+t]=u[4*r+t]}const c=[h,a,e];return Object(P.i)(l,c,"int32")}});function Vi(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+` but the rank was ${t.rank}.`);if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+` but the rank was ${e.rank}.`);if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+` but the dtype was ${e.dtype}.`);if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+`${e.shape[e.rank-1]} vs. ${t.rank}`);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty."+` Input shape: ${t.shape}.`);const r=e.shape,i=r[r.length-1];let n=1;for(let t=0;t<r.length-1;++t)n*=r[t];const s=t.shape,o=r.slice();o.pop();let a=1;for(let e=i;e<t.rank;++e)a*=s[e],o.push(s[e]);const h=[...Object(O.computeStrides)(t.shape).map(t=>t/a),1].slice(0,i);return[o,n,a,h]}function Hi(t,e,r){const i=e.rank>1?e.shape[e.rank-1]:1,n=e.rank>1?e.rank-1:1,s="Must have updates.shape = indices.shape[:batchDim] + "+`shape[sliceDim:], got updates.shape: ${r.shape}`+`, indices.shape: ${e.shape}, shape: ${t}`+`, sliceDim: ${i}, and batchDim: ${n}.`;if(r.rank<n)throw new Error(s+` update.rank < ${n}. `);if(t.length<i+(r.rank-n))throw new Error(s+` Output shape length < ${i+(r.rank-n)}`);if(r.rank!==n+t.length-i)throw new Error(s+` update.rank != ${n+t.length-i}`);for(let t=0;t<n;++t)if(r.shape[t]!==e.shape[t])throw new Error(s+` updates.shape[${t}] (${r.shape[t]}) != indices.shape[${t}] (${e.shape[t]}).`);for(let e=0;e<r.rank-n;++e)if(r.shape[e+n]!==t[e+i])throw new Error(s+` updates.shape[${e+n}] (${r.shape[e+n]}) != shape[${e+n}] (${t[e+n]})`)}function $i(t,e,r){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+` but the rank was ${e.rank}.`);if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+` but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(r.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${r}`);if(0===r.length){if(0===e.size)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(0===t.size)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}Hi(r,e,t)}function Wi(t,e,r){const i=e.shape.length,n=i>1?e.shape[i-1]:1,s=r.length;let o=1;for(let t=n;t<s;++t)o*=r[t];const a=n<1?1:n;return{sliceRank:n,numUpdates:Object(O.sizeFromShape)(e.shape)/a,sliceSize:o,strides:[...Object(O.computeStrides)(r.slice(0,n)),1],outputSize:Object(O.sizeFromShape)(r)}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yi{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class qi{constructor(){this.classNameMap={}}static getMap(){return null==qi.instance&&(qi.instance=new qi),qi.instance}static register(t){qi.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Ki(t){Object(O.assert)(null!=t.className,()=>"Class being registered does not have the static className property defined."),Object(O.assert)("string"==typeof t.className,()=>"className is required to be a string, but got type "+typeof t.className),Object(O.assert)(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),qi.register(t)}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zi(t){Object(Hr.b)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ji(){return y.a}function Qi(){return y.a.memory()}function tn(t,e){return y.a.tidy(t,e)}function en(t){Object(w.getTensorsInContainer)(t).forEach(t=>t.dispose())}function rn(t){return y.a.keep(t)}function nn(t){return y.a.setBackend(t)}function sn(t,e,r=1){return y.a.registerBackend(t,e,r)}function on(){return y.a.backend}Object(C.d)(Zi);const an=Object(I.a)({addN_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){O.assert(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),O.assert(t.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+`${t.length}`);const e=t.map((t,e)=>Object(S.a)(t,`tensors${e}`,"addN")),r=e[0];e.forEach(t=>{if(t.dtype!==r.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(t=>{if(!O.arraysEqual(t.shape,r.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const i=e;return y.a.runKernelFunc((t,r)=>{const i=t.addN(e);return r(e),i},i,null,v.b)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hn=Object(I.a)({atan2_:function(t,e){let r=Object(S.a)(t,"a","atan2"),i=Object(S.a)(e,"b","atan2");[r,i]=Object(w.makeTypesMatch)(r,i);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.atan2(r,i);return e([r,i]),n},n,null,v.c)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const un=Object(I.a)({avgPool_:function(t,e,r,i,n){const s=Object(S.a)(t,"x","avgPool","float32");O.assert(se(r,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+`Got strides ${r} and dilations '1'`);let o=s,a=!1;3===s.rank&&(a=!0,o=U(s,[1,s.shape[0],s.shape[1],s.shape[2]])),O.assert(4===o.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),null!=n&&O.assert(O.isInt(i),()=>"Error in avgPool: pad must be an integer when using, "+`dimRoundingMode ${n} but got pad ${i}.`);const h={x:o},u={filterSize:e,strides:r,pad:i,dimRoundingMode:n};let l=y.a.runKernelFunc((t,s)=>{const a=qt(o.shape,e,r,1,i,n);return s([o]),1===a.filterWidth&&1===a.filterHeight&&O.arraysEqual(a.inShape,a.outShape)?o.clone():t.avgPool(o,a)},h,null,v.d,u);return l=L(l,s.dtype),a?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ln=Object(I.a)({avgPool3d_:function(t,e,r,i,n,s="NDHWC",o){null==o?o=[1,1,1]:Zi("dilations is deprecated, this field will be gone in v3.0.0.");const a=Object(S.a)(t,"x","avgPool3d","float32");let h=a,u=!1;4===a.rank&&(u=!0,h=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),O.assert(5===h.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${h.rank}.`),O.assert("NDHWC"===s,()=>"Error in avgPool3d: Only NDHWC is currently supported, "+`but got dataFormat of ${s}`),O.assert(se(r,o),()=>"Error in avgPool3d: Either strides or dilations must be 1. "+`Got strides ${r} and dilations '${o}'`),null!=n&&O.assert(O.isInt(i),()=>"Error in avgPool3d: pad must be an integer when using, "+`dimRoundingMode ${n} but got pad ${i}.`);const l={x:h},c={filterSize:e,strides:r,pad:i,dimRoundingMode:n,dataFormat:s,dilations:o};let d=y.a.runKernelFunc((t,a)=>{null==o&&(o=[1,1,1]);const u=Kt(h.shape,e,r,o,i,n,s);return a([h]),t.avgPool3d(h,u)},l,null,v.e,c);return d=L(d,h.dtype),u?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}});function cn(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}const dn=Object(I.a)({batchNorm_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i,n,s){null==s&&(s=.001);const o=Object(S.a)(t,"x","batchNorm"),a=Object(S.a)(e,"mean","batchNorm"),h=Object(S.a)(r,"variance","batchNorm");let u,l;null!=n&&(u=Object(S.a)(n,"scale","batchNorm")),null!=i&&(l=Object(S.a)(i,"offset","batchNorm")),O.assert(a.rank===h.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O.assert(null==l||a.rank===l.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O.assert(null==u||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const c=function(t){let e;return e=0===t.rank||1===t.rank?t.as4D(1,1,1,t.size):2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t,e}(o),d={x:c,scale:u,offset:l,mean:a,variance:h},p={varianceEpsilon:s},f=y.a.runKernelFunc((t,e)=>(e([c,a,h,u]),t.batchNorm(c,cn(a),cn(h),cn(l),cn(u),s)),d,null,v.F,p);return U(f,o.shape)}});const pn=Object(I.a)({batchNorm2d_:function(t,e,r,i,n,s){const o=Object(S.a)(t,"x","batchNorm"),a=Object(S.a)(e,"mean","batchNorm"),h=Object(S.a)(r,"variance","batchNorm");let u,l;return null!=n&&(u=Object(S.a)(n,"scale","batchNorm")),null!=i&&(l=Object(S.a)(i,"offset","batchNorm")),O.assert(2===o.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+`${o.rank}.`),O.assert(2===a.rank||1===a.rank,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+`got rank ${a.rank}.`),O.assert(2===h.rank||1===h.rank,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+`but got rank ${h.rank}.`),null!=u&&O.assert(2===u.rank||1===u.rank,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+`but got rank ${u.rank}.`),null!=l&&O.assert(2===l.rank||1===l.rank,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+`but got rank ${l.rank}.`),dn(o,a,h,l,u,s)}});const fn=Object(I.a)({batchNorm3d_:function(t,e,r,i,n,s){const o=Object(S.a)(t,"x","batchNorm"),a=Object(S.a)(e,"mean","batchNorm"),h=Object(S.a)(r,"variance","batchNorm");let u,l;return null!=n&&(u=Object(S.a)(n,"scale","batchNorm")),null!=i&&(l=Object(S.a)(i,"offset","batchNorm")),O.assert(3===o.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+`${o.rank}.`),O.assert(3===a.rank||1===a.rank,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+`got rank ${a.rank}.`),O.assert(3===h.rank||1===h.rank,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+`but got rank ${h.rank}.`),null!=u&&O.assert(3===u.rank||1===u.rank,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+`but got rank ${u.rank}.`),null!=l&&O.assert(3===l.rank||1===l.rank,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+`but got rank ${l.rank}.`),dn(o,a,h,l,u,s)}});const mn=Object(I.a)({batchNorm4d_:function(t,e,r,i,n,s){const o=Object(S.a)(t,"x","batchNorm"),a=Object(S.a)(e,"mean","batchNorm"),h=Object(S.a)(r,"variance","batchNorm");let u,l;return null!=n&&(u=Object(S.a)(n,"scale","batchNorm")),null!=i&&(l=Object(S.a)(i,"offset","batchNorm")),O.assert(4===o.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+`${o.rank}.`),O.assert(4===a.rank||1===a.rank,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+`got rank ${a.rank}.`),O.assert(4===h.rank||1===h.rank,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+`but got rank ${h.rank}.`),null!=u&&O.assert(4===u.rank||1===u.rank,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+`but got rank ${u.rank}.`),null!=l&&O.assert(4===l.rank||1===l.rank,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+`but got rank ${l.rank}.`),dn(o,a,h,l,u,s)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gn=Object(I.a)({clone_:function(t){const e=Object(S.a)(t,"x","clone",null);return y.a.runKernelFunc(()=>y.a.makeTensorFromDataId(e.dataId,e.shape,e.dtype),{x:e},null,v.J)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yn=Object(I.a)({broadcastTo_:function(t,e){let r=Object(S.a)(t,"broadcastTo","x");const i=r.shape;if(e.some(t=>!(t>0)||t%1!=0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<r.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${r.rank}.`);if(e.length>r.rank){const t=r.shape.slice();for(;t.length<e.length;)t.unshift(1);r=U(r,t)}const n=r.shape,s=Array.from(e);for(let t=e.length-1;t>=0;t--)if(n[t]===e[t])s[t]=1;else if(1!==r.shape[t])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${e}].`);if(0===s.map((t,e)=>t>1?e:-1).filter(t=>t>=0).length)return gn(r);const o={x:r},a={shape:e,inputShape:n};return y.a.runKernelFunc(t=>t.tile(r,s),o,null,v.j,a)}});var vn=r(19);const _n=Object(I.a)({concat1d_:function(t){return M(t,0)}});const bn=Object(I.a)({concat2d_:function(t,e){return M(t,e)}});const xn=Object(I.a)({concat3d_:function(t,e){return M(t,e)}});const Tn=Object(I.a)({concat4d_:function(t,e){return M(t,e)}});const En=Object(I.a)({conv1d_:function(t,e,r,i,n="NWC",s=1,o){const a=Object(S.a)(t,"x","conv1d"),h=Object(S.a)(e,"filter","conv1d");let u=a,l=!1;2===a.rank&&(l=!0,u=U(a,[1,a.shape[0],a.shape[1]])),O.assert(3===u.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),O.assert(3===h.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+`${h.rank}.`),null!=o&&O.assert(O.isInt(i),()=>"Error in conv1d: pad must be an integer when using, "+`dimRoundingMode ${o} but got pad ${i}.`),O.assert(u.shape[2]===h.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match `+`input depth for filter ${h.shape[1]}.`),O.assert(se(r,s),()=>"Error in conv1D: Either stride or dilation must be 1. "+`Got stride ${r} and dilation '${s}'`),O.assert("NWC"===n,()=>`Error in conv1d: got dataFormat of ${n} but only NWC is currently supported.`);const c=U(h,[1,h.shape[0],h.shape[1],h.shape[2]]),d=U(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=xe(d,c,[1,r],i,"NHWC",[1,s],o);return U(p,l?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});const wn=Object(I.a)({conv2dTranspose_:function(t,e,r,i,n,s){const o=Object(S.a)(t,"x","conv2dTranspose"),a=Object(S.a)(e,"filter","conv2dTranspose");return _e(r,o,a,i,n,"NHWC",s)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sn=Object(I.a)({conv3d_:function(t,e,r,i,n="NDHWC",s=[1,1,1]){const o=Object(S.a)(t,"x","conv3d"),a=Object(S.a)(e,"filter","conv3d");let h=o,u=!1;4===o.rank&&(u=!0,h=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O.assert(5===h.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${h.rank}.`),O.assert(5===a.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+`${a.rank}.`),O.assert(h.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${h.shape[4]}) must match `+`input depth for filter ${a.shape[3]}.`),O.assert(se(r,s),()=>"Error in conv3D: Either strides or dilations must be 1. "+`Got strides ${r} and dilations '${s}'`),O.assert("NDHWC"===n,()=>`Error in conv3d: got dataFormat of ${n} but only NDHWC is currently supported.`);const l={x:h,filter:a},c={strides:r,pad:i,dataFormat:n,dilations:s},d=y.a.runKernelFunc((t,e)=>{const n=Jt(h.shape,a.shape,r,s,i),o=t.conv3d(h,a,n);return e([h,a]),o},l,null,v.p,c);return u?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}});const In=Object(I.a)({conv3dTranspose_:function(t,e,r,i,n){const s=Object(S.a)(t,"x","conv3dTranspose"),o=Object(S.a)(e,"filter","conv3dTranspose");return we(r,s,o,i,n)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const An=Object(I.a)({depthToSpace_:function(t,e,r="NHWC"){const i=Object(S.a)(t,"x","depthToSpace"),n="NHWC"===r?i.shape[1]:i.shape[2],s="NHWC"===r?i.shape[2]:i.shape[3],o="NHWC"===r?i.shape[3]:i.shape[1];O.assert(n*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${n} and ${e}  for depthToSpace with input shape\n    ${i.shape}`),O.assert(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${e} for depthToSpace with input shape\n        ${i.shape}`),O.assert(o%(e*e)==0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${i.shape}`);const a={x:i},h={blockSize:e,dataFormat:r};return y.a.runKernelFunc(t=>t.depthToSpace(i,e,r),a,null,v.t,h)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cn=Object(I.a)({depthwiseConv2d_:function(t,e,r,i,n="NHWC",s=[1,1],o){const a=Object(S.a)(t,"x","depthwiseConv2d"),h=Object(S.a)(e,"filter","depthwiseConv2d");let u=a,l=!1;3===a.rank&&(l=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O.assert(4===u.rank,()=>"Error in depthwiseConv2d: input must be rank 4, but got "+`rank ${u.rank}.`),O.assert(4===h.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+`${h.rank}.`),O.assert(u.shape[3]===h.shape[2],()=>"Error in depthwiseConv2d: number of input channels "+`(${u.shape[3]}) must match the inChannels dimension in `+`filter ${h.shape[2]}.`),null!=o&&O.assert(O.isInt(i),()=>"Error in depthwiseConv2d: pad must be an integer when using, "+`dimRoundingMode ${o} but got pad ${i}.`);const c={x:u,filter:h},d={strides:r,pad:i,dataFormat:n,dilations:s,dimRoundingMode:o},p=y.a.runKernelFunc((t,e)=>{null==s&&(s=[1,1]),O.assert(se(r,s),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+`1. Got strides ${r} and dilations '${s}'`);const n=Zt(u.shape,h.shape,r,s,i,o,!0),a=t.depthwiseConv2D(u,h,n);return e([u,h]),a},c,null,v.u,d);return l?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const On=Object(I.a)({diag_:function(t){const e=Object(S.a)(t,"x","diag").flatten(),r={x:e};return y.a.runKernelFunc(r=>{const i=r.diag(e),n=[...t.shape,...t.shape];return U(i,n)},r,null,v.x)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rn=Object(I.a)({divNoNan_:function(t,e){let r=Object(S.a)(t,"a","div"),i=Object(S.a)(e,"b","div");[r,i]=Object(w.makeTypesMatch)(r,i);const n=V(r,i),s=Object(P.o)(n),o=i.equal(s);return hr(o,s,n)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nn=Object(I.a)({dot_:function(t,e){const r=Object(S.a)(t,"t1","dot"),i=Object(S.a)(e,"t2","dot");O.assert(!(1!==r.rank&&2!==r.rank||1!==i.rank&&2!==i.rank),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+`${r.rank} and ${i.rank}.`);const n=1===r.rank?r.size:r.shape[1],s=1===i.rank?i.size:i.shape[0];if(O.assert(n===s,()=>"Error in dot: inner dimensions of inputs must match, but got "+`${n} and ${s}.`),1===r.rank&&1===i.rank){const t=U(r,[1,-1]),e=U(i,[-1,1]),n=ce(t,e);return U(n,[])}if(1===r.rank&&2===i.rank){const t=U(r,[1,-1]),e=U(i,[i.shape[0],i.shape[1]]),n=ce(t,e);return U(n,[n.size])}if(2===r.rank&&1===i.rank){const t=U(i,[-1,1]),e=ce(r,t);return U(e,[e.size])}{const t=U(i,[i.shape[0],i.shape[1]]);return ce(r,t)}}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pn=Object(I.a)({elu_:function(t){const e=Object(S.a)(t,"x","elu"),r={x:e};return y.a.runKernelFunc((t,r)=>{const i=t.elu(e);return r([i]),i},r,null,v.z)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mn=Object(I.a)({equal_:function(t,e){let r=Object(S.a)(t,"a","equal"),i=Object(S.a)(e,"b","equal");[r,i]=Object(w.makeTypesMatch)(r,i),x(r.shape,i.shape);const n={a:r,b:i};return y.a.runKernelFunc(t=>t.equal(r,i),n,null,v.B)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dn=Object(I.a)({eye_:function(t,e,r,i="float32"){null==e&&(e=t);const n=D([t,e],i),s=t<=e?t:e;for(let t=0;t<s;++t)n.set(1,t,t);const o=n.toTensor().as2D(t,e);if(null==r)return o;if(1===r.length)return Le(k(o,0),[r[0],1,1]);if(2===r.length)return Le(k(k(o,0),0),[r[0],r[1],1,1]);if(3===r.length)return Le(k(k(k(o,0),0),0),[r[0],r[1],r[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+`batchShapes, but received ${r.length}D.`)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fn(t,e,r){const i={shape:t,value:e,dtype:r};return y.a.runKernelFunc(i=>i.fill(t,e,r),{},null,v.C,i)}var Ln=r(29);
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kn=Object(I.a)({maximum_:function(t,e){let r=Object(S.a)(t,"a","maximum"),i=Object(S.a)(e,"b","maximum");[r,i]=Object(w.makeTypesMatch)(r,i),"bool"===r.dtype&&(r=L(r,"int32"),i=L(i,"int32")),x(r.shape,i.shape);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.maximum(r,i);return e([r,i]),n},n,null,v.V)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Un=Object(I.a)({leakyRelu_:function(t,e=.2){const r=Object(S.a)(t,"x","leakyRelu");return kn(H(Object(P.e)(e),r),r)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bn=Object(I.a)({localResponseNormalization_:function(t,e=5,r=1,i=1,n=.5){const s=Object(S.a)(t,"x","localResponseNormalization");O.assert(4===s.rank||3===s.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${s.rank}.`),O.assert(O.isInt(e),()=>"Error in localResponseNormalization: depthRadius must be an "+`integer but got depthRadius ${e}.`);let o=s,a=!1;3===s.rank&&(a=!0,o=U(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const h={x:o},u={depthRadius:e,bias:r,alpha:i,beta:n},l=y.a.runKernelFunc((t,s)=>{const a=t.localResponseNormalization4D(o,e,r,i,n);return s([o,a]),a},h,null,v.L,u);return a?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jn=Object(I.a)({max_:function(t,e=null,r=!1){const i=Object(S.a)(t,"x","max"),n={x:i},s={reductionIndices:e,keepDims:r},o=y.a.runKernelFunc((t,r)=>{let n=O.parseAxisParam(e,i.shape);const s=Q(n,i.rank);let o=i;null!=s&&(o=Ie(i,s),n=et(n.length,o.rank));const a=t.max(o,n);return r([i,a]),null!=s&&t.disposeData(o.dataId),a},n,null,v.P,s);return r?U(o,Z(o.shape,O.parseAxisParam(e,i.shape))):o}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xn=Object(I.a)({maxPool_:function(t,e,r,i,n){const s=Object(S.a)(t,"x","maxPool");let o=s,a=!1;3===s.rank&&(a=!0,o=U(s,[1,s.shape[0],s.shape[1],s.shape[2]])),O.assert(4===o.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),O.assert(se(r,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+`Got strides ${r} and dilations '1'`),null!=n&&O.assert(O.isInt(i),()=>"Error in maxPool: pad must be an integer when using, "+`dimRoundingMode ${n} but got pad ${i}.`);const h={x:o},u={filterSize:e,strides:r,pad:i,dimRoundingMode:n},l=y.a.runKernelFunc((t,s)=>{const a=qt(o.shape,e,r,1,i,n);let h;return h=1===a.filterWidth&&1===a.filterHeight&&O.arraysEqual(a.inShape,a.outShape)?o.clone():t.maxPool(o,a),s([o,h]),h},h,null,v.Q,u);return a?U(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gn=Object(I.a)({maxPool3d_:function(t,e=[1,1,1],r,i,n,s="NDHWC",o){null==o?o=[1,1,1]:Zi("dilations is deprecated, this field will be gone in v3.0.0.");const a=Object(S.a)(t,"x","maxPool3d");let h=a,u=!1;4===a.rank&&(u=!0,h=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),O.assert(5===h.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${h.rank}.`),O.assert("NDHWC"===s,()=>"Error in maxPool3d: Only NDHWC is currently supported, "+`but got dataFormat of ${s}`),O.assert(se(r,o),()=>"Error in maxPool3d: Either strides or dilations must be 1. "+`Got strides ${r} and dilations '${o}'`),null!=n&&O.assert(O.isInt(i),()=>"Error in maxPool3d: pad must be an integer when using, "+`dimRoundingMode ${n} but got pad ${i}.`);const l={x:h},c={filterSize:e,strides:r,pad:i,dimRoundingMode:n,dataFormat:s,dilations:o},d=y.a.runKernelFunc((t,a)=>{null==o&&(o=[1,1,1]);const u=Kt(h.shape,e,r,o,i,n,s),l=t.maxPool3d(h,u);return a([h,l]),l},l,null,v.R,c);return u?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zn=Object(I.a)({maxPoolWithArgmax_:function(t,e,r,i,n=!1){const s={x:Object(S.a)(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:r,pad:i,includeBatchInIndex:n},a=y.a.runKernel(v.U,s,o);return{result:a[0],indexes:a[1]}}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vn=Object(I.a)({minimum_:function(t,e){let r=Object(S.a)(t,"a","minimum"),i=Object(S.a)(e,"b","minimum");[r,i]=Object(w.makeTypesMatch)(r,i),"bool"===r.dtype&&(r=L(r,"int32"),i=L(i,"int32")),x(r.shape,i.shape);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.minimum(r,i);return e([r,i]),n},n,null,v.W)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hn=Object(I.a)({mod_:function(t,e){let r=Object(S.a)(t,"a","mod"),i=Object(S.a)(e,"b","mod");[r,i]=Object(w.makeTypesMatch)(r,i);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.mod(r,i);return e([r,i]),n},n,null,v.X)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $n=Object(I.a)({multinomial_:function(t,e,r,i=!1){const n=Object(S.a)(t,"logits","multinomial"),s=n.size,o=n.rank;if(s<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+`${s}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);r=r||Math.random();const a=1===o?n.as2D(1,-1):n,h=y.a.runKernelFunc(t=>t.multinomial(a,i,e,r),{logits2D:a});return 1===o?h.as1D():h}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wn=Object(I.a)({notEqual_:function(t,e){let r=Object(S.a)(t,"a","notEqual"),i=Object(S.a)(e,"b","notEqual");[r,i]=Object(w.makeTypesMatch)(r,i),x(r.shape,i.shape);const n={a:r,b:i};return y.a.runKernelFunc(t=>t.notEqual(r,i),n,null,v.bb)}});const Yn=Object(I.a)({outerProduct_:function(t,e){const r=Object(S.a)(t,"v1","outerProduct"),i=Object(S.a)(e,"v2","outerProduct");O.assert(1===r.rank&&1===i.rank,()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+`${r.rank} and ${i.rank}.`);const n=U(r,[-1,1]),s=U(i,[1,-1]);return ce(n,s)}});const qn=Object(I.a)({pad1d_:function(t,e,r=0){return Object(O.assert)(2===e.length,()=>"Invalid number of paddings. Must be length of 2."),wr(t,[e],r)}});const Kn=Object(I.a)({pad2d_:function(t,e,r=0){return Object(O.assert)(2===e.length&&2===e[0].length&&2===e[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),wr(t,e,r)}});const Zn=Object(I.a)({pad3d_:function(t,e,r=0){return Object(O.assert)(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),wr(t,e,r)}});const Jn=Object(I.a)({pad4d_:function(t,e,r=0){return Object(O.assert)(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),wr(t,e,r)}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qn=Object(I.a)({pool_:function(t,e,r,i,n,s){null==n&&(n=[1,1]),null==s&&(s=1),0===i&&(i="valid");const o=Object(S.a)(t,"x","maxPool");let a=o,h=!1;3===o.rank&&(h=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2]])),O.assert(se(s,n),()=>"Error in pool: Either strides or dilations must be 1. "+`Got strides ${s} and dilations '${n}'`);const u=qt(a.shape,e,s,n,i),l=[u.dilationHeight,u.dilationWidth];let c;c="same"===i?function(t,e){const r=t.map((t,r)=>t+(t-1)*(e[r]-1)).map(t=>t-1),i=r.map(t=>Math.floor(t/2)),n=r.map((t,e)=>t-i[e]);return r.map((t,e)=>[i[e],n[e]])}([u.filterHeight,u.filterWidth],l):[[0,0],[0,0]];const d=1===l[0]&&1===l[1],[p,f]=function(t,e,r){const i=r.map(t=>t[0]),n=r.map(t=>t[1]),s=t.concat(i,n),o=e.map((t,e)=>(t-s[e]%t)%t),a=n.map((t,e)=>t+o[e]),h=e.map((t,e)=>[i[e],a[e]]),u=e.map((t,e)=>[0,o[e]]);return[h,u]}([u.inHeight,u.inWidth],l,c),m=d?i:"valid",g=d?a:pe(a,l,p),y=("avg"===r?()=>un(g,e,s,m):()=>Xn(g,e,s,m))(),v=d?y:vr(y,l,f);return h?U(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ts=Object(I.a)({prelu_:function(t,e){const r=Object(S.a)(t,"x","prelu"),i=Object(S.a)(e,"alpha","prelu"),n={x:r,alpha:i};return y.a.runKernelFunc((t,e)=>{const n=t.prelu(r,i);return e([r,i]),n},n,null,v.fb)}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const es=Object(I.a)({rand_:function(t,e,r){const i=Object(O.sizeFromShape)(t);let n=null;if(null==r||"float32"===r)n=new Float32Array(i);else if("int32"===r)n=new Int32Array(i);else{if("bool"!==r)throw new Error(`Unknown data type ${r}`);n=new Uint8Array(i)}for(let t=0;t<i;t++)n[t]=e();return y.a.makeTensor(n,t,r)}});var rs=r(21);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class is{constructor(t,e,r,i,n){this.mean=t,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const s=n||Math.random();this.random=rs.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,r=!1;for(;!r;){let i,n,s;do{i=2*this.random()-1,n=2*this.random()-1,s=i*i+n*n}while(s>=1||0===s);const o=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*i*o,e=this.mean+this.stdDev*n*o,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class ns{constructor(t,e,r,i){this.alpha=t,this.beta=1/e,this.dtype=r;const n=i||Math.random();this.randu=rs.alea(n.toString()),this.randn=new is(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,r,i,n,s;for(;;){do{i=this.randn.nextValue(),s=1+this.c*i}while(s<=0);if(s*=s*s,t=i*i,e=1-.331*t*t,r=.5*t+this.d*(1-s+Math.log(s)),n=this.randu(),n<e||Math.log(n)<r)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class ss{constructor(t=0,e=1,r,i){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=r,null==i&&(i=Math.random()),"number"==typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=rs.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const os=Object(I.a)({randomGamma_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r=1,i="float32",n){if(null==r&&(r=1),null==i&&(i="float32"),"float32"!==i&&"int32"!==i)throw new Error(`Unsupported data type ${i}`);const s=new ns(e,r,i,n),o=D(t,i);for(let t=0;t<o.values.length;t++)o.values[t]=s.nextValue();return o.toTensor()}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const as=Object(I.a)({randomNormal_:function(t,e=0,r=1,i,n){if(null!=i&&"bool"===i)throw new Error(`Unsupported data type ${i}`);const s=new is(e,r,i,!1,n),o=D(t,i);for(let t=0;t<o.values.length;t++)o.values[t]=s.nextValue();return o.toTensor()}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hs=Object(I.a)({randomUniform_:function(t,e=0,r=1,i="float32",n){const s=D(t,i),o=new ss(e,r,null,n);for(let t=0;t<s.values.length;t++)s.values[t]=o.nextValue();return s.toTensor()}});var us=r(24);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ls=Object(I.a)({relu_:function(t){const e=Object(S.a)(t,"x","relu"),r={x:e};return y.a.runKernelFunc((t,r)=>(r([e]),"bool"===e.dtype?e.toInt():t.relu(e)),r,null,v.hb)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cs=Object(I.a)({relu6_:function(t){const e=Object(S.a)(t,"x","relu6"),r={x:e};return y.a.runKernelFunc((t,r)=>(r([e]),"bool"===e.dtype?L(e,"int32"):t.relu6(e)),r,null,v.ib)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ds=Object(I.a)({selu_:function(t){const e=Object(S.a)(t,"x","selu"),r={x:e};return y.a.runKernelFunc((t,r)=>{const i=t.selu(e);return r([e]),i},r,null,v.kb)}});const ps=Object(I.a)({separableConv2d_:function(t,e,r,i,n,s=[1,1],o="NHWC"){const a=Object(S.a)(t,"x","separableConv2d"),h=Object(S.a)(e,"depthwiseFilter","separableConv2d"),u=Object(S.a)(r,"pointwiseFilter","separableConv2d");let l=a,c=!1;if(3===a.rank&&(c=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");O.assert(4===l.rank,()=>"Error in separableConv2d: input must be rank 4, but got "+`rank ${l.rank}.`),O.assert(4===h.rank,()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+`got rank ${h.rank}.`),O.assert(4===u.rank,()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+`got rank ${h.rank}.`),O.assert(1===u.shape[0],()=>"Error in separableConv2d: the first dimension of pointwise filter "+` must be 1, but got ${u.shape[0]}.`),O.assert(1===u.shape[1],()=>"Error in separableConv2d: the second dimension of pointwise "+`filter must be 1, but got ${u.shape[1]}.`);const d=h.shape[2],p=h.shape[3];O.assert(u.shape[2]===d*p,()=>"Error in separableConv2d: the third dimension of pointwise filter "+`must be ${d*p}, `+`but got ${u.shape[2]}.`);const f=Cn(l,h,i,n,o,s),m=xe(f,u,1,"valid",o);return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fs=Object(I.a)({squaredDifference_:function(t,e){let r=Object(S.a)(t,"a","squaredDifference"),i=Object(S.a)(e,"b","squaredDifference");[r,i]=Object(w.makeTypesMatch)(r,i),x(r.shape,i.shape);const n={a:r,b:i};return y.a.runKernelFunc((t,e)=>{const n=t.squaredDifference(r,i);return e([r,i]),n},n,null,v.ob,{})}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ms=Object(I.a)({truncatedNormal_:function(t,e=0,r=1,i,n){if(null!=i&&"bool"===i)throw new Error("Unsupported data type $ { dtype }");const s=new is(e,r,i,!0,n),o=D(t,i);for(let t=0;t<o.values.length;t++)o.values[t]=s.nextValue();return o.toTensor()}}),gs=30;
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ys(t){return t<=gs?t:Object(O.nearestDivisor)(t,Math.floor(Math.sqrt(t)))}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vs(t,e){let r,i=!1;for(t<=gs?(r=t,i=!0):r=Object(O.nearestDivisor)(t,Math.floor(Math.sqrt(t)));!i;)r>e||r===t?i=!0:r=Object(O.nearestDivisor)(t,r+1);return r}function _s(t,e,r){const i=[],n=t.length;for(let s=0;s<n;s++)s!==e?i.push(t[s]):i.push(r);return i}function bs(t,e,r){const i=t.shape[r],n=[];let s=1,o=1;for(let e=0;e<r;e++)n.push(t.shape[e]),s*=t.shape[e];for(let t=0;t<e.rank;t++)n.push(e.shape[t]);for(let e=r+1;e<t.rank;e++)n.push(t.shape[e]),o*=t.shape[e];return{batchSize:s,sliceSize:o,dimSize:i,outputShape:n}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xs(t,e){const r=[];for(let i=t;i<e;++i)r.push(i);return r}function Ts(t){const e=[];for(let r=0;r<t.length;++r)for(let i=0;i<t[r].length;++i)e.push(t[r][i]);return e}const Es=Object(I.a)({gather_:function(t,e,r=0){const i=Object(S.a)(t,"x","gather"),n=Object(S.a)(e,"indices","gather","int32");r=Object(O.parseAxisParam)(r,i.shape)[0];const s=bs(i,n,r);return y.a.runKernelFunc((t,e)=>{const s=t.gather(i,n.flatten(),r);return e([n]),s},{x:i,indices:n},(t,e)=>{const[n]=e;return{x:()=>{const e=i.shape,s=n.size,o=e.slice(0,r),a=o.length,h=e.slice(r,e.length).slice(1),u=h.length,l=xs(0,a),c=xs(a+1,a+1+u),d=Ts([o,[s],h]),p=t.reshape(d),f=n.reshape([s]),m=Ts([[a],l,c]),g=p.transpose(m);let y=ws(g,f,i.shape[r]);const v=tt(m);return y=y.transpose(v),y},indices:()=>n}},"Gather",{axis:r}).reshape(s.outputShape)}}),ws=Object(I.a)({unsortedSegmentSum_:function(t,e,r){const i=Object(S.a)(t,"x","unsortedSegmentSum"),n=Object(S.a)(e,"segmentIds","unsortedSegmentSum","int32");return Object(O.assert)(Object(O.isInt)(r),()=>"numSegments must be of dtype int"),y.a.runKernelFunc((t,e)=>{const s=t.unsortedSegmentSum(i,n,r);return e([n]),s},{$x:i},(t,e)=>{const[r]=e;return{$x:()=>function(t,e){const r=kn(e,Object(P.o)(e)),i=Es(t,r);let n=ze(e,Object(P.e)(0,"int32"));const s=i.rank-n.rank;for(let t=0;t<s;++t)n=k(n,t+1);n=nr(n,Object(P.b)(i.shape,"bool"));const o=Object(P.o)(i);return hr(n,i,o)}(t,r)}})}});const Ss=
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
async function(t,e,r){const i=Object(S.a)(t,"tensor","boolMask"),n=Object(S.a)(e,"mask","boolMask","bool"),s=null==r?0:r,o=n.rank,a=i.shape;O.assert(o>0,()=>"mask cannot be scalar"),O.assertShapesMatch(a.slice(s,s+o),n.shape,"mask's shape must match the first K dimensions of tensor's shape,");let h=1;for(let t=s;t<s+o;t++)h*=a[t];const u=a.slice(0,s).concat([h],a.slice(s+o)),l=i.reshape(u),c=n.reshape([-1]),d=await ur(c),p=d.squeeze([1]),f=Es(l,p,s);return t!==i&&i.dispose(),e!==n&&n.dispose(),p.dispose(),l.dispose(),c.dispose(),d.dispose(),f};
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Is=Object(I.a)({reverse_:function(t,e){const r=Object(S.a)(t,"x","reverse");if(0===r.rank)return r.clone();const i=O.parseAxisParam(e,r.shape);return y.a.runKernelFunc(t=>t.reverse(r,i),{$x:r},t=>({$x:()=>t.reverse(i)})).reshapeAs(r)}}),As=Object(I.a)({reverse1d_:function(t){const e=Object(S.a)(t,"x","reverse");return O.assert(1===e.rank,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Is(e,0)}}),Cs=Object(I.a)({reverse2d_:function(t,e){const r=Object(S.a)(t,"x","reverse");return O.assert(2===r.rank,()=>`Error in reverse2D: x must be rank 2 but got rank ${r.rank}.`),Is(r,e)}}),Os=Object(I.a)({reverse3d_:function(t,e){const r=Object(S.a)(t,"x","reverse");return O.assert(3===r.rank,()=>`Error in reverse3D: x must be rank 3 but got rank ${r.rank}.`),Is(r,e)}}),Rs=Object(I.a)({reverse4d_:function(t,e){const r=Object(S.a)(t,"x","reverse");return O.assert(4===r.rank,()=>`Error in reverse4D: x must be rank 4 but got rank ${r.rank}.`),Is(r,e)}});const Ns=Object(I.a)({equalStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","equalStrict"),i=Object(S.a)(e,"b","equalStrict");return Object(O.assertShapesMatch)(r.shape,i.shape,"Error in equalStrict: "),r.equal(i)}}),Ps=Object(I.a)({greaterEqualStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","greaterEqualStrict"),i=Object(S.a)(e,"b","greaterEqualStrict");return Object(O.assertShapesMatch)(r.shape,i.shape,"Error in greaterEqualStrict: "),r.greaterEqual(i)}}),Ms=Object(I.a)({greaterStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","greaterStrict"),i=Object(S.a)(e,"b","greaterStrict");return Object(O.assertShapesMatch)(r.shape,i.shape,"Error in greaterStrict: "),r.greater(i)}}),Ds=Object(I.a)({lessEqualStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","lessEqualStrict"),i=Object(S.a)(e,"b","lessEqualStrict");return Object(O.assertShapesMatch)(r.shape,i.shape,"Error in lessEqualStrict: "),r.lessEqual(i)}}),Fs=Object(I.a)({lessStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","lessStrict"),i=Object(S.a)(e,"b","lessStrict");return Object(O.assertShapesMatch)(r.shape,i.shape,"Error in lessStrict: "),r.less(i)}}),Ls=Object(I.a)({notEqualStrict_:
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","notEqualStrict"),i=Object(S.a)(e,"b","notEqualStrict");return Object(O.assertShapesMatch)(r.shape,i.shape,"Error in notEqualStrict: "),r.notEqual(i)}});const ks=Object(I.a)({addStrict_:
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","addStrict"),i=Object(S.a)(e,"b","addStrict");return O.assertShapesMatch(r.shape,i.shape,"Error in addStrict: "),r.add(i)}}),Us=Object(I.a)({divStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","div"),i=Object(S.a)(e,"b","div");return O.assertShapesMatch(r.shape,i.shape,"Error in divideStrict: "),r.div(i)}}),Bs=Object(I.a)({maximumStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","maximumStrict"),i=Object(S.a)(e,"b","maximumStrict");return O.assertShapesMatch(r.shape,i.shape,"Error in maximumStrict: "),r.maximum(i)}}),js=Object(I.a)({minimumStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","minimumStrict"),i=Object(S.a)(e,"b","minimumStrict");return O.assertShapesMatch(r.shape,i.shape,"Error in minimumStrict: "),r.minimum(i)}}),Xs=Object(I.a)({modStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","modStrict"),i=Object(S.a)(e,"b","modStrict");return O.assertShapesMatch(r.shape,i.shape,"Error in modStrict: "),r.mod(i)}}),Gs=Object(I.a)({mulStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","mul"),i=Object(S.a)(e,"b","mul");return O.assertShapesMatch(r.shape,i.shape,"Error in multiplyStrict: "),r.mul(i)}}),zs=Object(I.a)({powStrict_:function(t,e){return Zi("strict variants of ops have been deprecated and will be removed in future"),O.assertShapesMatch(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),Vs=Object(I.a)({squaredDifferenceStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","squaredDifferenceStrict"),i=Object(S.a)(e,"b","squaredDifferenceStrict");return O.assertShapesMatch(r.shape,i.shape,"Error in squaredDifferenceStrict: "),r.squaredDifference(i)}}),Hs=Object(I.a)({subStrict_:function(t,e){Zi("strict variants of ops have been deprecated and will be removed in future");const r=Object(S.a)(t,"a","subStrict"),i=Object(S.a)(e,"b","subStrict");return O.assertShapesMatch(r.shape,i.shape,"Error in subStrict: "),r.sub(i)}});const $s=Object(I.a)({softmax_:
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=-1){const r=Object(S.a)(t,"logits","softmax","float32");if(-1===e&&(e=r.rank-1),e!==r.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+`Logits was rank ${r.rank} and dim was ${e}`);return y.a.runKernelFunc((t,i)=>{const n=t.softmax(r,e);return i([n]),n},{logits:r},(t,r)=>{const[i]=r,n=t.mul(i);return{logits:()=>n.sub(n.sum([e],!0).mul(i))}},"Softmax",{dim:e},[],[!0])}}),Ws=Object(I.a)({logSoftmax_:function(t,e=-1){const r=Object(S.a)(t,"logits","logSoftmax");if(-1===e&&(e=r.rank-1),e!==r.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+`Logits was rank ${r.rank} and axis was ${e}`);return W((t,r)=>{const i=t.max(e,!0),n=t.sub(i),s=n.toFloat().sub(n.exp().sum(e,!0).log());r([s]);return{value:s,gradFunc:(t,r)=>{const[i]=r,n=i.exp();return t.sub(t.sum(e,!0).mul(n))}}})(r)}});const Ys=Object(I.a)({norm_:
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e="euclidean",r=null,i=!1){const n=function t(e,r,i=null){if(0===e.rank)return e.abs();if(1!==e.rank&&null===i)return t(e.reshape([-1]),r,i);if(1===e.rank||"number"==typeof i||Array.isArray(i)&&1===i.length){if(1===r)return e.abs().sum(i);if(r===1/0)return e.abs().max(i);if(r===-1/0)return e.abs().min(i);if("euclidean"===r||2===r)return e.abs().pow(Object(P.e)(2,"int32")).sum(i).sqrt();throw new Error(`Error in norm: invalid ord value: ${r}`)}if(Array.isArray(i)&&2===i.length){if(1===r)return e.abs().sum(i[0]).max(i[1]-1);if(r===1/0)return e.abs().sum(i[1]).max(i[0]);if(r===-1/0)return e.abs().sum(i[1]).min(i[0]);if("fro"===r||"euclidean"===r)return e.square().sum(i).sqrt();throw new Error(`Error in norm: invalid ord value: ${r}`)}throw new Error(`Error in norm: invalid axis: ${i}`)}(t=Object(S.a)(t,"x","norm"),e,r);let s=n.shape;if(i){const e=Object(O.parseAxisParam)(r,t.shape);s=Z(n.shape,e)}return n.reshape(s)}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qs=Object(I.a)({basicLSTMCell_:function(t,e,r,i,n,s){const o=Object(S.a)(t,"forgetBias","basicLSTMCell"),a=Object(S.a)(e,"lstmKernel","basicLSTMCell"),h=Object(S.a)(r,"lstmBias","basicLSTMCell"),u=Object(S.a)(i,"data","basicLSTMCell"),l=Object(S.a)(n,"c","basicLSTMCell"),c=Object(S.a)(s,"h","basicLSTMCell"),d=u.concat(c,1).matMul(a).add(h),p=d.shape[0],f=d.shape[1]/4,m=[p,f],g=d.slice([0,0],m),y=d.slice([0,f],m),v=d.slice([0,2*f],m),_=d.slice([0,3*f],m),b=g.sigmoid().mul(y.tanh()).add(l.mul(o.add(v).sigmoid())),x=b.tanh().mul(_.sigmoid());return[b,x]}}),Ks=Object(I.a)({multiRNNCell_:function(t,e,r,i){const n=Object(S.a)(e,"data","multiRNNCell"),s=Object(S.b)(r,"c","multiRNNCell"),o=Object(S.b)(i,"h","multiRNNCell");let a=n;const h=[];for(let e=0;e<t.length;e++){const r=t[e](a,s[e],o[e]);h.push(r[0]),h.push(r[1]),a=r[1]}const u=[],l=[];for(let t=0;t<h.length;t+=2)u.push(h[t]),l.push(h[t+1]);return[u,l]}});const Zs=Object(I.a)({movingAverage_:
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i,n=!0){const s=Object(S.a)(t,"v","movingAverage"),o=Object(S.a)(e,"x","movingAverage"),a=Object(S.a)(r,"decay","movingAverage");Object(w.assertTypesMatch)(s,o),O.assert(O.arraysEqual(s.shape,o.shape),()=>"Shape mismatch in v and x");const h=Object(P.e)(1),u=h.sub(a);let l=o.sub(s).mul(u);if(n){O.assert(null!=i,()=>"When using zeroDebias: true, step is required.");const t=Object(S.a)(i,"step","movingAverage");l=l.div(h.sub(lr(a,t)))}return s.add(l)}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Js=Object(I.a)({stridedSlice_:function(t,e,r,i,n=0,s=0,o=0,a=0,h=0){null==i&&(i=new Array(e.length));const u=Ir(o);if(u.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==a)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==h)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");let l=Object(S.a)(t,"x","stridedSlice");const c=l.rank-e.length,d=Ir(a),p=l.shape.slice();d.forEach(t=>{e[t]=0,r[t]=1,p.splice(t,0,1)}),l=l.reshape(p);for(let t=0;t<l.rank;t++)e[t]=Pr(n,e,i,l.shape,t,o),r[t]=Mr(s,r,i,l.shape,t,o),i[t]=Nr(i,t,o);if(u.length&&c>0){const t=u[0],n=c+1;e=Or(e,t,n),r=Rr(r,t,n,l.shape),i=Cr(i,t,n)}const f=Ir(h);f.forEach(t=>{r[t]=e[t]+1,i[t]=1});const m=Ar(e,r,i),g=m.filter((t,e)=>-1===f.indexOf(e));return i.every(t=>1===t)?Lr(l,e,m).reshape(g):y.a.runKernelFunc(t=>t.stridedSlice(l,e,r,i),{$x:l}).reshape(g)}});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qs=Object(I.a)({topk_:function(t,e=1,r=!0){const i=Object(S.a)(t,"x","topk");if(0===i.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const n=i.shape[i.shape.length-1];if(e>n)throw new Error(`'k' passed to topk() must be <= the last dimension (${n}) `+`but got ${e}`);const[s,o]=y.a.runKernelFunc(t=>t.topk(i,e,r),{$x:i});return{values:s,indices:o}}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const to=Object(I.a)({scatterND_:function(t,e,r){const i=Object(S.a)(t,"indices","scatterND","int32"),n=Object(S.a)(e,"updates","scatterND");return $i(n,i,r),y.a.runKernelFunc(t=>t.scatterND(i,n,r),{indices:i,updates:n},null,"ScatterNd",{shape:r})}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eo=Object(I.a)({fft_:function(t){Object(O.assert)("complex64"===t.dtype,()=>"The dtype for tf.spectral.fft() must be complex64 "+`but got ${t.dtype}.`);const e=t.shape[t.shape.length-1],r=t.size/e,i=t.as2D(r,e);return y.a.runKernelFunc(t=>t.fft(i),{input:t}).reshape(t.shape)}}),ro=Object(I.a)({ifft_:function(t){Object(O.assert)("complex64"===t.dtype,()=>"The dtype for tf.spectral.ifft() must be complex64 "+`but got ${t.dtype}.`);const e=t.shape[t.shape.length-1],r=t.size/e,i=t.as2D(r,e);return y.a.runKernelFunc(t=>t.ifft(i),{input:t}).reshape(t.shape)}}),io=Object(I.a)({rfft_:function(t,e){Object(O.assert)("float32"===t.dtype,()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let r=t.shape[t.shape.length-1];const i=t.size/r;let n;if(null!=e&&e<r){const i=t.shape.map(t=>0),s=t.shape.map(t=>t);s[t.shape.length-1]=e,n=t.slice(i,s),r=e}else if(null!=e&&e>r){const i=t.shape.map(t=>t);i[t.shape.length-1]=e-r,n=t.concat(Object(P.n)(i),t.shape.length-1),r=e}else n=t;const s=n.zerosLike(),o=Object(vn.a)(n,s).as2D(i,r),a=eo(o),h=Math.floor(r/2)+1,u=Object(us.a)(a),l=Object(Ln.a)(a),c=u.split([h,r-h],u.shape.length-1),d=l.split([h,r-h],l.shape.length-1),p=n.shape.slice();return p[n.shape.length-1]=h,Object(vn.a)(c[0],d[0]).reshape(p)}}),no=Object(I.a)({irfft_:function(t){const e=t.shape[t.shape.length-1],r=t.size/e;if(e<=2){const i=t.as2D(r,e),n=ro(i);return Object(us.a)(n)}{const i=[r,2*(e-1)],n=Object(us.a)(t).as2D(r,e),s=Object(Ln.a)(t).as2D(r,e),o=n.slice([0,1],[r,e-2]).reverse(1),a=s.slice([0,1],[r,e-2]).reverse(1).mul(Object(P.e)(-1)),h=n.concat(o,1),u=s.concat(a,1),l=Object(vn.a)(h,u).as2D(i[0],i[1]),c=ro(l);return Object(us.a)(c)}}});const so=Object(I.a)({sparseToDense_:
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i=0){const n=Object(S.a)(t,"sparseIndices","sparseToDense","int32"),s=Object(S.a)(e,"sparseValues","sparseToDense"),o=Object(S.a)(i,"defaultValue","sparseToDense",s.dtype);return function(t,e,r,i){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+` but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+` but got shape ${t.shape}.`);const n=t.rank>0?t.shape[0]:1,s=t.rank>1?t.shape[1]:1;if(r.length!==s)throw new Error("outputShape has incorrect number of elements:,"+` ${r.length}, should be: ${s}.`);const o=e.size;if(0!==e.rank&&(1!==e.rank||o!==n))throw new Error("sparseValues has incorrect shape "+`${e.shape}, should be [] or [${n}]`);if(e.dtype!==i.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(n,s,r,o),y.a.runKernelFunc(t=>t.sparseToDense(n,s,r,o),{$sparseIndices:n,$sparseValues:s,$defaultValue:o})}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oo=Object(I.a)({gatherND_:function(t,e){const r=Object(S.a)(e,"indices","gatherND","int32"),i=Object(S.a)(t,"x","gatherND"),n={params:i,indices:r};return y.a.runKernelFunc(t=>t.gatherND(i,r),n,null,v.G)}});
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ao=Object(I.a)({dropout_:
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i){const n=Object(S.a)(t,"x","dropout");if(O.assert("float32"===n.dtype,()=>"x has to be a floating point tensor since it's going to be "+`scaled, but got a ${n.dtype} tensor instead.`),O.assert(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),0===e)return t instanceof C.a?n.clone():n;const s=function(t,e){if(null==e)return t.shape.slice();if(O.arraysEqual(t.shape,e))return e;if(t.shape.length===e.length){const r=[];for(let i=0;i<t.shape.length;i++)null==e[i]&&null!=t.shape[i]?r.push(t.shape[i]):r.push(e[i]);return r}return e}(n,r),o=1-e,a=hs(s,0,1,"float32",i).add(o).floor().div(o);return n.mul(a)}});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ho(t,e,r){const i=1-t%2,n=new Float32Array(t);for(let s=0;s<t;++s){const o=2*Math.PI*s/(t+i-1);n[s]=e-r*Math.cos(o)}return Object(P.g)(n,"float32")}const uo=Object(I.a)({hannWindow_:function(t){return ho(t,.5,.5)}}),lo=Object(I.a)({hammingWindow_:function(t){return ho(t,.54,.46)}}),co=Object(I.a)({frame_:function(t,e,r,i=!1,n=0){let s=0;const o=[];for(;s+e<=t.size;)o.push(Lr(t,s,e)),s+=r;if(i)for(;s<t.size;){const i=s+e-t.size,a=M([Lr(t,s,e-i),Fn([i],n)]);o.push(a),s+=r}return 0===o.length?Object(P.h)([],[0,e]):M(o).as2D(o.length,e)}}),po=Object(I.a)({stft_:function(t,e,r,i,n=uo){var s;null==i&&(s=e,i=Math.floor(Math.pow(2,Math.ceil(Math.log(s)/Math.log(2)))));const o=co(t,e,r),a=H(o,n(e)),h=[];for(let t=0;t<o.shape[0];t++)h.push(io(a.slice([t,0],[1,e]),i));return M(h)}});const fo=
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
async function(t,e,r=1){const i=Object(S.a)(t,"predictions","inTopK"),n=Object(S.a)(e,"targets","inTopK");Object(O.assert)(i.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, "+`but got ${i.rank}`),Object(O.assert)(i.rank-1===n.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+`${i.rank} and targets rank ${n.rank}`),Object(O.assertShapesMatch)(i.shape.slice(0,i.shape.length-1),n.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=i.shape[i.shape.length-1];Object(O.assert)(r>0&&r<=s,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+`dimension (${s}), but got ${r}`);const o=await i.data(),a=await n.data(),[h,u]=[o.length/s,s],l=Object(O.getTypedArrayFromDType)("bool",h);for(let t=0;t<h;t++){const e=t*u,i=o.subarray(e,e+u),n=[];for(let t=0;t<i.length;t++)n.push({value:i[t],index:t});n.sort((t,e)=>e.value-t.value),l[t]=0;for(let e=0;e<r;e++)if(n[e].index===a[t]){l[t]=1;break}}return t!==i&&i.dispose(),e!==n&&n.dispose(),Object(P.f)(l,n.shape,"bool")};
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mo;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(mo||(mo={}));const go=Object(I.a)({absoluteDifference_:function(t,e,r,i=mo.SUM_BY_NONZERO_WEIGHTS){const n=Object(S.a)(t,"labels","absoluteDifference"),s=Object(S.a)(e,"predictions","absoluteDifference");let o=null;null!=r&&(o=Object(S.a)(r,"weights","absoluteDifference")),Object(O.assertShapesMatch)(n.shape,s.shape,"Error in absoluteDifference: ");const a=n.sub(s).abs();return yo(a,o,i)}}),yo=Object(I.a)({computeWeightedLoss_:function(t,e,r=mo.SUM_BY_NONZERO_WEIGHTS){const i=Object(S.a)(t,"losses","computeWeightedLoss");let n=null;null!=e&&(n=Object(S.a)(e,"weights","computeWeightedLoss"));const s=null==n?i:i.mul(n);if(r===mo.NONE)return s;if(r===mo.SUM)return s.sum();if(r===mo.MEAN){if(null==n)return s.mean();{const t=i.size/n.size,e=s.sum().div(n.sum());return t>1?e.div(Object(P.e)(t)):e}}if(r===mo.SUM_BY_NONZERO_WEIGHTS){if(null==n)return s.sum().div(Object(P.e)(i.size));{const t=n.mul(Object(P.b)(i.shape)).notEqual(Object(P.e)(0)).sum().toFloat();return s.sum().div(t)}}throw Error(`Unknown reduction: ${r}`)}}),vo=Object(I.a)({cosineDistance_:function(t,e,r,i,n=mo.SUM_BY_NONZERO_WEIGHTS){const s=Object(S.a)(t,"labels","cosineDistance"),o=Object(S.a)(e,"predictions","cosineDistance");let a=null;null!=i&&(a=Object(S.a)(i,"weights","cosineDistance")),Object(O.assertShapesMatch)(s.shape,o.shape,"Error in cosineDistance: ");const h=Object(P.e)(1).sub(s.mul(o).sum(r,!0));return yo(h,a,n)}}),_o=Object(I.a)({hingeLoss_:function(t,e,r,i=mo.SUM_BY_NONZERO_WEIGHTS){let n=Object(S.a)(t,"labels","hingeLoss");const s=Object(S.a)(e,"predictions","hingeLoss");let o=null;null!=r&&(o=Object(S.a)(r,"weights","hingeLoss")),Object(O.assertShapesMatch)(n.shape,s.shape,"Error in hingeLoss: ");const a=Object(P.e)(1);n=Object(P.e)(2).mul(n).sub(a);const h=a.sub(n.mul(s)).relu();return yo(h,o,i)}}),bo=Object(I.a)({huberLoss_:function(t,e,r,i=1,n=mo.SUM_BY_NONZERO_WEIGHTS){const s=Object(S.a)(t,"labels","huberLoss"),o=Object(S.a)(e,"predictions","huberLoss");let a=null;null!=r&&(a=Object(S.a)(r,"weights","huberLoss")),Object(O.assertShapesMatch)(s.shape,o.shape,"Error in huberLoss: ");const h=Object(P.e)(i),u=o.sub(s).abs(),l=Vn(u,h),c=u.sub(l),d=Object(P.e)(.5).mul(l.square()).add(h.mul(c));return yo(d,a,n)}}),xo=Object(I.a)({logLoss_:function(t,e,r,i=1e-7,n=mo.SUM_BY_NONZERO_WEIGHTS){const s=Object(S.a)(t,"labels","logLoss"),o=Object(S.a)(e,"predictions","logLoss");let a=null;null!=r&&(a=Object(S.a)(r,"weights","logLoss")),Object(O.assertShapesMatch)(s.shape,o.shape,"Error in logLoss: ");const h=Object(P.e)(1),u=Object(P.e)(i),l=s.mul(o.add(u).log()).neg().sub(h.sub(s).mul(h.sub(o).add(u).log()));return yo(l,a,n)}}),To=Object(I.a)({meanSquaredError_:function(t,e,r,i=mo.SUM_BY_NONZERO_WEIGHTS){const n=Object(S.a)(t,"labels","meanSquaredError"),s=Object(S.a)(e,"predictions","meanSquaredError");let o=null;null!=r&&(o=Object(S.a)(r,"weights","meanSquaredError")),Object(O.assertShapesMatch)(n.shape,s.shape,"Error in meanSquaredError: ");const a=n.squaredDifference(s);return yo(a,o,i)}}),Eo=Object(I.a)({sigmoidCrossEntropy_:function(t,e,r,i=0,n=mo.SUM_BY_NONZERO_WEIGHTS){let s=Object(S.a)(t,"multiClassLabels","sigmoidCrossEntropy");const o=Object(S.a)(e,"logits","sigmoidCrossEntropy");let a=null;if(null!=r&&(a=Object(S.a)(r,"weights","sigmoidCrossEntropy")),Object(O.assertShapesMatch)(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),i>0){const t=Object(P.e)(i),e=Object(P.e)(1),r=Object(P.e)(.5);s=s.mul(e.sub(t)).add(r.mul(t))}const h=function(t,e){const r=Object(S.a)(t,"labels","sigmoidCrossEntropyWithLogits"),i=Object(S.a)(e,"logits","sigmoidCrossEntropyWithLogits");Object(O.assertShapesMatch)(r.shape,i.shape,"Error in sigmoidCrossEntropyWithLogits: ");const n=i.relu(),s=i.mul(r),o=i.abs().neg().exp().log1p();return n.sub(s).add(o)}(s,o);return yo(h,a,n)}}),wo=Object(I.a)({softmaxCrossEntropy_:function(t,e,r,i=0,n=mo.SUM_BY_NONZERO_WEIGHTS){let s=Object(S.a)(t,"onehotLabels","softmaxCrossEntropy");const o=Object(S.a)(e,"logits","softmaxCrossEntropy");let a=null;if(null!=r&&(a=Object(S.a)(r,"weights","softmaxCrossEntropy")),Object(O.assertShapesMatch)(s.shape,o.shape,"Error in softmaxCrossEntropy: "),i>0){const t=Object(P.e)(i),e=Object(P.e)(1),r=Object(P.e)(s.shape[1]);s=s.mul(e.sub(t)).add(t.div(r))}const h=function(t,e,r=-1){if(-1===r&&(r=e.rank-1),r!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+`supported. Labels / logits was rank ${e.rank} `+`and dim was ${r}`);return W((t,e,i)=>{const n=e.logSumExp([r],!0),s=e.toFloat().sub(n);i([t,s]);return{value:s.mul(t).neg().sum([r]),gradFunc:(t,e)=>{const[i,n]=e,s=Z(t.shape,[r]);return[t.reshape(s).mul(i.toFloat().sub(n.exp())),t.reshape(s).mul(n.exp().sub(i.toFloat()))]}}})(t,e)}(s,o);return yo(h,a,n)}});function So(t,e=!1){return y.a.tidy(()=>{if(2!==t.shape.length)throw new Error(`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const r=t.shape[0],i=t.shape[1];let n=Dn(r),s=t.clone();const o=Object(P.h)([[1]],[1,1]);let a=o.clone();const h=r>=i?i:r;for(let t=0;t<h;++t){const e=s,h=a,u=n;[a,s,n]=y.a.tidy(()=>{const e=s.slice([t,t],[r-t,1]),h=e.norm(),u=s.slice([t,t],[1,1]),l=Object(P.h)([[-1]]).where(u.greater(0),Object(P.h)([[1]])),c=u.sub(l.mul(h)),d=e.div(c);a=1===d.shape[0]?o.clone():o.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);const p=l.matMul(c).div(h).neg(),f=s.slice([t,0],[r-t,i]),m=p.mul(a),g=a.transpose();if(0===t)s=f.sub(m.matMul(g.matMul(f)));else{const e=f.sub(m.matMul(g.matMul(f)));s=s.slice([0,0],[t,i]).concat(e,0)}const y=m.transpose(),v=n.slice([0,t],[r,n.shape[1]-t]);if(0===t)n=v.sub(v.matMul(a).matMul(y));else{const e=v.sub(v.matMul(a).matMul(y));n=n.slice([0,0],[r,t]).concat(e,1)}return[a,s,n]}),en([e,h,u])}return!e&&r>i&&(n=n.slice([0,0],[r,i]),s=s.slice([0,0],[i,i])),[n,s]})}const Io=Object(I.a)({bandPart_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r){if(e%1!=0)throw new Error(`bandPart(): numLower must be an integer, got ${e}.`);if(r%1!=0)throw new Error(`bandPart(): numUpper must be an integer, got ${r}.`);const i=Object(S.a)(t,"a","bandPart");if(i.rank<2)throw new Error(`bandPart(): Rank must be at least 2, got ${i.rank}.`);const n=i.shape,[s,o]=i.shape.slice(-2);if(!(e<=s))throw new Error(`bandPart(): numLower (${e})`+` must not be greater than the number of rows (${s}).`);if(!(r<=o))throw new Error(`bandPart(): numUpper (${r})`+` must not be greater than the number of columns (${o}).`);e<0&&(e=s),r<0&&(r=o);const a=Object(P.d)(0,s,1,"int32").reshape([-1,1]),h=Object(P.d)(0,o,1,"int32"),u=Fe(a,h),l=nr(u.lessEqual(Object(P.e)(+e,"int32")),u.greaterEqual(Object(P.e)(-r,"int32"))),c=Object(P.n)([s,o],i.dtype);return j(X(i.reshape([-1,s,o])).map(t=>hr(l,t,c))).reshape(n)}}),Ao=Object(I.a)({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,Object(O.assert)(null!=t&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let e=1;e<t.length;++e)Object(O.assert)(t[e].shape[0]===r,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+`(${t[e].shape[0]} vs. ${r})`)}else e=!0,t=ge(t,t.shape[0],0).map(t=>B(t,[0]));Object(O.assert)(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds `+`number of dimensions (${t[0].shape[0]}).`);const r=[],i=t;for(let e=0;e<t.length;++e)r.push(y.a.tidy(()=>{let t=i[e];if(e>0)for(let i=0;i<e;++i){const e=ct(r[i].mul(t)).mul(r[i]);t=t.sub(e)}return t.div(Ys(t,"euclidean"))}));return e?j(r,0):r}}),Co=Object(I.a)({qr_:function(t,e=!1){if(t.rank<2)throw new Error(`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`);if(2===t.rank)return So(t,e);{const r=t.shape.slice(0,t.shape.length-2).reduce((t,e)=>t*e),i=X(t.reshape([r,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),n=[],s=[];return i.forEach(t=>{const[r,i]=So(t,e);n.push(r),s.push(i)}),[j(n,0).reshape(t.shape),j(s,0).reshape(t.shape)]}}});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Oo(t,e,r){const i=function(t,e,r){return function(t,e,r){let i=0,n=t.length,s=0,o=!1;for(;i<n;){s=i+(n-i>>>1);const a=r(e,t[s]);a>0?i=s+1:(n=s,o=!a)}return o?i:-i-1}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t,e,r||Ro)}(t,e,r),n=i<0?-(i+1):i;t.splice(n,0,e)}function Ro(t,e){return t>e?1:t<e?-1:0}function No(t,e,r,i,n){const s=Mo(t,e,r,i,n,0);return s.selectedScores.dispose(),s.numValidOutputs.dispose(),s.selectedIndices}function Po(t,e,r,i,n,s){const o=Mo(t,e,r,i,n,s,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function Mo(t,e,r,i,n,s,o=!1,a=!1){const h=[];for(let t=0;t<e.length;t++)e[t]>n&&h.push({score:e[t],boxIndex:t,suppressBeginIndex:0});h.sort(Lo);const u=s>0?-.5/s:0,l=[],c=[];for(;l.length<r&&h.length>0;){const e=h.pop(),{score:r,boxIndex:s,suppressBeginIndex:o}=e;if(r<n)break;let a=!1;for(let r=l.length-1;r>=o;--r){const o=Do(t,s,l[r]);if(o>=i){a=!0;break}if(e.score=e.score*Fo(i,u,o),e.score<=n)break}e.suppressBeginIndex=l.length,a||(e.score===r?(l.push(s),c.push(e.score)):e.score>n&&Oo(h,e,Lo))}const d=l.length;return a&&(l.fill(0,d),c.fill(0,d)),{selectedIndices:Object(P.g)(l,"int32"),selectedScores:Object(P.g)(c,"float32"),numValidOutputs:Object(P.e)(d,"int32")}}function Do(t,e,r){const i=t.subarray(4*e,4*e+4),n=t.subarray(4*r,4*r+4),s=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]),u=Math.min(n[0],n[2]),l=Math.min(n[1],n[3]),c=Math.max(n[0],n[2]),d=Math.max(n[1],n[3]),p=(a-s)*(h-o),f=(c-u)*(d-l);if(p<=0||f<=0)return 0;const m=Math.max(s,u),g=Math.max(o,l),y=Math.min(a,c),v=Math.min(h,d),_=Math.max(y-m,0)*Math.max(v-g,0);return _/(p+f-_)}function Fo(t,e,r){const i=Math.exp(e*r*r);return r<=t?i:0}function Lo(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ko(t,e,r,i,n,s){null==i&&(i=.5),null==n&&(n=Number.NEGATIVE_INFINITY),null==s&&(s=0);const o=t.shape[0];return r=Math.min(r,o),O.assert(0<=i&&i<=1,()=>`iouThreshold must be in [0, 1], but was '${i}'`),O.assert(2===t.rank,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),O.assert(4===t.shape[1],()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),O.assert(1===e.rank,()=>"scores must be a 1D tensor"),O.assert(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, `+`but was ${e.shape[0]}`),O.assert(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:r,iouThreshold:i,scoreThreshold:n,softNmsSigma:s}}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uo=Object(I.a)({nonMaxSuppression_:function(t,e,r,i=.5,n=Number.NEGATIVE_INFINITY){const s=Object(S.a)(t,"boxes","nonMaxSuppression"),o=Object(S.a)(e,"scores","nonMaxSuppression"),a=ko(s,o,r,i,n);r=a.maxOutputSize,i=a.iouThreshold,n=a.scoreThreshold;const h={maxOutputSize:r,iouThreshold:i,scoreThreshold:n};return y.a.runKernelFunc(t=>t.nonMaxSuppression(s,o,r,i,n),{boxes:s,scores:o},null,v.Z,h)}});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bo=Object(I.a)({resizeBilinear_:function(t,e,r=!1){const i=Object(S.a)(t,"images","resizeBilinear");O.assert(3===i.rank||4===i.rank,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+`rank ${i.rank}.`),O.assert(2===e.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+`${e}.`);let n=i,s=!1;3===i.rank&&(s=!0,n=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));const[o,a]=e,h=y.a.runKernelFunc((t,e)=>(e([n]),t.resizeBilinear(n,o,a,r)),{x:n},(t,e)=>({x:()=>y.a.runKernelFunc(i=>i.resizeBilinearBackprop(t,e[0],r),{})}),"ResizeBilinear",{alignCorners:r,newHeight:o,newWidth:a});return s?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),jo=Object(I.a)({resizeNearestNeighbor_:function(t,e,r=!1){const i=Object(S.a)(t,"images","resizeNearestNeighbor");O.assert(3===i.rank||4===i.rank,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+`rank ${i.rank}.`),O.assert(2===e.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+`${e}.`),O.assert("float32"===i.dtype||"int32"===i.dtype,()=>"`images` must have `int32` or `float32` as dtype");let n=i,s=!1;3===i.rank&&(s=!0,n=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));const[o,a]=e,h=y.a.runKernelFunc((t,e)=>(e([n]),t.resizeNearestNeighbor(n,o,a,r)),{batchImages:n},(t,e)=>({batchImages:()=>y.a.runKernelFunc(i=>i.resizeNearestNeighborBackprop(t,e[0],r),{})}));return s?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),Xo=async function(t,e,r,i=.5,n=Number.NEGATIVE_INFINITY){const s=Object(S.a)(t,"boxes","nonMaxSuppressionAsync"),o=Object(S.a)(e,"scores","nonMaxSuppressionAsync"),a=ko(s,o,r,i,n);r=a.maxOutputSize,i=a.iouThreshold,n=a.scoreThreshold;const h=await Promise.all([s.data(),o.data()]),u=No(h[0],h[1],r,i,n);return s!==t&&s.dispose(),o!==e&&o.dispose(),u},Go=Object(I.a)({nonMaxSuppressionWithScore_:function(t,e,r,i=.5,n=Number.NEGATIVE_INFINITY,s=0){const o=Object(S.a)(t,"boxes","nonMaxSuppression"),a=Object(S.a)(e,"scores","nonMaxSuppression"),h=ko(o,a,r,i,n,s),u={maxOutputSize:r=h.maxOutputSize,iouThreshold:i=h.iouThreshold,scoreThreshold:n=h.scoreThreshold,softNmsSigma:s=h.softNmsSigma},l=y.a.runKernel("NonMaxSuppressionV5",{boxes:o,scores:a},u);return{selectedIndices:l[0],selectedScores:l[1]}}}),zo=async function(t,e,r,i=.5,n=Number.NEGATIVE_INFINITY,s=0){const o=Object(S.a)(t,"boxes","nonMaxSuppressionAsync"),a=Object(S.a)(e,"scores","nonMaxSuppressionAsync"),h=ko(o,a,r,i,n,s);r=h.maxOutputSize,i=h.iouThreshold,n=h.scoreThreshold,s=h.softNmsSigma;const u=await Promise.all([o.data(),a.data()]),l=Po(u[0],u[1],r,i,n,s);return o!==t&&o.dispose(),a!==e&&a.dispose(),l},Vo=Object(I.a)({cropAndResize_:function(t,e,r,i,n,s){const o=Object(S.a)(t,"image","cropAndResize"),a=Object(S.a)(e,"boxes","cropAndResize","float32"),h=Object(S.a)(r,"boxInd","cropAndResize","int32");n=n||"bilinear",s=s||0;const u=a.shape[0];return O.assert(4===o.rank,()=>"Error in cropAndResize: image must be rank 4,"+`but got rank ${o.rank}.`),O.assert(2===a.rank&&4===a.shape[1],()=>`Error in cropAndResize: boxes must be have size [${u},4] `+`but had shape ${a.shape}.`),O.assert(1===h.rank&&h.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] `+`but had shape ${a.shape}.`),O.assert(2===i.length,()=>"Error in cropAndResize: cropSize must be of length 2, but got "+`length ${i.length}.`),O.assert(i[0]>=1&&i[1]>=1,()=>`cropSize must be atleast [1,1], but was ${i}`),O.assert("bilinear"===n||"nearest"===n,()=>`method must be bilinear or nearest, but was ${n}`),y.a.runKernelFunc((t,e)=>t.cropAndResize(o,a,h,i,n,s),{images:o,boxes:a,boxInd:h},null,"CropAndResize",{method:n,extrapolationValue:s,cropSize:i})}}),Ho=(t,e)=>!(t>0)||"linear"===e,$o=(t,e,r)=>{if(null==r||"linear"===r)return t;if("relu"===r)return t.mul(e.step());throw new Error(`Gradient for activation ${r} has not been `+"implemented yet.")},Wo=(t,e)=>{let r=e;const i=b(t.shape,e.shape);return i.length>0&&(r=r.sum(i)),r.reshape(t.shape)},Yo=(t,e,r)=>{if("linear"===e)return t;if("relu"===e)return ls(t);if("elu"===e)return Pn(t);if("relu6"===e)return cs(t);if("prelu"===e)return ts(t,r);throw new Error(`Unknown fused activation ${e}.`)};const qo=Object(I.a)({fusedMatMul_:function({a:t,b:e,transposeA:r=!1,transposeB:i=!1,bias:n,activation:s="linear",preluActivationWeights:o}){if(!1===Ho(y.a.state.gradientDepth,s)){let a=ce(t,e,r,i);return null!=n&&(a=A(a,n)),Yo(a,s,o)}let a=Object(S.a)(t,"a","fused matMul"),h=Object(S.a)(e,"b","fused matMul");[a,h]=Object(w.makeTypesMatch)(a,h);const u=r?a.shape[a.rank-2]:a.shape[a.rank-1],l=i?h.shape[h.rank-1]:h.shape[h.rank-2],c=r?a.shape[a.rank-1]:a.shape[a.rank-2],d=i?h.shape[h.rank-2]:h.shape[h.rank-1],p=a.shape.slice(0,-2),f=h.shape.slice(0,-2),m=O.sizeFromShape(p),g=O.sizeFromShape(f);O.assert(a.rank>=2&&h.rank>=2&&a.rank===h.rank,()=>"Error in fused matMul: inputs must have the same rank of at least "+`2, got ranks ${a.rank} and ${h.rank}.`),O.assert(O.arraysEqual(p,f),()=>`Error in fused matMul: outer dimensions (${p}) and (`+`${f}) of Tensors with shapes ${a.shape} and `+`${h.shape} must match.`),O.assert(u===l,()=>`Error in fused matMul: inner shapes (${u}) and (`+`${l}) of Tensors with shapes ${a.shape} and `+`${h.shape} and transposeA=${r}`+` and transposeB=${i} must match.`);const v=a.shape.slice(0,-2).concat([c,d]),_=r?a.as3D(m,u,c):a.as3D(m,c,u),b=i?h.as3D(g,d,l):h.as3D(g,l,d);let T,E;null!=n&&(T=Object(S.a)(n,"bias","fused matMul"),[T]=Object(w.makeTypesMatch)(T,a),x(v,T.shape)),null!=o&&(E=Object(S.a)(o,"prelu weights","fused matMul"));const I={a:_,b:b};null!=n&&(I.bias=T),null!=o&&(I.preluActivationWeights=E);const C=[_,b];return y.a.runKernelFunc((t,e)=>{const n=t.fusedBatchMatMul({a:_,b:b,transposeA:r,transposeB:i,bias:T,activation:s,preluActivationWeights:E});return e([_,b,n]),n},I,(t,e)=>{const[o,a,h]=e,u=$o(t,h,s);let l={};return null!=n&&(l={bias:()=>Wo(T,u)}),r||i?!r&&i?Object.assign({a:()=>u.matMul(a,!1,!1),b:()=>u.matMul(o,!0,!1)},l):r&&!i?Object.assign({a:()=>a.matMul(u,!1,!0),b:()=>o.matMul(u,!1,!1)},l):Object.assign({a:()=>a.matMul(u,!0,!0),b:()=>u.matMul(o,!0,!0)},l):Object.assign({a:()=>u.matMul(a,!1,!0),b:()=>o.matMul(u,!0,!1)},l)},"_FusedMatMul",{transposeA:r,transposeB:i,activation:s},C,[!0]).reshape(v)}}),Ko=Object(I.a)({fusedConv2d_:function({x:t,filter:e,strides:r,pad:i,dataFormat:n="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:h="linear",preluActivationWeights:u}){if(h=h||"linear",!1===Ho(y.a.state.gradientDepth,h)){let l=xe(t,e,r,i,n,s,o);return null!=a&&(l=A(l,a)),Yo(l,h,u)}const l=Object(S.a)(t,"x","conv2d"),c=Object(S.a)(e,"filter","conv2d");let d=l,p=!1;3===l.rank&&(p=!0,d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),O.assert(4===d.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+`${d.rank}.`),O.assert(4===c.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+`${c.rank}.`),null!=o&&O.assert(O.isInt(i),()=>"Error in fused conv2d: pad must be an integer when using, "+`dimRoundingMode ${o} but got pad ${i}.`),O.assert(d.shape[3]===c.shape[2],()=>`Error in conv2d: depth of input (${d.shape[3]}) must match `+`input depth for filter ${c.shape[2]}.`),O.assert(se(r,s),()=>"Error in conv2D: Either strides or dilations must be 1. "+`Got strides ${r} and dilations '${s}'`),O.assert("NHWC"===n,()=>`Error in conv2d: got dataFormat of ${n} but only NHWC is currently supported.`);const f=Zt(d.shape,c.shape,r,s,i,o);let m,g;null!=a&&(m=Object(S.a)(a,"bias","fused conv2d"),[m]=Object(w.makeTypesMatch)(m,l),x(f.outShape,m.shape)),null!=u&&(g=Object(S.a)(u,"prelu weights","fused conv2d"));const v={x:d,filter:c};null!=a&&(v.bias=m),null!=u&&(v.preluActivationWeights=g);const _=[c,d],b=y.a.runKernelFunc((t,e)=>{const r=t.fusedConv2d({input:d,filter:c,convInfo:f,bias:m,activation:h,preluActivationWeights:g});return e([c,d,r]),r},v,(t,e)=>{const[n,o,u]=e,l=$o(t,u,h);O.assert(ne(s),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+`are not yet supported in gradients. Got dilations '${s}'`);let c={};return null!=a&&(c={bias:()=>Wo(m,l)}),Object.assign({x:()=>_e(o.shape,l,n,r,i),filter:()=>ve(o,l,n.shape,r,i)},c)},"FusedConv2D",{convInfo:f,activation:h},_,[!0]);return p?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),Zo=Object(I.a)({fusedDepthwiseConv2d_:function({x:t,filter:e,strides:r,pad:i,dataFormat:n="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:h="linear",preluActivationWeights:u}){if(!1===Ho(y.a.state.gradientDepth,h)){let l=Cn(t,e,r,i,n,s,o);return null!=a&&(l=A(l,a)),Yo(l,h,u)}const l=Object(S.a)(t,"x","depthwiseConv2d"),c=Object(S.a)(e,"filter","depthwiseConv2d");let d=l,p=!1;3===l.rank&&(p=!0,d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),O.assert(4===d.rank,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+`rank ${d.rank}.`),O.assert(4===c.rank,()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+`but got rank ${c.rank}.`),O.assert(d.shape[3]===c.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels "+`(${d.shape[3]}) must match the inChannels dimension in `+`filter ${c.shape[2]}.`),null==s&&(s=[1,1]),O.assert(se(r,s),()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+`be 1. Got strides ${r} and dilations '${s}'`),null!=o&&O.assert(O.isInt(i),()=>"Error in fused depthwiseConv2d: pad must be an integer when "+`using dimRoundingMode ${o} but got pad ${i}.`);const f=Zt(d.shape,c.shape,r,s,i,o,!0);let m,g;null!=a&&(m=Object(S.a)(a,"bias","fused conv2d"),[m]=Object(w.makeTypesMatch)(m,l),x(f.outShape,m.shape)),null!=u&&(g=Object(S.a)(u,"prelu weights","fused depthwiseConv2d"));const v={x:d,filter:c};null!=a&&(v.bias=m),null!=u&&(v.preluActivationWeights=g);const _=[c,d],b=y.a.runKernelFunc((t,e)=>{const r=t.fusedDepthwiseConv2D({input:d,filter:c,convInfo:f,bias:m,activation:h,preluActivationWeights:g});return e([c,d,r]),r},v,(t,e)=>{O.assert(ne(s),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+`'${s}'`);const[r,i,n]=e,o=$o(t,n,h);let u={};return null!=a&&(u={bias:()=>Wo(m,o)}),Object.assign({x:()=>Re(i.shape,o,r,f),filter:()=>Oe(i,o,r.shape,f)},u)},"FusedDepthwiseConv2D",{convInfo:f,activation:h},_,[!0]);return p?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Jo extends Yi{minimize(t,e=!1,r){const{value:i,grads:n}=this.computeGradients(t,r);if(null!=r){const t=r.map(t=>({name:t.name,tensor:n[t.name]}));this.applyGradients(t)}else this.applyGradients(n);return en(n),e?i:(i.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return $(t,e)}dispose(){null!=this.iterations_&&en(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Object(P.e)(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+`${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Jo,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Qo extends Jo{constructor(t,e,r=null){super(),this.learningRate=t,this.rho=e,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==r&&(this.epsilon=y.a.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,r)=>{const i=y.a.registeredVariables[e];null==this.accumulatedGrads[r]&&(this.accumulatedGrads[r]={originalName:`${e}/accum_grad`,variable:tn(()=>Object(P.o)(i).variable(!1))}),null==this.accumulatedUpdates[r]&&(this.accumulatedUpdates[r]={originalName:`${e}/accum_var`,variable:tn(()=>Object(P.o)(i).variable(!1))});const n=Array.isArray(t)?t[r].tensor:t[e];if(null==n)return;const s=this.accumulatedGrads[r].variable,o=this.accumulatedUpdates[r].variable;tn(()=>{const t=s.mul(this.rho).add(n.square().mul(1-this.rho)),e=o.add(this.epsilon).sqrt().div(s.add(this.epsilon).sqrt()).mul(n),r=o.mul(this.rho).add(e.square().mul(1-this.rho));s.assign(t),o.assign(r);const a=e.mul(-this.learningRate).add(i);i.assign(a)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(en(this.accumulatedGrads.map(t=>t.variable)),en(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2;this.accumulatedGrads=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedUpdates=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}Qo.className="Adadelta",Ki(Qo);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ta extends Jo{constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,r)=>{const i=y.a.registeredVariables[e];if(null==this.accumulatedGrads[r]){const t=!1;this.accumulatedGrads[r]={originalName:`${e}/accumulator`,variable:tn(()=>Fn(i.shape,this.initialAccumulatorValue).variable(t))}}const n=Array.isArray(t)?t[r].tensor:t[e];if(null==n)return;const s=this.accumulatedGrads[r].variable;tn(()=>{const t=s.add(n.square());s.assign(t);const e=n.div(t.add(y.a.backend.epsilon()).sqrt()).mul(-this.learningRate).add(i);i.assign(e)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&en(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);this.accumulatedGrads=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}ta.className="Adagrad",Ki(ta);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ea extends Jo{constructor(t,e,r,i=null){super(),this.learningRate=t,this.beta1=e,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],tn(()=>{this.accBeta1=Object(P.e)(e).variable(),this.accBeta2=Object(P.e)(r).variable()}),null==i&&(this.epsilon=y.a.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);tn(()=>{const r=Fe(1,this.accBeta1),i=Fe(1,this.accBeta2);e.forEach((e,n)=>{const s=y.a.registeredVariables[e];null==this.accumulatedFirstMoment[n]&&(this.accumulatedFirstMoment[n]={originalName:`${e}/m`,variable:tn(()=>Object(P.o)(s).variable(!1))}),null==this.accumulatedSecondMoment[n]&&(this.accumulatedSecondMoment[n]={originalName:`${e}/v`,variable:tn(()=>Object(P.o)(s).variable(!1))});const o=Array.isArray(t)?t[n].tensor:t[e];if(null==o)return;const a=this.accumulatedFirstMoment[n].variable,h=this.accumulatedSecondMoment[n].variable,u=a.mul(this.beta1).add(o.mul(1-this.beta1)),l=h.mul(this.beta2).add(o.square().mul(1-this.beta2)),c=u.div(r),d=l.div(i);a.assign(u),h.assign(l);const p=c.div(d.sqrt().add(this.epsilon)).mul(-this.learningRate).add(s);s.assign(p)}),this.accBeta1.assign(this.accBeta1.mul(this.beta1)),this.accBeta2.assign(this.accBeta2.mul(this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&en(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&en(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),tn(()=>{this.accBeta1.assign(lr(this.beta1,this.iterations_+1)),this.accBeta2.assign(lr(this.beta2,this.iterations_+1))});const e=t.length/2;this.accumulatedFirstMoment=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedSecondMoment=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}ea.className="Adam",Ki(ea);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ra extends Jo{constructor(t,e,r,i=null,n=0){super(),this.learningRate=t,this.beta1=e,this.beta2=r,this.epsilon=i,this.decay=n,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],tn(()=>{this.iteration=Object(P.e)(0).variable(),this.accBeta1=Object(P.e)(e).variable()}),null==i&&(this.epsilon=y.a.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);tn(()=>{const r=Fe(1,this.accBeta1),i=V(-this.learningRate,this.iteration.mul(this.decay).add(1));e.forEach((e,n)=>{const s=y.a.registeredVariables[e];null==this.accumulatedFirstMoment[n]&&(this.accumulatedFirstMoment[n]={originalName:`${e}/m`,variable:Object(P.o)(s).variable(!1)}),null==this.accumulatedWeightedInfNorm[n]&&(this.accumulatedWeightedInfNorm[n]={originalName:`${e}/v`,variable:Object(P.o)(s).variable(!1)});const o=Array.isArray(t)?t[n].tensor:t[e];if(null==o)return;const a=this.accumulatedFirstMoment[n].variable,h=this.accumulatedWeightedInfNorm[n].variable,u=a.mul(this.beta1).add(o.mul(1-this.beta1)),l=h.mul(this.beta2),c=o.abs(),d=l.maximum(c);a.assign(u),h.assign(d);const p=i.div(r).mul(u.div(d.add(this.epsilon))).add(s);s.assign(p)}),this.iteration.assign(this.iteration.add(1)),this.accBeta1.assign(this.accBeta1.mul(this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&en(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&en(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}ra.className="Adamax",Ki(ra);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ia extends Jo{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,r)=>{const i=Array.isArray(t)?t[r].tensor:t[e];if(null==i)return;const n=y.a.registeredVariables[e];tn(()=>{const t=this.c.mul(i).add(n);n.assign(t)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=rn(Object(P.e)(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}ia.className="SGD",Ki(ia);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class na extends ia{constructor(t,e,r=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=r,this.accumulations=[],this.m=Object(P.e)(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,r)=>{const i=y.a.registeredVariables[e];if(null==this.accumulations[r]){const t=!1;this.accumulations[r]={originalName:`${e}/momentum`,variable:tn(()=>Object(P.o)(i).variable(t))}}const n=this.accumulations[r].variable,s=Array.isArray(t)?t[r].tensor:t[e];null!=s&&tn(()=>{let t;const e=this.m.mul(n).add(s);t=this.useNesterov?this.c.mul(s.add(e.mul(this.m))).add(i):this.c.mul(e).add(i),n.assign(e),i.assign(t)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&en(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);this.accumulations=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}na.className="Momentum",Ki(na);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class sa extends Jo{constructor(t,e=.9,r=0,i=null,n=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=n,null==i&&(this.epsilon=y.a.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,r)=>{const i=y.a.registeredVariables[e];null==this.accumulatedMeanSquares[r]&&(this.accumulatedMeanSquares[r]={originalName:`${e}/rms`,variable:tn(()=>Object(P.o)(i).variable(!1))}),null==this.accumulatedMoments[r]&&(this.accumulatedMoments[r]={originalName:`${e}/momentum`,variable:tn(()=>Object(P.o)(i).variable(!1))}),null==this.accumulatedMeanGrads[r]&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${e}/mg`,variable:tn(()=>Object(P.o)(i).variable(!1))});const n=Array.isArray(t)?t[r].tensor:t[e];if(null==n)return;const s=this.accumulatedMeanSquares[r].variable,o=this.accumulatedMoments[r].variable;tn(()=>{const t=s.mul(this.decay).add(n.square().mul(1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[r].variable,a=e.mul(this.decay).add(n.mul(1-this.decay)),h=o.mul(this.momentum).add(n.mul(this.learningRate).div(t.sub(a.square().add(this.epsilon)).sqrt()));s.assign(t),e.assign(a),o.assign(h);const u=i.sub(h);i.assign(u)}else{const t=s.mul(this.decay).add(n.square().mul(1-this.decay)),e=o.mul(this.momentum).add(n.mul(this.learningRate).div(t.add(this.epsilon).sqrt()));s.assign(t),o.assign(e);const r=i.sub(e);i.assign(r)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&en(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&en(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&en(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2;this.accumulatedMeanSquares=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedMoments=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}sa.className="RMSProp",Ki(sa);var oa=r(25);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aa{static sgd(t){return new ia(t)}static momentum(t,e,r=!1){return new na(t,e,r)}static rmsprop(t,e=.9,r=0,i=null,n=!1){return new sa(t,e,r,i,n)}static adam(t=.001,e=.9,r=.999,i=null){return new ea(t,e,r,i)}static adadelta(t=.001,e=.95,r=null){return new Qo(t,e,r)}static adamax(t=.002,e=.9,r=.999,i=null,n=0){return new ra(t,e,r,i,n)}static adagrad(t,e=.1){return new ta(t,e)}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ha={sgd:aa.sgd,momentum:aa.momentum,adadelta:aa.adadelta,adagrad:aa.adagrad,rmsprop:aa.rmsprop,adamax:aa.adamax,adam:aa.adam};var ua=r(38);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function la(t,e,r,i=!0){let n=[];if(i)n=n.concat(e.slice(0)),n.push(t[0]/r),n=n.concat(t.slice(1));else{n=n.concat(t[0]);const r=e.length;for(let i=0;i<r;++i)n=n.concat([t[i+1]/e[i],e[i]]);n=n.concat(t.slice(r+1))}return n}function ca(t,e,r=!0){const i=[];if(r){i.push(e);for(let r=e+1;r<t;++r)r<=2*e?(i.push(r),i.push(r-(e+1))):i.push(r)}else{const r=[],n=[];for(let i=1;i<t;++i)i>=2*e+1||i%2==1?n.push(i):r.push(i);i.push(...r),i.push(0),i.push(...n)}return i}function da(t,e,r,i=!0){const n=[];i?n.push(t[0]/r):n.push(t[0]*r);for(let r=1;r<t.length;++r)r<=e.length?i?n.push(e[r-1]*t[r]):n.push(t[r]/e[r-1]):n.push(t[r]);return n}function pa(t,e){const r=[0];for(let i=0;i<e;++i)r.push(t[i][0]);return r}function fa(t,e,r){const i=t.slice(0,1);for(let n=0;n<r;++n)i.push(t[n+1]-e[n][0]-e[n][1]);return i}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ma=.3275911,ga=.254829592,ya=-.284496736,va=1.421413741,_a=-1.453152027,ba=1.061405429;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xa(...t){Object(Hr.b)().getBool("IS_TEST")||console.warn(...t)}function Ta(...t){Object(Hr.b)().getBool("IS_TEST")||console.log(...t)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ea(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+`${t.length}, imag: ${e.length}.`);const r=new Float32Array(2*t.length);for(let i=0;i<r.length;i+=2)r[i]=t[i/2],r[i+1]=e[i/2];return r}function wa(t){const e=new Float32Array(t.length/2),r=new Float32Array(t.length/2);for(let i=0;i<t.length;i+=2)e[i/2]=t[i],r[i/2]=t[i+1];return{real:e,imag:r}}function Sa(t){const e=Math.ceil(t.length/4),r=new Float32Array(e),i=new Float32Array(e);for(let e=0;e<t.length;e+=4)r[Math.floor(e/4)]=t[e],i[Math.floor(e/4)]=t[e+1];return{real:r,imag:i}}function Ia(t){const e=Math.floor(t.length/4),r=new Float32Array(e),i=new Float32Array(e);for(let e=2;e<t.length;e+=4)r[Math.floor(e/4)]=t[e],i[Math.floor(e/4)]=t[e+1];return{real:r,imag:i}}function Aa(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Ca(t,e,r,i){t[2*i]=e,t[2*i+1]=r}function Oa(t,e){const r=new Float32Array(t/2),i=new Float32Array(t/2);for(let n=0;n<Math.ceil(t/2);n++){const s=(e?2:-2)*Math.PI*(n/t);r[n]=Math.cos(s),i[n]=Math.sin(s)}return{real:r,imag:i}}function Ra(t,e,r){const i=(r?2:-2)*Math.PI*(t/e);return{real:Math.cos(i),imag:Math.sin(i)}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Na(t,e,r){if("complex64"===e){if("complex64"===t.dtype)return t.clone();const e=Object(P.n)(t.shape),i=t.toFloat(),n=r.complex(i,e);return e.dispose(),i.dispose(),n}if(!Object(O.hasEncodingLoss)(t.dtype,e))return y.a.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){const i=r.real(t),n=i.cast(e);return i.dispose(),n}if("int32"===e)return r.int(t);if("bool"===e){const e=Object(P.e)(0,t.dtype),i=r.notEqual(t,e);return e.dispose(),i}throw new Error(`Error in Cast: failed to cast ${t.dtype} to ${e}`)}function Pa(t,e){return y.a.makeTensorFromDataId(t.dataId,e,t.dtype)}function Ma(t,e,r){const i=(e-t)/(r-1),n=Object(O.makeZerosTypedArray)(r,"float32");n[0]=t;for(let t=1;t<n.length;t++)n[t]=n[t-1]+i;return Object(P.g)(n,"float32")}var Da=r(34);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fa(t,e,r){const i=new Array(t.rank).fill(0),n=t.shape.slice();return e.map(e=>{const s=[...n];s[r]=e;const o=t.slice(i,s);return i[r]+=e,o})}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function La(t,e){const r=new Array(t.rank);for(let i=0;i<r.length;i++)r[i]=t.shape[i]*e[i];const i=D(r,t.dtype);for(let e=0;e<i.values.length;++e){const r=i.indexToLoc(e),n=new Array(t.rank);for(let e=0;e<n.length;e++)n[e]=r[e]%t.shape[e];const s=t.locToIndex(n);i.values[e]=t.values[s]}return i.toTensor()}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ka(t,e,r,i,n){const s=e[e.length-1],[o,a]=[t.length/s,s],h=Object(O.getTypedArrayFromDType)(r,o*i),u=Object(O.getTypedArrayFromDType)("int32",o*i);for(let e=0;e<o;e++){const r=e*a,n=t.subarray(r,r+a),s=[];for(let t=0;t<n.length;t++)s.push({value:n[t],index:t});s.sort((t,e)=>e.value-t.value);const o=e*i,l=h.subarray(o,o+i),c=u.subarray(o,o+i);for(let t=0;t<i;t++)l[t]=s[t].value,c[t]=s[t].index}const l=e.slice();return l[l.length-1]=i,[Object(P.f)(h,l,r),Object(P.f)(u,l,"int32")]}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ua{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class Ba{time(t){return ja("time")}read(t){return ja("read")}readSync(t){return ja("readSync")}numDataIds(){return ja("numDataIds")}disposeData(t){return ja("disposeData")}write(t,e,r){return ja("write")}move(t,e,r,i){return ja("move")}memory(){return ja("memory")}floatPrecision(){return ja("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}batchMatMul(t,e,r,i){return ja("batchMatMul")}fusedBatchMatMul({a:t,b:e,transposeA:r,transposeB:i,bias:n,activation:s,preluActivationWeights:o}){return ja("fusedBatchMatMul")}slice(t,e,r){return ja("slice")}stridedSlice(t,e,r,i){return ja("stridedSlice")}unstack(t,e){return ja("unstack")}reverse(t,e){return ja("reverse")}concat(t,e){return ja("concat")}neg(t){return ja("neg")}add(t,e){return ja("add")}addN(t){return ja("addN")}subtract(t,e){return ja("subtract")}multiply(t,e){return ja("multiply")}realDivide(t,e){return ja("realDivide")}floorDiv(t,e){return ja("floorDiv")}sum(t,e){return ja("sum")}prod(t,e){return ja("prod")}unsortedSegmentSum(t,e,r){return ja("unsortedSegmentSum")}argMin(t,e){return ja("argMin")}argMax(t,e){return ja("argMax")}equal(t,e){return ja("equal")}notEqual(t,e){return ja("notEqual")}less(t,e){return ja("less")}lessEqual(t,e){return ja("lessEqual")}greater(t,e){return ja("greater")}greaterEqual(t,e){return ja("greaterEqual")}logicalNot(t){return ja("logicalNot")}logicalAnd(t,e){return ja("logicalAnd")}logicalOr(t,e){return ja("logicalOr")}where(t){return ja("where")}select(t,e,r){return ja("select")}topk(t,e,r){return ja("topk")}min(t,e){return ja("min")}minimum(t,e){return ja("minimum")}mod(t,e){return ja("mod")}max(t,e){return ja("max")}maximum(t,e){return ja("maximum")}all(t,e){return ja("all")}any(t,e){return ja("any")}squaredDifference(t,e){return ja("squaredDifference")}ceil(t){return ja("ceil")}floor(t){return ja("floor")}round(t){return ja("round")}sign(t){return ja("sign")}isNaN(t){return ja("isNaN")}isInf(t){return ja("isInf")}isFinite(t){return ja("isFinite")}pow(t,e){return ja("pow")}exp(t){return ja("exp")}expm1(t){return ja("expm1")}softmax(t,e){return ja("softmax")}log(t){return ja("log")}log1p(t){return ja("log1p")}sqrt(t){return ja("sqrt")}rsqrt(t){return ja("rsqrt")}square(t){return ja("square")}reciprocal(t){return ja("reciprocal")}relu(t){return ja("relu")}relu6(t){return ja("relu6")}prelu(t,e){return ja("prelu")}elu(t){return ja("elu")}eluDer(t,e){return ja("eluDer")}selu(t){return ja("selu")}int(t){return ja("int")}clip(t,e,r){return ja("clip")}abs(t){return ja("abs")}complexAbs(t){return ja("complexAbs")}sigmoid(t){return ja("sigmoid")}softplus(t){return ja("softplus")}sin(t){return ja("sin")}cos(t){return ja("cos")}tan(t){return ja("tan")}asin(t){return ja("asin")}acos(t){return ja("acos")}atan(t){return ja("atan")}atan2(t,e){return ja("atan2")}sinh(t){return ja("sinh")}cosh(t){return ja("cosh")}tanh(t){return ja("tanh")}asinh(t){return ja("asinh")}acosh(t){return ja("acosh")}atanh(t){return ja("atanh")}erf(t){return ja("erf")}step(t,e){return ja("step")}fusedConv2d({input:t,filter:e,convInfo:r,bias:i,activation:n,preluActivationWeights:s}){return ja("fusedConv2d")}conv2d(t,e,r){return ja("conv2d")}conv2dDerInput(t,e,r){return ja("conv2dDerInput")}conv2dDerFilter(t,e,r){return ja("conv2dDerFilter")}fusedDepthwiseConv2D({input:t,filter:e,convInfo:r,bias:i,activation:n,preluActivationWeights:s}){return ja("fusedDepthwiseConv2D")}depthwiseConv2D(t,e,r){return ja("depthwiseConv2D")}depthwiseConv2DDerInput(t,e,r){return ja("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,e,r){return ja("depthwiseConv2DDerFilter")}conv3d(t,e,r){return ja("conv3d")}conv3dDerInput(t,e,r){return ja("conv3dDerInput")}conv3dDerFilter(t,e,r){return ja("conv3dDerFilter")}maxPool(t,e){return ja("maxPool")}maxPoolBackprop(t,e,r,i){return ja("maxPoolBackprop")}avgPool(t,e){return ja("avgPool")}avgPoolBackprop(t,e,r){return ja("avgPoolBackprop")}avgPool3d(t,e){return ja("avgPool3d")}avgPool3dBackprop(t,e,r){return ja("avgPool3dBackprop")}maxPool3d(t,e){return ja("maxPool3d")}maxPool3dBackprop(t,e,r,i){return ja("maxPool3dBackprop")}reshape(t,e){return ja("reshape")}cast(t,e){return ja("cast")}tile(t,e){return ja("tile")}pad(t,e,r){return ja("pad")}transpose(t,e){return ja("transpose")}gather(t,e,r){return ja("gather")}gatherND(t,e){return ja("gatherND")}scatterND(t,e,r){return ja("scatterND")}batchToSpaceND(t,e,r){return ja("batchToSpaceND")}spaceToBatchND(t,e,r){return ja("spaceToBatchND")}resizeBilinear(t,e,r,i){return ja("resizeBilinear")}resizeBilinearBackprop(t,e,r){return ja("resizeBilinearBackprop")}resizeNearestNeighbor(t,e,r,i){return ja("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,e,r){return ja("resizeNearestNeighborBackprop")}batchNorm(t,e,r,i,n,s){return ja("batchNorm")}localResponseNormalization4D(t,e,r,i,n){return ja("localResponseNormalization4D")}LRNGrad(t,e,r,i,n,s,o){return ja("LRNGrad")}multinomial(t,e,r,i){return ja("multinomial")}oneHot(t,e,r,i){return ja("oneHot")}cumsum(t,e,r,i){return ja("cumsum")}nonMaxSuppression(t,e,r,i,n){return ja("nonMaxSuppression")}fft(t){return ja("fft")}ifft(t){return ja("ifft")}complex(t,e){return ja("complex")}real(t){return ja("real")}imag(t){return ja("imag")}cropAndResize(t,e,r,i,n,s){return ja("cropAndResize")}depthToSpace(t,e,r){return ja("depthToSpace")}split(t,e,r){return ja("split")}sparseToDense(t,e,r,i){return ja("sparseToDense")}diag(t){return ja("diag")}fill(t,e,r){return ja("fill")}onesLike(t){return ja("onesLike")}zerosLike(t){return ja("zerosLike")}linspace(t,e,r){return ja("linspace")}dispose(){return ja("dispose")}}function ja(t){throw new Error(`'${t}' not yet implemented or not found in the registry. `+"Did you forget to import the kernel?")}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */C.a.prototype.add=function(t){return this.throwIfDisposed(),A(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.atan2=function(t){return this.throwIfDisposed(),hn(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.avgPool=function(t,e,r,i){return this.throwIfDisposed(),un(this,t,e,r,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.batchNorm=function(t,e,r,i,n){return this.throwIfDisposed(),dn(this,t,e,r,i,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.broadcastTo=function(t){return this.throwIfDisposed(),yn(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),vr(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof C.a&&(t=[t]),M([this,...t],e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.conv1d=function(t,e,r,i,n,s){return this.throwIfDisposed(),En(this,t,e,r,i,n,s)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.conv2d=function(t,e,r,i,n,s){return this.throwIfDisposed(),xe(this,t,e,r,i,n,s)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.conv2dTranspose=function(t,e,r,i,n){return this.throwIfDisposed(),wn(this,t,e,r,i,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.cumsum=function(t,e,r){return this.throwIfDisposed(),Ae(this,t,e,r)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),An(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.depthwiseConv2d=function(t,e,r,i,n,s){return this.throwIfDisposed(),Cn(this,t,e,r,i,n,s)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.depthwiseConv2D=function(t,e,r,i,n,s){return Zi("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),Cn(this,t,e,r,i,n,s)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.div=function(t){return this.throwIfDisposed(),V(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.divNoNan=function(t){return this.throwIfDisposed(),Rn(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.dot=function(t){return this.throwIfDisposed(),Nn(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.elu=function(){return this.throwIfDisposed(),Pn(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.equal=function(t){return this.throwIfDisposed(),Mn(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.floorDiv=function(t){return this.throwIfDisposed(),z(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.greater=function(t){return this.throwIfDisposed(),Ke(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ze(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.leakyRelu=function(t){return this.throwIfDisposed(),Un(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.less=function(t){return this.throwIfDisposed(),Ve(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.lessEqual=function(t){return this.throwIfDisposed(),Ze(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.localResponseNormalization=function(t,e,r,i){return this.throwIfDisposed(),Bn(this,t,e,r,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.matMul=function(t,e,r){return this.throwIfDisposed(),ce(this,t,e,r)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.max=function(t,e){return this.throwIfDisposed(),jn(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.maxPool=function(t,e,r,i){return this.throwIfDisposed(),Xn(this,t,e,r,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.maximum=function(t){return this.throwIfDisposed(),kn(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.minimum=function(t){return this.throwIfDisposed(),Vn(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.mod=function(t){return this.throwIfDisposed(),Hn(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.mul=function(t){return this.throwIfDisposed(),H(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.notEqual=function(t){return this.throwIfDisposed(),Wn(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.oneHot=function(t,e=1,r=0){return this.throwIfDisposed(),ji(this,t,e,r)},
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.pad=function(t,e){return this.throwIfDisposed(),wr(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.pool=function(t,e,r,i,n){return this.throwIfDisposed(),Qn(this,t,e,r,i,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.pow=function(t){return this.throwIfDisposed(),lr(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.prelu=function(t){return this.throwIfDisposed(),ts(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.relu=function(){return this.throwIfDisposed(),ls(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.relu6=function(){return this.throwIfDisposed(),cs(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.selu=function(){return this.throwIfDisposed(),ds(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.separableConv2d=function(t,e,r,i,n,s){return this.throwIfDisposed(),ps(this,t,e,r,i,n,s)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.split=function(t,e){return this.throwIfDisposed(),ge(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.squaredDifference=function(t){return this.throwIfDisposed(),fs(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),pe(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.sub=function(t){return this.throwIfDisposed(),Fe(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.tile=function(t){return this.throwIfDisposed(),Le(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
C.a.prototype.transpose=function(t){return this.throwIfDisposed(),Ie(this,t)},
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */r.d(e,"i",(function(){return Jo})),r.d(e,"l",(function(){return C.a})),r.d(e,"m",(function(){return C.b})),r.d(e,"ld",(function(){return oa.a})),r.d(e,"Bd",(function(){return oa.b})),r.d(e,"r",(function(){return A})),r.d(e,"s",(function(){return an})),r.d(e,"A",(function(){return hn})),r.d(e,"C",(function(){return un})),r.d(e,"D",(function(){return ln})),r.d(e,"K",(function(){return vr})),r.d(e,"G",(function(){return dn})),r.d(e,"H",(function(){return pn})),r.d(e,"I",(function(){return fn})),r.d(e,"J",(function(){return mn})),r.d(e,"L",(function(){return yn})),r.d(e,"R",(function(){return vn.a})),r.d(e,"S",(function(){return M})),r.d(e,"T",(function(){return _n})),r.d(e,"U",(function(){return bn})),r.d(e,"V",(function(){return xn})),r.d(e,"W",(function(){return Tn})),r.d(e,"X",(function(){return En})),r.d(e,"Y",(function(){return xe})),r.d(e,"Z",(function(){return wn})),r.d(e,"ab",(function(){return Sn})),r.d(e,"db",(function(){return Ae})),r.d(e,"eb",(function(){return An})),r.d(e,"fb",(function(){return Cn})),r.d(e,"ib",(function(){return V})),r.d(e,"jb",(function(){return Rn})),r.d(e,"lb",(function(){return Pn})),r.d(e,"ob",(function(){return Mn})),r.d(e,"tb",(function(){return Dn})),r.d(e,"vb",(function(){return Fn})),r.d(e,"xb",(function(){return z})),r.d(e,"Bb",(function(){return Ke})),r.d(e,"Cb",(function(){return ze})),r.d(e,"Eb",(function(){return Ln.a})),r.d(e,"Kb",(function(){return Un})),r.d(e,"Lb",(function(){return Ve})),r.d(e,"Mb",(function(){return Ze})),r.d(e,"Pb",(function(){return Bn})),r.d(e,"Wb",(function(){return ce})),r.d(e,"Xb",(function(){return jn})),r.d(e,"Yb",(function(){return Xn})),r.d(e,"Zb",(function(){return Gn})),r.d(e,"ac",(function(){return zn})),r.d(e,"bc",(function(){return kn})),r.d(e,"fc",(function(){return Vn})),r.d(e,"gc",(function(){return Hn})),r.d(e,"ic",(function(){return H})),r.d(e,"jc",(function(){return $n})),r.d(e,"mc",(function(){return Wn})),r.d(e,"nc",(function(){return ji})),r.d(e,"qc",(function(){return wr})),r.d(e,"rc",(function(){return lr})),r.d(e,"sc",(function(){return ts})),r.d(e,"uc",(function(){return as})),r.d(e,"vc",(function(){return hs})),r.d(e,"xc",(function(){return us.a})),r.d(e,"Bc",(function(){return ls})),r.d(e,"Jc",(function(){return ds})),r.d(e,"Kc",(function(){return ps})),r.d(e,"ad",(function(){return pe})),r.d(e,"cd",(function(){return ge})),r.d(e,"ed",(function(){return pt})),r.d(e,"fd",(function(){return fs})),r.d(e,"jd",(function(){return Fe})),r.d(e,"vd",(function(){return Le})),r.d(e,"zd",(function(){return ms})),r.d(e,"Dc",(function(){return Is})),r.d(e,"Sc",(function(){return Lr})),r.d(e,"Tc",(function(){return kr})),r.d(e,"Uc",(function(){return Ur})),r.d(e,"Vc",(function(){return Br})),r.d(e,"Wc",(function(){return jr})),r.d(e,"o",(function(){return ft})),r.d(e,"p",(function(){return mt})),r.d(e,"q",(function(){return gt})),r.d(e,"x",(function(){return yt})),r.d(e,"y",(function(){return vt})),r.d(e,"z",(function(){return _t})),r.d(e,"B",(function(){return bt})),r.d(e,"P",(function(){return xt})),r.d(e,"Q",(function(){return Tt})),r.d(e,"bb",(function(){return Et})),r.d(e,"cb",(function(){return wt})),r.d(e,"pb",(function(){return St})),r.d(e,"qb",(function(){return It})),r.d(e,"sb",(function(){return At})),r.d(e,"wb",(function(){return Ct})),r.d(e,"Qb",(function(){return Ot})),r.d(e,"Rb",(function(){return Rt})),r.d(e,"kc",(function(){return Pt})),r.d(e,"yc",(function(){return Mt})),r.d(e,"Fc",(function(){return Dt})),r.d(e,"Gc",(function(){return Ft})),r.d(e,"Oc",(function(){return Lt})),r.d(e,"Pc",(function(){return kt})),r.d(e,"Qc",(function(){return Xt})),r.d(e,"Rc",(function(){return Gt})),r.d(e,"Zc",(function(){return zt})),r.d(e,"dd",(function(){return Vt})),r.d(e,"md",(function(){return $t})),r.d(e,"nd",(function(){return Wt})),r.d(e,"t",(function(){return it})),r.d(e,"u",(function(){return nt})),r.d(e,"v",(function(){return st})),r.d(e,"w",(function(){return ot})),r.d(e,"cc",(function(){return ht})),r.d(e,"ec",(function(){return ut})),r.d(e,"hc",(function(){return lt})),r.d(e,"kd",(function(){return ct})),r.d(e,"tc",(function(){return dt})),r.d(e,"Tb",(function(){return nr})),r.d(e,"Ub",(function(){return sr})),r.d(e,"Vb",(function(){return or})),r.d(e,"Gd",(function(){return hr})),r.d(e,"Hd",(function(){return ur})),r.d(e,"N",(function(){return D})),r.d(e,"O",(function(){return L})),r.d(e,"rb",(function(){return k})),r.d(e,"Cc",(function(){return U})),r.d(e,"gd",(function(){return B})),r.d(e,"hd",(function(){return j})),r.d(e,"Ad",(function(){return X})),r.d(e,"Nc",(function(){return G})),r.d(e,"Ob",(function(){return P.a})),r.d(e,"oc",(function(){return P.b})),r.d(e,"wc",(function(){return P.d})),r.d(e,"Hc",(function(){return P.e})),r.d(e,"od",(function(){return P.f})),r.d(e,"pd",(function(){return P.g})),r.d(e,"qd",(function(){return P.h})),r.d(e,"rd",(function(){return P.i})),r.d(e,"sd",(function(){return P.j})),r.d(e,"Dd",(function(){return P.m})),r.d(e,"Id",(function(){return P.n})),r.d(e,"pc",(function(){return P.c})),r.d(e,"Jd",(function(){return P.o})),r.d(e,"yd",(function(){return Ie})),r.d(e,"Yc",(function(){return $s})),r.d(e,"Sb",(function(){return Ws})),r.d(e,"zb",(function(){return Es})),r.d(e,"id",(function(){return Js})),r.d(e,"wd",(function(){return Qs})),r.d(e,"Ic",(function(){return to})),r.d(e,"ub",(function(){return eo})),r.d(e,"Db",(function(){return ro})),r.d(e,"Ec",(function(){return io})),r.d(e,"Hb",(function(){return no})),r.d(e,"bd",(function(){return so})),r.d(e,"Ab",(function(){return oo})),r.d(e,"kb",(function(){return ao})),r.d(e,"Fb",(function(){return d})),r.d(e,"Nb",(function(){return c})),r.d(e,"yb",(function(){return p})),r.d(e,"xd",(function(){return ha})),r.d(e,"mb",(function(){return Ji})),r.d(e,"dc",(function(){return Qi})),r.d(e,"ud",(function(){return tn})),r.d(e,"hb",(function(){return en})),r.d(e,"Ib",(function(){return rn})),r.d(e,"Mc",(function(){return nn})),r.d(e,"zc",(function(){return sn})),r.d(e,"E",(function(){return on})),r.d(e,"Ac",(function(){return zr.e})),r.d(e,"Ed",(function(){return $})),r.d(e,"nb",(function(){return Hr.b})),r.d(e,"Fd",(function(){return"2.0.1"})),r.d(e,"lc",(function(){return ua.a})),r.d(e,"M",(function(){return s})),r.d(e,"Gb",(function(){return n})),r.d(e,"Lc",(function(){return o})),r.d(e,"Cd",(function(){return O})),r.d(e,"F",(function(){return m})),r.d(e,"td",(function(){return w})),r.d(e,"Xc",(function(){return i})),r.d(e,"gb",(function(){return Da})),r.d(e,"Jb",(function(){return g})),r.d(e,"d",(function(){return Ba})),r.d(e,"a",(function(){return Ua})),r.d(e,"b",(function(){return v.y})),r.d(e,"e",(function(){return v.P})),r.d(e,"f",(function(){return v.U})),r.d(e,"g",(function(){return v.Z})),r.d(e,"h",(function(){return v.ab})),r.d(e,"k",(function(){return v.ob})),r.d(e,"j",(function(){return v.nb})),r.d(e,"n",(function(){return v.rb})),r.d(e,"c",(function(){return v.E})),
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object(C.e)(f)},function(t,e,r){"use strict";r.r(e),r.d(e,"shuffle",(function(){return n})),r.d(e,"clamp",(function(){return s})),r.d(e,"nearestLargerEven",(function(){return o})),r.d(e,"sum",(function(){return a})),r.d(e,"randUniform",(function(){return h})),r.d(e,"distSquared",(function(){return u})),r.d(e,"assert",(function(){return l})),r.d(e,"assertShapesMatch",(function(){return c})),r.d(e,"assertNonNull",(function(){return d})),r.d(e,"flatten",(function(){return p})),r.d(e,"sizeFromShape",(function(){return f})),r.d(e,"isScalarShape",(function(){return m})),r.d(e,"arraysEqual",(function(){return g})),r.d(e,"isInt",(function(){return y})),r.d(e,"tanh",(function(){return v})),r.d(e,"sizeToSquarishShape",(function(){return _})),r.d(e,"createShuffledIndices",(function(){return b})),r.d(e,"rightPad",(function(){return x})),r.d(e,"repeatedTry",(function(){return T})),r.d(e,"inferFromImplicitShape",(function(){return E})),r.d(e,"parseAxisParam",(function(){return w})),r.d(e,"squeezeShape",(function(){return S})),r.d(e,"getTypedArrayFromDType",(function(){return I})),r.d(e,"getArrayFromDType",(function(){return A})),r.d(e,"checkConversionForErrors",(function(){return C})),r.d(e,"isValidDtype",(function(){return O})),r.d(e,"hasEncodingLoss",(function(){return R})),r.d(e,"isTypedArray",(function(){return N})),r.d(e,"bytesPerElement",(function(){return P})),r.d(e,"bytesFromStringArray",(function(){return M})),r.d(e,"isString",(function(){return D})),r.d(e,"isBoolean",(function(){return F})),r.d(e,"isNumber",(function(){return L})),r.d(e,"inferDtype",(function(){return k})),r.d(e,"isFunction",(function(){return U})),r.d(e,"nearestDivisor",(function(){return B})),r.d(e,"computeStrides",(function(){return j})),r.d(e,"toTypedArray",(function(){return X})),r.d(e,"toNestedArray",(function(){return G})),r.d(e,"makeOnesTypedArray",(function(){return z})),r.d(e,"makeZerosTypedArray",(function(){return V})),r.d(e,"now",(function(){return H})),r.d(e,"assertNonNegativeIntegerDimensions",(function(){return $})),r.d(e,"fetch",(function(){return W})),r.d(e,"encodeString",(function(){return Y})),r.d(e,"decodeString",(function(){return q})),r.d(e,"locToIndex",(function(){return K})),r.d(e,"indexToLoc",(function(){return Z}));var i=r(9);
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n(t){let e=t.length,r=0,i=0;for(;e>0;)i=Math.random()*e|0,e--,r=t[e],t[e]=t[i],t[i]=r}function s(t,e,r){return Math.max(t,Math.min(e,r))}function o(t){return t%2==0?t:t+1}function a(t){let e=0;for(let r=0;r<t.length;r++)e+=t[r];return e}function h(t,e){const r=Math.random();return e*r+(1-r)*t}function u(t,e){let r=0;for(let i=0;i<t.length;i++){const n=Number(t[i])-Number(e[i]);r+=n*n}return r}function l(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function c(t,e,r=""){l(g(t,e),()=>r+` Shapes ${t} and ${e} must match`)}function d(t){l(null!=t,()=>"The input to the tensor constructor must be a non-null value.")}function p(t,e=[],r=!1){if(null==e&&(e=[]),Array.isArray(t)||N(t)&&!r)for(let i=0;i<t.length;++i)p(t[i],e,r);else e.push(t);return e}function f(t){if(0===t.length)return 1;let e=t[0];for(let r=1;r<t.length;r++)e*=t[r];return e}function m(t){return 0===t.length}function g(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function y(t){return t%1==0}function v(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function _(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function b(t){const e=new Uint32Array(t);for(let r=0;r<t;++r)e[r]=r;return n(e),e}function x(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function T(t,e=(t=>0),r){return new Promise((i,n)=>{let s=0;const o=()=>{if(t())return void i();s++;const a=e(s);null!=r&&s>=r?n():setTimeout(o,a)};o()})}function E(t,e){let r=1,i=-1;for(let e=0;e<t.length;++e)if(t[e]>=0)r*=t[e];else if(-1===t[e]){if(-1!==i)throw Error("Shapes can only have 1 implicit size. "+`Found -1 at dim ${i} and dim ${e}`);i=e}else if(t[e]<0)throw Error(`Shapes can not be < 0. Found ${t[e]} at dim ${e}`);if(-1===i){if(e>0&&e!==r)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(0===r)throw Error(`Cannot infer the missing size in [${t}] when `+"there are 0 elements");if(e%r!=0)throw Error("The implicit shape can't be a fractional number. "+`Got ${e} / ${r}`);const n=t.slice();return n[i]=e/r,n}function w(t,e){const r=e.length;return l((t=null==t?e.map((t,e)=>e):[].concat(t)).every(t=>t>=-r&&t<r),()=>`All values in axis param must be in range [-${r}, ${r}) but `+`got axis ${t}`),l(t.every(t=>y(t)),()=>"All values in axis param must be integers but "+`got axis ${t}`),t.map(t=>t<0?r+t:t)}function S(t,e){const r=[],i=[],n=null!=e&&Array.isArray(e)&&0===e.length,s=null==e||n?null:w(e,t).sort();let o=0;for(let e=0;e<t.length;++e){if(null!=s){if(s[o]===e&&1!==t[e])throw new Error(`Can't squeeze axis ${e} since its dim '${t[e]}' is not 1`);(null==s[o]||s[o]>e)&&1===t[e]&&(r.push(t[e]),i.push(e)),s[o]<=e&&o++}1!==t[e]&&(r.push(t[e]),i.push(e))}return{newShape:r,keptDims:i}}function I(t,e){let r=null;if(null==t||"float32"===t)r=new Float32Array(e);else if("int32"===t)r=new Int32Array(e);else{if("bool"!==t)throw new Error(`Unknown data type ${t}`);r=new Uint8Array(e)}return r}function A(t,e){let r=null;if(null==t||"float32"===t)r=new Float32Array(e);else if("int32"===t)r=new Int32Array(e);else if("bool"===t)r=new Uint8Array(e);else{if("string"!==t)throw new Error(`Unknown data type ${t}`);r=new Array(e)}return r}function C(t,e){for(let r=0;r<t.length;r++){const i=t[r];if(isNaN(i)||!isFinite(i))throw Error(`A tensor of type ${e} being uploaded contains ${i}.`)}}function O(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function R(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function N(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function P(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error(`Unknown dtype ${t}`)}function M(t){if(null==t)return 0;let e=0;return t.forEach(t=>e+=t.length),e}function D(t){return"string"==typeof t||t instanceof String}function F(t){return"boolean"==typeof t}function L(t){return"number"==typeof t}function k(t){return Array.isArray(t)?k(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":L(t)?"float32":D(t)?"string":F(t)?"bool":"float32"}function U(t){return!!(t&&t.constructor&&t.call&&t.apply)}function B(t,e){for(let r=e;r<t;++r)if(t%r==0)return r;return t}function j(t){const e=t.length;if(e<2)return[];const r=new Array(e-1);r[e-2]=t[e-1];for(let i=e-3;i>=0;--i)r[i]=r[i+1]*t[i+1];return r}function X(t,e,r){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=p(t)),r&&C(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let r=0;r<e.length;++r)0!==Math.round(t[r])&&(e[r]=1);return e}throw new Error(`Unknown data type ${e}`)}function G(t,e){if(0===t.length)return e[0];const r=t.reduce((t,e)=>t*e);if(0===r)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size.`);return function t(e,r,i){const n=new Array;if(1===r.length){const t=r[0];for(let r=0;r<t;r++)n[r]=i[e+r]}else{const s=r[0],o=r.slice(1),a=o.reduce((t,e)=>t*e);for(let r=0;r<s;r++)n[r]=t(e+r*a,o,i)}return n}(0,t,e)}function z(t,e){const r=V(t,e);for(let t=0;t<r.length;t++)r[t]=1;return r}function V(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function H(){return Object(i.b)().platform.now()}function $(t){t.forEach(e=>{l(Number.isInteger(e)&&e>=0,()=>"Tensor must have a shape comprised of positive integers but got "+`shape [${t}].`)})}function W(t,e){return Object(i.b)().platform.fetch(t,e)}function Y(t,e="utf-8"){return e=e||"utf-8",Object(i.b)().platform.encode(t,e)}function q(t,e="utf-8"){return e=e||"utf-8",Object(i.b)().platform.decode(t,e)}function K(t,e,r){if(0===e)return 0;if(1===e)return t[0];let i=t[t.length-1];for(let e=0;e<t.length-1;++e)i+=r[e]*t[e];return i}function Z(t,e,r){if(0===e)return[];if(1===e)return[t];const i=new Array(e);for(let e=0;e<i.length-1;++e)i[e]=Math.floor(t/r[e]),t-=i[e]*r[e];return i[i.length-1]=t,i}},function(t,e,r){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function i(t,e,r,i){const s=e.inputParams[t];if(s&&void 0!==s.inputIndexStart){const t=s.inputIndexStart,o=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?t+1:s.inputIndexEnd;if("tensor"===s.type)return n(e.inputNames[s.inputIndexStart],r,i);if("tensors"===s.type){return e.inputNames.slice(t,o).map(t=>n(t,r,i))}const a=Array.prototype.slice.call(n(e.inputNames.slice(t)[0],r,i).dataSync());return"number"===s.type?a[0]:a}const o=e.attrParams[t];return o&&o.value}function n(t,e,r){const[i,n]=h(t),s=r.currentContextIds.find(t=>!!e[a(i,t)]);return void 0!==s?e[a(i,s)][n]:void 0}function s(t,e,r){return e[a(t,r.currentContextId)]}function o(t,e){const[r,i]=h(t);return[a(r,e&&e.currentContextId),i]}function a(t,e){return e?`${t}-${e}`:t}function h(t){const e=t.split(":");return 1===e.length?[t,0]:[e[0],Number(e[e.length-1])]}function u(t,e){const r=[];for(let i=0;i<t.length;i+=e)r.push(t.slice(i,i+e));return r}r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return n})),r.d(e,"d",(function(){return s})),r.d(e,"a",(function(){return o})),r.d(e,"e",(function(){return h})),r.d(e,"f",(function(){return u}))},function(t,e,r){"use strict";r.d(e,"c",(function(){return a})),r.d(e,"a",(function(){return u})),r.d(e,"b",(function(){return l}));var i=r(5),n=r(9),s=r(7),o=r(1);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function a(t,e){let r=t;if(Object(o.isTypedArray)(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const i=[];for(;Array.isArray(r)||Object(o.isTypedArray)(r)&&"string"!==e;)i.push(r.length),r=r[0];return Array.isArray(t)&&Object(n.b)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,r,i){if(i=i||[],!Array.isArray(e)&&!Object(o.isTypedArray)(e))return void Object(o.assert)(0===r.length,()=>`Element arr[${i.join("][")}] is a primitive, `+`but should be an array/TypedArray of ${r[0]} elements`);Object(o.assert)(r.length>0,()=>`Element arr[${i.join("][")}] should be a primitive, `+`but is an array of ${e.length} elements`),Object(o.assert)(e.length===r[0],()=>`Element arr[${i.join("][")}] should have ${r[0]} `+`elements, but has ${e.length} elements`);const n=r.slice(1);for(let r=0;r<e.length;++r)t(e[r],n,i.concat(r))}(t,i,[]),i}function h(t,e,r,i){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error(`Argument '${r}' passed to '${i}' must `+`be ${t} tensor, but got ${e} tensor`)}function u(t,e,r,u="numeric"){if(t instanceof s.a)return h(u,t.dtype,e,r),t;let l=Object(o.inferDtype)(t);if("string"!==l&&["bool","int32","float32"].indexOf(u)>=0&&(l=u),h(u,l,e,r),null==t||!Object(o.isTypedArray)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){const i=null==t?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${r}' must be a `+`Tensor or TensorLike, but got '${i}'`)}const c=a(t,l);Object(o.isTypedArray)(t)||Array.isArray(t)||(t=[t]);const d="string"!==l?Object(o.toTypedArray)(t,l,Object(n.b)().getBool("DEBUG")):Object(o.flatten)(t,[],!0);return i.a.makeTensor(d,c,l)}function l(t,e,r,i="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${r} must be a `+"`Tensor[]` or `TensorLike[]`");return t.map((t,i)=>u(t,`${e}[${i}]`,r),i)}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var i=r(5);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+`${e.length} keys.`);let r=e[0];const n=t[r];r.endsWith("_")&&(r=r.substring(0,r.length-1));const s=(...t)=>{i.a.startScope(r);try{const e=n(...t);return e instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i.a.endScope(e),e}catch(t){throw i.a.endScope(null),t}};return Object.defineProperty(s,"name",{value:r,configurable:!0}),s}},function(t,e,r){"use strict";var i=r(9),n=r(32),s=r(18),o=r(1);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class a{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new h)}profileKernel(t,e,r){let i;const n=this.backendTimer.time(()=>{i=r()});return i.forEach(r=>{r.data().then(i=>{!function(t,e,r){if("float32"!==e)return!1;for(let e=0;e<t.length;e++){const i=t[e];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${r}'`),!0}}(i,r.dtype,t),n.then(n=>{let s="";null!=n.getExtraProfileInfo&&(s=n.getExtraProfileInfo()),this.logger.logKernelProfile(t,r,i,n.kernelMs,e,s)})})}),i}}class h{logKernelProfile(t,e,r,i,n,s){const a="number"==typeof i?o.rightPad(`${i}ms`,9):i.error,h=o.rightPad(t,25),u=e.rank,l=e.size,c=o.rightPad(e.shape.toString(),14);let d="";for(const t in n){const r=n[t].shape||e.shape,i=r.length;d+=`${t}: ${i}D ${i>0?r:""} `}console.log(`%c${h}\t%c${a}\t%c${u}D ${c}\t%c${l}\t%c${d}\t%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var u=r(7),l=r(10);r.d(e,"a",(function(){return p}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class c{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class d{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new c}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const r=t[e];if(await this.initializeBackend(r).success)return void await this.setBackend(r)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make `+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been `+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,r=1){return t in this.registryFactory?(console.warn(`${t} backend was already registered. `+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:r},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:r}=this.initializeBackend(t);if(!(r?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new a(this.backendInstance),!0}setupRegisteredKernels(){Object(s.c)(this.backendName).forEach(t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){Object(s.c)(t).forEach(e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const r=e.factory();if(Promise.resolve(r)===r){const e=++this.pendingBackendInitId,i=r.then(r=>!(e<this.pendingBackendInitId)&&(this.registry[t]=r,this.pendingBackendInit=null,!0)).catch(r=>!(e<this.pendingBackendInitId)&&(this.pendingBackendInit=null,console.warn(`Initialization of backend ${t} failed`),console.warn(r.stack||r.message),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn(`Initialization of backend ${t} failed`),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const r=t[e],{success:i,asyncInit:n}=this.initializeBackend(r);if(n||i)return{name:r,asyncInit:n}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const r=this.state.tensorInfo.get(e),i=r.backend,n=this.readSync(e);i.disposeData(e),r.backend=t,t.move(e,n,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let r,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(()=>this.startScope(i),()=>this.endScope(r),()=>(r=e(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(t,e,r){t();try{const t=r();return e(),t}catch(t){throw e(),t}}nextTensorId(){return d.nextTensorId++}nextVariableId(){return d.nextVariableId++}clone(t){const e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[e],t=>({x:()=>t.toFloat()}),[],{}),e}runKernel(t,e,r,i,n){return this.runKernelFunc(null,e,null,t,r,i,n)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,r){const i=this.backend.numDataIds();let n=0;r.forEach(t=>{n+="complex64"===t.dtype?3:1});const s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=i-e-n-s;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak `+`(${o} data ids) after running '${t}'`)}runKernelFunc(t,e,r,i,n,o,a){let h,u=[];const l=this.isTapeOn();null==i&&(i=null!=this.state.activeScope?this.state.activeScope.name:"");const c=this.state.numBytes,d=this.state.numTensors;let p;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);const f=Object(s.b)(i,this.backendName);let m;if(null!=f)p=()=>{const t=this.backend.numDataIds();m=f.kernelFunc({inputs:e,attrs:n,backend:this.backend});const r=Array.isArray(m)?m:[m];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,t,r);const s=r.map(({dataId:t,shape:e,dtype:r})=>this.makeTensorFromDataId(t,e,r));if(l){let t=this.getTensorsForGradient(i,e,s);if(null==t){null==a&&(a=[]);const e=s.filter((t,e)=>a[e]);t=(o||[]).slice().concat(e)}u=this.saveTensorsForBackwardMode(t)}return s};else{const e=t=>{l&&(u=t.map(t=>this.keep(this.clone(t))))};p=()=>{const r=this.backend.numDataIds();m=this.tidy(()=>t(this.backend,e));const n=Array.isArray(m)?m:[m];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,r,n),n}}return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{h=this.ENV.getBool("DEBUG")?this.profiler.profileKernel(i,e,()=>p()):p()}),l&&this.addTapeNode(i,e,h,r,u,n),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-c,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(t=>e[t].shape),outputShapes:h.map(t=>t.shape)}),Array.isArray(m)?h:h[0]}saveTensorsForBackwardMode(t){return t.map(t=>this.keep(this.clone(t)))}getTensorsForGradient(t,e,r){const i=Object(s.a)(t);if(null!=i){const t=i.inputsToSave||[],n=i.outputsToSave||[];let s;i.saveAllInputs?(o.assert(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),s=Object.keys(e).map(t=>e[t])):s=t.map(t=>e[t]);const a=r.filter((t,e)=>n[e]);return s.concat(a)}return null}makeTensor(t,e,r,i){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let n=t;"string"===r&&o.isString(t[0])&&(n=t.map(t=>o.encodeString(t)));const s=i.write(n,e,r),a=new u.a(e,r,s,this.nextTensorId());if(this.incRef(a,i),"string"===r){const t=this.state.tensorInfo.get(s),e=Object(o.bytesFromStringArray)(n);this.state.numBytes+=e-t.bytes,t.bytes=e}return a}makeTensorFromDataId(t,e,r,i){r=r||"float32";const n=new u.a(e,r,t,this.nextTensorId());return this.incRef(n,i),n}makeVariable(t,e=!0,r,i){r=r||this.nextVariableId().toString(),null!=i&&i!==t.dtype&&(t=t.asType(i));const n=new u.c(t,e,r,this.nextTensorId());if(null!=this.state.registeredVariables[n.name])throw new Error(`Variable with name ${n.name} was already registered`);return this.state.registeredVariables[n.name]=n,this.incRef(n,this.backend),n}incRef(t,e){const r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===r){this.state.numDataBuffers++;let r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*o.bytesPerElement(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof u.c||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;const e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,r=this.state.numTensors;return this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(t=>t.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-r,this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,r,i,n,a){const h={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:r,saved:n},u=Object(s.a)(t);null!=u&&(i=u.gradFunc),null!=i&&(h.gradient=t=>(t=t.map((t,e)=>{if(null==t){const t=r[e],i=o.makeZerosTypedArray(t.size,t.dtype);return this.makeTensor(i,t.shape,t.dtype)}return t}),i(t.length>1?t:t[0],n,a))),this.state.activeTape.push(h)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=Object(l.getTensorsInContainer)(t),r=new Set(e.map(t=>t.id));for(let t=0;t<this.state.activeScope.track.length;t++){const e=this.state.activeScope.track[t];e.kept||r.has(e.id)||e.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(t=>{t.kept||t.scopeId!==i.id||this.track(t)})}gradients(t,e,r,i=!1){if(o.assert(e.length>0,()=>"gradients() received an empty list of xs."),null!=r&&"float32"!==r.dtype)throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const n=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));o.assert(n instanceof u.a,()=>"The result y returned by f() must be a tensor.");const s=function(t,e,r){const i={},n={};for(let t=0;t<e.length;t++)i[e[t].id]=!0;for(let r=0;r<t.length;r++){const s=t[r],o=s.inputs;for(const t in o){const r=o[t];let a=!1;for(let t=0;t<e.length;t++)if(i[r.id]){s.outputs.forEach(t=>i[t.id]=!0),a=!0,n[s.id]=!0;break}if(a)break}}const s={};s[r.id]=!0;const o={};for(let e=t.length-1;e>=0;e--){const r=t[e],i=r.inputs;for(let t=0;t<r.outputs.length;t++)if(s[r.outputs[t].id]){for(const t in i)s[i[t].id]=!0,o[r.id]=!0;break}}const a=[];for(let e=0;e<t.length;e++){const r=t[e];if(n[r.id]&&o[r.id]){const t={};for(const e in r.inputs){const n=r.inputs[e];i[n.id]&&(t[e]=n)}const e=Object.assign({},r);e.inputs=t,e.outputs=r.outputs,a.push(e)}}return a}(this.state.activeTape,e,n);if(!i&&0===s.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const t={};t[n.id]=null==r?function(t){const e=Object(o.makeOnesTypedArray)(Object(o.sizeFromShape)(t),"float32");return p.makeTensor(e,t,"float32")}(n.shape):r,function(t,e,r){for(let i=e.length-1;i>=0;i--){const n=e[i],s=[];if(n.outputs.forEach(e=>{const r=t[e.id];null!=r?s.push(r):s.push(null)}),null==n.gradient)throw new Error("Cannot compute gradient: gradient function not found "+`for ${n.kernelName}.`);const a=n.gradient(s);for(const e in n.inputs){if(!(e in a))throw new Error(`Cannot backprop through input ${e}. `+`Available gradients found: ${Object.keys(a)}.`);const i=r(()=>a[e]());if("float32"!==i.dtype)throw new Error(`Error in gradient for op ${n.kernelName}. The gradient of input `+`${e} must have 'float32' dtype, but has '${i.dtype}'`);const s=n.inputs[e];if(!o.arraysEqual(i.shape,s.shape))throw new Error(`Error in gradient for op ${n.kernelName}. The gradient of input `+`'${e}' has shape '${i.shape}', which does not match `+`the shape of the input '${s.shape}'`);if(null==t[s.id])t[s.id]=i;else{const e=t[s.id];t[s.id]=e.add(i),e.dispose()}}}}(t,s,t=>this.tidy(t));const i=e.map(e=>t[e.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(t=>{for(const e of t.saved)e.dispose()}),this.state.activeTape=null),{value:n,grads:i}})}customGrad(t){return o.assert(o.isFunction(t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{let r;o.assert(e.every(t=>t instanceof u.a),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const i={};return e.forEach((t,e)=>{i[e]=t}),this.runKernelFunc((i,n)=>(r=t(...e,n),o.assert(r.value instanceof u.a,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),o.assert(o.isFunction(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),i,(t,i)=>{const n=r.gradFunc(t,i),s=Array.isArray(n)?n:[n];o.assert(s.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),o.assert(s.every(t=>t instanceof u.a),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const a={};return s.forEach((t,e)=>{a[e]=()=>t}),a})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}async time(t){const e=Object(o.now)(),r=await this.backend.time(t);return r.wallMs=Object(o.now)()-e,r}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new c;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}d.nextTensorId=0,d.nextVariableId=0;const p=function(){const t=Object(n.b)();if(null==t._tfengine){const e=new i.a(t);t._tfengine=new d(e)}return Object(i.c)(t._tfengine.ENV),Object(u.f)(()=>t._tfengine),t._tfengine}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return s})),r.d(e,"d",(function(){return o})),r.d(e,"g",(function(){return a})),r.d(e,"e",(function(){return h})),r.d(e,"f",(function(){return u})),r.d(e,"h",(function(){return l})),r.d(e,"i",(function(){return c})),r.d(e,"j",(function(){return d})),r.d(e,"k",(function(){return p})),r.d(e,"l",(function(){return f})),r.d(e,"m",(function(){return m})),r.d(e,"n",(function(){return g})),r.d(e,"o",(function(){return y})),r.d(e,"p",(function(){return v})),r.d(e,"q",(function(){return _})),r.d(e,"r",(function(){return b})),r.d(e,"s",(function(){return x})),r.d(e,"t",(function(){return T})),r.d(e,"u",(function(){return E})),r.d(e,"v",(function(){return w})),r.d(e,"w",(function(){return S})),r.d(e,"x",(function(){return I})),r.d(e,"y",(function(){return A})),r.d(e,"z",(function(){return C})),r.d(e,"A",(function(){return O})),r.d(e,"B",(function(){return R})),r.d(e,"D",(function(){return N})),r.d(e,"C",(function(){return P})),r.d(e,"F",(function(){return M})),r.d(e,"G",(function(){return D})),r.d(e,"H",(function(){return F})),r.d(e,"I",(function(){return L})),r.d(e,"J",(function(){return k})),r.d(e,"K",(function(){return U})),r.d(e,"N",(function(){return B})),r.d(e,"O",(function(){return j})),r.d(e,"L",(function(){return X})),r.d(e,"M",(function(){return G})),r.d(e,"P",(function(){return z})),r.d(e,"V",(function(){return V})),r.d(e,"Q",(function(){return H})),r.d(e,"T",(function(){return $})),r.d(e,"R",(function(){return W})),r.d(e,"S",(function(){return Y})),r.d(e,"U",(function(){return q})),r.d(e,"W",(function(){return K})),r.d(e,"X",(function(){return Z})),r.d(e,"Y",(function(){return J})),r.d(e,"bb",(function(){return Q})),r.d(e,"Z",(function(){return tt})),r.d(e,"ab",(function(){return et})),r.d(e,"cb",(function(){return rt})),r.d(e,"db",(function(){return it})),r.d(e,"eb",(function(){return nt})),r.d(e,"fb",(function(){return st})),r.d(e,"gb",(function(){return ot})),r.d(e,"hb",(function(){return at})),r.d(e,"ib",(function(){return ht})),r.d(e,"jb",(function(){return ut})),r.d(e,"kb",(function(){return lt})),r.d(e,"lb",(function(){return ct})),r.d(e,"mb",(function(){return dt})),r.d(e,"ob",(function(){return pt})),r.d(e,"nb",(function(){return ft})),r.d(e,"pb",(function(){return mt})),r.d(e,"qb",(function(){return gt})),r.d(e,"rb",(function(){return yt})),r.d(e,"E",(function(){return vt}));const i="Add",n="AddN",s="Atan2",o="AvgPool",a="AvgPoolBackprop",h="AvgPool3D",u="AvgPool3DBackprop",l="BatchMatMul",c="BatchToSpaceND",d="BroadcastTo",p="Complex",f="Concat",m="Conv2D",g="Conv2DBackpropFilter",y="Conv2DBackpropInput",v="Conv3D",_="Conv3DBackpropFilterV2",b="Conv3DBackpropInputV2",x="Cumsum",T="DepthToSpace",E="DepthwiseConv2dNative",w="DepthwiseConv2dNativeBackpropFilter",S="DepthwiseConv2dNativeBackpropInput",I="Diag",A="Div",C="Elu",O="EluGrad",R="Equal",N="FloorDiv",P="Fill",M="FusedBatchNorm",D="GatherNd",F="Greater",L="GreaterEqual",k="Identity",U="Imag",B="Less",j="LessEqual",X="LRN",G="LRNBackprop",z="Max",V="Maximum",H="MaxPool",$="MaxPoolBackprop",W="MaxPool3D",Y="MaxPool3DBackprop",q="MaxPoolWithArgmax",K="Minimum",Z="Mod",J="Multiply",Q="NotEqual",tt="NonMaxSuppressionV3",et="NonMaxSuppressionV5",rt="OneHot",it="PadV2",nt="Pow",st="Prelu",ot="Real",at="Relu",ht="Relu6",ut="SelectV2",lt="Selu",ct="SpaceToBatchND",dt="SplitV",pt="SquaredDifference",ft="Square",mt="Sub",gt="Tile",yt="Transpose",vt="FromPixels"},function(t,e,r){"use strict";var i=r(1);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n(t,e,r,n){const h=Object(i.computeStrides)(e),u=function(t,e,r,n){const o=Object(i.sizeFromShape)(e),h=n[n.length-1],u=new Array(h).fill(0),l=e.length,c="complex64"===r?a(t):t;if(l>1)for(let t=0;t<o/h;t++){const e=t*h;for(let t=0;t<h;t++)u[t]=Math.max(u[t],s(c[e+t],0,r).length)}return u}(t,e,r,h),l=e.length,c=function t(e,r,i,n,h,u=!0){const l="complex64"===i?2:1,c=r[0],d=r.length;if(0===d){if("complex64"===i){return[s(a(e)[0],0,i)]}return"bool"===i?[o(e[0])]:[e[0].toString()]}if(1===d){if(c>20){const t=3*l;let r=Array.from(e.slice(0,t)),n=Array.from(e.slice((c-3)*l,c*l));return"complex64"===i&&(r=a(r),n=a(n)),["["+r.map((t,e)=>s(t,h[e],i)).join(", ")+", ..., "+n.map((t,e)=>s(t,h[c-3+e],i)).join(", ")+"]"]}return["["+("complex64"===i?a(e):Array.from(e)).map((t,e)=>s(t,h[e],i)).join(", ")+"]"]}const p=r.slice(1),f=n.slice(1),m=n[0]*l,g=[];if(c>20){for(let r=0;r<3;r++){const n=r*m,s=n+m;g.push(...t(e.slice(n,s),p,i,f,h,!1))}g.push("...");for(let r=c-3;r<c;r++){const n=r*m,s=n+m;g.push(...t(e.slice(n,s),p,i,f,h,r===c-1))}}else for(let r=0;r<c;r++){const n=r*m,s=n+m;g.push(...t(e.slice(n,s),p,i,f,h,r===c-1))}const y=2===d?",":"";g[0]="["+g[0]+y;for(let t=1;t<g.length-1;t++)g[t]=" "+g[t]+y;let v=",\n";for(let t=2;t<d;t++)v+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(u?"":v),g}(t,e,r,h,u),d=["Tensor"];return n&&(d.push(`  dtype: ${r}`),d.push(`  rank: ${l}`),d.push(`  shape: [${e}]`),d.push("  values:")),d.push(c.map(t=>"    "+t).join("\n")),d.join("\n")}function s(t,e,r){let n;return n=Array.isArray(t)?`${parseFloat(t[0].toFixed(7))} + `+`${parseFloat(t[1].toFixed(7))}j`:Object(i.isString)(t)?`'${t}'`:"bool"===r?o(t):parseFloat(t.toFixed(7)).toString(),Object(i.rightPad)(n,e)}function o(t){return 0===t?"false":"true"}function a(t){const e=[];for(let r=0;r<t.length;r+=2)e.push([t[r],t[r+1]]);return e}r.d(e,"b",(function(){return h})),r.d(e,"f",(function(){return d})),r.d(e,"e",(function(){return p})),r.d(e,"d",(function(){return f})),r.d(e,"a",(function(){return m})),r.d(e,"c",(function(){return g}));
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class h{constructor(t,e,r){if(this.dtype=e,this.shape=t.slice(),this.size=i.sizeFromShape(t),null!=r){const t=r.length;i.assert(t===this.size,()=>`Length of values '${t}' does not match the size `+`inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||i.getArrayFromDType(e,this.size),this.strides=Object(i.computeStrides)(t)}set(t,...e){0===e.length&&(e=[0]),i.assert(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must `+`match the rank (${this.rank})`);const r=this.locToIndex(e);this.values[r]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const r of t){if(r<0||r>=this.shape[e]){const e=`Requested out of range element at ${t}. `+`  Buffer shape=${this.shape}`;throw new Error(e)}e++}let r=t[t.length-1];for(let e=0;e<t.length-1;++e)r+=this.strides[e]*t[e];return this.values[r]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return u().makeTensor(this.values,this.shape,this.dtype)}}let u=null,l=null,c=null;function d(t){u=t}function p(t){l=t}function f(t){c=t}class m{constructor(t,e,r,n){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=i.sizeFromShape(t),this.strides=Object(i.computeStrides)(t),this.dataId=r,this.id=n,this.rankType=this.rank<5?this.rank.toString():"higher"}flatten(){return this.throwIfDisposed(),this.as1D()}asScalar(){return this.throwIfDisposed(),i.assert(1===this.size,()=>"The array must have only 1 element."),this.reshape([])}as1D(){return this.throwIfDisposed(),this.reshape([this.size])}as2D(t,e){return this.throwIfDisposed(),this.reshape([t,e])}as3D(t,e,r){return this.throwIfDisposed(),this.reshape([t,e,r])}as4D(t,e,r,i){return this.throwIfDisposed(),this.reshape([t,e,r,i])}as5D(t,e,r,i,n){return this.throwIfDisposed(),this.reshape([t,e,r,i,n])}asType(t){return this.throwIfDisposed(),l.cast(this,t)}get rank(){return this.shape.length}async buffer(){const t=await this.data();return l.buffer(this.shape,this.dtype,t)}bufferSync(){return l.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Object(i.toNestedArray)(this.shape,t)}arraySync(){return Object(i.toNestedArray)(this.shape,this.dataSync())}async data(){this.throwIfDisposed();const t=u().read(this.dataId);if("string"===this.dtype){const e=await t;try{return e.map(t=>i.decodeString(t))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataSync(){this.throwIfDisposed();const t=u().readSync(this.dataId);if("string"===this.dtype)try{return t.map(t=>i.decodeString(t))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await u().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(u().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}toFloat(){return this.asType("float32")}toInt(){return this.asType("int32")}toBool(){return this.asType("bool")}print(t=!1){return l.print(this,t)}reshape(t){return this.throwIfDisposed(),l.reshape(this,t)}reshapeAs(t){return this.throwIfDisposed(),this.reshape(t.shape)}expandDims(t=0){return l.expandDims(this,t)}squeeze(t){return this.throwIfDisposed(),l.squeeze(this,t)}clone(){return this.throwIfDisposed(),l.clone(this)}toString(t=!1){return n(this.dataSync(),this.shape,this.dtype,t)}gather(t,e=0){return this.throwIfDisposed(),l.gather(this,t,e)}norm(t="euclidean",e=null,r=!1){return this.throwIfDisposed(),l.norm(this,t,e,r)}slice(t,e){return this.throwIfDisposed(),l.slice(this,t,e)}reverse(t){return this.throwIfDisposed(),l.reverse(this,t)}stack(t,e=0){return l.stack([this,t],e)}unstack(t=0){return l.unstack(this,t)}all(t=null,e=!1){return this.throwIfDisposed(),l.all(this,t,e)}any(t=null,e=!1){return this.throwIfDisposed(),l.any(this,t,e)}logSumExp(t=null,e=!1){return this.throwIfDisposed(),l.logSumExp(this,t,e)}sum(t=null,e=!1){return this.throwIfDisposed(),l.sum(this,t,e)}prod(t=null,e=!1){return this.throwIfDisposed(),l.prod(this,t,e)}mean(t=null,e=!1){return this.throwIfDisposed(),l.mean(this,t,e)}min(t=null,e=!1){return this.throwIfDisposed(),l.min(this,t,e)}argMin(t=null){return this.throwIfDisposed(),l.argMin(this,t)}argMax(t=null){return this.throwIfDisposed(),l.argMax(this,t)}cast(t){return this.throwIfDisposed(),l.cast(this,t)}addStrict(t){return this.throwIfDisposed(),l.addStrict(this,t)}subStrict(t){return this.throwIfDisposed(),l.subStrict(this,t)}powStrict(t){return this.throwIfDisposed(),l.powStrict(this,t)}mulStrict(t){return this.throwIfDisposed(),l.mulStrict(this,t)}divStrict(t){return this.throwIfDisposed(),l.divStrict(this,t)}minimumStrict(t){return this.throwIfDisposed(),l.minimumStrict(this,t)}maximumStrict(t){return this.throwIfDisposed(),l.maximumStrict(this,t)}modStrict(t){return this.throwIfDisposed(),l.modStrict(this,t)}squaredDifferenceStrict(t){return this.throwIfDisposed(),l.squaredDifferenceStrict(this,t)}notEqualStrict(t){return this.throwIfDisposed(),l.notEqualStrict(this,t)}lessStrict(t){return this.throwIfDisposed(),l.lessStrict(this,t)}equalStrict(t){return this.throwIfDisposed(),l.equalStrict(this,t)}lessEqualStrict(t){return this.throwIfDisposed(),l.lessEqualStrict(this,t)}greaterStrict(t){return this.throwIfDisposed(),l.greaterStrict(this,t)}greaterEqualStrict(t){return this.throwIfDisposed(),l.greaterEqualStrict(this,t)}logicalAnd(t){return this.throwIfDisposed(),l.logicalAnd(this,t)}logicalOr(t){return this.throwIfDisposed(),l.logicalOr(this,t)}logicalNot(){return this.throwIfDisposed(),l.logicalNot(this)}logicalXor(t){return this.throwIfDisposed(),l.logicalXor(this,t)}where(t,e){return this.throwIfDisposed(),l.where(t,this,e)}neg(){return this.throwIfDisposed(),l.neg(this)}ceil(){return this.throwIfDisposed(),l.ceil(this)}floor(){return this.throwIfDisposed(),l.floor(this)}sign(){return this.throwIfDisposed(),l.sign(this)}isNaN(){return this.throwIfDisposed(),l.isNaN(this)}isInf(){return this.throwIfDisposed(),l.isInf(this)}isFinite(){return this.throwIfDisposed(),l.isFinite(this)}exp(){return this.throwIfDisposed(),l.exp(this)}expm1(){return this.throwIfDisposed(),l.expm1(this)}log(){return this.throwIfDisposed(),l.log(this)}log1p(){return this.throwIfDisposed(),l.log1p(this)}sqrt(){return this.throwIfDisposed(),l.sqrt(this)}rsqrt(){return this.throwIfDisposed(),l.rsqrt(this)}square(){return this.throwIfDisposed(),l.square(this)}reciprocal(){return this.throwIfDisposed(),l.reciprocal(this)}abs(){return this.throwIfDisposed(),l.abs(this)}clipByValue(t,e){return this.throwIfDisposed(),l.clipByValue(this,t,e)}sigmoid(){return this.throwIfDisposed(),l.sigmoid(this)}logSigmoid(){return this.throwIfDisposed(),l.logSigmoid(this)}softplus(){return this.throwIfDisposed(),l.softplus(this)}zerosLike(){return this.throwIfDisposed(),l.zerosLike(this)}onesLike(){return this.throwIfDisposed(),l.onesLike(this)}sin(){return this.throwIfDisposed(),l.sin(this)}cos(){return this.throwIfDisposed(),l.cos(this)}tan(){return this.throwIfDisposed(),l.tan(this)}asin(){return this.throwIfDisposed(),l.asin(this)}acos(){return this.throwIfDisposed(),l.acos(this)}atan(){return this.throwIfDisposed(),l.atan(this)}sinh(){return this.throwIfDisposed(),l.sinh(this)}cosh(){return this.throwIfDisposed(),l.cosh(this)}tanh(){return this.throwIfDisposed(),l.tanh(this)}asinh(){return this.throwIfDisposed(),l.asinh(this)}acosh(){return this.throwIfDisposed(),l.acosh(this)}atanh(){return this.throwIfDisposed(),l.atanh(this)}erf(){return this.throwIfDisposed(),l.erf(this)}round(){return this.throwIfDisposed(),l.round(this)}step(t=0){return this.throwIfDisposed(),l.step(this,t)}softmax(t=-1){return this.throwIfDisposed(),l.softmax(this,t)}logSoftmax(t=-1){return this.throwIfDisposed(),l.logSoftmax(this,t)}resizeBilinear(t,e=!1){return this.throwIfDisposed(),l.image.resizeBilinear(this,t,e)}resizeNearestNeighbor(t,e=!1){return this.throwIfDisposed(),l.image.resizeNearestNeighbor(this,t,e)}variable(t=!0,e,r){return this.throwIfDisposed(),u().makeVariable(this,t,e,r)}unsortedSegmentSum(t,e){return this.throwIfDisposed(),l.unsortedSegmentSum(this,t,e)}topk(t=1,e=!0){return this.throwIfDisposed(),l.topk(this,t,e)}stridedSlice(t,e,r,i=0,n=0,s=0,o=0,a=0){return this.throwIfDisposed(),l.stridedSlice(this,t,e,r,i,n,s,o,a)}fft(){return this.throwIfDisposed(),l.spectral.fft(this)}ifft(){return this.throwIfDisposed(),l.spectral.ifft(this)}rfft(){return this.throwIfDisposed(),l.spectral.rfft(this)}irfft(){return this.throwIfDisposed(),l.spectral.irfft(this)}}Object.defineProperty(m,Symbol.hasInstance,{value:t=>!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype});class g extends m{constructor(t,e,r,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=e,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and `+`previous value (${this.dtype}) must match`);if(!i.arraysEqual(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and `+`previous value (${this.shape}) must match`);u().disposeTensor(this),this.dataId=t.dataId,u().incRef(this,null)}dispose(){u().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(g,Symbol.hasInstance,{value:t=>t instanceof m&&null!=t.assign&&t.assign instanceof Function})},function(t,e,r){"use strict";r.d(e,"a",(function(){return E})),r.d(e,"b",(function(){return x})),r.d(e,"d",(function(){return w})),r.d(e,"e",(function(){return p})),r.d(e,"f",(function(){return c})),r.d(e,"g",(function(){return f})),r.d(e,"h",(function(){return m})),r.d(e,"i",(function(){return g})),r.d(e,"j",(function(){return y})),r.d(e,"k",(function(){return v})),r.d(e,"l",(function(){return _})),r.d(e,"m",(function(){return b})),r.d(e,"n",(function(){return T})),r.d(e,"c",(function(){return S})),r.d(e,"o",(function(){return I}));var i=r(5),n=r(9),s=r(3),o=r(1),a=r(19),h=r(29),u=r(4),l=r(24);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e,r){return d(t,e,Object(s.c)(t,r),r)}function d(t,e,r,s){if(null==s&&(s=Object(o.inferDtype)(t)),"complex64"===s)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(o.isTypedArray)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Object(o.assertNonNegativeIntegerDimensions)(e);const t=Object(o.sizeFromShape)(e),i=Object(o.sizeFromShape)(r);Object(o.assert)(t===i,()=>`Based on the provided shape, [${e}], the tensor should have `+`${t} values but has ${i}`);for(let t=0;t<r.length;++t){const i=r[t],n=t!==r.length-1||i!==Object(o.sizeFromShape)(e.slice(t));Object(o.assert)(r[t]===e[t]||!n,()=>"Error creating a new Tensor. Inferred shape "+`(${r}) does not match the provided `+`shape (${e}). `)}}return Object(o.isTypedArray)(t)||Array.isArray(t)||(t=[t]),e=e||r,t="string"!==s?Object(o.toTypedArray)(t,s,Object(n.b)().getBool("DEBUG")):Object(o.flatten)(t,[],!0),i.a.makeTensor(t,e,s)}function p(t,e){if((Object(o.isTypedArray)(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Object(o.isTypedArray)(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return d(t,[],[],e)}function f(t,e){Object(o.assertNonNull)(t);const r=Object(s.c)(t,e);if(1!==r.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return d(t,null,r,e)}function m(t,e,r){if(Object(o.assertNonNull)(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const i=Object(s.c)(t,r);if(2!==i.length&&1!==i.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return d(t,e,i,r)}function g(t,e,r){if(Object(o.assertNonNull)(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const i=Object(s.c)(t,r);if(3!==i.length&&1!==i.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return d(t,e,i,r)}function y(t,e,r){if(Object(o.assertNonNull)(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const i=Object(s.c)(t,r);if(4!==i.length&&1!==i.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return d(t,e,i,r)}function v(t,e,r){if(Object(o.assertNonNull)(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const i=Object(s.c)(t,r);if(5!==i.length&&1!==i.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return d(t,e,i,r)}function _(t,e,r){if(Object(o.assertNonNull)(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const i=Object(s.c)(t,r);if(6!==i.length&&1!==i.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return d(t,e=e||i,i,r)}function b(t,e=!0,r,n){return i.a.makeVariable(t,e,r,n)}function x(t,e="float32"){if("complex64"===e){const e=x(t,"float32"),r=T(t,"float32");return Object(a.a)(e,r)}const r=Object(o.makeOnesTypedArray)(Object(o.sizeFromShape)(t),e);return i.a.makeTensor(r,t,e)}function T(t,e="float32"){if("complex64"===e){const e=T(t,"float32"),r=T(t,"float32");return Object(a.a)(e,r)}const r=Object(o.makeZerosTypedArray)(Object(o.sizeFromShape)(t),e);return i.a.makeTensor(r,t,e)}function E(t,e,r){if(r<=0)throw new Error("The number of values should be positive.");return i.a.runKernelFunc(i=>i.linspace(t,e,r),{})}function w(t,e,r=1,i="float32"){if(0===r)throw new Error("Cannot have a step of zero");if(t===e||t<e&&r<0||e<t&&r>1)return T([0],i);const n=Math.abs(Math.ceil((e-t)/r)),s=Object(o.makeZerosTypedArray)(n,i);e<t&&1===r&&(r=-1),s[0]=t;for(let t=1;t<s.length;t++)s[t]=s[t-1]+r;return f(s,i)}const S=Object(u.a)({onesLike_:function(t){const e=Object(s.a)(t,"x","onesLike");if("complex64"===e.dtype){const t=S(Object(l.a)(e)),r=I(Object(h.a)(e));return Object(a.a)(t,r)}return i.a.runKernelFunc(t=>t.onesLike(e),{x:e},(t,e)=>({x:()=>I(t)}),"OnesLike")}}),I=Object(u.a)({zerosLike_:function(t){const e=Object(s.a)(t,"x","zerosLike");return i.a.runKernelFunc(t=>t.zerosLike(e),{x:e},(t,e)=>({x:()=>I(t)}),"ZerosLike")}})},function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return o}));class i{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&console.warn(`Platform ${this.platformName} has already been set. `+`Overwriting the platform with ${e}.`),this.platformName=t,this.platform=e}registerFlag(t,e,r){if(this.flagRegistry[t]={evaluationFn:e,setHook:r},null!=this.urlFlags[t]){const e=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(e instanceof Promise)throw new Error(`Flag ${t} cannot be synchronously evaluated. `+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const t=function(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>(function(t,e,r){t[decodeURIComponent(e)]=decodeURIComponent(r||"")}(e,r[0],r[1]),r.join("="))),e}(this.global.location.search);if("tfjsflags"in t){t.tfjsflags.split(",").forEach(t=>{const[e,r]=t.split(":");this.urlFlags[e]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}(e,r)})}}}function n(){return s}let s=null;function o(t){s=t}},function(t,e,r){"use strict";r.r(e),r.d(e,"makeTypesMatch",(function(){return o})),r.d(e,"assertTypesMatch",(function(){return a})),r.d(e,"isTensorInList",(function(){return h})),r.d(e,"getTensorsInContainer",(function(){return u}));var i=r(7),n=r(25),s=r(1);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e){if(t.dtype===e.dtype)return[t,e];const r=Object(n.b)(t.dtype,e.dtype);return[t.cast(r),e.cast(r)]}function a(t,e){Object(s.assert)(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and`+` second(${e.dtype}) input must match`)}function h(t,e){return e.some(e=>e.id===t.id)}function u(t){const e=[];return function t(e,r,n){if(null==e)return;if(e instanceof i.a)return void r.push(e);if(s=e,!Array.isArray(s)&&"object"!=typeof s)return;var s;const o=e;for(const e in o){const i=o[e];n.has(i)||(n.add(i),t(i,r,n))}}(t,e,new Set),e}},function(t,e,r){"use strict";var i=r(62),n=r(63);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=_,e.resolve=function(t,e){return _(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?_(t,!1,!0).resolveObject(e):e},e.format=function(t){n.isString(t)&&(t=_(t));return t instanceof s?t.format():s.prototype.format.call(t)},e.Url=s;var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(u),c=["%","/","?",";","#"].concat(l),d=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=r(64);function _(t,e,r){if(t&&n.isObject(t)&&t instanceof s)return t;var i=new s;return i.parse(t,e,r),i}s.prototype.parse=function(t,e,r){if(!n.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),a=-1!==s&&s<t.indexOf("#")?"?":"#",u=t.split(a);u[0]=u[0].replace(/\\/g,"/");var _=t=u.join(a);if(_=_.trim(),!r&&1===t.split("#").length){var b=h.exec(_);if(b)return this.path=_,this.href=_,this.pathname=b[1],b[2]?(this.search=b[2],this.query=e?v.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var x=o.exec(_);if(x){var T=(x=x[0]).toLowerCase();this.protocol=T,_=_.substr(x.length)}if(r||x||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===_.substr(0,2);!E||x&&g[x]||(_=_.substr(2),this.slashes=!0)}if(!g[x]&&(E||x&&!y[x])){for(var w,S,I=-1,A=0;A<d.length;A++){-1!==(C=_.indexOf(d[A]))&&(-1===I||C<I)&&(I=C)}-1!==(S=-1===I?_.lastIndexOf("@"):_.lastIndexOf("@",I))&&(w=_.slice(0,S),_=_.slice(S+1),this.auth=decodeURIComponent(w)),I=-1;for(A=0;A<c.length;A++){var C;-1!==(C=_.indexOf(c[A]))&&(-1===I||C<I)&&(I=C)}-1===I&&(I=_.length),this.host=_.slice(0,I),_=_.slice(I),this.parseHost(),this.hostname=this.hostname||"";var O="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!O)for(var R=this.hostname.split(/\./),N=(A=0,R.length);A<N;A++){var P=R[A];if(P&&!P.match(p)){for(var M="",D=0,F=P.length;D<F;D++)P.charCodeAt(D)>127?M+="x":M+=P[D];if(!M.match(p)){var L=R.slice(0,A),k=R.slice(A+1),U=P.match(f);U&&(L.push(U[1]),k.unshift(U[2])),k.length&&(_="/"+k.join(".")+_),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),O||(this.hostname=i.toASCII(this.hostname));var B=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+B,this.href+=this.host,O&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==_[0]&&(_="/"+_))}if(!m[T])for(A=0,N=l.length;A<N;A++){var X=l[A];if(-1!==_.indexOf(X)){var G=encodeURIComponent(X);G===X&&(G=escape(X)),_=_.split(X).join(G)}}var z=_.indexOf("#");-1!==z&&(this.hash=_.substr(z),_=_.slice(0,z));var V=_.indexOf("?");if(-1!==V?(this.search=_.substr(V),this.query=_.substr(V+1),e&&(this.query=v.parse(this.query)),_=_.slice(0,V)):e&&(this.search="",this.query={}),_&&(this.pathname=_),y[T]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var H=this.search||"";this.path=B+H}return this.href=this.format(),this},s.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",i=this.hash||"",s=!1,o="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(o=v.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||y[e])&&!1!==s?(s="//"+(s||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):s||(s=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),e+s+(r=r.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+i},s.prototype.resolve=function(t){return this.resolveObject(_(t,!1,!0)).format()},s.prototype.resolveObject=function(t){if(n.isString(t)){var e=new s;e.parse(t,!1,!0),t=e}for(var r=new s,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];r[a]=this[a]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var h=Object.keys(t),u=0;u<h.length;u++){var l=h[u];"protocol"!==l&&(r[l]=t[l])}return y[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!y[t.protocol]){for(var c=Object.keys(t),d=0;d<c.length;d++){var p=c[d];r[p]=t[p]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||g[t.protocol])r.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var m=r.pathname||"",v=r.search||"";r.path=m+v}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var _=r.pathname&&"/"===r.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=b||_||r.host&&t.pathname,T=x,E=r.pathname&&r.pathname.split("/")||[],w=(f=t.pathname&&t.pathname.split("/")||[],r.protocol&&!y[r.protocol]);if(w&&(r.hostname="",r.port=null,r.host&&(""===E[0]?E[0]=r.host:E.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),x=x&&(""===f[0]||""===E[0])),b)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,E=f;else if(f.length)E||(E=[]),E.pop(),E=E.concat(f),r.search=t.search,r.query=t.query;else if(!n.isNullOrUndefined(t.search)){if(w)r.hostname=r.host=E.shift(),(O=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=O.shift(),r.host=r.hostname=O.shift());return r.search=t.search,r.query=t.query,n.isNull(r.pathname)&&n.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!E.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var S=E.slice(-1)[0],I=(r.host||t.host||E.length>1)&&("."===S||".."===S)||""===S,A=0,C=E.length;C>=0;C--)"."===(S=E[C])?E.splice(C,1):".."===S?(E.splice(C,1),A++):A&&(E.splice(C,1),A--);if(!x&&!T)for(;A--;A)E.unshift("..");!x||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),I&&"/"!==E.join("/").substr(-1)&&E.push("");var O,R=""===E[0]||E[0]&&"/"===E[0].charAt(0);w&&(r.hostname=r.host=R?"":E.length?E.shift():"",(O=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=O.shift(),r.host=r.hostname=O.shift()));return(x=x||r.host&&E.length)&&!R&&E.unshift(""),E.length?r.pathname=E.join("/"):(r.pathname=null,r.path=null),n.isNull(r.pathname)&&n.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},s.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,r){"use strict";var i=Object.prototype.hasOwnProperty,n="~";function s(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function a(t,e,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||t,s),h=n?n+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function h(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function u(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(n=!1)),u.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)i.call(t,e)&&r.push(n?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},u.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},u.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},u.prototype.emit=function(t,e,r,i,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var h,u,l=this._events[a],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,i),!0;case 5:return l.fn.call(l.context,e,r,i,s),!0;case 6:return l.fn.call(l.context,e,r,i,s,o),!0}for(u=1,h=new Array(c-1);u<c;u++)h[u-1]=arguments[u];l.fn.apply(l.context,h)}else{var d,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,r);break;case 4:l[u].fn.call(l[u].context,e,r,i);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];l[u].fn.apply(l[u].context,h)}}return!0},u.prototype.on=function(t,e,r){return a(this,t,e,r,!1)},u.prototype.once=function(t,e,r){return a(this,t,e,r,!0)},u.prototype.removeListener=function(t,e,r,i){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return h(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||i&&!o.once||r&&o.context!==r||h(this,s);else{for(var a=0,u=[],l=o.length;a<l;a++)(o[a].fn!==e||i&&!o[a].once||r&&o[a].context!==r)&&u.push(o[a]);u.length?this._events[s]=1===u.length?u[0]:u:h(this,s)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&h(this,e)):(this._events=new s,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=n,u.EventEmitter=u,t.exports=u},function(t,e,r){"use strict";function i(t,e,r){r=r||2;var i,a,h,u,l,p,f,g=e&&e.length,y=g?e[0]*r:t.length,v=n(t,0,y,r,!0),_=[];if(!v||v.next===v.prev)return _;if(g&&(v=function(t,e,r,i){var o,a,h,u,l,p=[];for(o=0,a=e.length;o<a;o++)h=e[o]*i,u=o<a-1?e[o+1]*i:t.length,(l=n(t,h,u,i,!1))===l.next&&(l.steiner=!0),p.push(m(l));for(p.sort(c),o=0;o<p.length;o++)d(p[o],r),r=s(r,r.next);return r}(t,e,v,r)),t.length>80*r){i=h=t[0],a=u=t[1];for(var b=r;b<y;b+=r)(l=t[b])<i&&(i=l),(p=t[b+1])<a&&(a=p),l>h&&(h=l),p>u&&(u=p);f=0!==(f=Math.max(h-i,u-a))?1/f:0}return o(v,_,r,i,a,f),_}function n(t,e,r,i,n){var s,o;if(n===C(t,e,r,i)>0)for(s=e;s<r;s+=i)o=S(s,t[s],t[s+1],o);else for(s=r-i;s>=e;s-=i)o=S(s,t[s],t[s+1],o);return o&&_(o,o.next)&&(I(o),o=o.next),o}function s(t,e){if(!t)return t;e||(e=t);var r,i=t;do{if(r=!1,i.steiner||!_(i,i.next)&&0!==v(i.prev,i,i.next))i=i.next;else{if(I(i),(i=e=i.prev)===i.next)break;r=!0}}while(r||i!==e);return e}function o(t,e,r,i,n,c,d){if(t){!d&&c&&function(t,e,r,i){var n=t;do{null===n.z&&(n.z=f(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,r,i,n,s,o,a,h,u=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,i=r,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(h=u;a>0||h>0&&i;)0!==a&&(0===h||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,h--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;r=i}s.nextZ=null,u*=2}while(o>1)}(n)}(t,i,n,c);for(var p,m,g=t;t.prev!==t.next;)if(p=t.prev,m=t.next,c?h(t,i,n,c):a(t))e.push(p.i/r),e.push(t.i/r),e.push(m.i/r),I(t),t=m.next,g=m.next;else if((t=m)===g){d?1===d?o(t=u(s(t),e,r),e,r,i,n,c,2):2===d&&l(t,e,r,i,n,c):o(s(t),e,r,i,n,c,1);break}}}function a(t){var e=t.prev,r=t,i=t.next;if(v(e,r,i)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(g(e.x,e.y,r.x,r.y,i.x,i.y,n.x,n.y)&&v(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function h(t,e,r,i){var n=t.prev,s=t,o=t.next;if(v(n,s,o)>=0)return!1;for(var a=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,h=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,u=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,l=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,c=f(a,h,e,r,i),d=f(u,l,e,r,i),p=t.prevZ,m=t.nextZ;p&&p.z>=c&&m&&m.z<=d;){if(p!==t.prev&&p!==t.next&&g(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,m!==t.prev&&m!==t.next&&g(n.x,n.y,s.x,s.y,o.x,o.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&g(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;m&&m.z<=d;){if(m!==t.prev&&m!==t.next&&g(n.x,n.y,s.x,s.y,o.x,o.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function u(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!_(n,o)&&b(n,i,i.next,o)&&E(n,o)&&E(o,n)&&(e.push(n.i/r),e.push(i.i/r),e.push(o.i/r),I(i),I(i.next),i=t=o),i=i.next}while(i!==t);return s(i)}function l(t,e,r,i,n,a){var h=t;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&y(h,u)){var l=w(h,u);return h=s(h,h.next),l=s(l,l.next),o(h,e,r,i,n,a),void o(l,e,r,i,n,a)}u=u.next}h=h.next}while(h!==t)}function c(t,e){return t.x-e.x}function d(t,e){if(e=function(t,e){var r,i=e,n=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=n&&a>o){if(o=a,a===n){if(s===i.y)return i;if(s===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!r)return null;if(n===o)return r;var h,u=r,l=r.x,c=r.y,d=1/0;i=r;do{n>=i.x&&i.x>=l&&n!==i.x&&g(s<c?n:o,s,l,c,s<c?o:n,s,i.x,i.y)&&(h=Math.abs(s-i.y)/(n-i.x),E(i,t)&&(h<d||h===d&&(i.x>r.x||i.x===r.x&&p(r,i)))&&(r=i,d=h)),i=i.next}while(i!==u);return r}(t,e)){var r=w(e,t);s(e,e.next),s(r,r.next)}}function p(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function f(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function m(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function g(t,e,r,i,n,s,o,a){return(n-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(r-o)*(e-a)>=0&&(r-o)*(s-a)-(n-o)*(i-a)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&b(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(E(t,e)&&E(e,t)&&function(t,e){var r=t,i=!1,n=(t.x+e.x)/2,s=(t.y+e.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||_(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,r,i){var n=T(v(t,e,r)),s=T(v(t,e,i)),o=T(v(r,i,t)),a=T(v(r,i,e));return n!==s&&o!==a||(!(0!==n||!x(t,r,e))||(!(0!==s||!x(t,i,e))||(!(0!==o||!x(r,t,i))||!(0!==a||!x(r,e,i)))))}function x(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function T(t){return t>0?1:t<0?-1:0}function E(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function w(t,e){var r=new A(t.i,t.x,t.y),i=new A(e.i,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function S(t,e,r,i){var n=new A(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function I(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function A(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(t,e,r,i){for(var n=0,s=e,o=r-i;s<r;s+=i)n+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return n}t.exports=i,t.exports.default=i,i.deviation=function(t,e,r,i){var n=e&&e.length,s=n?e[0]*r:t.length,o=Math.abs(C(t,0,s,r));if(n)for(var a=0,h=e.length;a<h;a++){var u=e[a]*r,l=a<h-1?e[a+1]*r:t.length;o-=Math.abs(C(t,u,l,r))}var c=0;for(a=0;a<i.length;a+=3){var d=i[a]*r,p=i[a+1]*r,f=i[a+2]*r;c+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},i.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[n][s][o]);n>0&&(i+=t[n-1].length,r.holes.push(i))}return r}},function(t,e,r){"use strict";(function(t){r.d(e,"f",(function(){return a})),r.d(e,"e",(function(){return h})),r.d(e,"a",(function(){return d})),r.d(e,"b",(function(){return p})),r.d(e,"d",(function(){return f})),r.d(e,"c",(function(){return m})),r.d(e,"g",(function(){return g}));var i=r(19),n=r(8),s=r(1),o=r(33);async function a(t,e){const r=[],i=[],n=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);for(let s=0;s<n.length;++s){const o=n[s],a=Array.isArray(t)?t[s].tensor:t[o];if("float32"!==a.dtype&&"int32"!==a.dtype&&"bool"!==a.dtype&&"string"!==a.dtype&&"complex64"!==a.dtype)throw new Error(`Unsupported dtype in weight '${o}': ${a.dtype}`);const h={name:o,shape:a.shape,dtype:a.dtype};if("string"===a.dtype){const t=new Promise(async t=>{const e=await a.bytes(),r=e.reduce((t,e)=>t+e.length,0)+4*e.length,i=new Uint8Array(r);let n=0;for(let t=0;t<e.length;t++){const r=e[t],s=new Uint8Array(new Uint32Array([r.length]).buffer);i.set(s,n),n+=4,i.set(r,n),n+=r.length}t(i)});i.push(t)}else i.push(a.data());null!=e&&(h.group=e),r.push(h)}return{data:u(await Promise.all(i)),specs:r}}function h(t,e){const r={};let a,h=0;for(const u of e){const e=u.name,l=u.dtype,c=u.shape,d=Object(s.sizeFromShape)(c);let p;if("quantization"in u){const r=u.quantization;if("uint8"===r.dtype||"uint16"===r.dtype){if(!("min"in r&&"scale"in r))throw new Error(`Weight ${u.name} with quantization ${r.dtype} `+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==r.dtype)throw new Error(`Weight ${u.name} has unknown `+`quantization dtype ${r.dtype}. `+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==l)throw new Error(`Weight ${u.name} is quantized with ${r.dtype} `+`which only supports weights of type float32 not ${l}.`)}const i=o.a[r.dtype],n=t.slice(h,h+d*i),s="uint8"===r.dtype?new Uint8Array(n):new Uint16Array(n);if("float32"===l)if("uint8"===r.dtype||"uint16"===r.dtype){p=new Float32Array(s.length);for(let t=0;t<s.length;t++){const e=s[t];p[t]=e*r.scale+r.min}}else{if("float16"!==r.dtype)throw new Error(`Unsupported quantization type ${r.dtype} `+"for weight type float32.");void 0===a&&(a=y()),p=a(s)}else{if("int32"!==l)throw new Error(`Unsupported dtype in weight '${e}': ${l}`);if("uint8"!==r.dtype&&"uint16"!==r.dtype)throw new Error(`Unsupported quantization type ${r.dtype} `+"for weight type int32.");p=new Int32Array(s.length);for(let t=0;t<s.length;t++){const e=s[t];p[t]=Math.round(e*r.scale+r.min)}}h+=d*i}else if("string"===l){const e=Object(s.sizeFromShape)(u.shape);p=[];for(let r=0;r<e;r++){const e=new Uint32Array(t.slice(h,h+4))[0];h+=4;const r=new Uint8Array(t.slice(h,h+e));p.push(r),h+=e}}else{const s=o.a[l],a=t.slice(h,h+d*s);if("float32"===l)p=new Float32Array(a);else if("int32"===l)p=new Int32Array(a);else if("bool"===l)p=new Uint8Array(a);else{if("complex64"!==l)throw new Error(`Unsupported dtype in weight '${e}': ${l}`);{p=new Float32Array(a);const t=new Float32Array(p.length/2),s=new Float32Array(p.length/2);for(let e=0;e<t.length;e++)t[e]=p[2*e],s[e]=p[2*e+1];const o=Object(n.f)(t,c,"float32"),h=Object(n.f)(s,c,"float32");r[e]=Object(i.a)(o,h)}}h+=d*s}"complex64"!==l&&(r[e]=Object(n.f)(p,c,l))}return r}function u(t){if(null===t)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const r=[];t.forEach(t=>{if(e+=t.byteLength,r.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${t.constructor.name}`)});const i=new Uint8Array(e);let n=0;return r.forEach(t=>{i.set(new Uint8Array(t.buffer),n),n+=t.byteLength}),i.buffer}const l=void 0!==t&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function c(e){return l?t.byteLength(e):new Blob([e]).size}function d(e){if(l)return t.from(e).toString("base64");const r=new Uint8Array(e);let i="";for(let t=0,e=r.length;t<e;t++)i+=String.fromCharCode(r[t]);return btoa(i)}function p(e){if(l){const r=t.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const r=atob(e),i=new Uint8Array(r.length);for(let t=0;t<r.length;++t)i.set([r.charCodeAt(t)],t);return i.buffer}function f(t){if(1===t.length)return t[0];let e=0;t.forEach(t=>{e+=t.byteLength});const r=new Uint8Array(e);let i=0;return t.forEach(t=>{r.set(new Uint8Array(t),i),i+=t.byteLength}),r.buffer}function m(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function g(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:c(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:c(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function y(){const t=function(){const t=t=>{let e=t<<13,r=0;for(;0==(8388608&e);)r-=8388608,e<<=1;return e&=-8388609,r+=947912704,e|r},e=new Uint32Array(2048);e[0]=0;for(let r=1;r<1024;r++)e[r]=t(r);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),r=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return i=>{const n=new ArrayBuffer(4*i.length),s=new Uint32Array(n);for(let n=0;n<i.length;n++){const o=i[n],a=t[r[o>>10]+(1023&o)]+e[o>>10];s[n]=a}return new Float32Array(n)}}}).call(this,r(35).Buffer)},function(t,e,r){"use strict";var i,n=r(0),s=r(21),o=r(20);function a(t){return t instanceof n.l?{value:t.clone(),recurse:!1}:Object(o.e)(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class h{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),r=this.get(e);return this.set(e,this.pop()),r}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class u extends h{constructor(){super(u.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),r=this.length();for(let t=0;t<r;t++)e[t]=this.get(this.wrap(this.begin+t));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=r}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
function l(t){return new m(t)}function c(t){return new g(t)}function d(t,e){return new A(t,e)}function p(t,e=i.FAIL){return new C(t,e)}u.INITIAL_CAPACITY=32,r.d(e,"f",(function(){return l})),r.d(e,"e",(function(){return c})),r.d(e,"d",(function(){return d})),r.d(e,"g",(function(){return p})),r.d(e,"a",(function(){return f})),r.d(e,"b",(function(){return S})),r.d(e,"c",(function(){return i}));class f{async toArray(){const t=[];let e=await this.next();for(;!e.done;)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let r=await t.next();for(;!r.done;)e.push(r.value),r=await t.next();return e}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let e=await this.next(),r=t(e.value);for(;!e.done&&r;)e=await this.next(),r=t(e.value)}handleErrors(t){return new E(this,t)}filter(t){return new x(this,t)}map(t){return new T(this,t)}mapAsync(t){return new w(this,t)}serialMapAsync(t){return new w(this,t).serial()}flatmap(t){return new I(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(t=>!0===t)}rowMajorBatch(t,e=!0){return new b(this,t,e)}columnMajorBatch(t,e=!0,r=o.f){return this.rowMajorBatch(t,e).map(t=>Object(o.d)(t,r))}concatenate(t,e){return new A(l([this,t]),e)}take(t){return t<0||null==t?this:new _(this,t)}skip(t){return t<0||null==t?this:new v(this,t)}prefetch(t){return new O(this,t)}shuffle(t,e){return new R(this,t,e)}serial(){return new y(this)}}class m extends f{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:(e=t,Object(o.b)(e,a)),done:!1};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
var e}}class g extends f{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message=`Error thrown while iterating through a dataset: ${t.message}`,t}}}class y extends f{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class v extends f{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;n.hb(t.value)}return this.upstream.next()}}class _ extends f{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class b extends f{constructor(t,e,r=!0){super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=r,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class x extends f{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;n.hb(t.value)}}}class T extends f{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Map`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=n.td.getTensorsInContainer(t.value),r=this.transform(t.value),i=n.td.getTensorsInContainer(r);for(const t of e)n.td.isTensorInList(t,i)||t.dispose();return{value:r,done:!1}}}class E extends f{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class w extends f{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=n.td.getTensorsInContainer(t.value),r=await this.transform(t.value),i=n.td.getTensorsInContainer(r);for(const t of e)n.td.isTensorInList(t,i)||t.dispose();return{value:r,done:!1}}}class S extends f{constructor(){super(),this.outputQueue=new u,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class I extends S{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=n.td.getTensorsInContainer(t.value),r=this.transform(t.value),i=n.td.getTensorsInContainer(r);this.outputQueue.pushAll(r);for(const t of e)n.td.isTensorInList(t,i)||t.dispose();return!0}}class A extends f{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(i||(i={}));class C extends f{constructor(t,e=i.FAIL){super(),this.iterators=t,this.mismatchMode=e,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(t){await t;let e=0,r=0;const n=await Object(o.c)(this.iterators,(function(t){if(t instanceof f){return{value:t.next().then(t=>(e++,t.done&&r++,t.value)),recurse:!1}}return{value:null,recurse:!0}}));if(e===r)return{value:null,done:!0};if(r>0)switch(this.mismatchMode){case i.FAIL:throw new Error("Zipped streams should have the same length. "+`Mismatched at element ${this.count}.`);case i.SHORTEST:return{value:null,done:!0};case i.LONGEST:}return this.count++,{value:n,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class O extends f{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new h(e)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class R extends O{constructor(t,e,r){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=s.alea(r||n.Cd.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return E})),r.d(e,"i",(function(){return S})),r.d(e,"c",(function(){return I})),r.d(e,"f",(function(){return A})),r.d(e,"e",(function(){return R})),r.d(e,"d",(function(){return N})),r.d(e,"k",(function(){return M})),r.d(e,"g",(function(){return D})),r.d(e,"h",(function(){return F})),r.d(e,"j",(function(){return L})),r.d(e,"b",(function(){return k}));var i=r(0),n=r(23),s=r(28),o=r(2),a=r(41),h=r(42),u=r(43),l=r(44),c=r(45),d=r(46),p=r(47),f=r(48),m=r(49),g=r(50),y=r(51),v=r(52),_=r(53),b=r(54),x=r(55),T=r(56);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class E{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[].concat(...[a,h,u,l,c,d,p,g,m,f,y,v,_,b,x,T].map(t=>t.json));this.opMappers=t.reduce((t,e)=>(t[e.tfOpName]=e,t),{})}transformGraph(t,e={}){const r=t.node,i=[],n=[],s=r.reduce((t,e)=>(t[e.name]=this.mapNode(e),e.op.startsWith("Placeholder")&&i.push(t[e.name]),"Const"===e.op&&n.push(t[e.name]),t),{});let a=[];const h=[];let u={},l={};null!=e&&(u=this.mapSignatureEntries(e.inputs),l=this.mapSignatureEntries(e.outputs));const c=Object.keys(s);c.forEach(t=>{const e=s[t];e.inputNames.forEach(t=>{const[r]=Object(o.a)(t);e.inputs.push(s[r]),s[r].children.push(e)})}),0===Object.keys(l).length?c.forEach(t=>{const e=s[t];0===e.children.length&&h.push(e)}):Object.keys(l).forEach(t=>{const[e]=Object(o.a)(t),r=s[e];null!=r&&(r.signatureKey=l[t],h.push(r))}),Object.keys(u).length>0?Object.keys(u).forEach(t=>{const[e]=Object(o.a)(t),r=s[e];r&&(r.signatureKey=u[t],a.push(r))}):a=i;let d={};return null!=t.library&&null!=t.library.function&&(d=t.library.function.reduce((t,e)=>(t[e.signature.name]=this.mapFunction(e),t),{})),{nodes:s,inputs:a,outputs:h,weights:n,placeholders:i,signature:e,functions:d}}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,r)=>(e[t[r].name]=r,e),{})}mapNode(t){const e=Object(s.a)(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const r={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(t=>t.startsWith("^")?t.substr(1):t),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(r.inputParams=e.inputs.reduce((t,e)=>(t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t),{})),null!=e.attrs&&(r.attrParams=e.attrs.reduce((e,r)=>{const i=r.type;let n=void 0;switch(r.type){case"string":n=S(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=S(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"string[]":n=F(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=F(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"number":n=A(t.attr,r.tfName,r.defaultValue||0),void 0===n&&r.tfDeprecatedName&&(n=A(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"number[]":n=D(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=D(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool":n=I(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=I(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool[]":n=k(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=k(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape":n=M(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=M(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape[]":n=L(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=L(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype":n=R(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=R(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype[]":n=N(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=N(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"func":n=O(t.attr,r.tfName,r.defaultValue),void 0===n&&r.tfDeprecatedName&&(n=O(t.attr,r.tfDeprecatedName,r.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${r.type} for op: ${t.op}`)}return e[r.name]={value:n,type:i},e},{})),r}mapFunction(t){const e=t.nodeDef,r=[];let i={};null!=e&&(i=e.reduce((t,e)=>(t[e.name]=this.mapNode(e),"Const"===e.op&&r.push(t[e.name]),t),{}));const n=[],s=[];t.signature.inputArg.forEach(t=>{const[e]=Object(o.a)(t.name),r={name:e,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:C(t.type),type:"dtype"}},children:[]};r.signatureKey=t.name,n.push(r),i[e]=r}),Object.keys(i).forEach(t=>{const e=i[t];e.inputNames.forEach(t=>{const[r]=Object(o.a)(t);e.inputs.push(i[r]),i[r].children.push(e)})});const a=t.ret;t.signature.outputArg.forEach(t=>{const[e,r]=Object(o.a)(a[t.name]),n=i[e];null!=n&&(n.defaultOutput=r,s.push(n))});const h=this.mapArgsToSignature(t);return{nodes:i,inputs:n,outputs:s,weights:r,placeholders:[],signature:h}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((t,e)=>(t[e.name]=this.mapArgToTensorInfo(e),t),{}),outputs:t.signature.outputArg.reduce((e,r)=>(e[r.name]=this.mapArgToTensorInfo(r,t.ret),e),{})}}mapArgToTensorInfo(t,e){let r=t.name;return null!=e&&(r=e[r]),{name:r,dtype:t.type}}}function w(e,r){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const r=Object(i.nb)().global;if(void 0!==r.atob)return r.atob(e);if(void 0!==t)return new t(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return r?n:n.toLowerCase()}function S(t,e,r,i=!1){const n=t[e];return null!=n?w(n.s,i):r}function I(t,e,r){const i=t[e];return i?i.b:r}function A(t,e,r){const i=t[e]||{},n=null!=i.i?i.i:null!=i.f?i.f:r;return"number"==typeof n?n:parseInt(n,10)}function C(t){switch("string"==typeof t&&(t=n.a[t]),t){case n.a.DT_FLOAT:return"float32";case n.a.DT_INT32:case n.a.DT_INT64:case n.a.DT_INT8:case n.a.DT_UINT8:return"int32";case n.a.DT_BOOL:return"bool";case n.a.DT_DOUBLE:return"float32";case n.a.DT_STRING:return"string";default:return null}}function O(t,e,r){const i=t[e];return i&&i.func?i.func.name:r}function R(t,e,r){const i=t[e];return i&&i.type?C(i.type):r}function N(t,e,r){const i=t[e];return i&&i.list&&i.list.type?i.list.type.map(t=>C(t)):r}function P(t){if(!t.unknownRank)return null!=t.dim?t.dim.map(t=>"number"==typeof t.size?t.size:parseInt(t.size,10)):[]}function M(t,e,r){const i=t[e];return i&&i.shape?P(i.shape):r}function D(t,e,r){const i=t[e];return i?((i.list.f&&i.list.f.length?i.list.f:i.list.i)||[]).map(t=>"number"==typeof t?t:parseInt(t,10)):r}function F(t,e,r,i=!1){const n=t[e];return n&&n.list&&n.list.s?n.list.s.map(t=>w(t,i)):r}function L(t,e,r){const i=t[e];return i&&i.list&&i.list.shape?i.list.shape.map(t=>P(t)):r}function k(t,e,r){const i=t[e];return i&&i.list&&i.list.b?i.list.b:r}}).call(this,r(35).Buffer)},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"a",(function(){return a})),r.d(e,"c",(function(){return h})),r.d(e,"e",(function(){return u})),r.d(e,"d",(function(){return l}));var i=r(32);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n=Object(i.a)("kernelRegistry",()=>new Map),s=Object(i.a)("gradRegistry",()=>new Map);function o(t,e){const r=c(t,e);return n.get(r)}function a(t){return s.get(t)}function h(t){const e=n.entries(),r=[];for(;;){const{done:i,value:n}=e.next();if(i)break;const[s,o]=n,[a]=s.split("_");a===t&&r.push(o)}return r}function u(t){const{kernelName:e,backendName:r}=t,i=c(e,r);n.has(i)&&console.warn(`The kernel '${e}' for backend `+`'${r}' is already registered`),n.set(i,t)}function l(t){const{kernelName:e}=t;s.has(e)&&console.warn(`Overriding the gradient for '${e}'`),s.set(e,t)}function c(t,e){return`${e}_${t}`}},function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var i=r(5),n=r(6),s=r(3),o=r(1),a=r(4);const h=Object(a.a)({complex_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const r=Object(s.a)(t,"real","complex"),a=Object(s.a)(e,"imag","complex");o.assertShapesMatch(r.shape,a.shape,`real and imag shapes, ${r.shape} and ${a.shape}, `+"must match in call to tf.complex().");const h={real:r,imag:a};return i.a.runKernelFunc(t=>t.complex(r,a),h,null,n.k)}})},function(t,e,r){"use strict";r.d(e,"b",(function(){return n})),r.d(e,"d",(function(){return o})),r.d(e,"f",(function(){return a})),r.d(e,"c",(function(){return h})),r.d(e,"e",(function(){return u})),r.d(e,"a",(function(){return l}));var i=r(0);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function n(t,e){return s(t,e)}function s(t,e,r=new Map,i=new Set){if(null==t)return null;if(i.has(t))throw new Error("Circular references are not supported.");if(r.has(t))return r.get(t);const n=e(t);if(n.recurse&&null!==n.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(n.recurse){if(u(t)){const n=Array.isArray(t)?[]:{};i.add(t);for(const o in t){const a=s(t[o],e,r,i);n[o]=a}return i.delete(t),n}throw new Error(`Can't recurse into non-iterable type: ${t}`)}return r.set(t,n.value),n.value}function o(t,e=a){return function t(e,r,i=new Set){const n=e[0];if(i.has(n))throw new Error("Circular references are not supported.");const s=r(e);if(s.recurse&&null!==s.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(s.recurse){if(u(n)){const s=Array.isArray(n)?[]:{};i.add(n);for(const o in n){const n=e.map(t=>t[o]),a=t(n,r,i);s[o]=a}return i.delete(n),s}throw new Error(`Can't recurse into non-iterable type: ${n}`)}return s.value}(t,e)}function a(t){return null===t?null:u(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function h(t,e){const r=new Map;s(t,e,r);for(const t of Array.from(r.keys())){const e=r.get(t);if(e instanceof Promise){const i=await e;r.set(t,i)}}return s(t,e,r)}function u(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof i.l))}function l(t){return null==t||(null===(e=t)||"object"!=typeof e&&"function"!=typeof e)||Array.isArray(t)||"object"==typeof t&&t instanceof i.l||i.Cd.isTypedArray(t);var e}},function(t,e,r){var i=r(74),n=r(75),s=r(76),o=r(77),a=r(78),h=r(79),u=r(80);u.alea=i,u.xor128=n,u.xorwow=s,u.xorshift7=o,u.xor4096=a,u.tychei=h,t.exports=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(e,r,i){void 0===r&&(r=!1),n(this,t),this._fn=e,this._once=r,this._thisArg=i,this._next=this._prev=this._owner=null}return i(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function o(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var a=function(){function t(){n(this,t),this._head=this._tail=void 0}return i(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var r=[];e;)r.push(e),e=e._next;return r}},{key:"has",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return o(this,new s(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return o(this,new s(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=s,e.default=a,t.exports=e.default},function(t,e,r){"use strict";
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
var i,n;r.d(e,"a",(function(){return i})),function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(i||(i={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(n||(n={}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var i=r(5),n=r(6),s=r(3),o=r(4);const a=Object(o.a)({real_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e=Object(s.a)(t,"input","real"),r={input:e};return i.a.runKernelFunc(t=>t.real(e),r,null,n.gb)}})},function(t,e,r){"use strict";
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var i,n,s,o,a;r.d(e,"b",(function(){return u})),r.d(e,"a",(function(){return l})),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(i||(i={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(n||(n={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(s||(s={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(o||(o={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(a||(a={}));const h={float32:o,int32:n,bool:s,complex64:a};function u(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return h[t][e]}function l(t){return u(t,"int32")}},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i={};function n(t){return i[t]}},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var i=r(5),n=r(6),s=r(3),o=r(4);const a=Object(o.a)({imag_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e=Object(s.a)(t,"input","imag"),r={input:e};return i.a.runKernelFunc(t=>t.imag(e),r,null,n.K)}})},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e){var r,i,n=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var h,u=[],l=!1,c=-1;function d(){l&&h&&(l=!1,h.length?u=h.concat(u):c=-1,u.length&&p())}function p(){if(!l){var t=a(d);l=!0;for(var e=u.length;e;){for(h=u,u=[];++c<e;)h&&h[c].run();c=-1,e=u.length}h=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new f(t,e)),1!==u.length||l||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e,r){"use strict";(function(t,i){
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
let n;function s(){if(null==n){let e;if("undefined"!=typeof window)e=window;else if(void 0!==t)e=t;else if(void 0!==i)e=i;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}n=e}return n}function o(t,e){const r=function(){const t=s();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(r.has(t))return r.get(t);{const i=e();return r.set(t,i),r.get(t)}}r.d(e,"b",(function(){return s})),r.d(e,"a",(function(){return o}))}).call(this,r(26),r(31))},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},function(t,e,r){"use strict";function i(){if("undefined"!=typeof navigator&&null!=navigator){const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function n(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}r.r(e),r.d(e,"isMobile",(function(){return i})),r.d(e,"isBrowser",(function(){return n}))},function(t,e,r){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=r(71),n=r(72),s=r(73);function o(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:(null===t&&(t=new h(e)),t.length=e),t}function h(t,e,r){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return u(this,t,e,r)}function u(t,e,r,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,i){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,r):new Uint8Array(e,r,i);h.TYPED_ARRAY_SUPPORT?(t=e).__proto__=h.prototype:t=d(t,e);return t}(t,e,r,i):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!h.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(e,r),n=(t=a(t,i)).write(e,r);n!==i&&(t=t.slice(0,n));return t}(t,e,r):function(t,e){if(h.isBuffer(e)){var r=0|p(e.length);return 0===(t=a(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?a(t,0):d(t,e);if("Buffer"===e.type&&s(e.data))return d(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function c(t,e){if(l(e),t=a(t,e<0?0:0|p(e)),!h.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function d(t,e){var r=e.length<0?0:0|p(e.length);t=a(t,r);for(var i=0;i<r;i+=1)t[i]=255&e[i];return t}function p(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function f(t,e){if(h.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return X(t).length;default:if(i)return j(t).length;e=(""+e).toLowerCase(),i=!0}}function m(t,e,r){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,r);case"utf8":case"utf-8":return I(this,e,r);case"ascii":return A(this,e,r);case"latin1":case"binary":return C(this,e,r);case"base64":return S(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function g(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function y(t,e,r,i,n){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof e&&(e=h.from(e,i)),h.isBuffer(e))return 0===e.length?-1:v(t,e,r,i,n);if("number"==typeof e)return e&=255,h.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):v(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function v(t,e,r,i,n){var s,o=1,a=t.length,h=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(n){var l=-1;for(s=r;s<a;s++)if(u(t,s)===u(e,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===h)return l*o}else-1!==l&&(s-=s-l),l=-1}else for(r+h>a&&(r=a-h),s=r;s>=0;s--){for(var c=!0,d=0;d<h;d++)if(u(t,s+d)!==u(e,d)){c=!1;break}if(c)return s}return-1}function _(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i))>n&&(i=n):i=n;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[r+o]=a}return o}function b(t,e,r,i){return G(j(e,t.length-r),t,r,i)}function x(t,e,r,i){return G(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,i)}function T(t,e,r,i){return x(t,e,r,i)}function E(t,e,r,i){return G(X(e),t,r,i)}function w(t,e,r,i){return G(function(t,e){for(var r,i,n,s=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}(e,t.length-r),t,r,i)}function S(t,e,r){return 0===e&&r===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,r))}function I(t,e,r){r=Math.min(t.length,r);for(var i=[],n=e;n<r;){var s,o,a,h,u=t[n],l=null,c=u>239?4:u>223?3:u>191?2:1;if(n+c<=r)switch(c){case 1:u<128&&(l=u);break;case 2:128==(192&(s=t[n+1]))&&(h=(31&u)<<6|63&s)>127&&(l=h);break;case 3:s=t[n+1],o=t[n+2],128==(192&s)&&128==(192&o)&&(h=(15&u)<<12|(63&s)<<6|63&o)>2047&&(h<55296||h>57343)&&(l=h);break;case 4:s=t[n+1],o=t[n+2],a=t[n+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(h=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(l=h)}null===l?(l=65533,c=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|1023&l),i.push(l),n+=c}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=4096));return r}(i)}e.Buffer=h,e.SlowBuffer=function(t){+t!=t&&(t=0);return h.alloc(+t)},e.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),h.poolSize=8192,h._augment=function(t){return t.__proto__=h.prototype,t},h.from=function(t,e,r){return u(null,t,e,r)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(t,e,r){return function(t,e,r,i){return l(e),e<=0?a(t,e):void 0!==r?"string"==typeof i?a(t,e).fill(r,i):a(t,e).fill(r):a(t,e)}(null,t,e,r)},h.allocUnsafe=function(t){return c(null,t)},h.allocUnsafeSlow=function(t){return c(null,t)},h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,i=e.length,n=0,s=Math.min(r,i);n<s;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=h.allocUnsafe(e),n=0;for(r=0;r<t.length;++r){var o=t[r];if(!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,n),n+=o.length}return i},h.byteLength=f,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},h.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?I(this,0,t):m.apply(this,arguments)},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t,e,r,i,n){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&e>=r)return 0;if(i>=n)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(n>>>=0)-(i>>>=0),o=(r>>>=0)-(e>>>=0),a=Math.min(s,o),u=this.slice(i,n),l=t.slice(e,r),c=0;c<a;++c)if(u[c]!==l[c]){s=u[c],o=l[c];break}return s<o?-1:o<s?1:0},h.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},h.prototype.indexOf=function(t,e,r){return y(this,t,e,r,!0)},h.prototype.lastIndexOf=function(t,e,r){return y(this,t,e,r,!1)},h.prototype.write=function(t,e,r,i){if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)i=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return _(this,t,e,r);case"utf8":case"utf-8":return b(this,t,e,r);case"ascii":return x(this,t,e,r);case"latin1":case"binary":return T(this,t,e,r);case"base64":return E(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}function C(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function O(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=e;s<r;++s)n+=B(t[s]);return n}function R(t,e,r){for(var i=t.slice(e,r),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}function N(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,r,i,n,s){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function M(t,e,r,i){e<0&&(e=65535+e+1);for(var n=0,s=Math.min(t.length-r,2);n<s;++n)t[r+n]=(e&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function D(t,e,r,i){e<0&&(e=4294967295+e+1);for(var n=0,s=Math.min(t.length-r,4);n<s;++n)t[r+n]=e>>>8*(i?n:3-n)&255}function F(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(t,e,r,i,s){return s||F(t,0,r,4),n.write(t,e,r,i,23,4),r+4}function k(t,e,r,i,s){return s||F(t,0,r,8),n.write(t,e,r,i,52,8),r+8}h.prototype.slice=function(t,e){var r,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),h.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=h.prototype;else{var n=e-t;r=new h(n,void 0);for(var s=0;s<n;++s)r[s]=this[s+t]}return r},h.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||N(t,e,this.length);for(var i=this[t],n=1,s=0;++s<e&&(n*=256);)i+=this[t+s]*n;return i},h.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||N(t,e,this.length);for(var i=this[t+--e],n=1;e>0&&(n*=256);)i+=this[t+--e]*n;return i},h.prototype.readUInt8=function(t,e){return e||N(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return e||N(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return e||N(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||N(t,e,this.length);for(var i=this[t],n=1,s=0;++s<e&&(n*=256);)i+=this[t+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*e)),i},h.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||N(t,e,this.length);for(var i=e,n=1,s=this[t+--i];i>0&&(n*=256);)s+=this[t+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*e)),s},h.prototype.readInt8=function(t,e){return e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){e||N(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt16BE=function(t,e){e||N(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt32LE=function(t,e){return e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return e||N(t,4,this.length),n.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return e||N(t,4,this.length),n.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return e||N(t,8,this.length),n.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return e||N(t,8,this.length),n.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,r,i){(t=+t,e|=0,r|=0,i)||P(this,t,e,r,Math.pow(2,8*r)-1,0);var n=1,s=0;for(this[e]=255&t;++s<r&&(n*=256);)this[e+s]=t/n&255;return e+r},h.prototype.writeUIntBE=function(t,e,r,i){(t=+t,e|=0,r|=0,i)||P(this,t,e,r,Math.pow(2,8*r)-1,0);var n=r-1,s=1;for(this[e+n]=255&t;--n>=0&&(s*=256);)this[e+n]=t/s&255;return e+r},h.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,1,255,0),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},h.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},h.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},h.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},h.prototype.writeIntLE=function(t,e,r,i){if(t=+t,e|=0,!i){var n=Math.pow(2,8*r-1);P(this,t,e,r,n-1,-n)}var s=0,o=1,a=0;for(this[e]=255&t;++s<r&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+r},h.prototype.writeIntBE=function(t,e,r,i){if(t=+t,e|=0,!i){var n=Math.pow(2,8*r-1);P(this,t,e,r,n-1,-n)}var s=r-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+r},h.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,1,127,-128),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},h.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},h.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},h.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},h.prototype.writeFloatLE=function(t,e,r){return L(this,t,e,!0,r)},h.prototype.writeFloatBE=function(t,e,r){return L(this,t,e,!1,r)},h.prototype.writeDoubleLE=function(t,e,r){return k(this,t,e,!0,r)},h.prototype.writeDoubleBE=function(t,e,r){return k(this,t,e,!1,r)},h.prototype.copy=function(t,e,r,i){if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var n,s=i-r;if(this===t&&r<e&&e<i)for(n=s-1;n>=0;--n)t[n+e]=this[n+r];else if(s<1e3||!h.TYPED_ARRAY_SUPPORT)for(n=0;n<s;++n)t[n+e]=this[n+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+s),e);return s},h.prototype.fill=function(t,e,r,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===t.length){var n=t.charCodeAt(0);n<256&&(t=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!h.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var o=h.isBuffer(t)?t:j(new h(t,i).toString()),a=o.length;for(s=0;s<r-e;++s)this[s+e]=o[s%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function B(t){return t<16?"0"+t.toString(16):t.toString(16)}function j(t,e){var r;e=e||1/0;for(var i=t.length,n=null,s=[],o=0;o<i;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function X(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(U,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function G(t,e,r,i){for(var n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}}).call(this,r(26))},function(t,e,r){"use strict";t.exports=function(t,e){e=e||{};for(var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=r.parser[e.strictMode?"strict":"loose"].exec(t),n={},s=14;s--;)n[r.key[s]]=i[s]||"";return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,(function(t,e,i){e&&(n[r.q.name][e]=i)})),n}},function(t,e,r){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function s(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new s(n.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new s(n.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},r(61),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,r(26))},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return n}));
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:void 0!==t?t:t=>t();function n(){return new Promise(t=>i(()=>t()))}}).call(this,r(37).setImmediate)},function(t,e,r){(function(i,n){var s;!function(i){var o=i.Promise,a=o&&"resolve"in o&&"reject"in o&&"all"in o&&"race"in o&&function(){var t;return new o((function(e){t=e})),"function"==typeof t}();e?(e.Promise=a?o:E,e.Polyfill=E):void 0===(s=function(){return a?o:E}.call(e,r,e,t))||(t.exports=s);var h=function(){};function u(t){return"[object Array]"===Object.prototype.toString.call(t)}var l,c=void 0!==n?n:setTimeout,d=[];function p(){for(var t=0;t<d.length;t++)d[t][0](d[t][1]);d=[],l=!1}function f(t,e){d.push([t,e]),l||(l=!0,c(p,0))}function m(t){var e=t.owner,r=e.state_,i=e.data_,n=t[r],s=t.then;if("function"==typeof n){r="fulfilled";try{i=n(i)}catch(t){_(s,t)}}g(s,i)||("fulfilled"===r&&y(s,i),"rejected"===r&&_(s,i))}function g(t,e){var r;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var i=e.then;if("function"==typeof i)return i.call(e,(function(i){r||(r=!0,e!==i?y(t,i):v(t,i))}),(function(e){r||(r=!0,_(t,e))})),!0}}catch(e){return r||_(t,e),!0}return!1}function y(t,e){t!==e&&g(t,e)||v(t,e)}function v(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,f(x,t))}function _(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,f(T,t))}function b(t){var e=t.then_;t.then_=void 0;for(var r=0;r<e.length;r++)m(e[r])}function x(t){t.state_="fulfilled",b(t)}function T(t){t.state_="rejected",b(t)}function E(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof E==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,e){function r(t){_(e,t)}try{t((function(t){y(e,t)}),r)}catch(t){r(t)}}(t,this)}E.prototype={constructor:E,state_:"pending",then_:null,data_:void 0,then:function(t,e){var r={owner:this,then:new this.constructor(h),fulfilled:t,rejected:e};return"fulfilled"===this.state_||"rejected"===this.state_?f(m,r):this.then_.push(r),r.then},catch:function(t){return this.then(null,t)}},E.all=function(t){if(!u(t))throw new TypeError("You must pass an array to Promise.all().");return new this((function(e,r){var i=[],n=0;function s(t){return n++,function(r){i[t]=r,--n||e(i)}}for(var o,a=0;a<t.length;a++)(o=t[a])&&"function"==typeof o.then?o.then(s(a),r):i[a]=o;n||e(i)}))},E.race=function(t){if(!u(t))throw new TypeError("You must pass an array to Promise.race().");return new this((function(e,r){for(var i,n=0;n<t.length;n++)(i=t[n])&&"function"==typeof i.then?i.then(e,r):e(i)}))},E.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this((function(e){e(t)}))},E.reject=function(t){return new this((function(e,r){r(t)}))}}("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this)}).call(this,r(26),r(37).setImmediate)},function(t,e,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,a,h=o(t),u=1;u<arguments.length;u++){for(var l in r=Object(arguments[u]))n.call(r,l)&&(h[l]=r[l]);if(i){a=i(r);for(var c=0;c<a.length;c++)s.call(r,a[c])&&(h[a[c]]=r[a[c]])}}return h}},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},function(t,e,r){"use strict";r.r(e),r.d(e,"json",(function(){return i}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}]},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return o}));var i=r(0),n=r(15),s=r(58);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
class o extends n.a{decodeUTF8(){return new a(this)}}class a extends s.a{constructor(t){super(),this.upstream=t,this.impl=new h(t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class h extends n.b{constructor(t){if(super(),this.upstream=t,Object(i.nb)().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:t}=r(82);this.decoder=new t("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){const e=await this.upstream.next();let r,n;return!e.done&&(r=e.value,n=Object(i.nb)().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(t.from(r.buffer)),this.outputQueue.push(n),!0)}}}).call(this,r(35).Buffer)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var i=r(15);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class n extends i.a{split(t){return new s(this,t)}}class s extends n{constructor(t,e){super(),this.upstream=t,this.impl=new o(t,e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class o extends i.b{constructor(t,e){super(),this.upstream=t,this.separator=e,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const t=await this.upstream.next();if(t.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);const e=t.value.split(this.separator);e[0]=this.carryover+e[0];for(const t of e.slice(0,-1))this.outputQueue.push(t);return this.carryover=e[e.length-1],!0}}},function(t,e,r){(function(t){var i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),r={},i=0;i<e.length;i++)r[e[i]]=Object.getOwnPropertyDescriptor(t,e[i]);return r},n=/%[sdj%]/g;e.format=function(t){if(!y(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(a(arguments[r]));return e.join(" ")}r=1;for(var i=arguments,s=i.length,o=String(t).replace(n,(function(t){if("%%"===t)return"%";if(r>=s)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return t}})),h=i[r];r<s;h=i[++r])m(h)||!b(h)?o+=" "+h:o+=" "+a(h);return o},e.deprecate=function(r,i){if(void 0!==t&&!0===t.noDeprecation)return r;if(void 0===t)return function(){return e.deprecate(r,i).apply(this,arguments)};var n=!1;return function(){if(!n){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),n=!0}return r.apply(this,arguments)}};var s,o={};function a(t,r){var i={seen:[],stylize:u};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),f(r)?i.showHidden=r:r&&e._extend(i,r),v(i.showHidden)&&(i.showHidden=!1),v(i.depth)&&(i.depth=2),v(i.colors)&&(i.colors=!1),v(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=h),l(i,t,i.depth)}function h(t,e){var r=a.styles[e];return r?"["+a.colors[r][0]+"m"+t+"["+a.colors[r][1]+"m":t}function u(t,e){return t}function l(t,r,i){if(t.customInspect&&r&&E(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(i,t);return y(n)||(n=l(t,n,i)),n}var s=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(y(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(g(e))return t.stylize(""+e,"number");if(f(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,r);if(s)return s;var o=Object.keys(r),a=function(t){var e={};return t.forEach((function(t,r){e[t]=!0})),e}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(r)),T(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return c(r);if(0===o.length){if(E(r)){var h=r.name?": "+r.name:"";return t.stylize("[Function"+h+"]","special")}if(_(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(x(r))return t.stylize(Date.prototype.toString.call(r),"date");if(T(r))return c(r)}var u,b="",w=!1,S=["{","}"];(p(r)&&(w=!0,S=["[","]"]),E(r))&&(b=" [Function"+(r.name?": "+r.name:"")+"]");return _(r)&&(b=" "+RegExp.prototype.toString.call(r)),x(r)&&(b=" "+Date.prototype.toUTCString.call(r)),T(r)&&(b=" "+c(r)),0!==o.length||w&&0!=r.length?i<0?_(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),u=w?function(t,e,r,i,n){for(var s=[],o=0,a=e.length;o<a;++o)C(e,String(o))?s.push(d(t,e,r,i,String(o),!0)):s.push("");return n.forEach((function(n){n.match(/^\d+$/)||s.push(d(t,e,r,i,n,!0))})),s}(t,r,i,a,o):o.map((function(e){return d(t,r,i,a,e,w)})),t.seen.pop(),function(t,e,r){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(u,b,S)):S[0]+b+S[1]}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,r,i,n,s){var o,a,h;if((h=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]}).get?a=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(a=t.stylize("[Setter]","special")),C(i,n)||(o="["+n+"]"),a||(t.seen.indexOf(h.value)<0?(a=m(r)?l(t,h.value,null):l(t,h.value,r-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),v(o)){if(s&&n.match(/^\d+$/))return a;(o=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function p(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function y(t){return"string"==typeof t}function v(t){return void 0===t}function _(t){return b(t)&&"[object RegExp]"===w(t)}function b(t){return"object"==typeof t&&null!==t}function x(t){return b(t)&&"[object Date]"===w(t)}function T(t){return b(t)&&("[object Error]"===w(t)||t instanceof Error)}function E(t){return"function"==typeof t}function w(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(r){if(v(s)&&(s=t.env.NODE_DEBUG||""),r=r.toUpperCase(),!o[r])if(new RegExp("\\b"+r+"\\b","i").test(s)){var i=t.pid;o[r]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",r,i,t)}}else o[r]=function(){};return o[r]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=f,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=y,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=_,e.isObject=b,e.isDate=x,e.isError=T,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(84);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var t=new Date,e=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":");return[t.getDate(),I[t.getMonth()],e].join(" ")}function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",A(),e.format.apply(e,arguments))},e.inherits=r(85),e._extend=function(t,e){if(!e||!b(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t};var O="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function R(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(O&&t[O]){var e;if("function"!=typeof(e=t[O]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,O,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,r,i=new Promise((function(t,i){e=t,r=i})),n=[],s=0;s<arguments.length;s++)n.push(arguments[s]);n.push((function(t,i){t?r(t):e(i)}));try{t.apply(this,n)}catch(t){r(t)}return i}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),O&&Object.defineProperty(e,O,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},e.promisify.custom=O,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],i=0;i<arguments.length;i++)r.push(arguments[i]);var n=r.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};e.apply(this,r).then((function(e){t.nextTick(o,null,e)}),(function(e){t.nextTick(R,e,o)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.defineProperties(r,i(e)),r}}).call(this,r(31))},function(t,e,r){"use strict";(function(t){var e=r(39),i=r(40),n=r.n(i);
/*!
 * @pixi/polyfill - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
window.Promise||(window.Promise=e.Polyfill),Object.assign||(Object.assign=n.a);var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!s.performance||!s.performance.now){var o=Date.now();s.performance||(s.performance={}),s.performance.now=function(){return Date.now()-o}}for(var a=Date.now(),h=["ms","moz","webkit","o"],u=0;u<h.length&&!s.requestAnimationFrame;++u){var l=h[u];s.requestAnimationFrame=s[l+"RequestAnimationFrame"],s.cancelAnimationFrame=s[l+"CancelAnimationFrame"]||s[l+"CancelRequestAnimationFrame"]}s.requestAnimationFrame||(s.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),r=16+a-e;return r<0&&(r=0),a=e,setTimeout((function(){a=Date.now(),t(performance.now())}),r)}),s.cancelAnimationFrame||(s.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array)}).call(this,r(26))},function(t,e,r){(function(t,e){!function(t,r){"use strict";if(!t.setImmediate){var i,n,s,o,a,h=1,u={},l=!1,c=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){f(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?t.MessageChannel?((s=new MessageChannel).port1.onmessage=function(t){f(t.data)},i=function(t){s.port2.postMessage(t)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,i=function(t){var e=c.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):i=function(t){setTimeout(f,0,t)}:(o="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&f(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),i=function(e){t.postMessage(o+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),r=0;r<e.length;r++)e[r]=arguments[r+1];var n={callback:t,args:e};return u[h]=n,i(h),h++},d.clearImmediate=p}function p(t){delete u[t]}function f(t){if(l)setTimeout(f,0,t);else{var e=u[t];if(e){l=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(void 0,r)}}(e)}finally{p(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,r(26),r(31))},function(t,e,r){(function(t,i){var n;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(s){e&&e.nodeType,t&&t.nodeType;var o="object"==typeof i&&i;o.global!==o&&o.window!==o&&o.self;var a,h=2147483647,u=/^xn--/,l=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,f=String.fromCharCode;function m(t){throw new RangeError(d[t])}function g(t,e){for(var r=t.length,i=[];r--;)i[r]=e(t[r]);return i}function y(t,e){var r=t.split("@"),i="";return r.length>1&&(i=r[0]+"@",t=r[1]),i+g((t=t.replace(c,".")).split("."),e).join(".")}function v(t){for(var e,r,i=[],n=0,s=t.length;n<s;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<s?56320==(64512&(r=t.charCodeAt(n++)))?i.push(((1023&e)<<10)+(1023&r)+65536):(i.push(e),n--):i.push(e);return i}function _(t){return g(t,(function(t){var e="";return t>65535&&(e+=f((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=f(t)})).join("")}function b(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function x(t,e,r){var i=0;for(t=r?p(t/700):t>>1,t+=p(t/e);t>455;i+=36)t=p(t/35);return p(i+36*t/(t+38))}function T(t){var e,r,i,n,s,o,a,u,l,c,d,f=[],g=t.length,y=0,v=128,b=72;for((r=t.lastIndexOf("-"))<0&&(r=0),i=0;i<r;++i)t.charCodeAt(i)>=128&&m("not-basic"),f.push(t.charCodeAt(i));for(n=r>0?r+1:0;n<g;){for(s=y,o=1,a=36;n>=g&&m("invalid-input"),((u=(d=t.charCodeAt(n++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:36)>=36||u>p((h-y)/o))&&m("overflow"),y+=u*o,!(u<(l=a<=b?1:a>=b+26?26:a-b));a+=36)o>p(h/(c=36-l))&&m("overflow"),o*=c;b=x(y-s,e=f.length+1,0==s),p(y/e)>h-v&&m("overflow"),v+=p(y/e),y%=e,f.splice(y++,0,v)}return _(f)}function E(t){var e,r,i,n,s,o,a,u,l,c,d,g,y,_,T,E=[];for(g=(t=v(t)).length,e=128,r=0,s=72,o=0;o<g;++o)(d=t[o])<128&&E.push(f(d));for(i=n=E.length,n&&E.push("-");i<g;){for(a=h,o=0;o<g;++o)(d=t[o])>=e&&d<a&&(a=d);for(a-e>p((h-r)/(y=i+1))&&m("overflow"),r+=(a-e)*y,e=a,o=0;o<g;++o)if((d=t[o])<e&&++r>h&&m("overflow"),d==e){for(u=r,l=36;!(u<(c=l<=s?1:l>=s+26?26:l-s));l+=36)T=u-c,_=36-c,E.push(f(b(c+T%_,0))),u=p(T/_);E.push(f(b(u,0))),s=x(r,y,i==n),r=0,++i}++r,++e}return E.join("")}a={version:"1.4.1",ucs2:{decode:v,encode:_},decode:T,encode:E,toASCII:function(t){return y(t,(function(t){return l.test(t)?"xn--"+E(t):t}))},toUnicode:function(t){return y(t,(function(t){return u.test(t)?T(t.slice(4).toLowerCase()):t}))}},void 0===(n=function(){return a}.call(e,r,e,t))||(t.exports=n)}()}).call(this,r(27)(t),r(26))},function(t,e,r){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,r){"use strict";e.decode=e.parse=r(65),e.encode=e.stringify=r(66)},function(t,e,r){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,r,s){e=e||"&",r=r||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(e);var h=1e3;s&&"number"==typeof s.maxKeys&&(h=s.maxKeys);var u=t.length;h>0&&u>h&&(u=h);for(var l=0;l<u;++l){var c,d,p,f,m=t[l].replace(a,"%20"),g=m.indexOf(r);g>=0?(c=m.substr(0,g),d=m.substr(g+1)):(c=m,d=""),p=decodeURIComponent(c),f=decodeURIComponent(d),i(o,p)?n(o[p])?o[p].push(f):o[p]=[o[p],f]:o[p]=f}return o};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,r){"use strict";var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,r,a){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?s(o(t),(function(o){var a=encodeURIComponent(i(o))+r;return n(t[o])?s(t[o],(function(t){return a+encodeURIComponent(i(t))})).join(e):a+encodeURIComponent(i(t[o]))})).join(e):a?encodeURIComponent(i(a))+r+encodeURIComponent(i(t)):""};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function s(t,e){if(t.map)return t.map(e);for(var r=[],i=0;i<t.length;i++)r.push(e(t[i],i));return r}var o=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},function(t,e,r){"use strict";(function(t){var e=r(34),i=r(9);
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const n=Object(i.b)();n.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),n.registerFlag("IS_BROWSER",()=>e.isBrowser()),n.registerFlag("IS_NODE",()=>void 0!==t&&void 0!==t.versions&&void 0!==t.versions.node),n.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),n.registerFlag("PROD",()=>!1),n.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>n.getBool("DEBUG")),n.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),n.registerFlag("IS_TEST",()=>!1)}).call(this,r(31))},function(t,e,r){"use strict";(function(t){var e=r(9);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i=()=>r(69);let n;class s{constructor(){this.util=r(70),this.textEncoder=new this.util.TextEncoder}fetch(t,r){return null!=Object(e.b)().global.fetch?Object(e.b)().global.fetch(t,r):(null==n&&(n=i()),n(t,r))}now(){const e=t.hrtime();return 1e3*e[0]+e[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}}Object(e.b)().get("IS_NODE")&&Object(e.b)().setPlatform("node",new s)}).call(this,r(31))},function(t,e){},function(t,e){},function(t,e,r){"use strict";e.byteLength=function(t){var e=u(t),r=e[0],i=e[1];return 3*(r+i)/4-i},e.toByteArray=function(t){var e,r,i=u(t),o=i[0],a=i[1],h=new s(function(t,e,r){return 3*(e+r)/4-r}(0,o,a)),l=0,c=a>0?o-4:o;for(r=0;r<c;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],h[l++]=e>>16&255,h[l++]=e>>8&255,h[l++]=255&e;2===a&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,h[l++]=255&e);1===a&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,h[l++]=e>>8&255,h[l++]=255&e);return h},e.fromByteArray=function(t){for(var e,r=t.length,n=r%3,s=[],o=0,a=r-n;o<a;o+=16383)s.push(l(t,o,o+16383>a?a:o+16383));1===n?(e=t[r-1],s.push(i[e>>2]+i[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],s.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"="));return s.join("")};for(var i=[],n=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,h=o.length;a<h;++a)i[a]=o[a],n[o.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function l(t,e,r){for(var n,s,o=[],a=e;a<r;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(i[(s=n)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,r,i,n){var s,o,a=8*n-i-1,h=(1<<a)-1,u=h>>1,l=-7,c=r?n-1:0,d=r?-1:1,p=t[e+c];for(c+=d,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=256*s+t[e+c],c+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=i;l>0;o=256*o+t[e+c],c+=d,l-=8);if(0===s)s=1-u;else{if(s===h)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),s-=u}return(p?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,r,i,n,s){var o,a,h,u=8*s-n-1,l=(1<<u)-1,c=l>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+c>=1?d/h:d*Math.pow(2,1-c))*h>=2&&(o++,h/=2),o+c>=l?(a=0,o=l):o+c>=1?(a=(e*h-1)*Math.pow(2,n),o+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,n),o=0));n>=8;t[r+p]=255&a,p+=f,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;t[r+p]=255&o,p+=f,o/=256,u-=8);t[r+p-f]|=128*m}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,r){(function(t){var i;!function(t,n,s){function o(t){var e,r=this,i=(e=4022871197,function(t){t=t.toString();for(var r=0;r<t.length;r++){var i=.02519603282416938*(e+=t.charCodeAt(r));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)});r.next=function(){var t=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=i(" "),r.s1=i(" "),r.s2=i(" "),r.s0-=i(t),r.s0<0&&(r.s0+=1),r.s1-=i(t),r.s1<0&&(r.s1+=1),r.s2-=i(t),r.s2<0&&(r.s2+=1),i=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function h(t,e){var r=new o(t),i=e&&e.state,n=r.next;return n.int32=function(){return 4294967296*r.next()|0},n.double=function(){return n()+11102230246251565e-32*(2097152*n()|0)},n.quick=n,i&&("object"==typeof i&&a(i,r),n.state=function(){return a(r,{})}),n}n&&n.exports?n.exports=h:r(17)&&r(30)?void 0===(i=function(){return h}.call(e,r,e,n))||(n.exports=i):this.alea=h}(0,t,r(17))}).call(this,r(27)(t))},function(t,e,r){(function(t){var i;!function(t,n,s){function o(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var i=0;i<r.length+64;i++)e.x^=0|r.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function h(t,e){var r=new o(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&("object"==typeof i&&a(i,r),n.state=function(){return a(r,{})}),n}n&&n.exports?n.exports=h:r(17)&&r(30)?void 0===(i=function(){return h}.call(e,r,e,n))||(n.exports=i):this.xor128=h}(0,t,r(17))}).call(this,r(27)(t))},function(t,e,r){(function(t){var i;!function(t,n,s){function o(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var i=0;i<r.length+64;i++)e.x^=0|r.charCodeAt(i),i==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function h(t,e){var r=new o(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&("object"==typeof i&&a(i,r),n.state=function(){return a(r,{})}),n}n&&n.exports?n.exports=h:r(17)&&r(30)?void 0===(i=function(){return h}.call(e,r,e,n))||(n.exports=i):this.xorwow=h}(0,t,r(17))}).call(this,r(27)(t))},function(t,e,r){(function(t){var i;!function(t,n,s){function o(t){var e=this;e.next=function(){var t,r,i=e.x,n=e.i;return t=i[n],r=(t^=t>>>7)^t<<24,r^=(t=i[n+1&7])^t>>>10,r^=(t=i[n+3&7])^t>>>3,r^=(t=i[n+4&7])^t<<7,t=i[n+7&7],r^=(t^=t<<13)^t<<9,i[n]=r,e.i=n+1&7,r},function(t,e){var r,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,r=0;r<e.length;++r)i[7&r]=i[7&r]<<15^e.charCodeAt(r)+i[r+1&7]<<13;for(;i.length<8;)i.push(0);for(r=0;r<8&&0===i[r];++r);for(8==r?i[7]=-1:i[r],t.x=i,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function h(t,e){null==t&&(t=+new Date);var r=new o(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&(i.x&&a(i,r),n.state=function(){return a(r,{})}),n}n&&n.exports?n.exports=h:r(17)&&r(30)?void 0===(i=function(){return h}.call(e,r,e,n))||(n.exports=i):this.xorshift7=h}(0,t,r(17))}).call(this,r(27)(t))},function(t,e,r){(function(t){var i;!function(t,n,s){function o(t){var e=this;e.next=function(){var t,r,i=e.w,n=e.X,s=e.i;return e.w=i=i+1640531527|0,r=n[s+34&127],t=n[s=s+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=n[s]=r^t,e.i=s,r+(i^i>>>16)|0},function(t,e){var r,i,n,s,o,a=[],h=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,h=Math.max(h,e.length)),n=0,s=-32;s<h;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(o=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(o=o+1640531527|0,n=0==(r=a[127&s]^=i+o)?n+1:0);for(n>=128&&(a[127&(e&&e.length||0)]=-1),n=127,s=512;s>0;--s)i=a[n+34&127],r=a[n=n+1&127],i^=i<<13,r^=r<<17,i^=i>>>15,r^=r>>>12,a[n]=i^r;t.w=o,t.X=a,t.i=n}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function h(t,e){null==t&&(t=+new Date);var r=new o(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&(i.X&&a(i,r),n.state=function(){return a(r,{})}),n}n&&n.exports?n.exports=h:r(17)&&r(30)?void 0===(i=function(){return h}.call(e,r,e,n))||(n.exports=i):this.xor4096=h}(0,t,r(17))}).call(this,r(27)(t))},function(t,e,r){(function(t){var i;!function(t,n,s){function o(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,i=e.d,n=e.a;return t=t<<25^t>>>7^r,r=r-i|0,i=i<<24^i>>>8^n,n=n-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-i|0,e.d=i<<16^r>>>16^n,e.a=n-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var i=0;i<r.length+20;i++)e.b^=0|r.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function h(t,e){var r=new o(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&("object"==typeof i&&a(i,r),n.state=function(){return a(r,{})}),n}n&&n.exports?n.exports=h:r(17)&&r(30)?void 0===(i=function(){return h}.call(e,r,e,n))||(n.exports=i):this.tychei=h}(0,t,r(17))}).call(this,r(27)(t))},function(t,e,r){var i;!function(n,s){var o,a=this,h=s.pow(256,6),u=s.pow(2,52),l=2*u;function c(t,e,r){var i=[],c=f(function t(e,r){var i,n=[],s=typeof e;if(r&&"object"==s)for(i in e)try{n.push(t(e[i],r-1))}catch(t){}return n.length?n:"string"==s?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,m(n)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(256):(t=new Uint8Array(256),(a.crypto||a.msCrypto).getRandomValues(t)),m(t)}catch(t){var e=a.navigator,r=e&&e.plugins;return[+new Date,a,r,a.screen,m(n)]}}():t,3),i),g=new d(i),y=function(){for(var t=g.g(6),e=h,r=0;t<u;)t=256*(t+r),e*=256,r=g.g(1);for(;t>=l;)t/=2,e/=2,r>>>=1;return(t+r)/e};return y.int32=function(){return 0|g.g(4)},y.quick=function(){return g.g(4)/4294967296},y.double=y,f(m(g.S),n),(e.pass||r||function(t,e,r,i){return i&&(i.S&&p(i,g),t.state=function(){return p(g,{})}),r?(s.random=t,e):t})(y,c,"global"in e?e.global:this==s,e.state)}function d(t){var e,r=t.length,i=this,n=0,s=i.i=i.j=0,o=i.S=[];for(r||(t=[r++]);n<256;)o[n]=n++;for(n=0;n<256;n++)o[n]=o[s=255&s+t[n%r]+(e=o[n])],o[s]=e;(i.g=function(t){for(var e,r=0,n=i.i,s=i.j,o=i.S;t--;)e=o[n=255&n+1],r=256*r+o[255&(o[n]=o[s=255&s+e])+(o[s]=e)];return i.i=n,i.j=s,r})(256)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function f(t,e){for(var r,i=t+"",n=0;n<i.length;)e[255&n]=255&(r^=19*e[255&n])+i.charCodeAt(n++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(s.seedrandom=c,f(s.random(),n),t.exports){t.exports=c;try{o=r(81)}catch(t){}}else void 0===(i=function(){return c}.call(e,r,e,t))||(t.exports=i)}([],Math)},function(t,e){},function(t,e){},function(t,e){},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e){},function(t,e,r){"use strict";r.r(e);var i={};r.r(i),r.d(i,"isMobile",(function(){return A})),r.d(i,"EventEmitter",(function(){return V.a})),r.d(i,"earcut",(function(){return $.a})),r.d(i,"url",(function(){return Y.a})),r.d(i,"BaseTextureCache",(function(){return wt})),r.d(i,"CanvasRenderTarget",(function(){return At})),r.d(i,"DATA_URI",(function(){return Rt})),r.d(i,"ProgramCache",(function(){return Tt})),r.d(i,"TextureCache",(function(){return Et})),r.d(i,"clearTextureCache",(function(){return It})),r.d(i,"correctBlendMode",(function(){return st})),r.d(i,"createIndicesForQuads",(function(){return ut})),r.d(i,"decomposeDataUri",(function(){return Nt})),r.d(i,"deprecation",(function(){return xt})),r.d(i,"destroyTextureCache",(function(){return St})),r.d(i,"determineCrossOrigin",(function(){return Pt})),r.d(i,"getBufferType",(function(){return lt})),r.d(i,"getResolutionOfUrl",(function(){return Mt})),r.d(i,"hex2rgb",(function(){return tt})),r.d(i,"hex2string",(function(){return et})),r.d(i,"interleaveTypedArrays",(function(){return dt})),r.d(i,"isPow2",(function(){return ft})),r.d(i,"isWebGLSupported",(function(){return Q})),r.d(i,"log2",(function(){return mt})),r.d(i,"nextPow2",(function(){return pt})),r.d(i,"premultiplyBlendMode",(function(){return nt})),r.d(i,"premultiplyRgba",(function(){return ot})),r.d(i,"premultiplyTint",(function(){return at})),r.d(i,"premultiplyTintToRgba",(function(){return ht})),r.d(i,"removeItems",(function(){return gt})),r.d(i,"rgb2hex",(function(){return it})),r.d(i,"sayHello",(function(){return J})),r.d(i,"sign",(function(){return yt})),r.d(i,"skipHello",(function(){return Z})),r.d(i,"string2hex",(function(){return rt})),r.d(i,"trimCanvas",(function(){return Ct})),r.d(i,"uid",(function(){return _t}));var n={};r.r(n),r.d(n,"AccessibilityManager",(function(){return ae})),r.d(n,"accessibleTarget",(function(){return se}));var s={};r.r(s),r.d(s,"InteractionData",(function(){return ce})),r.d(s,"InteractionEvent",(function(){return pe})),r.d(s,"InteractionManager",(function(){return _e})),r.d(s,"InteractionTrackingData",(function(){return fe})),r.d(s,"interactiveTarget",(function(){return ye}));var o={};r.r(o),r.d(o,"accessibility",(function(){return n})),r.d(o,"interaction",(function(){return s})),r.d(o,"utils",(function(){return i})),r.d(o,"Application",(function(){return Pi})),r.d(o,"AbstractBatchRenderer",(function(){return wi})),r.d(o,"AbstractRenderer",(function(){return fi})),r.d(o,"Attribute",(function(){return Ye})),r.d(o,"BaseRenderTexture",(function(){return Xe})),r.d(o,"BaseTexture",(function(){return Oe})),r.d(o,"BatchDrawCall",(function(){return bi})),r.d(o,"BatchGeometry",(function(){return Ii})),r.d(o,"BatchPluginFactory",(function(){return Oi})),r.d(o,"BatchRenderer",(function(){return Ni})),r.d(o,"BatchShaderGenerator",(function(){return Si})),r.d(o,"BatchTextureArray",(function(){return xi})),r.d(o,"Buffer",(function(){return Ke})),r.d(o,"CubeTexture",(function(){return _i})),r.d(o,"Filter",(function(){return $r})),r.d(o,"Framebuffer",(function(){return Be})),r.d(o,"GLProgram",(function(){return ni})),r.d(o,"GLTexture",(function(){return li})),r.d(o,"Geometry",(function(){return rr})),r.d(o,"MaskData",(function(){return yr})),r.d(o,"ObjectRenderer",(function(){return ur})),r.d(o,"Program",(function(){return jr})),r.d(o,"Quad",(function(){return ir})),r.d(o,"QuadUv",(function(){return nr})),r.d(o,"RenderTexture",(function(){return $e})),r.d(o,"RenderTexturePool",(function(){return We})),r.d(o,"Renderer",(function(){return mi})),r.d(o,"Shader",(function(){return Gr})),r.d(o,"SpriteMaskFilter",(function(){return Kr})),r.d(o,"State",(function(){return Vr})),r.d(o,"System",(function(){return ke})),r.d(o,"Texture",(function(){return Ve})),r.d(o,"TextureMatrix",(function(){return Yr})),r.d(o,"TextureUvs",(function(){return Ge})),r.d(o,"UniformGroup",(function(){return or})),r.d(o,"ViewableBuffer",(function(){return Ti})),r.d(o,"autoDetectRenderer",(function(){return gi})),r.d(o,"checkMaxIfStatementsInShader",(function(){return Lr})),r.d(o,"defaultFilterVertex",(function(){return vi})),r.d(o,"defaultVertex",(function(){return yi})),r.d(o,"resources",(function(){return Le})),r.d(o,"systems",(function(){return di})),r.d(o,"Extract",(function(){return Li})),r.d(o,"AppLoaderPlugin",(function(){return an})),r.d(o,"Loader",(function(){return on})),r.d(o,"LoaderResource",(function(){return hn})),r.d(o,"TextureLoader",(function(){return sn})),r.d(o,"ParticleContainer",(function(){return un})),r.d(o,"ParticleRenderer",(function(){return cn})),r.d(o,"BasePrepare",(function(){return ts})),r.d(o,"CountLimiter",(function(){return Qn})),r.d(o,"Prepare",(function(){return hs})),r.d(o,"TimeLimiter",(function(){return ds})),r.d(o,"Spritesheet",(function(){return ps})),r.d(o,"SpritesheetLoader",(function(){return ms})),r.d(o,"TilingSprite",(function(){return ys})),r.d(o,"TilingSpriteRenderer",(function(){return bs})),r.d(o,"BitmapFontLoader",(function(){return Ts})),r.d(o,"BitmapText",(function(){return xs})),r.d(o,"Ticker",(function(){return ue})),r.d(o,"TickerPlugin",(function(){return le})),r.d(o,"UPDATE_PRIORITY",(function(){return oe})),r.d(o,"ALPHA_MODES",(function(){return U})),r.d(o,"BLEND_MODES",(function(){return R})),r.d(o,"DRAW_MODES",(function(){return N})),r.d(o,"ENV",(function(){return C})),r.d(o,"FORMATS",(function(){return P})),r.d(o,"GC_MODES",(function(){return B})),r.d(o,"MASK_TYPES",(function(){return X})),r.d(o,"MIPMAP_MODES",(function(){return k})),r.d(o,"PRECISION",(function(){return j})),r.d(o,"RENDERER_TYPE",(function(){return O})),r.d(o,"SCALE_MODES",(function(){return F})),r.d(o,"TARGETS",(function(){return M})),r.d(o,"TYPES",(function(){return D})),r.d(o,"WRAP_MODES",(function(){return L})),r.d(o,"Bounds",(function(){return ee})),r.d(o,"Container",(function(){return ne})),r.d(o,"DisplayObject",(function(){return re})),r.d(o,"FillStyle",(function(){return pn})),r.d(o,"GRAPHICS_CURVES",(function(){return dn})),r.d(o,"Graphics",(function(){return kn})),r.d(o,"GraphicsData",(function(){return Rn})),r.d(o,"GraphicsGeometry",(function(){return Mn})),r.d(o,"LineStyle",(function(){return Dn})),r.d(o,"graphicsUtils",(function(){return On})),r.d(o,"Circle",(function(){return Zt})),r.d(o,"DEG_TO_RAD",(function(){return Bt})),r.d(o,"Ellipse",(function(){return Jt})),r.d(o,"Matrix",(function(){return jt})),r.d(o,"ObservablePoint",(function(){return Lt})),r.d(o,"PI_2",(function(){return kt})),r.d(o,"Point",(function(){return Ft})),r.d(o,"Polygon",(function(){return Qt})),r.d(o,"RAD_TO_DEG",(function(){return Ut})),r.d(o,"Rectangle",(function(){return Kt})),r.d(o,"RoundedRectangle",(function(){return te})),r.d(o,"SHAPES",(function(){return Dt})),r.d(o,"Transform",(function(){return qt})),r.d(o,"groupD8",(function(){return Yt})),r.d(o,"Mesh",(function(){return ks})),r.d(o,"MeshBatchUvs",(function(){return Ds})),r.d(o,"MeshGeometry",(function(){return Bs})),r.d(o,"MeshMaterial",(function(){return Us})),r.d(o,"NineSlicePlane",(function(){return Hs})),r.d(o,"PlaneGeometry",(function(){return js})),r.d(o,"RopeGeometry",(function(){return Xs})),r.d(o,"SimpleMesh",(function(){return Vs})),r.d(o,"SimplePlane",(function(){return zs})),r.d(o,"SimpleRope",(function(){return Gs})),r.d(o,"Runner",(function(){return be})),r.d(o,"Sprite",(function(){return jn})),r.d(o,"AnimatedSprite",(function(){return $s})),r.d(o,"TEXT_GRADIENT",(function(){return Xn})),r.d(o,"Text",(function(){return Jn})),r.d(o,"TextMetrics",(function(){return qn})),r.d(o,"TextStyle",(function(){return Vn})),r.d(o,"isMobile",(function(){return A})),r.d(o,"settings",(function(){return G})),r.d(o,"VERSION",(function(){return qs})),r.d(o,"filters",(function(){return Ks})),r.d(o,"useDeprecated",(function(){return Ys})),r.d(o,"CanvasRenderer",(function(){return Au})),r.d(o,"canvasUtils",(function(){return Cu})),r.d(o,"CanvasMeshRenderer",(function(){return hp})),r.d(o,"CanvasGraphicsRenderer",(function(){return hy})),r.d(o,"CanvasSpriteRenderer",(function(){return Db})),r.d(o,"CanvasExtract",(function(){return rw})),r.d(o,"CanvasPrepare",(function(){return AC}));var a={};r.r(a),r.d(a,"default",(function(){return hV}));var h={};r.r(h),r.d(h,"inputLayer",(function(){return eK})),r.d(h,"elu",(function(){return rK})),r.d(h,"reLU",(function(){return iK})),r.d(h,"leakyReLU",(function(){return nK})),r.d(h,"prelu",(function(){return sK})),r.d(h,"softmax",(function(){return oK})),r.d(h,"thresholdedReLU",(function(){return aK})),r.d(h,"conv1d",(function(){return hK})),r.d(h,"conv2d",(function(){return uK})),r.d(h,"conv2dTranspose",(function(){return lK})),r.d(h,"conv3d",(function(){return cK})),r.d(h,"separableConv2d",(function(){return dK})),r.d(h,"cropping2D",(function(){return pK})),r.d(h,"upSampling2d",(function(){return fK})),r.d(h,"depthwiseConv2d",(function(){return mK})),r.d(h,"activation",(function(){return gK})),r.d(h,"dense",(function(){return yK})),r.d(h,"dropout",(function(){return vK})),r.d(h,"spatialDropout1d",(function(){return _K})),r.d(h,"flatten",(function(){return bK})),r.d(h,"repeatVector",(function(){return xK})),r.d(h,"reshape",(function(){return TK})),r.d(h,"permute",(function(){return EK})),r.d(h,"embedding",(function(){return wK})),r.d(h,"add",(function(){return SK})),r.d(h,"average",(function(){return IK})),r.d(h,"concatenate",(function(){return AK})),r.d(h,"maximum",(function(){return CK})),r.d(h,"minimum",(function(){return OK})),r.d(h,"multiply",(function(){return RK})),r.d(h,"dot",(function(){return NK})),r.d(h,"batchNormalization",(function(){return PK})),r.d(h,"layerNormalization",(function(){return MK})),r.d(h,"zeroPadding2d",(function(){return DK})),r.d(h,"averagePooling1d",(function(){return FK})),r.d(h,"avgPool1d",(function(){return LK})),r.d(h,"avgPooling1d",(function(){return kK})),r.d(h,"averagePooling2d",(function(){return UK})),r.d(h,"avgPool2d",(function(){return BK})),r.d(h,"avgPooling2d",(function(){return jK})),r.d(h,"averagePooling3d",(function(){return XK})),r.d(h,"avgPool3d",(function(){return GK})),r.d(h,"avgPooling3d",(function(){return zK})),r.d(h,"globalAveragePooling1d",(function(){return VK})),r.d(h,"globalAveragePooling2d",(function(){return HK})),r.d(h,"globalMaxPooling1d",(function(){return $K})),r.d(h,"globalMaxPooling2d",(function(){return WK})),r.d(h,"maxPooling1d",(function(){return YK})),r.d(h,"maxPooling2d",(function(){return qK})),r.d(h,"maxPooling3d",(function(){return KK})),r.d(h,"gru",(function(){return ZK})),r.d(h,"gruCell",(function(){return JK})),r.d(h,"lstm",(function(){return QK})),r.d(h,"lstmCell",(function(){return tZ})),r.d(h,"simpleRNN",(function(){return eZ})),r.d(h,"simpleRNNCell",(function(){return rZ})),r.d(h,"rnn",(function(){return iZ})),r.d(h,"stackedRNNCells",(function(){return nZ})),r.d(h,"bidirectional",(function(){return sZ})),r.d(h,"timeDistributed",(function(){return oZ})),r.d(h,"globalMaxPool1d",(function(){return aZ})),r.d(h,"globalMaxPool2d",(function(){return hZ})),r.d(h,"maxPool1d",(function(){return uZ})),r.d(h,"maxPool2d",(function(){return lZ})),r.d(h,"Layer",(function(){return P$})),r.d(h,"RNN",(function(){return Gq})),r.d(h,"RNNCell",(function(){return zq})),r.d(h,"input",(function(){return eY})),r.d(h,"gaussianNoise",(function(){return cZ})),r.d(h,"gaussianDropout",(function(){return dZ})),r.d(h,"alphaDropout",(function(){return pZ})),r.d(h,"masking",(function(){return fZ}));var u={};r.r(u),r.d(u,"array",(function(){return TZ})),r.d(u,"Dataset",(function(){return bZ})),r.d(u,"zip",(function(){return EZ})),r.d(u,"CSVDataset",(function(){return NZ})),r.d(u,"TextLineDataset",(function(){return SZ})),r.d(u,"csv",(function(){return XZ})),r.d(u,"func",(function(){return GZ})),r.d(u,"generator",(function(){return zZ})),r.d(u,"microphone",(function(){return HZ})),r.d(u,"webcam",(function(){return VZ})),r.d(u,"FileDataSource",(function(){return BZ})),r.d(u,"URLDataSource",(function(){return jZ})),r.d(u,"version_data",(function(){return $Z}));var l={};r.r(l),r.d(l,"maxImpl",(function(){return WZ})),r.d(l,"transposeImpl",(function(){return YZ}));r(60);var c=/iPhone/i,d=/iPod/i,p=/iPad/i,f=/\biOS-universal(?:.+)Mac\b/i,m=/\bAndroid(?:.+)Mobile\b/i,g=/Android/i,y=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,v=/Silk/i,_=/Windows Phone/i,b=/\bWindows(?:.+)ARM\b/i,x=/BlackBerry/i,T=/BB10/i,E=/Opera Mini/i,w=/\b(CriOS|Chrome)(?:.+)Mobile/i,S=/Mobile(?:.+)Firefox\b/i,I=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var A=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(c)&&!n(_),ipod:n(d),tablet:!n(c)&&(n(p)||I(e))&&!n(_),universal:n(f),device:(n(c)||n(d)||n(p)||n(f)||I(e))&&!n(_)},amazon:{phone:n(y),tablet:!n(y)&&n(v),device:n(y)||n(v)},android:{phone:!n(_)&&n(y)||!n(_)&&n(m),tablet:!n(_)&&!n(y)&&!n(m)&&(n(v)||n(g)),device:!n(_)&&(n(y)||n(v)||n(m)||n(g))||n(/\bokhttp\b/i)},windows:{phone:n(_),tablet:n(b),device:n(_)||n(b)},other:{blackberry:n(x),blackberry10:n(T),opera:n(E),firefox:n(S),chrome:n(w),device:n(x)||n(T)||n(E)||n(S)||n(w)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var C,O,R,N,P,M,D,F,L,k,U,B,j,X,G={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(A.tablet||A.phone){if(e=!1,A.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(A.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:A.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!A.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},z=r(12),V=r.n(z),H=r(13),$=r.n(H),W=r(11),Y=r.n(W);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(C||(C={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(O||(O={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(R||(R={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(N||(N={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(P||(P={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(M||(M={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(D||(D={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(F||(F={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(L||(L={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(k||(k={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(U||(U={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(B||(B={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(j||(j={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(X||(X={})),
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
G.RETINA_PREFIX=/@([0-9\.]+)x/,G.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var q,K=!1;function Z(){K=!0}function J(t){var e;if(!K){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var r=["\n %c %c %c PixiJS 5.2.4 -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=window.console).log.apply(e,r)}else window.console&&window.console.log("PixiJS 5.2.4 - "+t+" - http://www.pixijs.com/");K=!0}}function Q(){return void 0===q&&(q=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:G.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!r||!r.getContextAttributes().stencil);if(r){var n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()}return r=null,i}catch(t){return!1}}()),q}function tt(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function et(t){var e=t.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)}function rt(t){return"string"==typeof t&&"#"===t[0]&&(t=t.substr(1)),parseInt(t,16)}function it(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}var nt=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[R.NORMAL_NPM]=R.NORMAL,t[R.ADD_NPM]=R.ADD,t[R.SCREEN_NPM]=R.SCREEN,e[R.NORMAL]=R.NORMAL_NPM,e[R.ADD]=R.ADD_NPM,e[R.SCREEN]=R.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();function st(t,e){return nt[e?1:0][t]}function ot(t,e,r,i){return r=r||new Float32Array(4),i||void 0===i?(r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e):(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=e,r}function at(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}function ht(t,e,r,i){return(r=r||new Float32Array(4))[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,(i||void 0===i)&&(r[0]*=e,r[1]*=e,r[2]*=e),r[3]=e,r}function ut(t,e){void 0===e&&(e=null);var r=6*t;if((e=e||new Uint16Array(r)).length!==r)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+r);for(var i=0,n=0;i<r;i+=6,n+=4)e[i+0]=n+0,e[i+1]=n+1,e[i+2]=n+2,e[i+3]=n+0,e[i+4]=n+2,e[i+5]=n+3;return e}function lt(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var ct={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function dt(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;var o=new ArrayBuffer(4*r),a=null,h=0;for(s=0;s<t.length;s++){var u=e[s],l=t[s],c=lt(l);n[c]||(n[c]=new ct[c](o)),a=n[c];for(var d=0;d<l.length;d++){a[(d/u|0)*i+h+d%u]=l[d]}h+=u}return new Float32Array(o)}function pt(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function ft(t){return!(t&t-1||!t)}function mt(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function gt(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}function yt(t){return 0===t?0:t<0?-1:1}var vt=0;function _t(){return++vt}var bt={};function xt(t,e,r){if(void 0===r&&(r=3),!bt[e]){var i=(new Error).stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),bt[e]=!0}}var Tt={},Et=Object.create(null),wt=Object.create(null);function St(){var t;for(t in Et)Et[t].destroy();for(t in wt)wt[t].destroy()}function It(){var t;for(t in Et)delete Et[t];for(t in wt)delete wt[t]}var At=function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||G.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0}),t}();function Ct(t){var e,r,i,n=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,n,s).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(r=e/4%n,i=~~(e/4/n),null===u.top&&(u.top=i),null===u.left?u.left=r:r<u.left&&(u.left=r),null===u.right?u.right=r+1:u.right<r&&(u.right=r+1),null===u.bottom?u.bottom=i:u.bottom<i&&(u.bottom=i));return null!==u.top&&(n=u.right-u.left,s=u.bottom-u.top+1,l=o.getImageData(u.left,u.top,n,s)),{height:s,width:n,data:l}}var Ot,Rt=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Nt(t){var e=Rt.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}function Pt(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,Ot||(Ot=document.createElement("a")),Ot.href=t;var r=Object(W.parse)(Ot.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}function Mt(t,e){var r=G.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/math - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Dt,Ft=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),Lt=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),kt=2*Math.PI,Ut=180/Math.PI,Bt=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(Dt||(Dt={}));var jt=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new Ft;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Ft;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(kt-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),Xt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Gt=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],zt=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Vt=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ht=[],$t=[],Wt=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Ht.push(e);for(var r=0;r<16;r++)for(var i=Wt(Xt[t]*Xt[r]+zt[t]*Gt[r]),n=Wt(Gt[t]*Xt[r]+Vt[t]*Gt[r]),s=Wt(Xt[t]*zt[r]+zt[t]*Vt[r]),o=Wt(Gt[t]*zt[r]+Vt[t]*Vt[r]),a=0;a<16;a++)if(Xt[a]===i&&Gt[a]===n&&zt[a]===s&&Vt[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new jt;h.set(Xt[t],Gt[t],zt[t],Vt[t],0,0),$t.push(h)}}();var Yt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Xt[t]},uY:function(t){return Gt[t]},vX:function(t){return zt[t]},vY:function(t){return Vt[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Ht[t][e]},sub:function(t,e){return Ht[t][Yt.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Yt.S:Yt.N:2*Math.abs(e)<=Math.abs(t)?t>0?Yt.E:Yt.W:e>0?t>0?Yt.SE:Yt.SW:t>0?Yt.NE:Yt.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=$t[Yt.inv(e)];n.tx=r,n.ty=i,t.append(n)}},qt=function(){function t(){this.worldTransform=new jt,this.localTransform=new jt,this.position=new Lt(this.onChange,this,0,0),this.scale=new Lt(this.onChange,this,1,1),this.pivot=new Lt(this.onChange,this,0,0),this.skew=new Lt(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),Kt=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=Dt.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}(),Zt=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=Dt.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new Kt(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}(),Jt=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=Dt.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new Kt(this.x-this.width,this.y-this.height,this.width,this.height)},t}(),Qt=function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof Ft){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=Dt.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r},t}(),te=function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=Dt.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1},t}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
G.SORTABLE_CHILDREN=!1;var ee=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};ee.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},ee.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},ee.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Kt.EMPTY:((t=t||new Kt(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},ee.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},ee.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},ee.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},ee.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},ee.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},ee.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},ee.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},ee.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},ee.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},ee.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},ee.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},ee.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},ee.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var re=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new qt,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new ee,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Kt),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Kt),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*Ut},r.angle.set=function(t){this.transform.rotation=t*Bt},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function ie(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}re.prototype.displayObjectUpdateTransform=re.prototype.updateTransform;var ne=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=G.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);gt(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,gt(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,gt(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(ie),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(re);ne.prototype.containerUpdateTransform=ne.prototype.updateTransform;
/*!
 * @pixi/accessibility - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var se={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0};re.mixin(se);var oe,ae=function(t){this._hookDiv=null,(A.tablet||A.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)};ae.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="select to enable accessability for this content",e.addEventListener("focus",(function(){t.isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},ae.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},ae.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},ae.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessibility&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},ae.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}},ae.prototype.update=function(){var t=performance.now();if(!(A.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),r=this.renderer.resolution,i=e.width/this.renderer.width*r,n=e.height/this.renderer.height*r,s=this.div;s.style.left=e.left+"px",s.style.top=e.top+"px",s.style.width=this.renderer.width+"px",s.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var a=this.children[o];if(a.renderId!==this.renderId)a._accessibleActive=!1,gt(this.children,o,1),this.div.removeChild(a._accessibleDiv),this.pool.push(a._accessibleDiv),a._accessibleDiv=null,o--;else{s=a._accessibleDiv;var h=a.hitArea,u=a.worldTransform;a.hitArea?(s.style.left=(u.tx+h.x*u.a)*i+"px",s.style.top=(u.ty+h.y*u.d)*n+"px",s.style.width=h.width*u.a*i+"px",s.style.height=h.height*u.d*n+"px"):(h=a.getBounds(),this.capHitArea(h),s.style.left=h.x*i+"px",s.style.top=h.y*n+"px",s.style.width=h.width*i+"px",s.style.height=h.height*n+"px",s.title!==a.accessibleTitle&&null!==a.accessibleTitle&&(s.title=a.accessibleTitle),s.getAttribute("aria-label")!==a.accessibleHint&&null!==a.accessibleHint&&s.setAttribute("aria-label",a.accessibleHint)),a.accessibleTitle===s.title&&a.tabIndex===s.tabIndex||(s.title=a.accessibleTitle,s.tabIndex=a.tabIndex,this.debug&&this.updateDebugHTML(s))}}this.renderId++}},ae.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},ae.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},ae.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},ae.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData),e.dispatchEvent(t.target.displayObject,"pointertap",e.eventData),e.dispatchEvent(t.target.displayObject,"tap",e.eventData)},ae.prototype._onFocus=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},ae.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},ae.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},ae.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},ae.prototype.destroy=function(){this.destroyTouchHook(),this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
G.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(oe||(oe={}));var he=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),ue=function(){function t(){var t=this;this._head=new he(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/G.TARGET_FPMS,this.elapsedMS=1/G.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=oe.NORMAL),this._addListener(new he(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=oe.NORMAL),this._addListener(new he(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*G.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,G.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),le=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,oe.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ue.shared:new ue,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}(),ce=function(){this.global=new Ft,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0},de={pointerId:{configurable:!0}};de.pointerId.get=function(){return this.identifier},ce.prototype.getLocalPosition=function(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)},ce.prototype.copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=Number.isInteger(t.buttons)?t.buttons:t.which,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},ce.prototype.reset=function(){this.isPrimary=!1},Object.defineProperties(ce.prototype,de);var pe=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null};pe.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},pe.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null};var fe=function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE},me={pointerId:{configurable:!0},flags:{configurable:!0},none:{configurable:!0},over:{configurable:!0},rightDown:{configurable:!0},leftDown:{configurable:!0}};fe.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},me.pointerId.get=function(){return this._pointerId},me.flags.get=function(){return this._flags},me.flags.set=function(t){this._flags=t},me.none.get=function(){return this._flags===this.constructor.FLAGS.NONE},me.over.get=function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},me.over.set=function(t){this._doSet(this.constructor.FLAGS.OVER,t)},me.rightDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},me.rightDown.set=function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)},me.leftDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},me.leftDown.set=function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)},Object.defineProperties(fe.prototype,me),fe.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4});var ge=function(){this._tempPoint=new Ft};ge.prototype.recursiveFindHit=function(t,e,r,i,n){if(!e||!e.visible)return!1;var s=t.data.global,o=!1,a=n=e.interactive||n,h=!0;if(e.hitArea?(i&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:(i=!1,h=!1)),a=!1):e._mask&&i&&(e._mask.containsPoint&&e._mask.containsPoint(s)||(i=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,l=u.length-1;l>=0;l--){var c=u[l],d=this.recursiveFindHit(t,c,r,i,a);if(d){if(!c.parent)continue;a=!1,d&&(t.target&&(i=!1),o=!0)}}return n&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(o=!0),e.interactive&&(o&&!t.target&&(t.target=e),r&&r(t,e,!!o))),o},ge.prototype.findHit=function(t,e,r,i){this.recursiveFindHit(t,e,r,i,!1)};var ye={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};re.mixin(ye);var ve={target:null,data:{global:null}},_e=function(t){function e(e,r){t.call(this),r=r||{},this.renderer=e,this.autoPreventDefault=void 0===r.autoPreventDefault||r.autoPreventDefault,this.interactionFrequency=r.interactionFrequency||10,this.mouse=new ce,this.mouse.identifier=1,this.mouse.global.set(-999999),this.activeInteractionData={},this.activeInteractionData[1]=this.mouse,this.interactionDataPool=[],this.eventData=new pe,this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.tickerAdded=!1,this.mouseOverRenderer=!1,this.supportsTouchEvents="ontouchstart"in window,this.supportsPointerEvents=!!window.PointerEvent,this.onPointerUp=this.onPointerUp.bind(this),this.processPointerUp=this.processPointerUp.bind(this),this.onPointerCancel=this.onPointerCancel.bind(this),this.processPointerCancel=this.processPointerCancel.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.processPointerDown=this.processPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.processPointerMove=this.processPointerMove.bind(this),this.onPointerOut=this.onPointerOut.bind(this),this.processPointerOverOut=this.processPointerOverOut.bind(this),this.onPointerOver=this.onPointerOver.bind(this),this.cursorStyles={default:"inherit",pointer:"pointer"},this.currentCursorMode=null,this.cursor=null,this.resolution=1,this.delayedEvents=[],this.search=new ge,this._useSystemTicker=void 0===r.useSystemTicker||r.useSystemTicker,this.setTargetElement(this.renderer.view,this.renderer.resolution)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={useSystemTicker:{configurable:!0}};return r.useSystemTicker.get=function(){return this._useSystemTicker},r.useSystemTicker.set=function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},e.prototype.hitTest=function(t,e){return ve.target=null,ve.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(ve,e,null,!0),ve.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(ue.system.add(this.tickerUpdate,this,oe.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(ue.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){!this.eventsAdded&&this.interactionDOMElement&&(window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},e.prototype.removeEvents=function(){this.eventsAdded&&this.interactionDOMElement&&(window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this.didMove)this.didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var r=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,r){r.stopPropagationHint&&t!==r.stopsPropagatingAt||(r.currentTarget=t,r.type=e,t.emit(e,r),t[e]&&t[e](r))},e.prototype.delayDispatchEvent=function(t,e,r){this.delayedEvents.push({displayObject:t,eventString:e,eventData:r})},e.prototype.mapPositionToPoint=function(t,e,r){var i;i=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var n=1/this.resolution;t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)*n,t.y=(r-i.top)*(this.interactionDOMElement.height/i.height)*n},e.prototype.processInteractive=function(t,e,r,i){var n=this.search.findHit(t,e,r,i),s=this.delayedEvents;if(!s.length)return n;t.stopPropagationHint=!1;var o=s.length;this.delayedEvents=[];for(var a=0;a<o;a++){var h=s[a],u=h.displayObject,l=h.eventString,c=h.eventData;c.stopsPropagatingAt===u&&(c.stopPropagationHint=!0),this.dispatchEvent(u,l,c)}return n},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var r=e.length,i=0;i<r;i++){var n=e[i],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);if(o.data.originalEvent=t,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===n.pointerType)this.emit("touchstart",o);else if("mouse"===n.pointerType||"pen"===n.pointerType){var a=2===n.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,r){var i=t.data,n=t.data.identifier;if(r)if(e.trackedPointers[n]||(e.trackedPointers[n]=new fe(n)),this.dispatchEvent(e,"pointerdown",t),"touch"===i.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===i.pointerType||"pen"===i.pointerType){var s=2===i.button;s?e.trackedPointers[n].rightDown=!0:e.trackedPointers[n].leftDown=!0,this.dispatchEvent(e,s?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,r){for(var i=this.normalizeToPointerData(t),n=i.length,s=t.target!==this.interactionDOMElement?"outside":"",o=0;o<n;o++){var a=i[o],h=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(u.data.originalEvent=t,this.processInteractive(u,this.renderer._lastObjectRendered,r,e||!s),this.emit(e?"pointercancel":"pointerup"+s,u),"mouse"===a.pointerType||"pen"===a.pointerType){var l=2===a.button;this.emit(l?"rightup"+s:"mouseup"+s,u)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+s,u),this.releaseInteractionDataForPointerId(a.pointerId,h))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var r=t.data,i=t.data.identifier;void 0!==e.trackedPointers[i]&&(delete e.trackedPointers[i],this.dispatchEvent(e,"pointercancel",t),"touch"===r.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,r){var i=t.data,n=t.data.identifier,s=e.trackedPointers[n],o="touch"===i.pointerType,a="mouse"===i.pointerType||"pen"===i.pointerType,h=!1;if(a){var u=2===i.button,l=fe.FLAGS,c=u?l.RIGHT_DOWN:l.LEFT_DOWN,d=void 0!==s&&s.flags&c;r?(this.dispatchEvent(e,u?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,u?"rightclick":"click",t),h=!0)):d&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),s&&(u?s.rightDown=!1:s.leftDown=!1)}r?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),s&&(a&&!h||this.dispatchEvent(e,"pointertap",t),o&&(this.dispatchEvent(e,"tap",t),s.over=!1))):s&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),s&&s.none&&delete e.trackedPointers[n]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this.didMove=!0,this.cursor=null);for(var r=e.length,i=0;i<r;i++){var n=e[i],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);o.data.originalEvent=t,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===n.pointerType&&this.emit("touchmove",o),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,r){var i=t.data,n="touch"===i.pointerType,s="mouse"===i.pointerType||"pen"===i.pointerType;s&&this.processPointerOverOut(t,e,r),this.moveWhenInside&&!r||(this.dispatchEvent(e,"pointermove",t),n&&this.dispatchEvent(e,"touchmove",t),s&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,r);i.data.originalEvent=e,this.processInteractive(i,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(r.identifier)}},e.prototype.processPointerOverOut=function(t,e,r){var i=t.data,n=t.data.identifier,s="mouse"===i.pointerType||"pen"===i.pointerType,o=e.trackedPointers[n];r&&!o&&(o=e.trackedPointers[n]=new fe(n)),void 0!==o&&(r&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(e,"pointerover",t),s&&this.delayDispatchEvent(e,"mouseover",t)),s&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),s&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[n]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],r=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,r);i.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",i)},e.prototype.getInteractionDataForPointerId=function(t){var e,r=t.pointerId;return 1===r||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[r]?e=this.activeInteractionData[r]:((e=this.interactionDataPool.pop()||new ce).identifier=r,this.activeInteractionData[r]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,r){return t.data=r,this.mapPositionToPoint(r.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=r.global.x,e.globalY=r.global.y),r.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,i=t.changedTouches.length;r<i;r++){var n=t.changedTouches[r];void 0===n.button&&(n.button=t.touches.length?1:0),void 0===n.buttons&&(n.buttons=t.touches.length?1:0),void 0===n.isPrimary&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,e.push(n)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent?e.push(t):(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=1),void 0===t.pressure&&(t.pressure=.5),void 0===t.twist&&(t.twist=0),void 0===t.tangentialPressure&&(t.tangentialPressure=0),t.isNormalized=!0,e.push(t));return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},Object.defineProperties(e.prototype,r),e}(V.a),be=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(be.prototype,{dispatch:{value:be.prototype.emit},run:{value:be.prototype.emit}});
/*!
 * @pixi/core - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var xe=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new be("setRealSize",2),this.onUpdate=new be("update"),this.onError=new be("onError",1)},Te={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};xe.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},xe.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},xe.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},Te.valid.get=function(){return!!this._width&&!!this._height},xe.prototype.update=function(){this.destroyed||this.onUpdate.run()},xe.prototype.load=function(){return Promise.resolve()},Te.width.get=function(){return this._width},Te.height.get=function(){return this._height},xe.prototype.upload=function(t,e,r){return!1},xe.prototype.style=function(t,e,r){return!1},xe.prototype.dispose=function(){},xe.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(xe.prototype,Te);var Ee=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=Pt(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===U.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(xe),we=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:G.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===U.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(Ee),Se=[];function Ie(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=Se.length-1;n>=0;--n){var s=Se[n];if(s.test&&s.test(t,r))return new s(t,e)}return new we(t,e)}var Ae=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===U.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(xe),Ce={scaleMode:F.NEAREST,format:P.RGBA,alphaMode:U.NPM},Oe=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof xe||((e=Ie(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||G.RESOLUTION,this.mipmap=void 0!==n?n:G.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:G.ANISOTROPIC_LEVEL,this.wrapMode=u||G.WRAP_MODE,this.scaleMode=void 0!==o?o:G.SCALE_MODE,this.format=l||P.RGBA,this.type=c||D.UNSIGNED_BYTE,this.target=d||M.TEXTURE_2D,this.alphaMode=void 0!==i?i:U.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=_t(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=ft(this.realWidth)&&ft(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete wt[this.cacheId],delete Et[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=G.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+_t()),s=t._pixiId);var o=wt[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new Ae(t,{width:r,height:i}),o=t instanceof Float32Array?D.FLOAT:D.UNSIGNED_BYTE;return new e(s,Object.assign(Ce,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),wt[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),wt[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=wt[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete wt[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete wt[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);Oe._globalBatch=0;var Re=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new Oe;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(Ie(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=M.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(xe),Ne=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(Ee),Pe=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=M.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=M.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(Re);Pe.SIDES=6;var Me=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+_t(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(Ee);Me.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var De=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=ue.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(ue.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(ue.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&ue.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(ue.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(ue.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(Ee);De.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var Fe=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(Ee);Se.push(we,Fe,Ne,De,Me,Ae,Pe,Re);var Le={INSTALLED:Se,autoDetectResource:Ie,ArrayResource:Re,BufferResource:Ae,CanvasResource:Ne,CubeResource:Pe,ImageResource:we,ImageBitmapResource:Fe,SVGResource:Me,VideoResource:De,Resource:xe,BaseImageResource:Ee},ke=function(t){this.renderer=t};ke.prototype.destroy=function(){this.renderer=null};var Ue=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===U.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(Ae),Be=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new be("disposeFramebuffer",2)},je={colorTexture:{configurable:!0}};je.colorTexture.get=function(){return this.colorTextures[0]},Be.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new Oe(null,{scaleMode:F.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Be.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Oe(new Ue(null,{width:this.width,height:this.height}),{scaleMode:F.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:P.DEPTH_COMPONENT,type:D.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},Be.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Be.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Be.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},Be.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(Be.prototype,je);var Xe=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new Be(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(Oe),Ge=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};Ge.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=Yt.add(r,Yt.NW),this.x0=a+s*Yt.uX(r),this.y0=h+o*Yt.uY(r),r=Yt.add(r,2),this.x1=a+s*Yt.uX(r),this.y1=h+o*Yt.uY(r),r=Yt.add(r,2),this.x2=a+s*Yt.uX(r),this.y2=h+o*Yt.uY(r),r=Yt.add(r,2),this.x3=a+s*Yt.uX(r),this.y3=h+o*Yt.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var ze=new Ge,Ve=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new Kt(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=ze,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new Ft(a.x,a.y):new Ft(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&Et[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===ze&&(this._uvs=new Ge),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=G.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+_t()),s=t._pixiId);var o=Et[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=Mt(t)),(o=new e(new Oe(t,r))).baseTexture.cacheId=s,Oe.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(Oe.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new we(t);n.url=r;var s=new e(new Oe(n,{scaleMode:G.SCALE_MODE,resolution:Mt(r)}));return i||(i=r),Oe.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(Oe.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Et[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Et[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Et[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Et[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)Et[t.textureCacheIds[i]]===t&&delete Et[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function He(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Ve.EMPTY=new Ve(new Oe),He(Ve.EMPTY),He(Ve.EMPTY.baseTexture),Ve.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Ve(new Oe(new Ne(t)))}(),He(Ve.WHITE),He(Ve.WHITE.baseTexture);var $e=function(t){function e(e,r){var i=null;if(!(e instanceof Xe)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new Xe({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new Xe(t))},e}(Ve),We=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};We.prototype.createTexture=function(t,e){var r=new Xe(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new $e(r)},We.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=We.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=pt(t)))<<16|65535&(e=pt(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},We.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},We.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},We.prototype.returnFilterTexture=function(t){this.returnTexture(t)},We.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},We.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=We.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},We.SCREEN_KEY="screen";var Ye=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};Ye.prototype.destroy=function(){this.buffer=null},Ye.from=function(t,e,r,i,n){return new Ye(t,e,r,i,n)};var qe=0,Ke=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=qe++,this.disposeRunner=new be("disposeBuffer",2)};function Ze(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}Ke.prototype.update=function(t){this.data=t||this.data,this._updateID++},Ke.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Ke.prototype.destroy=function(){this.dispose(),this.data=null},Ke.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new Ke(t)};var Je={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var Qe={5126:4,5123:2,5121:1},tr=0,er={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},rr=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=tr++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new be("disposeGeometry",2),this.refCount=0};rr.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Ke(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Ye(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},rr.prototype.getAttribute=function(t){return this.attributes[t]},rr.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},rr.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ke(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},rr.prototype.getIndex=function(){return this.indexBuffer},rr.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new Ke;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*Qe[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Ze(c);n[d]||(n[d]=new Je[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},rr.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},rr.prototype.dispose=function(){this.disposeRunner.run(this,!1)},rr.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},rr.prototype.clone=function(){for(var t=new rr,e=0;e<this.buffers.length;e++)t.buffers[e]=new Ke(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new Ye(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},rr.merge=function(t){for(var e,r=new rr,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(er[Ze(e.buffers[h].data)])(n[h]),r.buffers[h]=new Ke(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*Qe[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var ir=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(rr),nr=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ke(this.vertices),this.uvBuffer=new Ke(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(rr),sr=0,or=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=sr++,this.static=!!e};or.prototype.update=function(){this.dirtyId++},or.prototype.add=function(t,e,r){this.uniforms[t]=new or(e,r)},or.from=function(t,e){return new or(t,e)};var ar=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new Kt,this.destinationFrame=new Kt,this.filters=[]};ar.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var hr=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new We,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new ir,this.quadUv=new nr,this.tempRect=new Kt,this.activeState={},this.globalUniforms=new or({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new ar,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(N.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(N.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(jt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(ke),ur=function(t){this.renderer=t};ur.prototype.flush=function(){},ur.prototype.destroy=function(){this.renderer=null},ur.prototype.start=function(){},ur.prototype.stop=function(){this.flush()},ur.prototype.render=function(t){};var lr=function(t){function e(e){t.call(this,e),this.emptyRenderer=new ur(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(ke);G.PREFER_ENV=A.any?C.WEBGL:C.WEBGL2,G.STRICT_TEXTURE_CACHE=!1;var cr=0,dr=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=cr++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=cr++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(G.PREFER_ENV>=C.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(ke),pr=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new Be(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Kt,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;G.PREFER_ENV===C.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Kt},Object.defineProperties(e.prototype,r),e}(ke),fr=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},mr={5126:4,5123:2,5121:1},gr=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;G.PREFER_ENV===C.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*mr[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*mr[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*mr[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new fr(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(ke),yr=function(t){this.type=X.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function vr(t,e,r,i){var n=_r(t,t.VERTEX_SHADER,e),s=_r(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function _r(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function br(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return xr(2*e);case"bvec3":return xr(3*e);case"bvec4":return xr(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function xr(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}yr.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=X.NONE,this.autoDetect=!0),this._target=null},yr.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var Tr,Er={},wr=Er;function Sr(){if(wr===Er||wr&&wr.isContextLost()){var t,e=document.createElement("canvas");G.PREFER_ENV>=C.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),wr=t}return wr}function Ir(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===j.HIGH&&r!==j.HIGH&&(i=j.MEDIUM),"precision "+i+" float;\n"+t}return r!==j.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var Ar={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Cr(t){return Ar[t]}var Or=null,Rr={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function Nr(t,e){if(!Or){var r=Object.keys(Rr);Or={};for(var i=0;i<r.length;++i){var n=r[i];Or[t[n]]=Rr[n]}}return Or[e]}var Pr={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Mr={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Dr,Fr=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Lr(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=Fr.replace(/%forloop%/gi,kr(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}function kr(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var Ur=0,Br={},jr=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=Ur++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Br[i]?(Br[i]++,i+="-"+Br[i]):Br[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Ir(this.vertexSrc,G.PRECISION_VERTEX,j.HIGH),this.fragmentSrc=Ir(this.fragmentSrc,G.PRECISION_FRAGMENT,function(){if(!Tr){Tr=j.MEDIUM;var t=Sr();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Tr=e.precision?j.HIGH:j.MEDIUM}}return Tr}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},Xr={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};jr.prototype.extractData=function(t,e){var r=Sr();if(r){var i=vr(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},jr.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=Nr(e,o.type),h={type:a,name:o.name,size:Cr(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},jr.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=Nr(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:br(h,s.size)}}return r},Xr.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},Xr.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},jr.from=function(t,e,r){var i=t+e,n=Tt[i];return n||(Tt[i]=n=new jr(t,e,r)),n},Object.defineProperties(jr,Xr);var Gr=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof or?e:new or(e):new or({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},zr={uniforms:{configurable:!0}};Gr.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},Gr.prototype.destroy=function(){this.uniformGroup=null},zr.uniforms.get=function(){return this.uniformGroup.uniforms},Gr.from=function(t,e,r){var i=jr.from(t,e);return new Gr(i,r)},Object.defineProperties(Gr.prototype,zr);var Vr=function(){this.data=0,this.blendMode=R.NORMAL,this.polygonOffset=0,this.blend=!0},Hr={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};Hr.blend.get=function(){return!!(1&this.data)},Hr.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Hr.offsets.get=function(){return!!(2&this.data)},Hr.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},Hr.culling.get=function(){return!!(4&this.data)},Hr.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Hr.depthTest.get=function(){return!!(8&this.data)},Hr.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},Hr.clockwiseFrontFace.get=function(){return!!(16&this.data)},Hr.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Hr.blendMode.get=function(){return this._blendMode},Hr.blendMode.set=function(t){this.blend=t!==R.NONE,this._blendMode=t},Hr.polygonOffset.get=function(){return this._polygonOffset},Hr.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Vr.for2d=function(){var t=new Vr;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(Vr.prototype,Hr);var $r=function(t){function e(r,i,n){var s=jr.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=G.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Vr}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(Gr);$r.SOURCE_KEY_MAP={};var Wr=new jt,Yr=function(t,e){this._texture=t,this.mapCoord=new jt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},qr={texture:{configurable:!0}};qr.texture.get=function(){return this._texture},qr.texture.set=function(t){this._texture=t,this._updateID=-1},Yr.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},Yr.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(Wr.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Wr));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(Yr.prototype,qr);var Kr=function(t){function e(e){var r=new jt;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new Yr(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}($r),Zr=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new yr;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case X.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case X.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case X.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case X.SCISSOR:this.renderer.scissor.pop();break;case X.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case X.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=X.SPRITE;else if(t.type=X.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=X.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new Kr(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(ke),Jr=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(ke),Qr=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(Jr),ti=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(Jr),ei=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new jt,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(ke),ri=new Kt,ii=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Kt,this.destinationFrame=new Kt}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(ri.width=s.realWidth,ri.height=s.realHeight,r=ri),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(ri.width=n.width,ri.height=n.height,r=ri),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(ke),ni=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};ni.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var si=0,oi={textureCount:0},ai=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=si++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Dr)return Dr;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Dr=!0===t({a:"b"},"a","b")}catch(t){Dr=!1}return Dr}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(oi.textureCount=0,this.syncUniformGroup(t.uniformGroup,oi)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?Pr:Mr)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=vr(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:br(h.type,h.size)}}var u=new ni(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(ke);var hi=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=R.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Vr,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[R.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.ADD]=[t.ONE,t.ONE],e[R.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.NONE]=[0,0],e[R.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[R.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[R.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[R.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[R.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[R.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[R.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[R.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[R.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[R.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(ke),ui=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=G.GC_MAX_IDLE,this.checkCountMax=G.GC_MAX_CHECK_COUNT,this.mode=G.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==B.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(ke),li=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},ci=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Oe}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new li(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new li(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new li(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===D.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&gt(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==k.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=L.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===F.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===F.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===F.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===F.LINEAR?r.LINEAR:r.NEAREST)},e}(ke),di={FilterSystem:hr,BatchSystem:lr,ContextSystem:dr,FramebufferSystem:pr,GeometrySystem:gr,MaskSystem:Zr,ScissorSystem:Qr,StencilSystem:ti,ProjectionSystem:ei,RenderTextureSystem:ii,ShaderSystem:ai,StateSystem:hi,TextureGCSystem:ui,TextureSystem:ci},pi=new jt,fi=function(t){function e(e,r){t.call(this),(r=Object.assign({},G.RENDER_OPTIONS,r)).roundPixels&&(G.ROUND_PIXELS=r.roundPixels,xt("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=r,this.type=O.UNKNOWN,this.screen=new Kt(0,0,r.width,r.height),this.view=r.view||document.createElement("canvas"),this.resolution=r.resolution||G.RESOLUTION,this.transparent=r.transparent,this.autoDensity=r.autoDensity||r.autoResize||!1,this.preserveDrawingBuffer=r.preserveDrawingBuffer,this.clearBeforeRender=r.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=r.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new ne,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},r.width.get=function(){return this.view.width},r.height.get=function(){return this.view.height},e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,r,i){0===(i=i||t.getLocalBounds()).width&&(i.width=1),0===i.height&&(i.height=1);var n=$e.create({width:0|i.width,height:0|i.height,scaleMode:e,resolution:r});return pi.tx=-i.x,pi.ty=-i.y,this.render(t,n,!1,pi,!!t.parent),n},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=O.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},r.backgroundColor.get=function(){return this._backgroundColor},r.backgroundColor.set=function(t){this._backgroundColor=t,this._backgroundColorString=et(t),tt(t,this._backgroundColorRgba)},Object.defineProperties(e.prototype,r),e}(V.a),mi=function(t){function e(r){void 0===r&&(r={}),t.call(this,"WebGL",r),r=this.options,this.type=O.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new be("destroy"),contextChange:new be("contextChange",1),reset:new be("reset"),update:new be("update"),postrender:new be("postrender"),prerender:new be("prerender"),resize:new be("resize",2)},this.globalUniforms=new or({projectionMatrix:new jt},!0),this.addSystem(Zr,"mask").addSystem(dr,"context").addSystem(hi,"state").addSystem(ai,"shader").addSystem(ci,"texture").addSystem(gr,"geometry").addSystem(pr,"framebuffer").addSystem(Qr,"scissor").addSystem(ti,"stencil").addSystem(ei,"projection").addSystem(ui,"textureGC").addSystem(hr,"filter").addSystem(ii,"renderTexture").addSystem(lr,"batch"),this.initPlugins(e.__plugins),r.context?this.context.initFromContext(r.context):this.context.initFromOptions({alpha:this.transparent,antialias:r.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,J(2===this.context.webGLVersion?"WebGL 2":"WebGL 1"),this.resize(this.options.width,this.options.height)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t){if(Q())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,e){e||(e=t.name);var r=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var i in this[e]=r,this.runners)this.runners[i].add(r);return this},e.prototype.render=function(t,e,r,i,n){if(this.renderingToScreen=!e,this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(e||(this._lastObjectRendered=t),!n){var s=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=s}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(e,r){t.prototype.resize.call(this,e,r),this.runners.resize.run(e,r)},e.prototype.reset=function(){return this.runners.reset.run(),this},e.prototype.clear=function(){this.framebuffer.bind(),this.framebuffer.clear()},e.prototype.destroy=function(e){for(var r in this.runners.destroy.run(),this.runners)this.runners[r].destroy();t.prototype.destroy.call(this,e),this.gl=null},e.registerPlugin=function(t,r){e.__plugins=e.__plugins||{},e.__plugins[t]=r},e}(fi);function gi(t){return mi.create(t)}var yi="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",vi="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",_i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.from=function(t,r){return new e(new Pe(t,r))},e}(Oe),bi=function(){this.texArray=null,this.blend=0,this.type=N.TRIANGLES,this.start=0,this.size=0,this.data=null},xi=function(){this.elements=[],this.ids=[],this.count=0};xi.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var Ti=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},Ei={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Ei.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Ei.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Ei.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Ei.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Ei.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Ti.prototype.view=function(t){return this[t+"View"]},Ti.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Ti.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Ti.prototype,Ei);var wi=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Vr.for2d(),this.size=4*G.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;G.PREFER_ENV===C.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),G.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Lr(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new bi);for(;r.length<n;)r.push(new xi);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++Oe._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;Oe._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=nt[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;G.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),G.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=pt(Math.ceil(t/8)),r=mt(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new Ti(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=pt(Math.ceil(t/12)),r=mt(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?at(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(ur);wi._drawCallPool=[],wi._textureArrayPool=[];var Si=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};Si.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=or.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new jr(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new jt,default:this.defaultGroupCache[t]};return new Gr(this.programCache[t],n)},Si.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var Ii=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new Ke(null,e,!1),this._indexBuffer=new Ke(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,D.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,D.FLOAT).addAttribute("aColor",this._buffer,4,!0,D.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,D.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(rr),Ai="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Ci="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Oi=function(){},Ri={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};Oi.create=function(t){var e=Object.assign({vertex:Ai,fragment:Ci,geometryClass:Ii,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new Si(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(wi)},Ri.defaultVertexSrc.get=function(){return Ai},Ri.defaultFragmentTemplate.get=function(){return Ci},Object.defineProperties(Oi,Ri);var Ni=Oi.create(),Pi=function t(e){var r=this;e=Object.assign({forceCanvas:!1},e),this.renderer=gi(e),this.stage=new ne,t._plugins.forEach((function(t){t.init.call(r,e)}))},Mi={view:{configurable:!0},screen:{configurable:!0}};
/*!
 * @pixi/app - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Pi.registerPlugin=function(t){Pi._plugins.push(t)},Pi.prototype.render=function(){this.renderer.render(this.stage)},Mi.view.get=function(){return this.renderer.view},Mi.screen.get=function(){return this.renderer.screen},Pi.prototype.destroy=function(t,e){var r=this,i=Pi._plugins.slice(0);i.reverse(),i.forEach((function(t){t.destroy.call(r)})),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},Object.defineProperties(Pi.prototype,Mi),Pi._plugins=[];var Di=function(){};Di.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){window.removeEventListener("resize",this.resize),this._resizeTo=t,t&&(window.addEventListener("resize",this.resize),this.resize())},get:function(){return this._resizeTo}}),this.resize=function(){e._resizeTo&&(e._resizeTo===window?e.renderer.resize(window.innerWidth,window.innerHeight):e.renderer.resize(e._resizeTo.clientWidth,e._resizeTo.clientHeight))},this._resizeTo=null,this.resizeTo=t.resizeTo||null},Di.destroy=function(){this.resizeTo=null,this.resize=null},Pi.registerPlugin(Di);
/*!
 * @pixi/extract - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Fi=new Kt,Li=function(t){this.renderer=t,t.extract=this};Li.prototype.image=function(t,e,r){var i=new Image;return i.src=this.base64(t,e,r),i},Li.prototype.base64=function(t,e,r){return this.canvas(t).toDataURL(e,r)},Li.prototype.canvas=function(t){var e,r,i,n=this.renderer,s=!1,o=!1;t&&(t instanceof $e?i=t:(i=this.renderer.generateTexture(t),o=!0)),i?(e=i.baseTexture.resolution,r=i.frame,s=!1,n.renderTexture.bind(i)):(e=this.renderer.resolution,s=!0,(r=Fi).width=this.renderer.width,r.height=this.renderer.height,n.renderTexture.bind(null));var a=Math.floor(r.width*e+1e-4),h=Math.floor(r.height*e+1e-4),u=new At(a,h,1),l=new Uint8Array(4*a*h),c=n.gl;c.readPixels(r.x*e,r.y*e,a,h,c.RGBA,c.UNSIGNED_BYTE,l);var d=u.context.getImageData(0,0,a,h);if(Li.arrayPostDivide(l,d.data),u.context.putImageData(d,0,0),s){var p=new At(u.width,u.height,1);p.context.scale(1,-1),p.context.drawImage(u.canvas,0,-h),u.destroy(),u=p}return o&&i.destroy(!0),u.canvas},Li.prototype.pixels=function(t){var e,r,i,n=this.renderer,s=!1;t&&(t instanceof $e?i=t:(i=this.renderer.generateTexture(t),s=!0)),i?(e=i.baseTexture.resolution,r=i.frame,n.renderTexture.bind(i)):(e=n.resolution,(r=Fi).width=n.width,r.height=n.height,n.renderTexture.bind(null));var o=r.width*e,a=r.height*e,h=new Uint8Array(4*o*a),u=n.gl;return u.readPixels(r.x*e,r.y*e,o,a,u.RGBA,u.UNSIGNED_BYTE,h),s&&i.destroy(!0),Li.arrayPostDivide(h,h),h},Li.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},Li.arrayPostDivide=function(t,e){for(var r=0;r<t.length;r+=4){var i=e[r+3]=t[r+3];0!==i?(e[r]=Math.round(Math.min(255*t[r]/i,255)),e[r+1]=Math.round(Math.min(255*t[r+1]/i,255)),e[r+2]=Math.round(Math.min(255*t[r+2]/i,255))):(e[r]=t[r],e[r+1]=t[r+1],e[r+2]=t[r+2])}};var ki=r(36),Ui=r.n(ki),Bi=r(22),ji=r.n(Bi);
/*!
 * resource-loader - v3.0.1
 * https://github.com/pixijs/pixi-sound
 * Compiled Tue, 02 Jul 2019 14:06:18 UTC
 *
 * resource-loader is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */
function Xi(){}function Gi(t,e,r,i){var n=0,s=t.length;!function o(a){a||n===s?r&&r(a):i?setTimeout((function(){e(t[n++],o)}),1):e(t[n++],o)}()}function zi(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function Vi(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var r=0,i={_tasks:[],concurrency:e,saturated:Xi,unsaturated:Xi,buffer:e/4,empty:Xi,drain:Xi,error:Xi,started:!1,paused:!1,push:function(t,e){n(t,!1,e)},kill:function(){r=0,i.drain=Xi,i.started=!1,i._tasks=[]},unshift:function(t,e){n(t,!0,e)},process:function(){for(;!i.paused&&r<i.concurrency&&i._tasks.length;){var e=i._tasks.shift();0===i._tasks.length&&i.empty(),(r+=1)===i.concurrency&&i.saturated(),t(e.data,zi(s(e)))}},length:function(){return i._tasks.length},running:function(){return r},idle:function(){return i._tasks.length+r===0},pause:function(){!0!==i.paused&&(i.paused=!0)},resume:function(){if(!1!==i.paused){i.paused=!1;for(var t=1;t<=i.concurrency;t++)i.process()}}};function n(t,e,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(i.started=!0,null==t&&i.idle())setTimeout((function(){return i.drain()}),1);else{var n={data:t,callback:"function"==typeof r?r:Xi};e?i._tasks.unshift(n):i._tasks.push(n),setTimeout((function(){return i.process()}),1)}}function s(t){return function(){r-=1,t.callback.apply(t,arguments),null!=arguments[0]&&i.error(arguments[0],t.data),r<=i.concurrency-i.buffer&&i.unsaturated(),i.idle()&&i.drain(),i.process()}}return i}var Hi={};function $i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Wi(t,e,r){return e&&$i(t.prototype,e),r&&$i(t,r),t}var Yi=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),qi=null;function Ki(){}var Zi=function(){function t(e,r,i){if("string"!=typeof e||"string"!=typeof r)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===r.indexOf("data:")),this.name=e,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Ki,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new ji.a,this.onProgress=new ji.a,this.onComplete=new ji.a,this.onAfterMiddleware=new ji.a}t.setExtensionLoadType=function(e,r){Ji(t._loadTypeMap,e,r)},t.setExtensionXhrType=function(e,r){Ji(t._xhrTypeMap,e,r)};var e=t.prototype;return e.complete=function(){this._clearEvents(),this._finish()},e.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},e.load=function(e){var r=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(r)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:Yi&&this.crossOrigin?this._loadXdr():this._loadXhr()}},e._hasFlag=function(t){return 0!=(this._flags&t)},e._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},e._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},e._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},e._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(t,this.url[r],Array.isArray(e)?e[r]:e));else{var i=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(i)?i[0]:i))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},e._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},e._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},e._createSource=function(t,e,r){r||(r=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=r,i},e._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},e._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},e._onTimeout=function(){this.abort("Load timed out.")},e._xhrOnError=function(){var t=this.xhr;this.abort(Qi(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},e._xhrOnTimeout=function(){var t=this.xhr;this.abort(Qi(t)+" Request timed out.")},e._xhrOnAbort=function(){var t=this.xhr;this.abort(Qi(t)+" Request was aborted by the user.")},e._xhrOnLoad=function(){var e=this.xhr,r="",i=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(r=e.responseText),0===i&&(r.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(r,"text/xml")}else{var s=document.createElement("div");s.innerHTML=r,this.data=s}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||r;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},e._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,qi||(qi=document.createElement("a")),qi.href=t;var r=!(t=Ui()(qi.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,i=t.protocol?t.protocol+":":"";return t.host===e.hostname&&r&&i===e.protocol?"":"anonymous"},e._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},e._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},e._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var r=t.indexOf("/");e=t.substring(r+1,t.indexOf(";",r))}else{var i=t.indexOf("?"),n=t.indexOf("#"),s=Math.min(i>-1?i:t.length,n>-1?n:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},e._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},Wi(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function Ji(t,e,r){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=r)}function Qi(t){return t.toString().replace("object ","")}Zi.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},Zi.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},Zi.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},Zi.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},Zi._loadTypeMap={gif:Zi.LOAD_TYPE.IMAGE,png:Zi.LOAD_TYPE.IMAGE,bmp:Zi.LOAD_TYPE.IMAGE,jpg:Zi.LOAD_TYPE.IMAGE,jpeg:Zi.LOAD_TYPE.IMAGE,tif:Zi.LOAD_TYPE.IMAGE,tiff:Zi.LOAD_TYPE.IMAGE,webp:Zi.LOAD_TYPE.IMAGE,tga:Zi.LOAD_TYPE.IMAGE,svg:Zi.LOAD_TYPE.IMAGE,"svg+xml":Zi.LOAD_TYPE.IMAGE,mp3:Zi.LOAD_TYPE.AUDIO,ogg:Zi.LOAD_TYPE.AUDIO,wav:Zi.LOAD_TYPE.AUDIO,mp4:Zi.LOAD_TYPE.VIDEO,webm:Zi.LOAD_TYPE.VIDEO},Zi._xhrTypeMap={xhtml:Zi.XHR_RESPONSE_TYPE.DOCUMENT,html:Zi.XHR_RESPONSE_TYPE.DOCUMENT,htm:Zi.XHR_RESPONSE_TYPE.DOCUMENT,xml:Zi.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Zi.XHR_RESPONSE_TYPE.DOCUMENT,svg:Zi.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Zi.XHR_RESPONSE_TYPE.DOCUMENT,gif:Zi.XHR_RESPONSE_TYPE.BLOB,png:Zi.XHR_RESPONSE_TYPE.BLOB,bmp:Zi.XHR_RESPONSE_TYPE.BLOB,jpg:Zi.XHR_RESPONSE_TYPE.BLOB,jpeg:Zi.XHR_RESPONSE_TYPE.BLOB,tif:Zi.XHR_RESPONSE_TYPE.BLOB,tiff:Zi.XHR_RESPONSE_TYPE.BLOB,webp:Zi.XHR_RESPONSE_TYPE.BLOB,tga:Zi.XHR_RESPONSE_TYPE.BLOB,json:Zi.XHR_RESPONSE_TYPE.JSON,text:Zi.XHR_RESPONSE_TYPE.TEXT,txt:Zi.XHR_RESPONSE_TYPE.TEXT,ttf:Zi.XHR_RESPONSE_TYPE.BUFFER,otf:Zi.XHR_RESPONSE_TYPE.BUFFER},Zi.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var tn=window.URL||window.webkitURL;var en={caching:function(t,e){var r=this;Hi[t.url]?(t.data=Hi[t.url],t.complete()):t.onComplete.once((function(){return Hi[r.url]=r.data})),e()},parsing:function(t,e){if(t.data){if(t.xhr&&t.xhrType===Zi.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var r=tn.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=r,t.type=Zi.TYPE.IMAGE,void(t.data.onload=function(){tn.revokeObjectURL(r),t.data.onload=null,e()})}}else{var i=t.xhr.getResponseHeader("content-type");if(i&&0===i.indexOf("image"))return t.data=new Image,t.data.src="data:"+i+";base64,"+function(t){for(var e="",r=0;r<t.length;){for(var i=[0,0,0],n=[0,0,0,0],s=0;s<i.length;++s)r<t.length?i[s]=255&t.charCodeAt(r++):i[s]=0;switch(n[0]=i[0]>>2,n[1]=(3&i[0])<<4|i[1]>>4,n[2]=(15&i[1])<<2|i[2]>>6,n[3]=63&i[2],r-(t.length-1)){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64}for(var o=0;o<n.length;++o)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n[o])}return e}(t.xhr.responseText),t.type=Zi.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}},rn=/(#[\w-]+)?$/,nn=function(){function t(e,r){var i=this;void 0===e&&(e=""),void 0===r&&(r=10),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this._queue=Vi(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new ji.a,this.onError=new ji.a,this.onLoad=new ji.a,this.onStart=new ji.a,this.onComplete=new ji.a;for(var n=0;n<t._defaultBeforeMiddleware.length;++n)this.pre(t._defaultBeforeMiddleware[n]);for(var s=0;s<t._defaultAfterMiddleware.length;++s)this.use(t._defaultAfterMiddleware[s])}var e=t.prototype;return e.add=function(t,e,r,i){if(Array.isArray(t)){for(var n=0;n<t.length;++n)this.add(t[n]);return this}if("object"==typeof t&&(i=e||t.callback||t.onComplete,r=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(i=r,r=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(i=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new Zi(t,e,r),"function"==typeof i&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var s=r.parentResource,o=[],a=0;a<s.children.length;++a)s.children[a].isComplete||o.push(s.children[a]);var h=s.progressChunk*(o.length+1)/(o.length+2);s.children.push(this.resources[t]),s.progressChunk=h;for(var u=0;u<o.length;++u)o[u].progressChunk=h;this.resources[t].progressChunk=h}return this._queue.push(this.resources[t]),this},e.pre=function(t){return this._beforeMiddleware.push(t),this},e.use=function(t){return this._afterMiddleware.push(t),this},e.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},e.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},e._prepareUrl=function(t){var e,r=Ui()(t,{strictMode:!0});if(e=r.protocol||!r.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var i=rn.exec(e)[0];-1!==(e=e.substr(0,e.length-i.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=i}return e},e._loadResource=function(t,e){var r=this;t._dequeue=e,Gi(this._beforeMiddleware,(function(e,i){e.call(r,t,(function(){i(t.isComplete?{}:null)}))}),(function(){t.isComplete?r._onLoad(t):(t._onLoadBinding=t.onComplete.once(r._onLoad,r),t.load())}),!0)},e._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),Gi(this._afterMiddleware,(function(r,i){r.call(e,t,i)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},Wi(t,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),t}();nn._defaultBeforeMiddleware=[],nn._defaultAfterMiddleware=[],nn.pre=function(t){return nn._defaultBeforeMiddleware.push(t),nn},nn.use=function(t){return nn._defaultAfterMiddleware.push(t),nn};
/*!
 * @pixi/loaders - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var sn=function(){};sn.use=function(t,e){t.data&&t.type===Zi.TYPE.IMAGE&&(t.texture=Ve.fromLoader(t.data,t.url,t.name)),e()};var on=function(t){function e(r,i){var n=this;t.call(this,r,i),V.a.call(this);for(var s=0;s<e._plugins.length;++s){var o=e._plugins[s],a=o.pre,h=o.use;a&&this.pre(a),h&&this.use(h)}this.onStart.add((function(t){return n.emit("start",t)})),this.onProgress.add((function(t,e){return n.emit("progress",t,e)})),this.onError.add((function(t,e,r){return n.emit("error",t,e,r)})),this.onLoad.add((function(t,e){return n.emit("load",t,e)})),this.onComplete.add((function(t,e){return n.emit("complete",t,e)})),this._protected=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={shared:{configurable:!0}};return e.prototype.destroy=function(){this._protected||(this.removeAllListeners(),this.reset())},r.shared.get=function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},Object.defineProperties(e,r),e}(nn);Object.assign(on.prototype,V.a.prototype),on._plugins=[],on.registerPlugin=function(t){return on._plugins.push(t),t.add&&t.add(),on},on.registerPlugin({use:en.parsing}),on.registerPlugin(sn);var an=function(){};an.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?on.shared:new on},an.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)};var hn=Zi,un=function(t){function e(e,r,i,n){void 0===e&&(e=1500),void 0===i&&(i=16384),void 0===n&&(n=!1),t.call(this);i>16384&&(i=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=i,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=R.NORMAL,this.autoResize=n,this.roundPixels=!0,this.baseTexture=null,this.setProperties(r),this._tint=0,this.tintRgb=new Float32Array(4),this.tint=16777215}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={tint:{configurable:!0}};return e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t,tt(t,this.tintRgb)},e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},Object.defineProperties(e.prototype,r),e}(ne),ln=function(t,e,r){this.geometry=new rr,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var n=t[i];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||D.FLOAT,offset:n.offset},e[i]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()};
/*!
 * @pixi/particles - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/particles is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ln.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new Ke(ut(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){var i=this.dynamicProperties[r];i.offset=e,e+=i.size,this.dynamicStride+=i.size}var n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Ke(this.dynamicData,!1,!1);var s=0;this.staticStride=0;for(var o=0;o<this.staticProperties.length;++o){var a=this.staticProperties[o];a.offset=s,s+=a.size,this.staticStride+=a.size}var h=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(h),this.staticDataUint32=new Uint32Array(h),this.staticBuffer=new Ke(this.staticData,!0,!1);for(var u=0;u<this.dynamicProperties.length;++u){var l=this.dynamicProperties[u];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===D.UNSIGNED_BYTE,l.type,4*this.dynamicStride,4*l.offset)}for(var c=0;c<this.staticProperties.length;++c){var d=this.staticProperties[c];t.addAttribute(d.attributeName,this.staticBuffer,0,d.type===D.UNSIGNED_BYTE,d.type,4*this.staticStride,4*d.offset)}},ln.prototype.uploadDynamic=function(t,e,r){for(var i=0;i<this.dynamicProperties.length;i++){var n=this.dynamicProperties[i];n.uploadFunction(t,e,r,n.type===D.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++},ln.prototype.uploadStatic=function(t,e,r){for(var i=0;i<this.staticProperties.length;i++){var n=this.staticProperties[i];n.uploadFunction(t,e,r,n.type===D.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++},ln.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()};var cn=function(t){function e(e){t.call(this,e),this.shader=null,this.properties=null,this.tempMatrix=new jt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:D.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Gr.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=Vr.for2d()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=t.children,r=t._maxSize,i=t._batchSize,n=this.renderer,s=e.length;if(0!==s){s>r&&!t.autoResize&&(s=r);var o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));var a=e[0]._texture.baseTexture;this.state.blendMode=st(t.blendMode,a.alphaMode),n.state.set(this.state);var h=n.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=ot(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,a.alphaMode),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var l=!1,c=0,d=0;c<s;c+=i,d+=1){var p=s-c;p>i&&(p=i),d>=o.length&&o.push(this._generateOneMoreBuffer(t));var f=o[d];f.uploadDynamic(e,c,p);var m=t._bufferUpdateIDs[d]||0;(l=l||f._updateID<m)&&(f._updateID=t._updateID,f.uploadStatic(e,c,p)),n.geometry.bind(f.geometry),h.drawElements(h.TRIANGLES,6*p,h.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],r=t._maxSize,i=t._batchSize,n=t._properties,s=0;s<r;s+=i)e.push(new ln(this.properties,n,i));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,r=t._properties;return new ln(this.properties,r,e)},e.prototype.uploadVertices=function(t,e,r,i,n,s){for(var o=0,a=0,h=0,u=0,l=0;l<r;++l){var c=t[e+l],d=c._texture,p=c.scale.x,f=c.scale.y,m=d.trim,g=d.orig;m?(o=(a=m.x-c.anchor.x*g.width)+m.width,h=(u=m.y-c.anchor.y*g.height)+m.height):(o=g.width*(1-c.anchor.x),a=g.width*-c.anchor.x,h=g.height*(1-c.anchor.y),u=g.height*-c.anchor.y),i[s]=a*p,i[s+1]=u*f,i[s+n]=o*p,i[s+n+1]=u*f,i[s+2*n]=o*p,i[s+2*n+1]=h*f,i[s+3*n]=a*p,i[s+3*n+1]=h*f,s+=4*n}},e.prototype.uploadPosition=function(t,e,r,i,n,s){for(var o=0;o<r;o++){var a=t[e+o].position;i[s]=a.x,i[s+1]=a.y,i[s+n]=a.x,i[s+n+1]=a.y,i[s+2*n]=a.x,i[s+2*n+1]=a.y,i[s+3*n]=a.x,i[s+3*n+1]=a.y,s+=4*n}},e.prototype.uploadRotation=function(t,e,r,i,n,s){for(var o=0;o<r;o++){var a=t[e+o].rotation;i[s]=a,i[s+n]=a,i[s+2*n]=a,i[s+3*n]=a,s+=4*n}},e.prototype.uploadUvs=function(t,e,r,i,n,s){for(var o=0;o<r;++o){var a=t[e+o]._texture._uvs;a?(i[s]=a.x0,i[s+1]=a.y0,i[s+n]=a.x1,i[s+n+1]=a.y1,i[s+2*n]=a.x2,i[s+2*n+1]=a.y2,i[s+3*n]=a.x3,i[s+3*n+1]=a.y3,s+=4*n):(i[s]=0,i[s+1]=0,i[s+n]=0,i[s+n+1]=0,i[s+2*n]=0,i[s+2*n+1]=0,i[s+3*n]=0,i[s+3*n+1]=0,s+=4*n)}},e.prototype.uploadTint=function(t,e,r,i,n,s){for(var o=0;o<r;++o){var a=t[e+o],h=a._texture.baseTexture.alphaMode>0,u=a.alpha,l=u<1&&h?at(a._tintRGB,u):a._tintRGB+(255*u<<24);i[s]=l,i[s+n]=l,i[s+2*n]=l,i[s+3*n]=l,s+=4*n}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(ur),dn={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},pn=function(){this.reset()};pn.prototype.clone=function(){var t=new pn;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},pn.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Ve.WHITE,this.matrix=null,this.visible=!1},pn.prototype.destroy=function(){this.texture=null,this.matrix=null};var fn={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var r=t.points,i=t.holes,n=e.points,s=e.indices;if(r.length>=6){for(var o=[],a=0;a<i.length;a++){var h=i[a];o.push(r.length/2),r=r.concat(h.points)}var u=$()(r,o,2);if(!u)return;for(var l=n.length/2,c=0;c<u.length;c+=3)s.push(u[c]+l),s.push(u[c+1]+l),s.push(u[c+2]+l);for(var d=0;d<r.length;d++)n.push(r[d])}}},mn={build:function(t){var e,r,i=t.shape,n=t.points,s=i.x,o=i.y;if(n.length=0,t.type===Dt.CIRC?(e=i.radius,r=i.radius):(e=i.width,r=i.height),0!==e&&0!==r){var a=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(i.width+i.height));a/=2.3;for(var h=2*Math.PI/a,u=0;u<a-.5;u++)n.push(s+Math.sin(-h*u)*e,o+Math.cos(-h*u)*r);n.push(n[0],n[1])}},triangulate:function(t,e){var r=t.points,i=e.points,n=e.indices,s=i.length/2,o=s,a=t.shape,h=t.matrix,u=a.x,l=a.y;i.push(t.matrix?h.a*u+h.c*l+h.tx:u,t.matrix?h.b*u+h.d*l+h.ty:l);for(var c=0;c<r.length;c+=2)i.push(r[c],r[c+1]),n.push(s++,o,s)}},gn={build:function(t){var e=t.shape,r=e.x,i=e.y,n=e.width,s=e.height,o=t.points;o.length=0,o.push(r,i,r+n,i,r+n,i+s,r,i+s)},triangulate:function(t,e){var r=t.points,i=e.points,n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},yn={build:function(t){var e=t.shape,r=t.points,i=e.x,n=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));r.length=0,a?(_n(i,n+a,i,n,i+a,n,r),_n(i+s-a,n,i+s,n,i+s,n+a,r),_n(i+s,n+o-a,i+s,n+o,i+s-a,n+o,r),_n(i+a,n+o,i,n+o,i,n+o-a,r)):r.push(i,n,i+s,n,i+s,n+o,i,n+o)},triangulate:function(t,e){for(var r=t.points,i=e.points,n=e.indices,s=i.length/2,o=$()(r,null,2),a=0,h=o.length;a<h;a+=3)n.push(o[a]+s),n.push(o[a+1]+s),n.push(o[a+2]+s);for(var u=0,l=r.length;u<l;u++)i.push(r[u],r[++u])}};function vn(t,e,r){return t+(e-t)*r}function _n(t,e,r,i,n,s,o){void 0===o&&(o=[]);for(var a=o,h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0;f<=20;++f)h=vn(t,r,m=f/20),u=vn(e,i,m),l=vn(r,n,m),c=vn(i,s,m),d=vn(h,l,m),p=vn(u,c,m),a.push(d,p);return a}function bn(t,e){t.lineStyle.native?function(t,e){var r=0,i=t.shape,n=t.points||i.points,s=i.type!==Dt.POLY||i.closeStroke;if(0===n.length)return;var o=e.points,a=e.indices,h=n.length/2,u=o.length/2,l=u;for(o.push(n[0],n[1]),r=1;r<h;r++)o.push(n[2*r],n[2*r+1]),a.push(l,l+1),l++;s&&a.push(l,u)}(t,e):function(t,e){var r=t.shape,i=t.points||r.points.slice(),n=e.closePointEps;if(0===i.length)return;var s=t.lineStyle,o=new Ft(i[0],i[1]),a=new Ft(i[i.length-2],i[i.length-1]),h=r.type!==Dt.POLY||r.closeStroke,u=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(h){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var l=a.x+.5*(o.x-a.x),c=a.y+.5*(o.y-a.y);i.unshift(l,c),i.push(l,c)}var d=e.points,p=i.length/2,f=i.length,m=d.length/2,g=s.width/2,y=i[0],v=i[1],_=i[2],b=i[3],x=0,T=0,E=-(v-b),w=y-_,S=0,I=0,A=0,C=0,O=Math.sqrt(E*E+w*w);E/=O,w/=O,E*=g,w*=g;var R=s.alignment,N=2*(1-R),P=2*R;d.push(y-E*N,v-w*N),d.push(y+E*P,v+w*P);for(var M=1;M<p-1;++M){y=i[2*(M-1)],v=i[2*(M-1)+1],_=i[2*M],b=i[2*M+1],x=i[2*(M+1)],T=i[2*(M+1)+1],E=-(v-b),w=y-_,O=Math.sqrt(E*E+w*w),E/=O,w/=O,E*=g,w*=g,S=-(b-T),I=_-x,O=Math.sqrt(S*S+I*I),S/=O,I/=O;var D=-w+v-(-w+b),F=-E+_-(-E+y),L=(-E+y)*(-w+b)-(-E+_)*(-w+v),k=-(I*=g)+T-(-I+b),U=-(S*=g)+_-(-S+x),B=(-S+x)*(-I+b)-(-S+_)*(-I+T),j=D*U-k*F;if(Math.abs(j)<.1)j+=10.1,d.push(_-E*N,b-w*N),d.push(_+E*P,b+w*P);else{var X=(F*B-U*L)/j,G=(k*L-D*B)/j;(X-_)*(X-_)+(G-b)*(G-b)>196*g*g?(A=E-S,C=w-I,O=Math.sqrt(A*A+C*C),A/=O,C/=O,A*=g,C*=g,d.push(_-A*N,b-C*N),d.push(_+A*P,b+C*P),d.push(_-A*P*N,b-C*N),f++):(d.push(_+(X-_)*N,b+(G-b)*N),d.push(_-(X-_)*P,b-(G-b)*P))}}y=i[2*(p-2)],v=i[2*(p-2)+1],_=i[2*(p-1)],b=i[2*(p-1)+1],E=-(v-b),w=y-_,O=Math.sqrt(E*E+w*w),E/=O,w/=O,E*=g,w*=g,d.push(_-E*N,b-w*N),d.push(_+E*P,b+w*P);for(var z=e.indices,V=0;V<f-2;++V)z.push(m,m+1,m+2),m++}(t,e)}var xn=function(t){function e(e,r,i,n,s,o){s=s||n/2;for(var a=-1*Math.PI/2+o,h=2*i,u=kt/h,l=[],c=0;c<h;c++){var d=c%2?s:n,p=c*u+a;l.push(e+d*Math.cos(p),r+d*Math.sin(p))}t.call(this,l)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Qt),Tn=function(){};Tn.curveTo=function(t,e,r,i,n,s){var o=s[s.length-2],a=s[s.length-1]-e,h=o-t,u=i-e,l=r-t,c=Math.abs(a*l-h*u);if(c<1e-8||0===n)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var d=a*a+h*h,p=u*u+l*l,f=a*u+h*l,m=n*Math.sqrt(d)/c,g=n*Math.sqrt(p)/c,y=m*f/d,v=g*f/p,_=m*l+g*h,b=m*u+g*a,x=h*(g+y),T=a*(g+y),E=l*(m+v),w=u*(m+v);return{cx:_+t,cy:b+e,radius:n,startAngle:Math.atan2(T-b,x-_),endAngle:Math.atan2(w-b,E-_),anticlockwise:h*u>l*a}},Tn.arc=function(t,e,r,i,n,s,o,a,h){for(var u=o-s,l=dn._segmentsCount(Math.abs(u)*n,40*Math.ceil(Math.abs(u)/kt)),c=u/(2*l),d=2*c,p=Math.cos(c),f=Math.sin(c),m=l-1,g=m%1/m,y=0;y<=m;++y){var v=c+s+d*(y+g*y),_=Math.cos(v),b=-Math.sin(v);h.push((p*_+f*b)*n+r,(p*-b+f*_)*n+i)}};var En=function(){};En.curveLength=function(t,e,r,i,n,s,o,a){for(var h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=t,b=e,x=1;x<=10;++x)y=_-(m=(f=(p=(d=1-(u=x/10))*d)*d)*t+3*p*u*r+3*d*(l=u*u)*n+(c=l*u)*o),v=b-(g=f*e+3*p*u*i+3*d*l*s+c*a),_=m,b=g,h+=Math.sqrt(y*y+v*v);return h},En.curveTo=function(t,e,r,i,n,s,o){var a=o[o.length-2],h=o[o.length-1];o.length-=2;var u=dn._segmentsCount(En.curveLength(a,h,t,e,r,i,n,s)),l=0,c=0,d=0,p=0,f=0;o.push(a,h);for(var m=1,g=0;m<=u;++m)d=(c=(l=1-(g=m/u))*l)*l,f=(p=g*g)*g,o.push(d*a+3*c*g*t+3*l*p*r+f*n,d*h+3*c*g*e+3*l*p*i+f*s)};var wn=function(){};wn.curveLength=function(t,e,r,i,n,s){var o=t-2*r+n,a=e-2*i+s,h=2*r-2*t,u=2*i-2*e,l=4*(o*o+a*a),c=4*(o*h+a*u),d=h*h+u*u,p=2*Math.sqrt(l+c+d),f=Math.sqrt(l),m=2*l*f,g=2*Math.sqrt(d),y=c/f;return(m*p+f*c*(p-g)+(4*d*l-c*c)*Math.log((2*f+y+p)/(y+g)))/(4*m)},wn.curveTo=function(t,e,r,i,n){for(var s=n[n.length-2],o=n[n.length-1],a=dn._segmentsCount(wn.curveLength(s,o,t,e,r,i)),h=0,u=0,l=1;l<=a;++l){var c=l/a;h=s+(t-s)*c,u=o+(e-o)*c,n.push(h+(t+(r-t)*c-h)*c,u+(e+(i-e)*c-u)*c)}};var Sn=function(){this.reset()};Sn.prototype.begin=function(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r},Sn.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},Sn.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0};var In={};In[Dt.POLY]=fn,In[Dt.CIRC]=mn,In[Dt.ELIP]=mn,In[Dt.RECT]=gn,In[Dt.RREC]=yn;var An=[],Cn=[],On={buildPoly:fn,buildCircle:mn,buildRectangle:gn,buildRoundedRectangle:yn,FILL_COMMANDS:In,BATCH_POOL:An,DRAW_CALL_POOL:Cn,buildLine:bn,buildComplexPoly:function(t,e){var r=t.points.slice();if(!(r.length<6)){var i=e.indices;e.points=r,e.alpha=t.fillAlpha,e.color=tt(t.fillColor);for(var n=1/0,s=-1/0,o=1/0,a=-1/0,h=0,u=0,l=0;l<r.length;l+=2)n=(h=r[l])<n?h:n,s=h>s?h:s,o=(u=r[l+1])<o?u:o,a=u>a?u:a;r.push(n,o,s,o,s,a,n,a);for(var c=r.length/2,d=0;d<c;d++)i.push(d)}},bezierCurveTo:function(t,e,r,i,n,s,o,a,h,u){void 0===u&&(u=[]);var l=0,c=0,d=0,p=0,f=0;u.push(t,e);for(var m=1,g=0;m<=h;++m)d=(c=(l=1-(g=m/h))*l)*l,f=(p=g*g)*g,u.push(d*t+3*c*g*r+3*l*p*n+f*o,d*e+3*c*g*i+3*l*p*s+f*a);return u},Star:xn,ArcUtils:Tn,BezierUtils:En,QuadraticUtils:wn,BatchPart:Sn},Rn=function(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type,this.points=[],this.holes=[]};Rn.prototype.clone=function(){return new Rn(this.shape,this.fillStyle,this.lineStyle,this.matrix)},Rn.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null};var Nn=new Ft,Pn=new ee,Mn=function(t){function e(){t.call(this),this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeIndex=0,this._bounds=new ee,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.uvsFloat32=null,this.closePointEps=1e-4}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={bounds:{configurable:!0}};return r.bounds.get=function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].textures.length=0,Cn.push(this.drawCalls[t]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var r=this.batches[e];r.reset(),An.push(r)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,r,i){var n=new Rn(t,e,r,i);return this.graphicsData.push(n),this.dirty++,this},e.prototype.drawHole=function(t,e){if(!this.graphicsData.length)return null;var r=new Rn(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var r=0;r<this.graphicsData.length;++r)this.graphicsData[r].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,r=0;r<e.length;++r){var i=e[r];if(i.fillStyle.visible&&(i.shape&&(i.matrix?i.matrix.applyInverse(t,Nn):Nn.copyFrom(t),i.shape.contains(Nn.x,Nn.y)))){var n=!1;if(i.holes)for(var s=0;s<i.holes.length;s++){if(i.holes[s].shape.contains(Nn.x,Nn.y)){n=!0;break}}if(!n)return!0}}return!1},e.prototype.updateBatches=function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,e=this.graphicsData,r=null,i=null;this.batches.length>0&&(i=(r=this.batches[this.batches.length-1]).style);for(var n=this.shapeIndex;n<e.length;n++){this.shapeIndex++;var s=e[n],o=s.fillStyle,a=s.lineStyle;In[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var h=0;h<2;h++){var u=0===h?o:a;if(u.visible){var l=u.texture.baseTexture,c=this.indices.length,d=this.points.length/2;l.wrapMode=L.REPEAT,0===h?this.processFill(s):this.processLine(s);var p=this.points.length/2-d;0!==p&&(r&&!this._compareStyles(i,u)&&(r.end(c,d),r=null),r||((r=An.pop()||new Sn).begin(u,c,d),this.batches.push(r),i=u),this.addUvs(this.points,t,u.texture,d,p,u.matrix))}}}if(r){var f=this.indices.length,m=this.points.length/2;r.end(f,m)}0!==this.batches.length?(this.indicesUint16=new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()):this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var r=this.graphicsData[t],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,r=t.length;e<r;e++)for(var i=t[e],n=0;n<i.size;n++){var s=i.start+n;this.indicesUint16[s]=this.indicesUint16[s]-i.attribStart}},e.prototype.isBatchable=function(){for(var t=this.batches,r=0;r<t.length;r++)if(t[r].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++Oe._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].textures.length=0,Cn.push(this.drawCalls[e]);this.drawCalls.length=0;var r=this.colors,i=this.textureIds,n=Cn.pop();n||((n=new bi).textures=new xi),n.textures.count=0,n.start=0,n.size=0,n.type=N.TRIANGLES;var s=0,o=null,a=0,h=!1,u=N.TRIANGLES,l=0;this.drawCalls.push(n);for(var c=0;c<this.batches.length;c++){var d=this.batches[c],p=d.style,f=p.texture.baseTexture;h!==!!p.native&&(u=(h=!!p.native)?N.LINES:N.TRIANGLES,o=null,s=8,t++),o!==f&&(o=f,f._batchEnabled!==t&&(8===s&&(t++,s=0,n.size>0&&((n=Cn.pop())||((n=new bi).textures=new xi),this.drawCalls.push(n)),n.start=l,n.size=0,n.textures.count=0,n.type=u),f.touched=1,f._batchEnabled=t,f._batchLocation=s,f.wrapMode=10497,n.textures.elements[n.textures.count++]=f,s++)),n.size+=d.size,l+=d.size,a=f._batchLocation,this.addColors(r,p.color,p.alpha,d.attribSize),this.addTextureIds(i,a,d.attribSize)}Oe._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(3*t.length*4),s=new Float32Array(n),o=new Uint32Array(n),a=0,h=0;h<t.length/2;h++)s[a++]=t[2*h],s[a++]=t[2*h+1],s[a++]=e[2*h],s[a++]=e[2*h+1],o[a++]=r[h],s[a++]=i[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),fn.triangulate(t,this)):In[t.type].triangulate(t,this)},e.prototype.processLine=function(t){bn(t,this);for(var e=0;e<t.holes.length;e++)bn(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var r=t[e];In[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=Pn,r=jt.IDENTITY;this._bounds.clear(),e.clear();for(var i=0;i<this.graphicsData.length;i++){var n=this.graphicsData[i],s=n.shape,o=n.type,a=n.lineStyle,h=n.matrix||jt.IDENTITY,u=0;if(a&&a.visible){var l=a.alignment;u=a.width,o===Dt.POLY?u*=.5+Math.abs(.5-l):u*=Math.max(0,l)}r!==h&&(e.isEmpty()||(t.addBoundsMatrix(e,r),e.clear()),r=h),o===Dt.RECT||o===Dt.RREC?e.addFramePad(s.x,s.y,s.x+s.width,s.y+s.height,u,u):o===Dt.CIRC?e.addFramePad(s.x,s.y,s.x,s.y,s.radius+u,s.radius+u):o===Dt.ELIP?e.addFramePad(s.x,s.y,s.x,s.y,s.width+u,s.height+u):t.addVerticesMatrix(r,s.points,0,s.points.length,u,u)}e.isEmpty()||t.addBoundsMatrix(e,r),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var r=0;r<t.length/2;r++){var i=t[2*r],n=t[2*r+1];t[2*r]=e.a*i+e.c*n+e.tx,t[2*r+1]=e.b*i+e.d*n+e.ty}},e.prototype.addColors=function(t,e,r,i){for(var n=at((e>>16)+(65280&e)+((255&e)<<16),r);i-- >0;)t.push(n)},e.prototype.addTextureIds=function(t,e,r){for(;r-- >0;)t.push(e)},e.prototype.addUvs=function(t,e,r,i,n,s){for(var o=0,a=e.length,h=r.frame;o<n;){var u=t[2*(i+o)],l=t[2*(i+o)+1];if(s){var c=s.a*u+s.c*l+s.tx;l=s.b*u+s.d*l+s.ty,u=c}o++,e.push(u/h.width,l/h.height)}var d=r.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,r,a,n)},e.prototype.adjustUvs=function(t,e,r,i){for(var n=e.baseTexture,s=r+2*i,o=e.frame,a=o.width/n.width,h=o.height/n.height,u=o.x/o.width,l=o.y/o.height,c=Math.floor(t[r]+1e-6),d=Math.floor(t[r+1]+1e-6),p=r+2;p<s;p+=2)c=Math.min(c,Math.floor(t[p]+1e-6)),d=Math.min(d,Math.floor(t[p+1]+1e-6));u-=c,l-=d;for(var f=r;f<s;f+=2)t[f]=(t[f]+u)*a,t[f+1]=(t[f+1]+l)*h},Object.defineProperties(e.prototype,r),e}(Ii);Mn.BATCHABLE_SIZE=100;var Dn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.width=0,this.alignment=.5,this.native=!1},e}(pn),Fn=new Float32Array(3),Ln={},kn=function(t){function e(e){void 0===e&&(e=null),t.call(this),this.geometry=e||new Mn,this.geometry.refCount++,this.shader=null,this.state=Vr.for2d(),this._fillStyle=new pn,this._lineStyle=new Dn,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.vertexData=null,this._transformID=-1,this.batchDirty=-1,this.pluginName="batch",this.tint=16777215,this.blendMode=R.NORMAL}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0},tint:{configurable:!0},fill:{configurable:!0},line:{configurable:!0}};return e.prototype.clone=function(){return this.finishPoly(),new e(this.geometry)},r.blendMode.set=function(t){this.state.blendMode=t},r.blendMode.get=function(){return this.state.blendMode},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t},r.fill.get=function(){return this._fillStyle},r.line.get=function(){return this._lineStyle},e.prototype.lineStyle=function(t){if("number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){if("number"==typeof t){xt("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var e=arguments[0],r=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],o=arguments[5],a=arguments[6];t={width:e,texture:r,color:i,alpha:n,matrix:s,alignment:o,native:a},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({width:0,texture:Ve.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1},t),this.currentPath&&this.startPoly();var h=t.width>0&&t.alpha>0;return h?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:h},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Qt,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Qt,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return i===t&&n===e||r.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,r,i){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),wn.curveTo(t,e,r,i,n),this},e.prototype.bezierCurveTo=function(t,e,r,i,n,s){return this._initCurve(),En.curveTo(t,e,r,i,n,s,this.currentPath.points),this},e.prototype.arcTo=function(t,e,r,i,n){this._initCurve(t,e);var s=this.currentPath.points,o=Tn.curveTo(t,e,r,i,n,s);if(o){var a=o.cx,h=o.cy,u=o.radius,l=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(a,h,u,l,c,d)}return this},e.prototype.arc=function(t,e,r,i,n,s){if(void 0===s&&(s=!1),i===n)return this;if(!s&&n<=i?n+=kt:s&&i<=n&&(i+=kt),0===n-i)return this;var o=t+Math.cos(i)*r,a=e+Math.sin(i)*r,h=this.geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var l=Math.abs(u[u.length-2]-o),c=Math.abs(u[u.length-1]-a);l<h&&c<h||u.push(o,a)}else this.moveTo(o,a),u=this.currentPath.points;return Tn.arc(o,a,t,e,r,i,n,s,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:Ve.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){if(t instanceof Ve){xt("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments[0],r=arguments[1],i=arguments[2],n=arguments[3];t={texture:e,color:r,alpha:i,matrix:n},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({texture:Ve.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var s=t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:s},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,r,i){return this.drawShape(new Kt(t,e,r,i))},e.prototype.drawRoundedRect=function(t,e,r,i,n){return this.drawShape(new te(t,e,r,i,n))},e.prototype.drawCircle=function(t,e,r){return this.drawShape(new Zt(t,e,r))},e.prototype.drawEllipse=function(t,e,r,i){return this.drawShape(new Jt(t,e,r,i))},e.prototype.drawPolygon=function(t){var e=arguments,r=t,i=!0;if(r.points&&(i=r.closeStroke,r=r.points),!Array.isArray(r)){r=new Array(arguments.length);for(var n=0;n<r.length;++n)r[n]=e[n]}var s=new Qt(r);return s.closeStroke=i,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this.geometry.drawHole(t,this._matrix):this.geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,e,r,i,n,s){return void 0===s&&(s=0),this.drawPolygon(new xn(t,e,r,i,n,s))},e.prototype.clear=function(){return this.geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){return 1===this.geometry.graphicsData.length&&this.geometry.graphicsData[0].shape.type===Dt.RECT&&!this.geometry.graphicsData[0].lineWidth},e.prototype._render=function(t){this.finishPoly();var e=this.geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this.geometry,e=this.blendMode;this.batches=[],this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.vertexData=new Float32Array(t.points);for(var r=0,i=t.batches.length;r<i;r++){var n=t.batches[r],s=n.style.color,o=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),h={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:a,_batchRGB:tt(s),_tintRGB:s,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,r=this.batches.length;e<r;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),r=this.geometry,i=this.tint,n=this.worldAlpha,s=e.uniforms,o=r.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(i>>16&255)/255*n,s.tint[1]=(i>>8&255)/255*n,s.tint[2]=(255&i)/255*n,s.tint[3]=n,t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(var a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,r.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var r=e.textures,i=e.type,n=e.size,s=e.start,o=r.count,a=0;a<o;a++)t.texture.bind(r.elements[a],a);t.geometry.draw(i,n,s)},e.prototype._resolveDirectShader=function(t){var e=this.shader,r=this.pluginName;if(!e){if(!Ln[r]){for(var i=new Int32Array(16),n=0;n<16;n++)i[n]=n;var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new jt,default:or.from({uSamplers:i},!0)},o=t.plugins[r]._shader.program;Ln[r]=new Gr(o,s)}e=Ln[r]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this.geometry;if(t.graphicsData.length){var e=t.bounds,r=e.minX,i=e.minY,n=e.maxX,s=e.maxY;this._bounds.addFrame(this.transform,r,i,n,s)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this.geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=tt(this.tint,Fn),e=0;e<this.batches.length;e++){var r=this.batches[e],i=r._batchRGB,n=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);r._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID;for(var t=this.transform.worldTransform,e=t.a,r=t.b,i=t.c,n=t.d,s=t.tx,o=t.ty,a=this.geometry.points,h=this.vertexData,u=0,l=0;l<a.length;l+=2){var c=a[l],d=a[l+1];h[u++]=e*c+i*d+s,h[u++]=n*d+r*c+o}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this.geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},Object.defineProperties(e.prototype,r),e}(ne);kn._TEMP_POINT=new Ft;
/*!
 * @pixi/sprite - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Un=new Ft,Bn=new Uint16Array([0,1,2,0,2,3]),jn=function(t){function e(e){t.call(this),this._anchor=new Lt(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=R.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=e||Ve.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Bn,this.pluginName="batch",this.isSprite=!0,this._roundPixels=G.ROUND_PIXELS}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=yt(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=yt(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,d=0,p=0,f=0,m=0;if(u?(d=(p=u.x-c._x*l.width)+u.width,f=(m=u.y-c._y*l.height)+u.height):(d=(p=-c._x*l.width)+l.width,f=(m=-c._y*l.height)+l.height),h[0]=r*p+n*m+o,h[1]=s*m+i*p+a,h[2]=r*d+n*m+o,h[3]=s*m+i*d+a,h[4]=r*d+n*f+o,h[5]=s*f+i*d+a,h[6]=r*p+n*f+o,h[7]=s*f+i*p+a,this._roundPixels)for(var g=G.RESOLUTION,y=0;y<h.length;++y)h[y]=Math.round((h[y]*g|0)/g)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,i=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=-i._x*r.width,d=c+r.width,p=-i._y*r.height,f=p+r.height;e[0]=s*c+a*p+u,e[1]=h*p+o*c+l,e[2]=s*d+a*p+u,e[3]=h*p+o*d+l,e[4]=s*d+a*f+u,e[5]=h*f+o*d+l,e[6]=s*c+a*f+u,e[7]=h*f+o*c+l},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Kt),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Un);var e=this._texture.orig.width,r=this._texture.orig.height,i=-e*this.anchor.x,n=0;return Un.x>=i&&Un.x<i+e&&(n=-r*this.anchor.y,Un.y>=n&&Un.y<n+r)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var r="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null,this.shader=null},e.from=function(t,r){return new e(t instanceof Ve?t:Ve.from(t,r))},r.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},r.roundPixels.get=function(){return this._roundPixels},r.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},r.width.set=function(t){var e=yt(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},r.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},r.height.set=function(t){var e=yt(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},r.anchor.get=function(){return this._anchor},r.anchor.set=function(t){this._anchor.copyFrom(t)},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},r.texture.get=function(){return this._texture},r.texture.set=function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Ve.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},Object.defineProperties(e.prototype,r),e}(ne),Xn={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},Gn={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Xn.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},zn=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Vn=function(t){this.styleID=0,this.reset(),Yn(this,t,t)},Hn={align:{configurable:!0},breakWords:{configurable:!0},dropShadow:{configurable:!0},dropShadowAlpha:{configurable:!0},dropShadowAngle:{configurable:!0},dropShadowBlur:{configurable:!0},dropShadowColor:{configurable:!0},dropShadowDistance:{configurable:!0},fill:{configurable:!0},fillGradientType:{configurable:!0},fillGradientStops:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontStyle:{configurable:!0},fontVariant:{configurable:!0},fontWeight:{configurable:!0},letterSpacing:{configurable:!0},lineHeight:{configurable:!0},leading:{configurable:!0},lineJoin:{configurable:!0},miterLimit:{configurable:!0},padding:{configurable:!0},stroke:{configurable:!0},strokeThickness:{configurable:!0},textBaseline:{configurable:!0},trim:{configurable:!0},whiteSpace:{configurable:!0},wordWrap:{configurable:!0},wordWrapWidth:{configurable:!0}};function $n(t){return"number"==typeof t?et(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Wn(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=$n(t[e]);return t}return $n(t)}function Yn(t,e,r){for(var i in r)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}Vn.prototype.clone=function(){var t={};return Yn(t,this,Gn),new Vn(t)},Vn.prototype.reset=function(){Yn(this,Gn,Gn)},Hn.align.get=function(){return this._align},Hn.align.set=function(t){this._align!==t&&(this._align=t,this.styleID++)},Hn.breakWords.get=function(){return this._breakWords},Hn.breakWords.set=function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},Hn.dropShadow.get=function(){return this._dropShadow},Hn.dropShadow.set=function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},Hn.dropShadowAlpha.get=function(){return this._dropShadowAlpha},Hn.dropShadowAlpha.set=function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},Hn.dropShadowAngle.get=function(){return this._dropShadowAngle},Hn.dropShadowAngle.set=function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},Hn.dropShadowBlur.get=function(){return this._dropShadowBlur},Hn.dropShadowBlur.set=function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},Hn.dropShadowColor.get=function(){return this._dropShadowColor},Hn.dropShadowColor.set=function(t){var e=Wn(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},Hn.dropShadowDistance.get=function(){return this._dropShadowDistance},Hn.dropShadowDistance.set=function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},Hn.fill.get=function(){return this._fill},Hn.fill.set=function(t){var e=Wn(t);this._fill!==e&&(this._fill=e,this.styleID++)},Hn.fillGradientType.get=function(){return this._fillGradientType},Hn.fillGradientType.set=function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},Hn.fillGradientStops.get=function(){return this._fillGradientStops},Hn.fillGradientStops.set=function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},Hn.fontFamily.get=function(){return this._fontFamily},Hn.fontFamily.set=function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},Hn.fontSize.get=function(){return this._fontSize},Hn.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},Hn.fontStyle.get=function(){return this._fontStyle},Hn.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},Hn.fontVariant.get=function(){return this._fontVariant},Hn.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},Hn.fontWeight.get=function(){return this._fontWeight},Hn.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},Hn.letterSpacing.get=function(){return this._letterSpacing},Hn.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},Hn.lineHeight.get=function(){return this._lineHeight},Hn.lineHeight.set=function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},Hn.leading.get=function(){return this._leading},Hn.leading.set=function(t){this._leading!==t&&(this._leading=t,this.styleID++)},Hn.lineJoin.get=function(){return this._lineJoin},Hn.lineJoin.set=function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},Hn.miterLimit.get=function(){return this._miterLimit},Hn.miterLimit.set=function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},Hn.padding.get=function(){return this._padding},Hn.padding.set=function(t){this._padding!==t&&(this._padding=t,this.styleID++)},Hn.stroke.get=function(){return this._stroke},Hn.stroke.set=function(t){var e=Wn(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},Hn.strokeThickness.get=function(){return this._strokeThickness},Hn.strokeThickness.set=function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},Hn.textBaseline.get=function(){return this._textBaseline},Hn.textBaseline.set=function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},Hn.trim.get=function(){return this._trim},Hn.trim.set=function(t){this._trim!==t&&(this._trim=t,this.styleID++)},Hn.whiteSpace.get=function(){return this._whiteSpace},Hn.whiteSpace.set=function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},Hn.wordWrap.get=function(){return this._wordWrap},Hn.wordWrap.set=function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},Hn.wordWrapWidth.get=function(){return this._wordWrapWidth},Hn.wordWrapWidth.set=function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},Vn.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var i=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&zn.indexOf(i)<0&&(i='"'+i+'"'),e[r]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},Object.defineProperties(Vn.prototype,Hn);var qn=function(t,e,r,i,n,s,o,a,h){this.text=t,this.style=e,this.width=r,this.height=i,this.lines=n,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h};qn.measureText=function(t,e,r,i){void 0===i&&(i=qn._canvas),r=null==r?e.wordWrap:r;var n=e.toFontString(),s=qn.measureFont(n);0===s.fontSize&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var o=i.getContext("2d");o.font=n;for(var a=(r?qn.wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),h=new Array(a.length),u=0,l=0;l<a.length;l++){var c=o.measureText(a[l]).width+(a[l].length-1)*e.letterSpacing;h[l]=c,u=Math.max(u,c)}var d=u+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);var p=e.lineHeight||s.fontSize+e.strokeThickness,f=Math.max(p,s.fontSize+e.strokeThickness)+(a.length-1)*(p+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new qn(t,e,d,f,a,h,p+e.leading,u,s)},qn.wordWrap=function(t,e,r){void 0===r&&(r=qn._canvas);for(var i=r.getContext("2d"),n=0,s="",o="",a={},h=e.letterSpacing,u=e.whiteSpace,l=qn.collapseSpaces(u),c=qn.collapseNewlines(u),d=!l,p=e.wordWrapWidth+h,f=qn.tokenize(t),m=0;m<f.length;m++){var g=f[m];if(qn.isNewline(g)){if(!c){o+=qn.addLine(s),d=!l,s="",n=0;continue}g=" "}if(l){var y=qn.isBreakingSpace(g),v=qn.isBreakingSpace(s[s.length-1]);if(y&&v)continue}var _=qn.getFromCache(g,h,a,i);if(_>p)if(""!==s&&(o+=qn.addLine(s),s="",n=0),qn.canBreakWords(g,e.breakWords))for(var b=qn.wordWrapSplit(g),x=0;x<b.length;x++){for(var T=b[x],E=1;b[x+E];){var w=b[x+E],S=T[T.length-1];if(qn.canBreakChars(S,w,g,x,e.breakWords))break;T+=w,E++}x+=T.length-1;var I=qn.getFromCache(T,h,a,i);I+n>p&&(o+=qn.addLine(s),d=!1,s="",n=0),s+=T,n+=I}else{s.length>0&&(o+=qn.addLine(s),s="",n=0);var A=m===f.length-1;o+=qn.addLine(g,!A),d=!1,s="",n=0}else _+n>p&&(d=!1,o+=qn.addLine(s),s="",n=0),(s.length>0||!qn.isBreakingSpace(g)||d)&&(s+=g,n+=_)}return o+=qn.addLine(s,!1)},qn.addLine=function(t,e){return void 0===e&&(e=!0),t=qn.trimRight(t),t=e?t+"\n":t},qn.getFromCache=function(t,e,r,i){var n=r[t];if(void 0===n){var s=t.length*e;n=i.measureText(t).width+s,r[t]=n}return n},qn.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},qn.collapseNewlines=function(t){return"normal"===t},qn.trimRight=function(t){if("string"!=typeof t)return"";for(var e=t.length-1;e>=0;e--){var r=t[e];if(!qn.isBreakingSpace(r))break;t=t.slice(0,-1)}return t},qn.isNewline=function(t){return"string"==typeof t&&qn._newlines.indexOf(t.charCodeAt(0))>=0},qn.isBreakingSpace=function(t){return"string"==typeof t&&qn._breakingSpaces.indexOf(t.charCodeAt(0))>=0},qn.tokenize=function(t){var e=[],r="";if("string"!=typeof t)return e;for(var i=0;i<t.length;i++){var n=t[i];qn.isBreakingSpace(n)||qn.isNewline(n)?(""!==r&&(e.push(r),r=""),e.push(n)):r+=n}return""!==r&&e.push(r),e},qn.canBreakWords=function(t,e){return e},qn.canBreakChars=function(t,e,r,i,n){return!0},qn.wordWrapSplit=function(t){return t.split("")},qn.measureFont=function(t){if(qn._fonts[t])return qn._fonts[t];var e={},r=qn._canvas,i=qn._context;i.font=t;var n=qn.METRICS_STRING+qn.BASELINE_SYMBOL,s=Math.ceil(i.measureText(n).width),o=Math.ceil(i.measureText(qn.BASELINE_SYMBOL).width),a=2*o;o=o*qn.BASELINE_MULTIPLIER|0,r.width=s,r.height=a,i.fillStyle="#f00",i.fillRect(0,0,s,a),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,o);var h=i.getImageData(0,0,s,a).data,u=h.length,l=4*s,c=0,d=0,p=!1;for(c=0;c<o;++c){for(var f=0;f<l;f+=4)if(255!==h[d+f]){p=!0;break}if(p)break;d+=l}for(e.ascent=o-c,d=u-l,p=!1,c=a;c>o;--c){for(var m=0;m<l;m+=4)if(255!==h[d+m]){p=!0;break}if(p)break;d-=l}return e.descent=c-o,e.fontSize=e.ascent+e.descent,qn._fonts[t]=e,e},qn.clearMetrics=function(t){void 0===t&&(t=""),t?delete qn._fonts[t]:qn._fonts={}};var Kn=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();Kn.width=Kn.height=10,qn._canvas=Kn,qn._context=Kn.getContext("2d"),qn._fonts={},qn.METRICS_STRING="|q",qn.BASELINE_SYMBOL="M",qn.BASELINE_MULTIPLIER=1.4,qn._newlines=[10,13],qn._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Zn={texture:!0,children:!1,baseTexture:!0},Jn=function(t){function e(e,r,i){var n=!1;i||(i=document.createElement("canvas"),n=!0),i.width=3,i.height=3;var s=Ve.from(i);s.orig=new Kt,s.trim=new Kt,t.call(this,s),this._ownCanvas=n,this.canvas=i,this.context=this.canvas.getContext("2d"),this._resolution=G.RESOLUTION,this._autoResolution=!0,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0},style:{configurable:!0},text:{configurable:!0},resolution:{configurable:!0}};return e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var r,i,n=this.context,s=qn.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,h=s.lines,u=s.lineHeight,l=s.lineWidths,c=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil((Math.max(1,o)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;for(var p=e.dropShadow?2:1,f=0;f<p;++f){var m=e.dropShadow&&0===f,g=m?2*a:0,y=g*this.resolution;if(m){n.fillStyle="black",n.strokeStyle="black";var v=e.dropShadowColor,_=tt("number"==typeof v?v:rt(v));n.shadowColor="rgba("+255*_[0]+","+255*_[1]+","+255*_[2]+","+e.dropShadowAlpha+")",n.shadowBlur=e.dropShadowBlur,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+y}else n.fillStyle=this._generateFillStyle(e,h,s),n.strokeStyle=e.stroke,n.shadowColor=0,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var b=0;b<h.length;b++)r=e.strokeThickness/2,i=e.strokeThickness/2+b*u+d.ascent,"right"===e.align?r+=c-l[b]:"center"===e.align&&(r+=(c-l[b])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[b],r+e.padding,i+e.padding-g,!0),e.fill&&this.drawLetterSpacing(h[b],r+e.padding,i+e.padding-g)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,r,i){void 0===i&&(i=!1);var n=this._style.letterSpacing;if(0!==n)for(var s=e,o=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,h=0,u=0;u<o.length;++u){var l=o[u];i?this.context.strokeText(l,s,r):this.context.fillText(l,s,r),s+=a-(h=this.context.measureText(t.substring(u+1)).width)+n,a=h}else i?this.context.strokeText(t,e,r):this.context.fillText(t,e,r)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=Ct(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var r=this._texture,i=this._style,n=i.trim?0:i.padding,s=r.baseTexture;r.trim.width=r._frame.width=Math.ceil(t.width/this._resolution),r.trim.height=r._frame.height=Math.ceil(t.height/this._resolution),r.trim.x=-n,r.trim.y=-n,r.orig.width=r._frame.width-2*n,r.orig.height=r._frame.height-2*n,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e,r){if(!Array.isArray(t.fill))return t.fill;if(1===t.fill.length)return t.fill[0];var i,n=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,o=Math.ceil(this.canvas.width/this._resolution)-n-2*s,a=Math.ceil(this.canvas.height/this._resolution)-n-2*s,h=t.fill.slice(),u=t.fillGradientStops.slice();if(!u.length)for(var l=h.length+1,c=1;c<l;++c)u.push(c/l);if(h.unshift(t.fill[0]),u.unshift(0),h.push(t.fill[t.fill.length-1]),u.push(1),t.fillGradientType===Xn.LINEAR_VERTICAL){i=this.context.createLinearGradient(o/2,s,o/2,a+s);for(var d=0,p=(r.fontProperties.fontSize+t.strokeThickness)/a,f=0;f<e.length;f++)for(var m=r.lineHeight*f,g=0;g<h.length;g++){var y=m/a+("number"==typeof u[g]?u[g]:g/h.length)*p,v=Math.max(d,y);v=Math.min(v,1),i.addColorStop(v,h[g]),d=v}}else{i=this.context.createLinearGradient(s,a/2,o+s,a/2);for(var _=h.length+1,b=1,x=0;x<h.length;x++){var T=void 0;T="number"==typeof u[x]?u[x]:b/_,i.addColorStop(T,h[x]),b++}}return i},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},Zn,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},r.width.get=function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},r.width.set=function(t){this.updateText(!0);var e=yt(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},r.height.get=function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},r.height.set=function(t){this.updateText(!0);var e=yt(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},r.style.get=function(){return this._style},r.style.set=function(t){t=t||{},this._style=t instanceof Vn?t:new Vn(t),this.localStyleID=-1,this.dirty=!0},r.text.get=function(){return this._text},r.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},r.resolution.get=function(){return this._resolution},r.resolution.set=function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},Object.defineProperties(e.prototype,r),e}(jn);
/*!
 * @pixi/prepare - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
G.UPLOADS_PER_FRAME=4;var Qn=function(t){this.maxItemsPerFrame=t,this.itemsLeft=0};Qn.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},Qn.prototype.allowedToUpload=function(){return this.itemsLeft-- >0};var ts=function(t){var e=this;this.limiter=new Qn(G.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(os),this.registerFindHook(as),this.registerFindHook(es),this.registerFindHook(rs),this.registerFindHook(is),this.registerUploadHook(ns),this.registerUploadHook(ss)};function es(t,e){var r=!1;if(t&&t._textures&&t._textures.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof Ve){var n=t._textures[i].baseTexture;-1===e.indexOf(n)&&(e.push(n),r=!0)}return r}function rs(t,e){if(t.baseTexture instanceof Oe){var r=t.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function is(t,e){if(t._texture&&t._texture instanceof Ve){var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function ns(t,e){return e instanceof Jn&&(e.updateText(!0),!0)}function ss(t,e){if(e instanceof Vn){var r=e.toFontString();return qn.measureFont(r),!0}return!1}function os(t,e){if(t instanceof Jn){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function as(t,e){return t instanceof Vn&&(-1===e.indexOf(t)&&e.push(t),!0)}ts.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,ue.system.addOnce(this.tick,this,oe.UTILITY))):e&&e()},ts.prototype.tick=function(){setTimeout(this.delayedTick,0)},ts.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)ue.system.addOnce(this.tick,this,oe.UTILITY);else{this.ticking=!1;var n=this.completes.slice(0);this.completes.length=0;for(var s=0,o=n.length;s<o;s++)n[s]()}},ts.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},ts.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},ts.prototype.add=function(t){for(var e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof ne)for(var i=t.children.length-1;i>=0;i--)this.add(t.children[i]);return this},ts.prototype.destroy=function(){this.ticking&&ue.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null};var hs=function(t){function e(e){t.call(this,e),this.uploadHookHelper=this.renderer,this.registerFindHook(cs),this.registerUploadHook(us),this.registerUploadHook(ls)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ts);function us(t,e){return e instanceof Oe&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function ls(t,e){if(!(e instanceof kn))return!1;var r=e.geometry;e.finishPoly(),r.updateBatches();for(var i=r.batches,n=0;n<i.length;n++){var s=i[n].style.texture;s&&us(t,s.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function cs(t,e){return t instanceof kn&&(e.push(t),!0)}var ds=function(t){this.maxMilliseconds=t,this.frameStart=0};ds.prototype.beginFrame=function(){this.frameStart=Date.now()},ds.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds};
/*!
 * @pixi/spritesheet - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var ps=function(t,e,r){void 0===r&&(r=null),this._texture=t instanceof Ve?t:null,this.baseTexture=t instanceof Oe?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e,this.resolution=this._updateResolution(r||(this.baseTexture.resource?this.baseTexture.resource.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null},fs={BATCH_SIZE:{configurable:!0}};fs.BATCH_SIZE.get=function(){return 1e3},ps.prototype._updateResolution=function(t){var e=this.data.meta.scale,r=Mt(t,null);return null===r&&(r=void 0!==e?parseFloat(e):1),1!==r&&this.baseTexture.setResolution(r),r},ps.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=ps.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},ps.prototype._processFrames=function(t){for(var e=t,r=ps.BATCH_SIZE;e-t<r&&e<this._frameKeys.length;){var i=this._frameKeys[e],n=this._frames[i],s=n.frame;if(s){var o=null,a=null,h=!1!==n.trimmed&&n.sourceSize?n.sourceSize:n.frame,u=new Kt(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);o=n.rotated?new Kt(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new Kt(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),!1!==n.trimmed&&n.spriteSourceSize&&(a=new Kt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[i]=new Ve(this.baseTexture,o,u,a,n.rotated?2:0,n.anchor),Ve.addToCache(this.textures[i],i)}e++}},ps.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var r=0;r<t[e].length;r++){var i=t[e][r];this.animations[e].push(this.textures[i])}}},ps.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},ps.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*ps.BATCH_SIZE),this._batchIndex++,setTimeout((function(){t._batchIndex*ps.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())}),0)},ps.prototype.destroy=function(t){for(var e in void 0===t&&(t=!1),this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture&&this._texture.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},Object.defineProperties(ps,fs);var ms=function(){};ms.use=function(t,e){var r=t.name+"_image";if(t.data&&t.type===hn.TYPE.JSON&&t.data.frames&&!this.resources[r]){var i={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},n=ms.getResourcePath(t,this.baseUrl);this.add(r,n,i,(function(r){if(r.error)e(r.error);else{var i=new ps(r.texture,t.data,t.url);i.parse((function(){t.spritesheet=i,t.textures=i.textures,e()}))}}))}else e()},ms.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:Y.a.resolve(t.url.replace(e,""),t.data.meta.image)};
/*!
 * @pixi/sprite-tiling - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var gs=new Ft,ys=function(t){function e(e,r,i){void 0===r&&(r=100),void 0===i&&(i=100),t.call(this,e),this.tileTransform=new qt,this._width=r,this._height=i,this._canvasPattern=null,this.uvMatrix=e.uvMatrix||new Yr(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={clampMargin:{configurable:!0},tileScale:{configurable:!0},tilePosition:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return r.clampMargin.get=function(){return this.uvMatrix.clampMargin},r.clampMargin.set=function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},r.tileScale.get=function(){return this.tileTransform.scale},r.tileScale.set=function(t){this.tileTransform.scale.copyFrom(t)},r.tilePosition.get=function(){return this.tileTransform.position},r.tilePosition.set=function(t){this.tileTransform.position.copyFrom(t)},e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,r,i)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Kt),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,gs);var e=this._width,r=this._height,i=-e*this.anchor._x;if(gs.x>=i&&gs.x<i+e){var n=-r*this.anchor._y;if(gs.y>=n&&gs.y<n+r)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,r,i){return new e(Ve.from(t),r,i)},e.fromFrame=function(t,r,i){var n=Et[t];if(!n)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(n,r,i)},e.fromImage=function(t,r,i,n){return n&&"object"!=typeof n&&(n={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}),new e(Ve.from(t,n),r,i)},r.width.get=function(){return this._width},r.width.set=function(t){this._width=t},r.height.get=function(){return this._height},r.height.set=function(t){this._height=t},Object.defineProperties(e.prototype,r),e}(jn),vs="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",_s=new jt,bs=function(t){function e(e){t.call(this,e);var r={globals:this.renderer.globalUniforms};this.shader=Gr.from(vs,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord - floor(vTextureCoord - uClampOffset);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",r),this.simpleShader=Gr.from(vs,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",r),this.quad=new nr,this.state=Vr.for2d()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=this.renderer,r=this.quad,i=r.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((i=r.uvs)[0]=i[6]=-t.anchor.x,i[1]=i[3]=-t.anchor.y,i[2]=i[4]=1-t.anchor.x,i[5]=i[7]=1-t.anchor.y),r.invalidate();var n=t._texture,s=n.baseTexture,o=t.tileTransform.localTransform,a=t.uvMatrix,h=s.isPowerOfTwo&&n.frame.width===s.width&&n.frame.height===s.height;h&&(s._glTextures[e.CONTEXT_UID]?h=s.wrapMode!==L.CLAMP:s.wrapMode===L.CLAMP&&(s.wrapMode=L.REPEAT));var u=h?this.simpleShader:this.shader,l=n.width,c=n.height,d=t._width,p=t._height;_s.set(o.a*l/d,o.b*l/p,o.c*c/d,o.d*c/p,o.tx/d,o.ty/p),_s.invert(),h?_s.prepend(a.mapCoord):(u.uniforms.uMapCoord=a.mapCoord.toArray(!0),u.uniforms.uClampFrame=a.uClampFrame,u.uniforms.uClampOffset=a.uClampOffset),u.uniforms.uTransform=_s.toArray(!0),u.uniforms.uColor=ht(t.tint,t.worldAlpha,u.uniforms.uColor,s.alphaMode),u.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),u.uniforms.uSampler=n,e.shader.bind(u),e.geometry.bind(r),this.state.blendMode=st(t.blendMode,s.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e}(ur),xs=function(t){function e(e,r){var i=this;void 0===r&&(r={}),t.call(this),this._textWidth=0,this._textHeight=0,this._glyphs=[],this._font={tint:void 0!==r.tint?r.tint:16777215,align:r.align||"left",name:null,size:0},this.font=r.font,this._text=e,this._maxWidth=0,this._maxLineHeight=0,this._letterSpacing=0,this._anchor=new Lt((function(){i.dirty=!0}),this,0,0),this.dirty=!1,this.roundPixels=G.ROUND_PIXELS,this.updateText()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={tint:{configurable:!0},align:{configurable:!0},anchor:{configurable:!0},font:{configurable:!0},text:{configurable:!0},maxWidth:{configurable:!0},maxLineHeight:{configurable:!0},textWidth:{configurable:!0},letterSpacing:{configurable:!0},textHeight:{configurable:!0}};return e.prototype.updateText=function(){for(var t=e.fonts[this._font.name],r=this._font.size/t.size,i=new Ft,n=[],s=[],o=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",a=o.length,h=this._maxWidth*t.size/this._font.size,u=null,l=0,c=0,d=0,p=-1,f=0,m=0,g=0,y=0;y<a;y++){var v=o.charCodeAt(y),_=o.charAt(y);if(/(?:\s)/.test(_)&&(p=y,f=l),"\r"!==_&&"\n"!==_){var b=t.chars[v];b&&(u&&b.kerning[u]&&(i.x+=b.kerning[u]),n.push({texture:b.texture,line:d,charCode:v,position:new Ft(i.x+b.xOffset+this._letterSpacing/2,i.y+b.yOffset)}),i.x+=b.xAdvance+this._letterSpacing,l=i.x,g=Math.max(g,b.yOffset+b.texture.height),u=v,-1!==p&&h>0&&i.x>h&&(gt(n,1+p-++m,1+y-p),y=p,p=-1,s.push(f),c=Math.max(c,f),d++,i.x=0,i.y+=t.lineHeight,u=null))}else s.push(l),c=Math.max(c,l),++d,++m,i.x=0,i.y+=t.lineHeight,u=null}var x=o.charAt(o.length-1);"\r"!==x&&"\n"!==x&&(/(?:\s)/.test(x)&&(l=f),s.push(l),c=Math.max(c,l));for(var T=[],E=0;E<=d;E++){var w=0;"right"===this._font.align?w=c-s[E]:"center"===this._font.align&&(w=(c-s[E])/2),T.push(w)}for(var S=n.length,I=this.tint,A=0;A<S;A++){var C=this._glyphs[A];C?C.texture=n[A].texture:((C=new jn(n[A].texture)).roundPixels=this.roundPixels,this._glyphs.push(C)),C.position.x=(n[A].position.x+T[n[A].line])*r,C.position.y=n[A].position.y*r,C.scale.x=C.scale.y=r,C.tint=I,C.parent||this.addChild(C)}for(var O=S;O<this._glyphs.length;++O)this.removeChild(this._glyphs[O]);if(this._textWidth=c*r,this._textHeight=(i.y+t.lineHeight)*r,0!==this.anchor.x||0!==this.anchor.y)for(var R=0;R<S;R++)this._glyphs[R].x-=this._textWidth*this.anchor.x,this._glyphs[R].y-=this._textHeight*this.anchor.y;this._maxLineHeight=g*r},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},r.tint.get=function(){return this._font.tint},r.tint.set=function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0},r.align.get=function(){return this._font.align},r.align.set=function(t){this._font.align=t||"left",this.dirty=!0},r.anchor.get=function(){return this._anchor},r.anchor.set=function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},r.font.get=function(){return this._font},r.font.set=function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):e.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)},r.text.get=function(){return this._text},r.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},r.maxWidth.get=function(){return this._maxWidth},r.maxWidth.set=function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},r.maxLineHeight.get=function(){return this.validate(),this._maxLineHeight},r.textWidth.get=function(){return this.validate(),this._textWidth},r.letterSpacing.get=function(){return this._letterSpacing},r.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},r.textHeight.get=function(){return this.validate(),this._textHeight},e.registerFont=function(t,r){var i={},n=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0],o=t.getElementsByTagName("page"),a=Mt(o[0].getAttribute("file")),h={};i.font=n.getAttribute("face"),i.size=parseInt(n.getAttribute("size"),10),i.lineHeight=parseInt(s.getAttribute("lineHeight"),10)/a,i.chars={},r instanceof Ve&&(r=[r]);for(var u=0;u<o.length;u++){var l=o[u].getAttribute("id"),c=o[u].getAttribute("file");h[l]=r instanceof Array?r[u]:r[c]}for(var d=t.getElementsByTagName("char"),p=0;p<d.length;p++){var f=d[p],m=parseInt(f.getAttribute("id"),10),g=f.getAttribute("page")||0,y=new Kt(parseInt(f.getAttribute("x"),10)/a+h[g].frame.x/a,parseInt(f.getAttribute("y"),10)/a+h[g].frame.y/a,parseInt(f.getAttribute("width"),10)/a,parseInt(f.getAttribute("height"),10)/a);i.chars[m]={xOffset:parseInt(f.getAttribute("xoffset"),10)/a,yOffset:parseInt(f.getAttribute("yoffset"),10)/a,xAdvance:parseInt(f.getAttribute("xadvance"),10)/a,kerning:{},texture:new Ve(h[g].baseTexture,y),page:g}}for(var v=t.getElementsByTagName("kerning"),_=0;_<v.length;_++){var b=v[_],x=parseInt(b.getAttribute("first"),10)/a,T=parseInt(b.getAttribute("second"),10)/a,E=parseInt(b.getAttribute("amount"),10)/a;i.chars[T]&&(i.chars[T].kerning[x]=E)}return e.fonts[i.font]=i,i},Object.defineProperties(e.prototype,r),e}(ne);xs.fonts={};var Ts=function(){};Ts.parse=function(t,e){t.bitmapFont=xs.registerFont(t.data,e)},Ts.add=function(){hn.setExtensionXhrType("fnt",hn.XHR_RESPONSE_TYPE.DOCUMENT)},Ts.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},Ts.use=function(t,e){if(t.data&&t.type===hn.TYPE.XML)if(0!==t.data.getElementsByTagName("page").length&&0!==t.data.getElementsByTagName("info").length&&null!==t.data.getElementsByTagName("info")[0].getAttribute("face")){var r=t.isDataUrl?"":Ts.dirname(t.url);t.isDataUrl&&("."===r&&(r=""),this.baseUrl&&r&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(r+="/")),(r=r.replace(this.baseUrl,""))&&"/"!==r.charAt(r.length-1)&&(r+="/");for(var i=t.data.getElementsByTagName("page"),n={},s=function(r){n[r.metadata.pageFile]=r.texture,Object.keys(n).length===i.length&&(Ts.parse(t,n),e())},o=0;o<i.length;++o){var a=i[o].getAttribute("file"),h=r+a,u=!1;for(var l in this.resources){var c=this.resources[l];if(c.url===h){c.metadata.pageFile=a,c.texture?s(c):c.onAfterMiddleware.add(s),u=!0;break}}if(!u){var d={crossOrigin:t.crossOrigin,loadType:hn.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:a},t.metadata.imageMetadata),parentResource:t};this.add(h,d,s)}}}else e();else e()};
/*!
 * @pixi/filter-alpha - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Es=function(t){function e(e){void 0===e&&(e=1),t.call(this,yi,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={alpha:{configurable:!0}};return r.alpha.get=function(){return this.uniforms.uAlpha},r.alpha.set=function(t){this.uniforms.uAlpha=t},Object.defineProperties(e.prototype,r),e}($r);var ws={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Ss=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");var Is=function(t){function e(e,r,i,n,s){var o=function(t,e){var r,i=Math.ceil(t/2),n="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";r=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<t;o++){var a=r.replace("%index%",o);s+=a=a.replace("%sampleIndex%",o-(i-1)+".0"),s+="\n"}return n=(n=n.replace("%blur%",s)).replace("%size%",t)}(s=s||5,e),a=function(t){for(var e,r=ws[t],i=r.length,n=Ss,s="",o=0;o<t;o++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o);e=o,o>=i&&(e=t-o-1),s+=a=a.replace("%value%",r[e]),s+="\n"}return n=(n=n.replace("%blur%",s)).replace("%size%",t)}(s);t.call(this,o,a),this.horizontal=e,this.resolution=n||G.RESOLUTION,this._quality=0,this.quality=i||4,this.blur=r||8}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blur:{configurable:!0},quality:{configurable:!0}};return e.prototype.apply=function(t,e,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/e.width):this.uniforms.strength=1/r.height*(r.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,r,i);else{var n=t.getFilterTexture(),s=t.renderer,o=e,a=n;this.state.blend=!1,t.applyFilter(this,o,a,!0);for(var h=1;h<this.passes-1;h++){s.renderTexture.bind(o,o.filterFrame),this.uniforms.uSampler=a;var u=a;a=o,o=u,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,r,i),t.returnFilterTexture(n)}},r.blur.get=function(){return this.strength},r.blur.set=function(t){this.padding=1+2*Math.abs(t),this.strength=t},r.quality.get=function(){return this._quality},r.quality.set=function(t){this._quality=t,this.passes=t},Object.defineProperties(e.prototype,r),e}($r),As=function(t){function e(e,r,i,n){t.call(this),this.blurXFilter=new Is(!0,e,r,i,n),this.blurYFilter=new Is(!1,e,r,i,n),this.resolution=i||G.RESOLUTION,this.quality=r||4,this.blur=e||8,this.repeatEdgePixels=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blur:{configurable:!0},quality:{configurable:!0},blurX:{configurable:!0},blurY:{configurable:!0},blendMode:{configurable:!0},repeatEdgePixels:{configurable:!0}};return e.prototype.apply=function(t,e,r,i){var n=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(n&&s){var o=t.getFilterTexture();this.blurXFilter.apply(t,e,o,!0),this.blurYFilter.apply(t,o,r,i),t.returnFilterTexture(o)}else s?this.blurYFilter.apply(t,e,r,i):this.blurXFilter.apply(t,e,r,i)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},r.blur.get=function(){return this.blurXFilter.blur},r.blur.set=function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},r.quality.get=function(){return this.blurXFilter.quality},r.quality.set=function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},r.blurX.get=function(){return this.blurXFilter.blur},r.blurX.set=function(t){this.blurXFilter.blur=t,this.updatePadding()},r.blurY.get=function(){return this.blurYFilter.blur},r.blurY.set=function(t){this.blurYFilter.blur=t,this.updatePadding()},r.blendMode.get=function(){return this.blurYFilter.blendMode},r.blendMode.set=function(t){this.blurYFilter.blendMode=t},r.repeatEdgePixels.get=function(){return this._repeatEdgePixels},r.repeatEdgePixels.set=function(t){this._repeatEdgePixels=t,this.updatePadding()},Object.defineProperties(e.prototype,r),e}($r),Cs=function(t){function e(){var e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};t.call(this,vi,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",e),this.alpha=1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={matrix:{configurable:!0},alpha:{configurable:!0}};return e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var r=t;e&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r},e.prototype._multiply=function(t,e,r){return t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15],t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16],t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17],t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18],t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4],t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15],t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16],t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17],t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18],t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9],t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15],t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16],t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17],t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18],t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14],t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15],t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16],t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17],t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18],t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.greyscale=function(t,e){var r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var r=Math.cos(t),i=Math.sin(t),n=1/3,s=(0,Math.sqrt)(n),o=[r+(1-r)*n,n*(1-r)-s*i,n*(1-r)+s*i,0,0,n*(1-r)+s*i,r+n*(1-r),n*(1-r)-s*i,0,0,n*(1-r)-s*i,n*(1-r)+s*i,r+n*(1-r),0,0,0,0,0,1,0];this._loadMatrix(o,e)},e.prototype.contrast=function(t,e){var r=(t||0)+1,i=-.5*(r-1),n=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var r=2*t/3+1,i=-.5*(r-1),n=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,r,i,n){var s=((r=r||16770432)>>16&255)/255,o=(r>>8&255)/255,a=(255&r)/255,h=((i=i||3375104)>>16&255)/255,u=(i>>8&255)/255,l=(255&i)/255,c=[.3,.59,.11,0,0,s,o,a,t=t||.2,0,h,u,l,e=e||.15,0,s-h,o-u,a-l,0,0];this._loadMatrix(c,n)},e.prototype.night=function(t,e){var r=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.predator=function(t,e){var r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},r.matrix.get=function(){return this.uniforms.m},r.matrix.set=function(t){this.uniforms.m=t},r.alpha.get=function(){return this.uniforms.uAlpha},r.alpha.set=function(t){this.uniforms.uAlpha=t},Object.defineProperties(e.prototype,r),e}($r);Cs.prototype.grayscale=Cs.prototype.greyscale;
/*!
 * @pixi/filter-displacement - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Os=function(t){function e(e,r){var i=new jt;e.renderable=!1,t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=i,null==r&&(r=20),this.scale=new Ft(r,r)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={map:{configurable:!0}};return e.prototype.apply=function(t,e,r,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var n=this.maskSprite.transform.worldTransform,s=Math.sqrt(n.a*n.a+n.b*n.b),o=Math.sqrt(n.c*n.c+n.d*n.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=n.a/s,this.uniforms.rotation[1]=n.b/s,this.uniforms.rotation[2]=n.c/o,this.uniforms.rotation[3]=n.d/o),t.applyFilter(this,e,r,i)},r.map.get=function(){return this.uniforms.mapSampler},r.map.set=function(t){this.uniforms.mapSampler=t},Object.defineProperties(e.prototype,r),e}($r),Rs=function(t){function e(){t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}($r),Ns=function(t){function e(e,r){void 0===e&&(e=.5),void 0===r&&(r=Math.random()),t.call(this,vi,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={noise:{configurable:!0},seed:{configurable:!0}};return r.noise.get=function(){return this.uniforms.uNoise},r.noise.set=function(t){this.uniforms.uNoise=t},r.seed.get=function(){return this.uniforms.uSeed},r.seed.set=function(t){this.uniforms.uSeed=t},Object.defineProperties(e.prototype,r),e}($r),Ps=new jt;re.prototype._cacheAsBitmap=!1,re.prototype._cacheData=!1;var Ms=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(re.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Ms),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),re.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},re.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.batch.flush();var r=this.getLocalBounds().clone();if(this.filters){var i=this.filters[0].padding;r.pad(i)}r.ceil(G.RESOLUTION);var n=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.projection.transform,a=$e.create(r.width,r.height),h="cacheAsBitmap_"+_t();this._cacheData.textureCacheId=h,Oe.addToCache(a.baseTexture,h),Ve.addToCache(a,h);var u=Ps;u.tx=-r.x,u.ty=-r.y,this.transform.worldTransform.identity(),this.render=this._cacheData.originalRender,t.render(this,a,!0,u,!0),t.projection.transform=o,t.renderTexture.bind(n,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var l=new jn(a);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-r.x/r.width,l.anchor.y=-r.y/r.height,l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},re.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},re.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),r=this.alpha;this.alpha=1;var i=t.context,n=t._projTransform;e.ceil(G.RESOLUTION);var s=$e.create(e.width,e.height),o="cacheAsBitmap_"+_t();this._cacheData.textureCacheId=o,Oe.addToCache(s.baseTexture,o),Ve.addToCache(s,o);var a=Ps;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,s,!0,a,!1),t.context=i,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var h=new jn(s);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},re.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._lastBoundsID=this._boundsID},re.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},re.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Oe.removeFromCache(this._cacheData.textureCacheId),Ve.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},re.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},
/*!
 * @pixi/mixin-get-child-by-name - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
re.prototype.name=null,ne.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null},
/*!
 * @pixi/mixin-get-global-position - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
re.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new Ft),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};
/*!
 * @pixi/mesh - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Ds=function(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0};Ds.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}};var Fs=new Ft,Ls=new Qt,ks=function(t){function e(e,r,i,n){void 0===n&&(n=N.TRIANGLES),t.call(this),this.geometry=e,e.refCount++,this.shader=r,this.state=i||Vr.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=0,this._transformID=-1,this.tint=16777215,this.blendMode=R.NORMAL,this._roundPixels=G.ROUND_PIXELS,this.batchUvs=null}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={uvBuffer:{configurable:!0},verticesBuffer:{configurable:!0},material:{configurable:!0},blendMode:{configurable:!0},roundPixels:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return r.uvBuffer.get=function(){return this.geometry.buffers[1]},r.verticesBuffer.get=function(){return this.geometry.buffers[0]},r.material.set=function(t){this.shader=t},r.material.get=function(){return this.shader},r.blendMode.set=function(t){this.state.blendMode=t},r.blendMode.get=function(){return this.state.blendMode},r.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},r.roundPixels.get=function(){return this._roundPixels},r.tint.get=function(){return this.shader.tint},r.tint.set=function(t){this.shader.tint=t},r.texture.get=function(){return this.shader.texture},r.texture.set=function(t){this.shader.texture=t},e.prototype._render=function(t){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===N.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var r=this.transform.worldTransform,i=r.a,n=r.b,s=r.c,o=r.d,a=r.tx,h=r.ty,u=this.vertexData,l=0;l<u.length/2;l++){var c=e[2*l],d=e[2*l+1];u[2*l]=i*c+s*d+a,u[2*l+1]=n*c+o*d+h}if(this._roundPixels)for(var p=G.RESOLUTION,f=0;f<u.length;++f)u[f]=Math.round((u[f]*p|0)/p);this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Ds(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Fs);for(var e=this.geometry.getBuffer("aVertexPosition").data,r=Ls.points,i=this.geometry.getIndex().data,n=i.length,s=4===this.drawMode?3:1,o=0;o+2<n;o+=s){var a=2*i[o],h=2*i[o+1],u=2*i[o+2];if(r[0]=e[a],r[1]=e[a+1],r[2]=e[h],r[3]=e[h+1],r[4]=e[u],r[5]=e[u+1],Ls.contains(Fs.x,Fs.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Object.defineProperties(e.prototype,r),e}(ne);ks.BATCHABLE_SIZE=100;var Us=function(t){function e(e,r){var i={uSampler:e,alpha:1,uTextureMatrix:jt.IDENTITY,uColor:new Float32Array([1,1,1,1])};(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(i,r.uniforms),t.call(this,r.program||jr.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),i),this._colorDirty=!1,this.uvMatrix=new Yr(e),this.batchable=void 0===r.program,this.pluginName=r.pluginName,this.tint=r.tint,this.alpha=r.alpha}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={texture:{configurable:!0},alpha:{configurable:!0},tint:{configurable:!0}};return r.texture.get=function(){return this.uniforms.uSampler},r.texture.set=function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},r.alpha.set=function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},r.alpha.get=function(){return this._alpha},r.tint.set=function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},r.tint.get=function(){return this._tint},e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;ht(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},Object.defineProperties(e.prototype,r),e}(Gr),Bs=function(t){function e(e,r,i){t.call(this);var n=new Ke(e),s=new Ke(r,!0),o=new Ke(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,D.FLOAT).addAttribute("aTextureCoord",s,2,!1,D.FLOAT).addIndex(o),this._updateId=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={vertexDirtyId:{configurable:!0}};return r.vertexDirtyId.get=function(){return this.buffers[0]._updateID},Object.defineProperties(e.prototype,r),e}(rr),js=function(t){function e(e,r,i,n){void 0===e&&(e=100),void 0===r&&(r=100),void 0===i&&(i=10),void 0===n&&(n=10),t.call(this),this.segWidth=i,this.segHeight=n,this.width=e,this.height=r,this.build()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],r=[],i=[],n=this.segWidth-1,s=this.segHeight-1,o=this.width/n,a=this.height/s,h=0;h<t;h++){var u=h%this.segWidth,l=h/this.segWidth|0;e.push(u*o,l*a),r.push(u/n,l/s)}for(var c=n*s,d=0;d<c;d++){var p=d%n,f=d/n|0,m=f*this.segWidth+p,g=f*this.segWidth+p+1,y=(f+1)*this.segWidth+p,v=(f+1)*this.segWidth+p+1;i.push(m,g,y,g,v,y)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(Bs),Xs=function(t){function e(e,r,i){void 0===e&&(e=200),void 0===i&&(i=0),t.call(this,new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1))),this.points=r,this.width=e,this.textureScale=i,this.build()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),i=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),r.data=new Float32Array(4*t.length),i.data=new Uint16Array(6*(t.length-1)));var n=r.data,s=i.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;for(var o=0,a=t[0],h=this.width*this.textureScale,u=t.length,l=0;l<u;l++){var c=4*l;if(this.textureScale>0){var d=a.x-t[l].x,p=a.y-t[l].y,f=Math.sqrt(d*d+p*p);a=t[l],o+=f/h}else o=l/(u-1);n[c]=o,n[c+1]=0,n[c+2]=o,n[c+3]=1}for(var m=0,g=0;g<u-1;g++){var y=2*g;s[m++]=y,s[m++]=y+1,s[m++]=y+2,s[m++]=y+2,s[m++]=y+1,s[m++]=y+3}r.update(),i.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,r=t[0],i=0,n=0,s=this.buffers[0].data,o=t.length,a=0;a<o;a++){var h=t[a],u=4*a;n=-((e=a<t.length-1?t[a+1]:h).x-r.x),i=e.y-r.y;var l=Math.sqrt(i*i+n*n),c=this.textureScale>0?this.textureScale*this.width/2:this.width/2;i/=l,n/=l,i*=c,n*=c,s[u]=h.x+i,s[u+1]=h.y+n,s[u+2]=h.x-i,s[u+3]=h.y-n,r=h}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(Bs),Gs=function(t){function e(e,r,i){void 0===i&&(i=0);var n=new Xs(e.height,r,i),s=new Us(e);i>0&&(e.baseTexture.wrapMode=L.REPEAT),t.call(this,n,s),this.autoUpdate=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._render=function(e){(this.autoUpdate||this.geometry.width!==this.shader.texture.height)&&(this.geometry.width=this.shader.texture.height,this.geometry.update()),t.prototype._render.call(this,e)},e}(ks),zs=function(t){function e(e,r,i){var n=new js(e.width,e.height,r,i),s=new Us(Ve.WHITE);t.call(this,n,s),this.texture=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={texture:{configurable:!0}};return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this.geometry.width=this.shader.texture.width,this.geometry.height=this.shader.texture.height,this.geometry.build()},r.texture.set=function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},r.texture.get=function(){return this.shader.texture},e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},Object.defineProperties(e.prototype,r),e}(ks),Vs=function(t){function e(e,r,i,n,s){void 0===e&&(e=Ve.EMPTY);var o=new Bs(r,i,n);o.getBuffer("aVertexPosition").static=!1;var a=new Us(e);t.call(this,o,a,null,s),this.autoUpdate=!0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={vertices:{configurable:!0}};return r.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data},r.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},Object.defineProperties(e.prototype,r),e}(ks),Hs=function(t){function e(e,r,i,n,s){t.call(this,Ve.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=void 0!==r?r:10,this._rightWidth=void 0!==n?n:10,this._topHeight=void 0!==i?i:10,this._bottomHeight=void 0!==s?s:10,this.texture=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={vertices:{configurable:!0},width:{configurable:!0},height:{configurable:!0},leftWidth:{configurable:!0},rightWidth:{configurable:!0},topHeight:{configurable:!0},bottomHeight:{configurable:!0}};return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},r.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data},r.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,r=this._topHeight+this._bottomHeight,i=this._height>r?1:this._height/r;return Math.min(e,i)},r.width.get=function(){return this._width},r.width.set=function(t){this._width=t,this._refresh()},r.height.get=function(){return this._height},r.height.set=function(t){this._height=t,this._refresh()},r.leftWidth.get=function(){return this._leftWidth},r.leftWidth.set=function(t){this._leftWidth=t,this._refresh()},r.rightWidth.get=function(){return this._rightWidth},r.rightWidth.set=function(t){this._rightWidth=t,this._refresh()},r.topHeight.get=function(){return this._topHeight},r.topHeight.set=function(t){this._topHeight=t,this._refresh()},r.bottomHeight.get=function(){return this._bottomHeight},r.bottomHeight.set=function(t){this._bottomHeight=t,this._refresh()},e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var r=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=r*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-r*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},Object.defineProperties(e.prototype,r),e}(zs),$s=function(t){function e(e,r){t.call(this,e[0]instanceof Ve?e[0]:e[0].texture),this._textures=null,this._durations=null,this._autoUpdate=!1!==r,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={totalFrames:{configurable:!0},textures:{configurable:!0},currentFrame:{configurable:!0},playing:{configurable:!0},autoUpdate:{configurable:!0}};return e.prototype.stop=function(){this.playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(ue.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this.playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(ue.shared.add(this.update,this,oe.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,r=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r?this.onLoop():this.animationSpeed<0&&this.currentFrame>r&&this.onLoop()),this.updateTexture())},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var r=[],i=0;i<t.length;++i)r.push(Ve.from(t[i]));return new e(r)},e.fromImages=function(t){for(var r=[],i=0;i<t.length;++i)r.push(Ve.from(t[i]));return new e(r)},r.totalFrames.get=function(){return this._textures.length},r.textures.get=function(){return this._textures},r.textures.set=function(t){if(t[0]instanceof Ve)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},r.currentFrame.get=function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},r.playing.get=function(){return this._playing},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(ue.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(ue.shared.add(this.update,this),this._isConnectedToTicker=!0))},Object.defineProperties(e.prototype,r),e}(jn),Ws="5.0.0";function Ys(){var t=this;Object.defineProperties(t,{SVG_SIZE:{get:function(){return xt(Ws,"PIXI.utils.SVG_SIZE property has moved to PIXI.resources.SVGResource.SVG_SIZE"),t.SVGResource.SVG_SIZE}},TransformStatic:{get:function(){return xt(Ws,"PIXI.TransformStatic class has been removed, use PIXI.Transform"),t.Transform}},TransformBase:{get:function(){return xt(Ws,"PIXI.TransformBase class has been removed, use PIXI.Transform"),t.Transform}},TRANSFORM_MODE:{get:function(){return xt(Ws,"PIXI.TRANSFORM_MODE property has been removed"),{STATIC:0,DYNAMIC:1}}},WebGLRenderer:{get:function(){return xt(Ws,"PIXI.WebGLRenderer class has moved to PIXI.Renderer"),t.Renderer}},CanvasRenderTarget:{get:function(){return xt(Ws,"PIXI.CanvasRenderTarget class has moved to PIXI.utils.CanvasRenderTarget"),t.utils.CanvasRenderTarget}},loader:{get:function(){return xt(Ws,"PIXI.loader instance has moved to PIXI.Loader.shared"),t.Loader.shared}},FilterManager:{get:function(){return xt(Ws,"PIXI.FilterManager class has moved to PIXI.systems.FilterSystem"),t.systems.FilterSystem}},CanvasTinter:{get:function(){return xt("5.2.0","PIXI.CanvasTinter namespace has moved to PIXI.canvasUtils"),t.canvasUtils}},GroupD8:{get:function(){return xt("5.2.0","PIXI.GroupD8 namespace has moved to PIXI.groupD8"),t.groupD8}}}),t.prepare={},Object.defineProperties(t.prepare,{BasePrepare:{get:function(){return xt("5.2.1","PIXI.prepare.BasePrepare moved to PIXI.BasePrepare"),t.BasePrepare}},Prepare:{get:function(){return xt("5.2.1","PIXI.prepare.Prepare moved to PIXI.Prepare"),t.Prepare}},CanvasPrepare:{get:function(){return xt("5.2.1","PIXI.prepare.CanvasPrepare moved to PIXI.CanvasPrepare"),t.CanvasPrepare}}}),t.extract={},Object.defineProperties(t.extract,{Extract:{get:function(){return xt("5.2.1","PIXI.extract.Extract moved to PIXI.Extract"),t.Extract}},CanvasExtract:{get:function(){return xt("5.2.1","PIXI.extract.CanvasExtract moved to PIXI.CanvasExtract"),t.CanvasExtract}}}),t.extras={},Object.defineProperties(t.extras,{TilingSprite:{get:function(){return xt(Ws,"PIXI.extras.TilingSprite class has moved to PIXI.TilingSprite"),t.TilingSprite}},TilingSpriteRenderer:{get:function(){return xt(Ws,"PIXI.extras.TilingSpriteRenderer class has moved to PIXI.TilingSpriteRenderer"),t.TilingSpriteRenderer}},AnimatedSprite:{get:function(){return xt(Ws,"PIXI.extras.AnimatedSprite class has moved to PIXI.AnimatedSprite"),t.AnimatedSprite}},BitmapText:{get:function(){return xt(Ws,"PIXI.extras.BitmapText class has moved to PIXI.BitmapText"),t.BitmapText}}}),Object.defineProperties(t.utils,{getSvgSize:{get:function(){return xt(Ws,"PIXI.utils.getSvgSize function has moved to PIXI.resources.SVGResource.getSize"),t.SVGResource.getSize}}}),t.mesh={},Object.defineProperties(t.mesh,{Mesh:{get:function(){return xt(Ws,"PIXI.mesh.Mesh class has moved to PIXI.SimpleMesh"),t.SimpleMesh}},NineSlicePlane:{get:function(){return xt(Ws,"PIXI.mesh.NineSlicePlane class has moved to PIXI.NineSlicePlane"),t.NineSlicePlane}},Plane:{get:function(){return xt(Ws,"PIXI.mesh.Plane class has moved to PIXI.SimplePlane"),t.SimplePlane}},Rope:{get:function(){return xt(Ws,"PIXI.mesh.Rope class has moved to PIXI.SimpleRope"),t.SimpleRope}},RawMesh:{get:function(){return xt(Ws,"PIXI.mesh.RawMesh class has moved to PIXI.Mesh"),t.Mesh}},CanvasMeshRenderer:{get:function(){return xt(Ws,"PIXI.mesh.CanvasMeshRenderer class has moved to PIXI.CanvasMeshRenderer"),t.CanvasMeshRenderer}},MeshRenderer:{get:function(){return xt(Ws,"PIXI.mesh.MeshRenderer class has moved to PIXI.MeshRenderer"),t.MeshRenderer}}}),t.particles={},Object.defineProperties(t.particles,{ParticleContainer:{get:function(){return xt(Ws,"PIXI.particles.ParticleContainer class has moved to PIXI.ParticleContainer"),t.ParticleContainer}},ParticleRenderer:{get:function(){return xt(Ws,"PIXI.particles.ParticleRenderer class has moved to PIXI.ParticleRenderer"),t.ParticleRenderer}}}),t.ticker={},Object.defineProperties(t.ticker,{Ticker:{get:function(){return xt(Ws,"PIXI.ticker.Ticker class has moved to PIXI.Ticker"),t.Ticker}},shared:{get:function(){return xt(Ws,"PIXI.ticker.shared instance has moved to PIXI.Ticker.shared"),t.Ticker.shared}}}),t.loaders={},Object.defineProperties(t.loaders,{Loader:{get:function(){return xt(Ws,"PIXI.loaders.Loader class has moved to PIXI.Loader"),t.Loader}},Resource:{get:function(){return xt(Ws,"PIXI.loaders.Resource class has moved to PIXI.LoaderResource"),t.LoaderResource}},bitmapFontParser:{get:function(){return xt(Ws,"PIXI.loaders.bitmapFontParser function has moved to PIXI.BitmapFontLoader.use"),t.BitmapFontLoader.use}},parseBitmapFontData:{get:function(){return xt(Ws,"PIXI.loaders.parseBitmapFontData function has moved to PIXI.BitmapFontLoader.parse"),t.BitmapFontLoader.parse}},spritesheetParser:{get:function(){return xt(Ws,"PIXI.loaders.spritesheetParser function has moved to PIXI.SpritesheetLoader.use"),t.SpritesheetLoader.use}},getResourcePath:{get:function(){return xt(Ws,"PIXI.loaders.getResourcePath property has moved to PIXI.SpritesheetLoader.getResourcePath"),t.SpritesheetLoader.getResourcePath}}}),t.Loader.addPixiMiddleware=function(e){return xt(Ws,"PIXI.loaders.Loader.addPixiMiddleware function is deprecated, use PIXI.loaders.Loader.registerPlugin"),t.loaders.Loader.registerPlugin({use:e()})},Object.defineProperty(t.extract,"WebGLExtract",{get:function(){return xt(Ws,"PIXI.extract.WebGLExtract method has moved to PIXI.Extract"),t.Extract}}),Object.defineProperty(t.prepare,"WebGLPrepare",{get:function(){return xt(Ws,"PIXI.prepare.WebGLPrepare class has moved to PIXI.Prepare"),t.Prepare}}),t.Container.prototype._renderWebGL=function(t){xt(Ws,"PIXI.Container._renderWebGL method has moved to PIXI.Container._render"),this._render(t)},t.Container.prototype.renderWebGL=function(t){xt(Ws,"PIXI.Container.renderWebGL method has moved to PIXI.Container.render"),this.render(t)},t.DisplayObject.prototype.renderWebGL=function(t){xt(Ws,"PIXI.DisplayObject.renderWebGL method has moved to PIXI.DisplayObject.render"),this.render(t)},t.Container.prototype.renderAdvancedWebGL=function(t){xt(Ws,"PIXI.Container.renderAdvancedWebGL method has moved to PIXI.Container.renderAdvanced"),this.renderAdvanced(t)},Object.defineProperties(t.settings,{TRANSFORM_MODE:{get:function(){return xt(Ws,"PIXI.settings.TRANSFORM_MODE property has been removed"),0},set:function(){xt(Ws,"PIXI.settings.TRANSFORM_MODE property has been removed")}}});var e=t.BaseTexture;e.prototype.loadSource=function(e){xt(Ws,"PIXI.BaseTexture.loadSource method has been deprecated");var r=t.resources.autoDetectResource(e);r.internal=!0,this.setResource(r),this.update()};var r=!1;Object.defineProperties(e.prototype,{hasLoaded:{get:function(){return xt(Ws,"PIXI.BaseTexture.hasLoaded property has been removed, use PIXI.BaseTexture.valid"),this.valid}},imageUrl:{get:function(){return xt(Ws,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&this.resource.url},set:function(t){xt(Ws,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&(this.resource.url=t)}},source:{get:function(){return xt(Ws,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source`"),this.resource&&this.resource.source},set:function(t){xt(Ws,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source` if you want to set HTMLCanvasElement. Otherwise, create new BaseTexture."),this.resource&&(this.resource.source=t)}},premultiplyAlpha:{get:function(){return xt("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){xt("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}},_id:{get:function(){return r||(xt("5.2.0","PIXI.BaseTexture._id batch local field has been changed to `_batchLocation`"),r=!0),this._batchLocation},set:function(t){this._batchLocation=t}}}),e.fromImage=function(t,r,i,n){xt(Ws,"PIXI.BaseTexture.fromImage method has been replaced with PIXI.BaseTexture.from");var s={scale:n,crossorigin:r};return e.from(t,{scaleMode:i,resourceOptions:s})},e.fromCanvas=function(t,r){return xt(Ws,"PIXI.BaseTexture.fromCanvas method has been replaced with PIXI.BaseTexture.from"),e.from(t,{scaleMode:r})},e.fromSVG=function(t,r,i,n){xt(Ws,"PIXI.BaseTexture.fromSVG method has been replaced with PIXI.BaseTexture.from");var s={scale:n,crossorigin:r};return e.from(t,{scaleMode:i,resourceOptions:s})},Object.defineProperties(t.resources.ImageResource.prototype,{premultiplyAlpha:{get:function(){return xt("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){xt("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}}}),t.Point.prototype.copy=function(t){return xt(Ws,"PIXI.Point.copy method has been replaced with PIXI.Point.copyFrom"),this.copyFrom(t)},t.ObservablePoint.prototype.copy=function(t){return xt(Ws,"PIXI.ObservablePoint.copy method has been replaced with PIXI.ObservablePoint.copyFrom"),this.copyFrom(t)},t.Rectangle.prototype.copy=function(t){return xt(Ws,"PIXI.Rectangle.copy method has been replaced with PIXI.Rectangle.copyFrom"),this.copyFrom(t)},t.Matrix.prototype.copy=function(t){return xt(Ws,"PIXI.Matrix.copy method has been replaced with PIXI.Matrix.copyTo"),this.copyTo(t)},t.systems.StateSystem.prototype.setState=function(t){return xt("v5.1.0","StateSystem.setState has been renamed to StateSystem.set"),this.set(t)},Object.assign(t.systems.FilterSystem.prototype,{getRenderTarget:function(t,e){return xt(Ws,"PIXI.FilterManager.getRenderTarget method has been replaced with PIXI.systems.FilterSystem#getFilterTexture"),this.getFilterTexture(e)},returnRenderTarget:function(t){xt(Ws,"PIXI.FilterManager.returnRenderTarget method has been replaced with PIXI.systems.FilterSystem.returnFilterTexture"),this.returnFilterTexture(t)},calculateScreenSpaceMatrix:function(t){xt(Ws,"PIXI.systems.FilterSystem.calculateScreenSpaceMatrix method is removed, use `(vTextureCoord * inputSize.xy) + outputFrame.xy` instead");var e=t.identity(),r=this.activeState,i=r.sourceFrame,n=r.destinationFrame;return e.translate(i.x/n.width,i.y/n.height),e.scale(n.width,n.height),e},calculateNormalizedScreenSpaceMatrix:function(t){xt(Ws,"PIXI.systems.FilterManager.calculateNormalizedScreenSpaceMatrix method is removed, use `((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw` instead.");var e=this.activeState,r=e.sourceFrame,i=e.destinationFrame,n=t.identity();n.translate(r.x/i.width,r.y/i.height);var s=i.width/r.width,o=i.height/r.height;return n.scale(s,o),n}}),Object.defineProperties(t.RenderTexture.prototype,{sourceFrame:{get:function(){return xt(Ws,"PIXI.RenderTexture.sourceFrame property has been removed"),this.filterFrame}},size:{get:function(){return xt(Ws,"PIXI.RenderTexture.size property has been removed"),this._frame}}});var i=function(t){function e(e,r,i,n){xt(Ws,"PIXI.filters.BlurXFilter class is deprecated, use PIXI.filters.BlurFilterPass"),t.call(this,!0,e,r,i,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(t.filters.BlurFilterPass),n=function(t){function e(e,r,i,n){xt(Ws,"PIXI.filters.BlurYFilter class is deprecated, use PIXI.filters.BlurFilterPass"),t.call(this,!1,e,r,i,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(t.filters.BlurFilterPass);Object.assign(t.filters,{BlurXFilter:i,BlurYFilter:n});var s=t.Sprite,o=t.Texture,a=t.Graphics;function h(t,e,r,i){return xt(Ws,"PIXI.Sprite."+t+" method is deprecated, use PIXI.Sprite.from"),s.from(e,{resourceOptions:{scale:i,crossorigin:r}})}function u(t,e,r,i){return xt(Ws,"PIXI.Texture."+t+" method is deprecated, use PIXI.Texture.from"),o.from(e,{resourceOptions:{scale:i,crossorigin:r}})}a.prototype.generateCanvasTexture||(a.prototype.generateCanvasTexture=function(){xt(Ws,'PIXI.Graphics.generateCanvasTexture method is only available in "pixi.js-legacy"')}),Object.defineProperty(t.Graphics.prototype,"graphicsData",{get:function(){return xt(Ws,"PIXI.Graphics.graphicsData property is deprecated, use PIXI.Graphics.geometry.graphicsData"),this.geometry.graphicsData}}),Object.defineProperty(t.SimpleRope.prototype,"points",{get:function(){return xt(Ws,"PIXI.SimpleRope.points property is deprecated, use PIXI.SimpleRope.geometry.points"),this.geometry.points},set:function(t){xt(Ws,"PIXI.SimpleRope.points property is deprecated, use PIXI.SimpleRope.geometry.points"),this.geometry.points=t}}),s.fromImage=h.bind(null,"fromImage"),s.fromSVG=h.bind(null,"fromSVG"),s.fromCanvas=h.bind(null,"fromCanvas"),s.fromVideo=h.bind(null,"fromVideo"),s.fromFrame=h.bind(null,"fromFrame"),o.fromImage=u.bind(null,"fromImage"),o.fromSVG=u.bind(null,"fromSVG"),o.fromCanvas=u.bind(null,"fromCanvas"),o.fromVideo=u.bind(null,"fromVideo"),o.fromFrame=u.bind(null,"fromFrame"),Object.defineProperty(t.AbstractRenderer.prototype,"autoResize",{get:function(){return xt(Ws,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity},set:function(t){xt(Ws,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity=t}}),Object.defineProperty(t.Renderer.prototype,"textureManager",{get:function(){return xt(Ws,"PIXI.Renderer.textureManager property is deprecated, use PIXI.Renderer.texture"),this.texture}}),t.utils.mixins={mixin:function(){xt(Ws,"PIXI.utils.mixins.mixin function is no longer available")},delayMixin:function(){xt(Ws,"PIXI.utils.mixins.delayMixin function is no longer available")},performMixins:function(){xt(Ws,"PIXI.utils.mixins.performMixins function is no longer available")}}}mi.registerPlugin("accessibility",ae),mi.registerPlugin("extract",Li),mi.registerPlugin("interaction",_e),mi.registerPlugin("particle",cn),mi.registerPlugin("prepare",hs),mi.registerPlugin("batch",Ni),mi.registerPlugin("tilingSprite",bs),on.registerPlugin(Ts),on.registerPlugin(ms),Pi.registerPlugin(le),Pi.registerPlugin(an);var qs="5.2.4",Ks={AlphaFilter:Es,BlurFilter:As,BlurFilterPass:Is,ColorMatrixFilter:Cs,DisplacementFilter:Os,FXAAFilter:Rs,NoiseFilter:Ns},Zs=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(Zs.prototype,{dispatch:{value:Zs.prototype.emit},run:{value:Zs.prototype.emit}});var Js=/iPhone/i,Qs=/iPod/i,to=/iPad/i,eo=/\biOS-universal(?:.+)Mac\b/i,ro=/\bAndroid(?:.+)Mobile\b/i,io=/Android/i,no=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,so=/Silk/i,oo=/Windows Phone/i,ao=/\bWindows(?:.+)ARM\b/i,ho=/BlackBerry/i,uo=/BB10/i,lo=/Opera Mini/i,co=/\b(CriOS|Chrome)(?:.+)Mobile/i,po=/Mobile(?:.+)Firefox\b/i,fo=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var mo=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(Js)&&!n(oo),ipod:n(Qs),tablet:!n(Js)&&(n(to)||fo(e))&&!n(oo),universal:n(eo),device:(n(Js)||n(Qs)||n(to)||n(eo)||fo(e))&&!n(oo)},amazon:{phone:n(no),tablet:!n(no)&&n(so),device:n(no)||n(so)},android:{phone:!n(oo)&&n(no)||!n(oo)&&n(ro),tablet:!n(oo)&&!n(no)&&!n(ro)&&(n(so)||n(io)),device:!n(oo)&&(n(no)||n(so)||n(ro)||n(io))||n(/\bokhttp\b/i)},windows:{phone:n(oo),tablet:n(ao),device:n(oo)||n(ao)},other:{blackberry:n(ho),blackberry10:n(uo),opera:n(lo),firefox:n(po),chrome:n(co),device:n(ho)||n(uo)||n(lo)||n(po)||n(co)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var go,yo,vo,_o,bo,xo,To,Eo,wo,So,Io,Ao,Co,Oo,Ro={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(mo.tablet||mo.phone){if(e=!1,mo.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(mo.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:mo.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!mo.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};
/*!
 * @pixi/constants - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(go||(go={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(yo||(yo={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(vo||(vo={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(_o||(_o={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(bo||(bo={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(xo||(xo={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(To||(To={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Eo||(Eo={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(wo||(wo={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(So||(So={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Io||(Io={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Ao||(Ao={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Co||(Co={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Oo||(Oo={})),
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Ro.RETINA_PREFIX=/@([0-9\.]+)x/,Ro.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var No,Po=!1;function Mo(t){var e;if(!Po){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var r=["\n %c %c %c PixiJS 5.2.4 -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=window.console).log.apply(e,r)}else window.console&&window.console.log("PixiJS 5.2.4 - "+t+" - http://www.pixijs.com/");Po=!0}}function Do(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}var Fo=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[vo.NORMAL_NPM]=vo.NORMAL,t[vo.ADD_NPM]=vo.ADD,t[vo.SCREEN_NPM]=vo.SCREEN,e[vo.NORMAL]=vo.NORMAL_NPM,e[vo.ADD]=vo.ADD_NPM,e[vo.SCREEN]=vo.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();Float32Array,Uint32Array,Int32Array,Uint8Array;function Lo(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function ko(t){return!(t&t-1||!t)}function Uo(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function Bo(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}var jo=0;function Xo(){return++jo}var Go={};var zo={},Vo=Object.create(null),Ho=Object.create(null);var $o=function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||Ro.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0}),t}();var Wo,Yo;function qo(t,e){var r=Ro.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Ro.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(Yo||(Yo={}));var Ko,Zo=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Jo=function(){function t(){var t=this;this._head=new Zo(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Ro.TARGET_FPMS,this.elapsedMS=1/Ro.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=Yo.NORMAL),this._addListener(new Zo(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=Yo.NORMAL),this._addListener(new Zo(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Ro.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,Ro.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),Qo=(function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Yo.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Jo.shared:new Jo,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}(),function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}()),ta=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),ea=2*Math.PI,ra=180/Math.PI,ia=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(Ko||(Ko={}));var na=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new Qo;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Qo;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(ea-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),sa=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],oa=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],aa=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ha=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ua=[],la=[],ca=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];ua.push(e);for(var r=0;r<16;r++)for(var i=ca(sa[t]*sa[r]+aa[t]*oa[r]),n=ca(oa[t]*sa[r]+ha[t]*oa[r]),s=ca(sa[t]*aa[r]+aa[t]*ha[r]),o=ca(oa[t]*aa[r]+ha[t]*ha[r]),a=0;a<16;a++)if(sa[a]===i&&oa[a]===n&&aa[a]===s&&ha[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new na;h.set(sa[t],oa[t],aa[t],ha[t],0,0),la.push(h)}}();var da={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return sa[t]},uY:function(t){return oa[t]},vX:function(t){return aa[t]},vY:function(t){return ha[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return ua[t][e]},sub:function(t,e){return ua[t][da.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?da.S:da.N:2*Math.abs(e)<=Math.abs(t)?t>0?da.E:da.W:e>0?t>0?da.SE:da.SW:t>0?da.NE:da.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=la[da.inv(e)];n.tx=r,n.ty=i,t.append(n)}},pa=function(){function t(){this.worldTransform=new na,this.localTransform=new na,this.position=new ta(this.onChange,this,0,0),this.scale=new ta(this.onChange,this,1,1),this.pivot=new ta(this.onChange,this,0,0),this.skew=new ta(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),fa=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=Ko.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}();(function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=Ko.CIRC}t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new fa(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}})(),function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=Ko.ELIP}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new fa(this.x-this.width,this.y-this.height,this.width,this.height)}}(),function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof Qo){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=Ko.POLY,this.closeStroke=!0}t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r}}(),function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=Ko.RREC}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1}}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Ro.SORTABLE_CHILDREN=!1;var ma=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};ma.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},ma.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},ma.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?fa.EMPTY:((t=t||new fa(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},ma.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},ma.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},ma.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},ma.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},ma.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},ma.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},ma.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},ma.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},ma.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},ma.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},ma.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},ma.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},ma.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var ga=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new pa,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new ma,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new fa),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new fa),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*ra},r.angle.set=function(t){this.transform.rotation=t*ia},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function ya(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}ga.prototype.displayObjectUpdateTransform=ga.prototype.updateTransform;var va=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=Ro.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);Bo(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,Bo(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Bo(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(ya),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(ga);va.prototype.containerUpdateTransform=va.prototype.updateTransform;
/*!
 * @pixi/core - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var _a=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Zs("setRealSize",2),this.onUpdate=new Zs("update"),this.onError=new Zs("onError",1)},ba={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};_a.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},_a.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},_a.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},ba.valid.get=function(){return!!this._width&&!!this._height},_a.prototype.update=function(){this.destroyed||this.onUpdate.run()},_a.prototype.load=function(){return Promise.resolve()},ba.width.get=function(){return this._width},ba.height.get=function(){return this._height},_a.prototype.upload=function(t,e,r){return!1},_a.prototype.style=function(t,e,r){return!1},_a.prototype.dispose=function(){},_a.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(_a.prototype,ba);var xa=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,Wo||(Wo=document.createElement("a")),Wo.href=t;var r=Object(W.parse)(Wo.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Io.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(_a),Ta=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:Ro.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===Io.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(xa),Ea=[];function wa(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=Ea.length-1;n>=0;--n){var s=Ea[n];if(s.test&&s.test(t,r))return new s(t,e)}return new Ta(t,e)}var Sa=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Io.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(_a),Ia={scaleMode:Eo.NEAREST,format:bo.RGBA,alphaMode:Io.NPM},Aa=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof _a||((e=wa(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||Ro.RESOLUTION,this.mipmap=void 0!==n?n:Ro.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:Ro.ANISOTROPIC_LEVEL,this.wrapMode=u||Ro.WRAP_MODE,this.scaleMode=void 0!==o?o:Ro.SCALE_MODE,this.format=l||bo.RGBA,this.type=c||To.UNSIGNED_BYTE,this.target=d||xo.TEXTURE_2D,this.alphaMode=void 0!==i?i:Io.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=Xo(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=ko(this.realWidth)&&ko(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ho[this.cacheId],delete Vo[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=Ro.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+Xo()),s=t._pixiId);var o=Ho[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new Sa(t,{width:r,height:i}),o=t instanceof Float32Array?To.FLOAT:To.UNSIGNED_BYTE;return new e(s,Object.assign(Ia,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Ho[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Ho[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Ho[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Ho[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Ho[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);Aa._globalBatch=0;var Ca=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new Aa;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(wa(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=xo.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(_a),Oa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(xa),Ra=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=xo.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=xo.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(Ca);Ra.SIDES=6;var Na=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+Xo(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(xa);Na.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Pa=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=Jo.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Jo.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Jo.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&Jo.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Jo.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Jo.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(xa);Pa.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var Ma=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(xa);Ea.push(Ta,Ma,Oa,Pa,Na,Sa,Ra,Ca);var Da={INSTALLED:Ea,autoDetectResource:wa,ArrayResource:Ca,BufferResource:Sa,CanvasResource:Oa,CubeResource:Ra,ImageResource:Ta,ImageBitmapResource:Ma,SVGResource:Na,VideoResource:Pa,Resource:_a,BaseImageResource:xa},Fa=function(t){this.renderer=t};Fa.prototype.destroy=function(){this.renderer=null};var La=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Io.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(Sa),ka=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Zs("disposeFramebuffer",2)},Ua={colorTexture:{configurable:!0}};Ua.colorTexture.get=function(){return this.colorTextures[0]},ka.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new Aa(null,{scaleMode:Eo.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},ka.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Aa(new La(null,{width:this.width,height:this.height}),{scaleMode:Eo.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:bo.DEPTH_COMPONENT,type:To.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},ka.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},ka.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},ka.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},ka.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(ka.prototype,Ua);var Ba=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new ka(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(Aa),ja=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};ja.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=da.add(r,da.NW),this.x0=a+s*da.uX(r),this.y0=h+o*da.uY(r),r=da.add(r,2),this.x1=a+s*da.uX(r),this.y1=h+o*da.uY(r),r=da.add(r,2),this.x2=a+s*da.uX(r),this.y2=h+o*da.uY(r),r=da.add(r,2),this.x3=a+s*da.uX(r),this.y3=h+o*da.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var Xa=new ja,Ga=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new fa(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=Xa,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new Qo(a.x,a.y):new Qo(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&Vo[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===Xa&&(this._uvs=new ja),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=Ro.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+Xo()),s=t._pixiId);var o=Vo[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=qo(t)),(o=new e(new Aa(t,r))).baseTexture.cacheId=s,Aa.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(Aa.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new Ta(t);n.url=r;var s=new e(new Aa(n,{scaleMode:Ro.SCALE_MODE,resolution:qo(r)}));return i||(i=r),Aa.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(Aa.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Vo[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Vo[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Vo[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Vo[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)Vo[t.textureCacheIds[i]]===t&&delete Vo[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function za(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Ga.EMPTY=new Ga(new Aa),za(Ga.EMPTY),za(Ga.EMPTY.baseTexture),Ga.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Ga(new Aa(new Oa(t)))}(),za(Ga.WHITE),za(Ga.WHITE.baseTexture);var Va=function(t){function e(e,r){var i=null;if(!(e instanceof Ba)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new Ba({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new Ba(t))},e}(Ga),Ha=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};Ha.prototype.createTexture=function(t,e){var r=new Ba(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Va(r)},Ha.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=Ha.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=Lo(t)))<<16|65535&(e=Lo(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},Ha.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},Ha.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},Ha.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Ha.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},Ha.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=Ha.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Ha.SCREEN_KEY="screen";var $a=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};$a.prototype.destroy=function(){this.buffer=null},$a.from=function(t,e,r,i,n){return new $a(t,e,r,i,n)};var Wa=0,Ya=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=Wa++,this.disposeRunner=new Zs("disposeBuffer",2)};function qa(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}Ya.prototype.update=function(t){this.data=t||this.data,this._updateID++},Ya.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Ya.prototype.destroy=function(){this.dispose(),this.data=null},Ya.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new Ya(t)};var Ka={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var Za={5126:4,5123:2,5121:1},Ja=0,Qa={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},th=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Ja++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Zs("disposeGeometry",2),this.refCount=0};th.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Ya(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new $a(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},th.prototype.getAttribute=function(t){return this.attributes[t]},th.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},th.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ya(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},th.prototype.getIndex=function(){return this.indexBuffer},th.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new Ya;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*Za[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=qa(c);n[d]||(n[d]=new Ka[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},th.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},th.prototype.dispose=function(){this.disposeRunner.run(this,!1)},th.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},th.prototype.clone=function(){for(var t=new th,e=0;e<this.buffers.length;e++)t.buffers[e]=new Ya(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new $a(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},th.merge=function(t){for(var e,r=new th,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(Qa[qa(e.buffers[h].data)])(n[h]),r.buffers[h]=new Ya(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*Za[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var eh=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(th),rh=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ya(this.vertices),this.uvBuffer=new Ya(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(th),ih=0,nh=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=ih++,this.static=!!e};nh.prototype.update=function(){this.dirtyId++},nh.prototype.add=function(t,e,r){this.uniforms[t]=new nh(e,r)},nh.from=function(t,e){return new nh(t,e)};var sh=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new fa,this.destinationFrame=new fa,this.filters=[]};sh.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var oh=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new Ha,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new eh,this.quadUv=new rh,this.tempRect=new fa,this.activeState={},this.globalUniforms=new nh({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new sh,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(_o.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(_o.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(na.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(Fa),ah=function(t){this.renderer=t};ah.prototype.flush=function(){},ah.prototype.destroy=function(){this.renderer=null},ah.prototype.start=function(){},ah.prototype.stop=function(){this.flush()},ah.prototype.render=function(t){};var hh=function(t){function e(e){t.call(this,e),this.emptyRenderer=new ah(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(Fa);Ro.PREFER_ENV=mo.any?go.WEBGL:go.WEBGL2,Ro.STRICT_TEXTURE_CACHE=!1;var uh=0,lh=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=uh++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=uh++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(Ro.PREFER_ENV>=go.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(Fa),ch=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new ka(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new fa,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;Ro.PREFER_ENV===go.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new fa},Object.defineProperties(e.prototype,r),e}(Fa),dh=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},ph={5126:4,5123:2,5121:1},fh=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;Ro.PREFER_ENV===go.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*ph[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*ph[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*ph[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new dh(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(Fa),mh=function(t){this.type=Oo.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function gh(t,e,r,i){var n=yh(t,t.VERTEX_SHADER,e),s=yh(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function yh(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function vh(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return _h(2*e);case"bvec3":return _h(3*e);case"bvec4":return _h(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function _h(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}mh.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Oo.NONE,this.autoDetect=!0),this._target=null},mh.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var bh,xh={},Th=xh;function Eh(){if(Th===xh||Th&&Th.isContextLost()){var t,e=document.createElement("canvas");Ro.PREFER_ENV>=go.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),Th=t}return Th}function wh(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===Co.HIGH&&r!==Co.HIGH&&(i=Co.MEDIUM),"precision "+i+" float;\n"+t}return r!==Co.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var Sh={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Ih(t){return Sh[t]}var Ah=null,Ch={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function Oh(t,e){if(!Ah){var r=Object.keys(Ch);Ah={};for(var i=0;i<r.length;++i){var n=r[i];Ah[t[n]]=Ch[n]}}return Ah[e]}var Rh={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Nh={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Ph,Mh=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Dh(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var Fh=0,Lh={},kh=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=Fh++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Lh[i]?(Lh[i]++,i+="-"+Lh[i]):Lh[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=wh(this.vertexSrc,Ro.PRECISION_VERTEX,Co.HIGH),this.fragmentSrc=wh(this.fragmentSrc,Ro.PRECISION_FRAGMENT,function(){if(!bh){bh=Co.MEDIUM;var t=Eh();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);bh=e.precision?Co.HIGH:Co.MEDIUM}}return bh}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},Uh={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};kh.prototype.extractData=function(t,e){var r=Eh();if(r){var i=gh(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},kh.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=Oh(e,o.type),h={type:a,name:o.name,size:Ih(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},kh.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=Oh(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:vh(h,s.size)}}return r},Uh.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},Uh.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},kh.from=function(t,e,r){var i=t+e,n=zo[i];return n||(zo[i]=n=new kh(t,e,r)),n},Object.defineProperties(kh,Uh);var Bh=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof nh?e:new nh(e):new nh({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},jh={uniforms:{configurable:!0}};Bh.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},Bh.prototype.destroy=function(){this.uniformGroup=null},jh.uniforms.get=function(){return this.uniformGroup.uniforms},Bh.from=function(t,e,r){var i=kh.from(t,e);return new Bh(i,r)},Object.defineProperties(Bh.prototype,jh);var Xh=function(){this.data=0,this.blendMode=vo.NORMAL,this.polygonOffset=0,this.blend=!0},Gh={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};Gh.blend.get=function(){return!!(1&this.data)},Gh.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Gh.offsets.get=function(){return!!(2&this.data)},Gh.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},Gh.culling.get=function(){return!!(4&this.data)},Gh.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Gh.depthTest.get=function(){return!!(8&this.data)},Gh.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},Gh.clockwiseFrontFace.get=function(){return!!(16&this.data)},Gh.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Gh.blendMode.get=function(){return this._blendMode},Gh.blendMode.set=function(t){this.blend=t!==vo.NONE,this._blendMode=t},Gh.polygonOffset.get=function(){return this._polygonOffset},Gh.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Xh.for2d=function(){var t=new Xh;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(Xh.prototype,Gh);var zh=function(t){function e(r,i,n){var s=kh.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=Ro.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Xh}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(Bh);zh.SOURCE_KEY_MAP={};var Vh=new na,Hh=function(t,e){this._texture=t,this.mapCoord=new na,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},$h={texture:{configurable:!0}};$h.texture.get=function(){return this._texture},$h.texture.set=function(t){this._texture=t,this._updateID=-1},Hh.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},Hh.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(Vh.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Vh));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(Hh.prototype,$h);var Wh=function(t){function e(e){var r=new na;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new Hh(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(zh),Yh=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new mh;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case Oo.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case Oo.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case Oo.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Oo.SCISSOR:this.renderer.scissor.pop();break;case Oo.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Oo.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Oo.SPRITE;else if(t.type=Oo.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=Oo.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new Wh(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(Fa),qh=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(Fa),Kh=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(qh),Zh=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(qh),Jh=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new na,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(Fa),Qh=new fa,tu=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new fa,this.destinationFrame=new fa}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(Qh.width=s.realWidth,Qh.height=s.realHeight,r=Qh),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(Qh.width=n.width,Qh.height=n.height,r=Qh),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(Fa),eu=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};eu.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var ru=0,iu={textureCount:0},nu=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=ru++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Ph)return Ph;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Ph=!0===t({a:"b"},"a","b")}catch(t){Ph=!1}return Ph}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(iu.textureCount=0,this.syncUniformGroup(t.uniformGroup,iu)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?Rh:Nh)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=gh(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:vh(h.type,h.size)}}var u=new eu(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(Fa);var su=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=vo.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Xh,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[vo.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.ADD]=[t.ONE,t.ONE],e[vo.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.NONE]=[0,0],e[vo.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[vo.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vo.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[vo.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[vo.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[vo.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[vo.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[vo.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[vo.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[vo.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[vo.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(Fa),ou=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=Ro.GC_MAX_IDLE,this.checkCountMax=Ro.GC_MAX_CHECK_COUNT,this.mode=Ro.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Ao.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(Fa),au=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},hu=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Aa}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new au(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new au(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new au(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===To.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&Bo(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==So.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=wo.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Eo.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Eo.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Eo.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===Eo.LINEAR?r.LINEAR:r.NEAREST)},e}(Fa),uu=new na,lu=function(t){function e(e,r){t.call(this),(r=Object.assign({},Ro.RENDER_OPTIONS,r)).roundPixels&&(Ro.ROUND_PIXELS=r.roundPixels,function(t,e,r){if(void 0===r&&(r=3),!Go[e]){var i=(new Error).stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),Go[e]=!0}}("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=r,this.type=yo.UNKNOWN,this.screen=new fa(0,0,r.width,r.height),this.view=r.view||document.createElement("canvas"),this.resolution=r.resolution||Ro.RESOLUTION,this.transparent=r.transparent,this.autoDensity=r.autoDensity||r.autoResize||!1,this.preserveDrawingBuffer=r.preserveDrawingBuffer,this.clearBeforeRender=r.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=r.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new va,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},r.width.get=function(){return this.view.width},r.height.get=function(){return this.view.height},e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,r,i){0===(i=i||t.getLocalBounds()).width&&(i.width=1),0===i.height&&(i.height=1);var n=Va.create({width:0|i.width,height:0|i.height,scaleMode:e,resolution:r});return uu.tx=-i.x,uu.ty=-i.y,this.render(t,n,!1,uu,!!t.parent),n},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=yo.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},r.backgroundColor.get=function(){return this._backgroundColor},r.backgroundColor.set=function(t){var e;this._backgroundColor=t,this._backgroundColorString=(e=t.toString(16),"#"+(e="000000".substr(0,6-e.length)+e)),Do(t,this._backgroundColorRgba)},Object.defineProperties(e.prototype,r),e}(V.a),cu=function(t){function e(r){void 0===r&&(r={}),t.call(this,"WebGL",r),r=this.options,this.type=yo.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new Zs("destroy"),contextChange:new Zs("contextChange",1),reset:new Zs("reset"),update:new Zs("update"),postrender:new Zs("postrender"),prerender:new Zs("prerender"),resize:new Zs("resize",2)},this.globalUniforms=new nh({projectionMatrix:new na},!0),this.addSystem(Yh,"mask").addSystem(lh,"context").addSystem(su,"state").addSystem(nu,"shader").addSystem(hu,"texture").addSystem(fh,"geometry").addSystem(ch,"framebuffer").addSystem(Kh,"scissor").addSystem(Zh,"stencil").addSystem(Jh,"projection").addSystem(ou,"textureGC").addSystem(oh,"filter").addSystem(tu,"renderTexture").addSystem(hh,"batch"),this.initPlugins(e.__plugins),r.context?this.context.initFromContext(r.context):this.context.initFromOptions({alpha:this.transparent,antialias:r.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,Mo(2===this.context.webGLVersion?"WebGL 2":"WebGL 1"),this.resize(this.options.width,this.options.height)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t){if(void 0===No&&(No=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:Ro.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!r||!r.getContextAttributes().stencil);if(r){var n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()}return r=null,i}catch(t){return!1}}()),No)return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,e){e||(e=t.name);var r=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var i in this[e]=r,this.runners)this.runners[i].add(r);return this},e.prototype.render=function(t,e,r,i,n){if(this.renderingToScreen=!e,this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(e||(this._lastObjectRendered=t),!n){var s=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=s}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(e,r){t.prototype.resize.call(this,e,r),this.runners.resize.run(e,r)},e.prototype.reset=function(){return this.runners.reset.run(),this},e.prototype.clear=function(){this.framebuffer.bind(),this.framebuffer.clear()},e.prototype.destroy=function(e){for(var r in this.runners.destroy.run(),this.runners)this.runners[r].destroy();t.prototype.destroy.call(this,e),this.gl=null},e.registerPlugin=function(t,r){e.__plugins=e.__plugins||{},e.__plugins[t]=r},e}(lu);var du=function(){this.texArray=null,this.blend=0,this.type=_o.TRIANGLES,this.start=0,this.size=0,this.data=null},pu=function(){this.elements=[],this.ids=[],this.count=0};pu.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var fu=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},mu={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};mu.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},mu.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},mu.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},mu.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},mu.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},fu.prototype.view=function(t){return this[t+"View"]},fu.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},fu.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(fu.prototype,mu);var gu=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Xh.for2d(),this.size=4*Ro.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;Ro.PREFER_ENV===go.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Ro.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=Mh.replace(/%forloop%/gi,Dh(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new du);for(;r.length<n;)r.push(new pu);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++Aa._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;Aa._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=Fo[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;Ro.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Ro.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=Lo(Math.ceil(t/8)),r=Uo(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new fu(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=Lo(Math.ceil(t/12)),r=Uo(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(ah);gu._drawCallPool=[],gu._textureArrayPool=[];var yu=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};yu.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=nh.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new kh(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new na,default:this.defaultGroupCache[t]};return new Bh(this.programCache[t],n)},yu.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var vu=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new Ya(null,e,!1),this._indexBuffer=new Ya(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,To.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,To.FLOAT).addAttribute("aColor",this._buffer,4,!0,To.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,To.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(th),_u="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",bu="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",xu=function(){},Tu={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};xu.create=function(t){var e=Object.assign({vertex:_u,fragment:bu,geometryClass:vu,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new yu(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(gu)},Tu.defaultVertexSrc.get=function(){return _u},Tu.defaultFragmentTemplate.get=function(){return bu},Object.defineProperties(xu,Tu);xu.create();
/*!
 * @pixi/canvas-renderer - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/canvas-renderer is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Eu=function(t){this.renderer=t,this._foundShapes=[]};function wu(t){var e=document.createElement("canvas");e.width=6,e.height=1;var r=e.getContext("2d");return r.fillStyle=t,r.fillRect(0,0,6,1),e}function Su(){if("undefined"==typeof document)return!1;var t=wu("#ff00ff"),e=wu("#ffff00"),r=document.createElement("canvas");r.width=6,r.height=1;var i=r.getContext("2d");i.globalCompositeOperation="multiply",i.drawImage(t,0,0),i.drawImage(e,2,0);var n=i.getImageData(2,0,1,1);if(!n)return!1;var s=n.data;return 255===s[0]&&0===s[1]&&0===s[2]}Eu.prototype.pushMask=function(t){var e=this.renderer,r=t.isMaskData?t.maskObject:t;e.context.save();var i=this._foundShapes;if(this.recursiveFindShapes(r,i),i.length>0){var n=e.context;n.beginPath();for(var s=0;s<i.length;s++){var o=i[s],a=o.transform.worldTransform;this.renderer.setContextTransform(a),this.renderGraphicsShape(o)}i.length=0,n.clip()}},Eu.prototype.recursiveFindShapes=function(t,e){t.geometry&&t.geometry.graphicsData&&e.push(t);var r=t.children;if(r)for(var i=0;i<r.length;i++)this.recursiveFindShapes(r[i],e)},Eu.prototype.renderGraphicsShape=function(t){t.finishPoly();var e=this.renderer.context,r=t.geometry.graphicsData,i=r.length;if(0!==i)for(var n=0;n<i;n++){var s=r[n],o=s.shape;if(s.type===Ko.POLY){var a=o.points;e.moveTo(a[0],a[1]);for(var h=1;h<a.length/2;h++)e.lineTo(a[2*h],a[2*h+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(s.type===Ko.RECT)e.rect(o.x,o.y,o.width,o.height),e.closePath();else if(s.type===Ko.CIRC)e.arc(o.x,o.y,o.radius,0,2*Math.PI),e.closePath();else if(s.type===Ko.ELIP){var u=2*o.width,l=2*o.height,c=o.x-u/2,d=o.y-l/2,p=u/2*.5522848,f=l/2*.5522848,m=c+u,g=d+l,y=c+u/2,v=d+l/2;e.moveTo(c,v),e.bezierCurveTo(c,v-f,y-p,d,y,d),e.bezierCurveTo(y+p,d,m,v-f,m,v),e.bezierCurveTo(m,v+f,y+p,g,y,g),e.bezierCurveTo(y-p,g,c,v+f,c,v),e.closePath()}else if(s.type===Ko.RREC){var _=o.x,b=o.y,x=o.width,T=o.height,E=o.radius,w=Math.min(x,T)/2|0;E=E>w?w:E,e.moveTo(_,b+E),e.lineTo(_,b+T-E),e.quadraticCurveTo(_,b+T,_+E,b+T),e.lineTo(_+x-E,b+T),e.quadraticCurveTo(_+x,b+T,_+x,b+T-E),e.lineTo(_+x,b+E),e.quadraticCurveTo(_+x,b,_+x-E,b),e.lineTo(_+E,b),e.quadraticCurveTo(_,b,_,b+E),e.closePath()}}},Eu.prototype.popMask=function(t){t.context.restore(),t.invalidateBlendMode()},Eu.prototype.destroy=function(){};var Iu=new na,Au=function(t){function e(r,i,n){var s;t.call(this,"Canvas",r,i,n),this.type=yo.CANVAS,this.rootContext=this.view.getContext("2d",{alpha:this.transparent}),this.context=this.rootContext,this.refresh=!0,this.maskManager=new Eu(this),this.smoothProperty="imageSmoothingEnabled",this.rootContext.imageSmoothingEnabled||(this.rootContext.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.rootContext.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.rootContext.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.rootContext.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(e.__plugins),this.blendModes=(void 0===s&&(s=[]),Su()?(s[vo.NORMAL]="source-over",s[vo.ADD]="lighter",s[vo.MULTIPLY]="multiply",s[vo.SCREEN]="screen",s[vo.OVERLAY]="overlay",s[vo.DARKEN]="darken",s[vo.LIGHTEN]="lighten",s[vo.COLOR_DODGE]="color-dodge",s[vo.COLOR_BURN]="color-burn",s[vo.HARD_LIGHT]="hard-light",s[vo.SOFT_LIGHT]="soft-light",s[vo.DIFFERENCE]="difference",s[vo.EXCLUSION]="exclusion",s[vo.HUE]="hue",s[vo.SATURATION]="saturate",s[vo.COLOR]="color",s[vo.LUMINOSITY]="luminosity"):(s[vo.NORMAL]="source-over",s[vo.ADD]="lighter",s[vo.MULTIPLY]="source-over",s[vo.SCREEN]="source-over",s[vo.OVERLAY]="source-over",s[vo.DARKEN]="source-over",s[vo.LIGHTEN]="source-over",s[vo.COLOR_DODGE]="source-over",s[vo.COLOR_BURN]="source-over",s[vo.HARD_LIGHT]="source-over",s[vo.SOFT_LIGHT]="source-over",s[vo.DIFFERENCE]="source-over",s[vo.EXCLUSION]="source-over",s[vo.HUE]="source-over",s[vo.SATURATION]="source-over",s[vo.COLOR]="source-over",s[vo.LUMINOSITY]="source-over"),s[vo.NORMAL_NPM]=s[vo.NORMAL],s[vo.ADD_NPM]=s[vo.ADD],s[vo.SCREEN_NPM]=s[vo.SCREEN],s[vo.SRC_IN]="source-in",s[vo.SRC_OUT]="source-out",s[vo.SRC_ATOP]="source-atop",s[vo.DST_OVER]="destination-over",s[vo.DST_IN]="destination-in",s[vo.DST_OUT]="destination-out",s[vo.DST_ATOP]="destination-atop",s[vo.XOR]="xor",s[vo.SUBTRACT]="source-over",s),this._activeBlendMode=null,this._outerBlend=!1,this._projTransform=null,this.renderingToScreen=!1,Mo("Canvas"),this.resize(this.options.width,this.options.height)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t,e,r,i,n){if(this.view){this.renderingToScreen=!e,this.emit("prerender");var s=this.resolution;e?((e=e.baseTexture||e)._canvasRenderTarget||(e._canvasRenderTarget=new $o(e.width,e.height,e.resolution),e.resource=new Da.CanvasResource(e._canvasRenderTarget.canvas),e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):this.context=this.rootContext;var o=this.context;if(this._projTransform=i||null,e||(this._lastObjectRendered=t),!n){var a=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=a}o.save(),o.setTransform(1,0,0,1,0,0),o.globalAlpha=1,this._activeBlendMode=vo.NORMAL,this._outerBlend=!1,o.globalCompositeOperation=this.blendModes[vo.NORMAL],(void 0!==r?r:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?o.clearRect(0,0,this.width,this.height):(o.fillStyle=this._backgroundColorString,o.fillRect(0,0,this.width,this.height)));var h=this.context;this.context=o,t.renderCanvas(this),this.context=h,o.restore(),this.resolution=s,this._projTransform=null,this.emit("postrender")}},e.prototype.setContextTransform=function(t,e,r){var i=t,n=this._projTransform,s=this.resolution;r=r||s,n&&((i=Iu).copyFrom(t),i.prepend(n)),e?this.context.setTransform(i.a*r,i.b*r,i.c*r,i.d*r,i.tx*s|0,i.ty*s|0):this.context.setTransform(i.a*r,i.b*r,i.c*r,i.d*r,i.tx*s,i.ty*s)},e.prototype.clear=function(t){var e=this.context;t=t||this._backgroundColorString,!this.transparent&&t?(e.fillStyle=t,e.fillRect(0,0,this.width,this.height)):e.clearRect(0,0,this.width,this.height)},e.prototype.setBlendMode=function(t,e){var r=t===vo.SRC_IN||t===vo.SRC_OUT||t===vo.DST_IN||t===vo.DST_ATOP;!e&&r&&(t=vo.NORMAL),this._activeBlendMode!==t&&(this._activeBlendMode=t,this._outerBlend=r,this.context.globalCompositeOperation=this.blendModes[t])},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},e.prototype.resize=function(e,r){t.prototype.resize.call(this,e,r),this.smoothProperty&&(this.rootContext[this.smoothProperty]=Ro.SCALE_MODE===Eo.LINEAR)},e.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},e.registerPlugin=function(t,r){e.__plugins=e.__plugins||{},e.__plugins[t]=r},e}(lu),Cu={getTintedCanvas:function(t,e){var r=t.texture,i="#"+("00000"+(0|(e=Cu.roundColor(e))).toString(16)).substr(-6);r.tintCache=r.tintCache||{};var n,s=r.tintCache[i];if(s){if(s.tintId===r._updateID)return r.tintCache[i];n=r.tintCache[i]}else n=document.createElement("canvas");if(Cu.tintMethod(r,e,n),n.tintId=r._updateID,Cu.convertTintToImage){var o=new Image;o.src=n.toDataURL(),r.tintCache[i]=o}else r.tintCache[i]=n;return n},getTintedPattern:function(t,e){var r="#"+("00000"+(0|(e=Cu.roundColor(e))).toString(16)).substr(-6);t.patternCache=t.patternCache||{};var i=t.patternCache[r];return i&&i.tintId===t._updateID?i:(Cu.canvas||(Cu.canvas=document.createElement("canvas")),Cu.tintMethod(t,e,Cu.canvas),(i=Cu.canvas.getContext("2d").createPattern(Cu.canvas,"repeat")).tintId=t._updateID,t.patternCache[r]=i,i)},tintWithMultiply:function(t,e,r){var i=r.getContext("2d"),n=t._frame.clone(),s=t.baseTexture.resolution;n.x*=s,n.y*=s,n.width*=s,n.height*=s,r.width=Math.ceil(n.width),r.height=Math.ceil(n.height),i.save(),i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,n.width,n.height),i.globalCompositeOperation="multiply";var o=t.baseTexture.getDrawableSource();i.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height),i.globalCompositeOperation="destination-atop",i.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height),i.restore()},tintWithOverlay:function(t,e,r){var i=r.getContext("2d"),n=t._frame.clone(),s=t.baseTexture.resolution;n.x*=s,n.y*=s,n.width*=s,n.height*=s,r.width=Math.ceil(n.width),r.height=Math.ceil(n.height),i.save(),i.globalCompositeOperation="copy",i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,n.width,n.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.getDrawableSource(),n.x,n.y,n.width,n.height,0,0,n.width,n.height),i.restore()},tintWithPerPixel:function(t,e,r){var i=r.getContext("2d"),n=t._frame.clone(),s=t.baseTexture.resolution;n.x*=s,n.y*=s,n.width*=s,n.height*=s,r.width=Math.ceil(n.width),r.height=Math.ceil(n.height),i.save(),i.globalCompositeOperation="copy",i.drawImage(t.baseTexture.getDrawableSource(),n.x,n.y,n.width,n.height,0,0,n.width,n.height),i.restore();for(var o=Do(e),a=o[0],h=o[1],u=o[2],l=i.getImageData(0,0,n.width,n.height),c=l.data,d=0;d<c.length;d+=4)c[d+0]*=a,c[d+1]*=h,c[d+2]*=u;i.putImageData(l,0,0)},roundColor:function(t){var e,r=Cu.cacheStepsPerColorChannel,i=Do(t);return i[0]=Math.min(255,i[0]/r*r),i[1]=Math.min(255,i[1]/r*r),i[2]=Math.min(255,i[2]/r*r),(255*(e=i)[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:Su(),tintMethod:function(){}};Cu.tintMethod=Cu.canUseMultiply?Cu.tintWithMultiply:Cu.tintWithPerPixel;var Ou,Ru,Nu,Pu,Mu,Du,Fu,Lu,ku,Uu,Bu,ju,Xu,Gu,zu=cu.create;cu.create=function(t){if(!(t&&t.forceCanvas))try{return zu(t)}catch(t){}return new Au(t)},Aa.prototype.getDrawableSource=function(){var t=this.resource;return t?t.bitmap||t.source:null},function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(Ou||(Ou={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(Ru||(Ru={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Nu||(Nu={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Pu||(Pu={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Mu||(Mu={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Du||(Du={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Fu||(Fu={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Lu||(Lu={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(ku||(ku={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(Uu||(Uu={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Bu||(Bu={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(ju||(ju={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Xu||(Xu={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Gu||(Gu={}));var Vu=/iPhone/i,Hu=/iPod/i,$u=/iPad/i,Wu=/\biOS-universal(?:.+)Mac\b/i,Yu=/\bAndroid(?:.+)Mobile\b/i,qu=/Android/i,Ku=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Zu=/Silk/i,Ju=/Windows Phone/i,Qu=/\bWindows(?:.+)ARM\b/i,tl=/BlackBerry/i,el=/BB10/i,rl=/Opera Mini/i,il=/\b(CriOS|Chrome)(?:.+)Mobile/i,nl=/Mobile(?:.+)Firefox\b/i,sl=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var ol=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(Vu)&&!n(Ju),ipod:n(Hu),tablet:!n(Vu)&&(n($u)||sl(e))&&!n(Ju),universal:n(Wu),device:(n(Vu)||n(Hu)||n($u)||n(Wu)||sl(e))&&!n(Ju)},amazon:{phone:n(Ku),tablet:!n(Ku)&&n(Zu),device:n(Ku)||n(Zu)},android:{phone:!n(Ju)&&n(Ku)||!n(Ju)&&n(Yu),tablet:!n(Ju)&&!n(Ku)&&!n(Yu)&&(n(Zu)||n(qu)),device:!n(Ju)&&(n(Ku)||n(Zu)||n(Yu)||n(qu))||n(/\bokhttp\b/i)},windows:{phone:n(Ju),tablet:n(Qu),device:n(Ju)||n(Qu)},other:{blackberry:n(tl),blackberry10:n(el),opera:n(rl),firefox:n(nl),chrome:n(il),device:n(tl)||n(el)||n(rl)||n(nl)||n(il)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var al={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(ol.tablet||ol.phone){if(e=!1,ol.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(ol.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:ol.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!ol.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},hl=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();
/*!
 * @pixi/runner - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Object.defineProperties(hl.prototype,{dispatch:{value:hl.prototype.emit},run:{value:hl.prototype.emit}}),
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
al.RETINA_PREFIX=/@([0-9\.]+)x/,al.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var ul,ll=!1;var cl=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[Nu.NORMAL_NPM]=Nu.NORMAL,t[Nu.ADD_NPM]=Nu.ADD,t[Nu.SCREEN_NPM]=Nu.SCREEN,e[Nu.NORMAL]=Nu.NORMAL_NPM,e[Nu.ADD]=Nu.ADD_NPM,e[Nu.SCREEN]=Nu.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();Float32Array,Uint32Array,Int32Array,Uint8Array;function dl(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function pl(t){return!(t&t-1||!t)}function fl(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function ml(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}var gl=0;function yl(){return++gl}var vl={};var _l={},bl=Object.create(null),xl=Object.create(null);!function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||al.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0})}();var Tl,El;function wl(t,e){var r=al.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */al.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(El||(El={}));var Sl,Il=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Al=function(){function t(){var t=this;this._head=new Il(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/al.TARGET_FPMS,this.elapsedMS=1/al.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=El.NORMAL),this._addListener(new Il(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=El.NORMAL),this._addListener(new Il(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*al.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,al.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),Cl=(function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,El.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Al.shared:new Al,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}(),function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}()),Ol=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),Rl=2*Math.PI,Nl=180/Math.PI,Pl=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(Sl||(Sl={}));var Ml=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new Cl;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Cl;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(Rl-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),Dl=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Fl=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ll=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],kl=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ul=[],Bl=[],jl=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Ul.push(e);for(var r=0;r<16;r++)for(var i=jl(Dl[t]*Dl[r]+Ll[t]*Fl[r]),n=jl(Fl[t]*Dl[r]+kl[t]*Fl[r]),s=jl(Dl[t]*Ll[r]+Ll[t]*kl[r]),o=jl(Fl[t]*Ll[r]+kl[t]*kl[r]),a=0;a<16;a++)if(Dl[a]===i&&Fl[a]===n&&Ll[a]===s&&kl[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new Ml;h.set(Dl[t],Fl[t],Ll[t],kl[t],0,0),Bl.push(h)}}();var Xl={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Dl[t]},uY:function(t){return Fl[t]},vX:function(t){return Ll[t]},vY:function(t){return kl[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Ul[t][e]},sub:function(t,e){return Ul[t][Xl.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Xl.S:Xl.N:2*Math.abs(e)<=Math.abs(t)?t>0?Xl.E:Xl.W:e>0?t>0?Xl.SE:Xl.SW:t>0?Xl.NE:Xl.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=Bl[Xl.inv(e)];n.tx=r,n.ty=i,t.append(n)}},Gl=function(){function t(){this.worldTransform=new Ml,this.localTransform=new Ml,this.position=new Ol(this.onChange,this,0,0),this.scale=new Ol(this.onChange,this,1,1),this.pivot=new Ol(this.onChange,this,0,0),this.skew=new Ol(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),zl=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=Sl.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}(),Vl=(function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=Sl.CIRC}t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new zl(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}(),function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=Sl.ELIP}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new zl(this.x-this.width,this.y-this.height,this.width,this.height)}}(),function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof Cl){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=Sl.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r},t}());!function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=Sl.RREC}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1}}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
al.SORTABLE_CHILDREN=!1;var Hl=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};Hl.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Hl.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Hl.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?zl.EMPTY:((t=t||new zl(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Hl.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Hl.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},Hl.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},Hl.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},Hl.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},Hl.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},Hl.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},Hl.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},Hl.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Hl.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},Hl.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Hl.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},Hl.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var $l=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new Gl,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Hl,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new zl),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new zl),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*Nl},r.angle.set=function(t){this.transform.rotation=t*Pl},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function Wl(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}$l.prototype.displayObjectUpdateTransform=$l.prototype.updateTransform;var Yl=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=al.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);ml(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,ml(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,ml(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Wl),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}($l);Yl.prototype.containerUpdateTransform=Yl.prototype.updateTransform;
/*!
 * @pixi/core - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var ql=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new hl("setRealSize",2),this.onUpdate=new hl("update"),this.onError=new hl("onError",1)},Kl={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};ql.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},ql.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},ql.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},Kl.valid.get=function(){return!!this._width&&!!this._height},ql.prototype.update=function(){this.destroyed||this.onUpdate.run()},ql.prototype.load=function(){return Promise.resolve()},Kl.width.get=function(){return this._width},Kl.height.get=function(){return this._height},ql.prototype.upload=function(t,e,r){return!1},ql.prototype.style=function(t,e,r){return!1},ql.prototype.dispose=function(){},ql.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(ql.prototype,Kl);var Zl=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,Tl||(Tl=document.createElement("a")),Tl.href=t;var r=Object(W.parse)(Tl.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Bu.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(ql),Jl=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:al.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===Bu.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(Zl),Ql=[];function tc(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=Ql.length-1;n>=0;--n){var s=Ql[n];if(s.test&&s.test(t,r))return new s(t,e)}return new Jl(t,e)}var ec=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Bu.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(ql),rc={scaleMode:Lu.NEAREST,format:Mu.RGBA,alphaMode:Bu.NPM},ic=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof ql||((e=tc(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||al.RESOLUTION,this.mipmap=void 0!==n?n:al.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:al.ANISOTROPIC_LEVEL,this.wrapMode=u||al.WRAP_MODE,this.scaleMode=void 0!==o?o:al.SCALE_MODE,this.format=l||Mu.RGBA,this.type=c||Fu.UNSIGNED_BYTE,this.target=d||Du.TEXTURE_2D,this.alphaMode=void 0!==i?i:Bu.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=yl(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=pl(this.realWidth)&&pl(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete xl[this.cacheId],delete bl[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=al.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+yl()),s=t._pixiId);var o=xl[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new ec(t,{width:r,height:i}),o=t instanceof Float32Array?Fu.FLOAT:Fu.UNSIGNED_BYTE;return new e(s,Object.assign(rc,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),xl[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),xl[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=xl[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete xl[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete xl[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);ic._globalBatch=0;var nc=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new ic;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(tc(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Du.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(ql),sc=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(Zl),oc=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=Du.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Du.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(nc);oc.SIDES=6;var ac=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+yl(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(Zl);ac.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var hc=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=Al.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Al.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Al.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&Al.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Al.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Al.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(Zl);hc.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var uc=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(Zl);Ql.push(Jl,uc,sc,hc,ac,ec,oc,nc);var lc=function(t){this.renderer=t};lc.prototype.destroy=function(){this.renderer=null};var cc=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Bu.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(ec),dc=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new hl("disposeFramebuffer",2)},pc={colorTexture:{configurable:!0}};pc.colorTexture.get=function(){return this.colorTextures[0]},dc.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new ic(null,{scaleMode:Lu.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},dc.prototype.addDepthTexture=function(t){return this.depthTexture=t||new ic(new cc(null,{width:this.width,height:this.height}),{scaleMode:Lu.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:Mu.DEPTH_COMPONENT,type:Fu.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},dc.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},dc.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},dc.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},dc.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(dc.prototype,pc);var fc=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new dc(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(ic),mc=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};mc.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=Xl.add(r,Xl.NW),this.x0=a+s*Xl.uX(r),this.y0=h+o*Xl.uY(r),r=Xl.add(r,2),this.x1=a+s*Xl.uX(r),this.y1=h+o*Xl.uY(r),r=Xl.add(r,2),this.x2=a+s*Xl.uX(r),this.y2=h+o*Xl.uY(r),r=Xl.add(r,2),this.x3=a+s*Xl.uX(r),this.y3=h+o*Xl.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var gc=new mc,yc=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new zl(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=gc,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new Cl(a.x,a.y):new Cl(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&bl[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===gc&&(this._uvs=new mc),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=al.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+yl()),s=t._pixiId);var o=bl[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=wl(t)),(o=new e(new ic(t,r))).baseTexture.cacheId=s,ic.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(ic.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new Jl(t);n.url=r;var s=new e(new ic(n,{scaleMode:al.SCALE_MODE,resolution:wl(r)}));return i||(i=r),ic.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(ic.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),bl[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),bl[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=bl[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete bl[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)bl[t.textureCacheIds[i]]===t&&delete bl[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function vc(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}yc.EMPTY=new yc(new ic),vc(yc.EMPTY),vc(yc.EMPTY.baseTexture),yc.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new yc(new ic(new sc(t)))}(),vc(yc.WHITE),vc(yc.WHITE.baseTexture);var _c=function(t){function e(e,r){var i=null;if(!(e instanceof fc)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new fc({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new fc(t))},e}(yc),bc=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};bc.prototype.createTexture=function(t,e){var r=new fc(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new _c(r)},bc.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=bc.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=dl(t)))<<16|65535&(e=dl(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},bc.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},bc.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},bc.prototype.returnFilterTexture=function(t){this.returnTexture(t)},bc.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},bc.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=bc.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},bc.SCREEN_KEY="screen";var xc=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};xc.prototype.destroy=function(){this.buffer=null},xc.from=function(t,e,r,i,n){return new xc(t,e,r,i,n)};var Tc=0,Ec=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=Tc++,this.disposeRunner=new hl("disposeBuffer",2)};function wc(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}Ec.prototype.update=function(t){this.data=t||this.data,this._updateID++},Ec.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Ec.prototype.destroy=function(){this.dispose(),this.data=null},Ec.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new Ec(t)};var Sc={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var Ic={5126:4,5123:2,5121:1},Ac=0,Cc={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},Oc=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Ac++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new hl("disposeGeometry",2),this.refCount=0};Oc.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Ec(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new xc(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},Oc.prototype.getAttribute=function(t){return this.attributes[t]},Oc.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},Oc.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ec(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},Oc.prototype.getIndex=function(){return this.indexBuffer},Oc.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new Ec;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*Ic[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=wc(c);n[d]||(n[d]=new Sc[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Oc.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Oc.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Oc.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Oc.prototype.clone=function(){for(var t=new Oc,e=0;e<this.buffers.length;e++)t.buffers[e]=new Ec(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new xc(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},Oc.merge=function(t){for(var e,r=new Oc,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(Cc[wc(e.buffers[h].data)])(n[h]),r.buffers[h]=new Ec(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*Ic[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var Rc=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Oc),Nc=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ec(this.vertices),this.uvBuffer=new Ec(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Oc),Pc=0,Mc=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Pc++,this.static=!!e};Mc.prototype.update=function(){this.dirtyId++},Mc.prototype.add=function(t,e,r){this.uniforms[t]=new Mc(e,r)},Mc.from=function(t,e){return new Mc(t,e)};var Dc=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new zl,this.destinationFrame=new zl,this.filters=[]};Dc.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var Fc=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new bc,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new Rc,this.quadUv=new Nc,this.tempRect=new zl,this.activeState={},this.globalUniforms=new Mc({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new Dc,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Pu.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Pu.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(Ml.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(lc),Lc=function(t){this.renderer=t};Lc.prototype.flush=function(){},Lc.prototype.destroy=function(){this.renderer=null},Lc.prototype.start=function(){},Lc.prototype.stop=function(){this.flush()},Lc.prototype.render=function(t){};var kc=function(t){function e(e){t.call(this,e),this.emptyRenderer=new Lc(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(lc);al.PREFER_ENV=ol.any?Ou.WEBGL:Ou.WEBGL2,al.STRICT_TEXTURE_CACHE=!1;var Uc=0,Bc=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Uc++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Uc++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(al.PREFER_ENV>=Ou.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(lc),jc=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new dc(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new zl,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;al.PREFER_ENV===Ou.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new zl},Object.defineProperties(e.prototype,r),e}(lc),Xc=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},Gc={5126:4,5123:2,5121:1},zc=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;al.PREFER_ENV===Ou.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Gc[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*Gc[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*Gc[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new Xc(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(lc),Vc=function(t){this.type=Gu.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function Hc(t,e,r,i){var n=$c(t,t.VERTEX_SHADER,e),s=$c(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function $c(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function Wc(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return Yc(2*e);case"bvec3":return Yc(3*e);case"bvec4":return Yc(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Yc(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}Vc.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Gu.NONE,this.autoDetect=!0),this._target=null},Vc.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var qc,Kc={},Zc=Kc;function Jc(){if(Zc===Kc||Zc&&Zc.isContextLost()){var t,e=document.createElement("canvas");al.PREFER_ENV>=Ou.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),Zc=t}return Zc}function Qc(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===Xu.HIGH&&r!==Xu.HIGH&&(i=Xu.MEDIUM),"precision "+i+" float;\n"+t}return r!==Xu.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var td={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function ed(t){return td[t]}var rd=null,id={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function nd(t,e){if(!rd){var r=Object.keys(id);rd={};for(var i=0;i<r.length;++i){var n=r[i];rd[t[n]]=id[n]}}return rd[e]}var sd={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},od={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var ad,hd=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function ud(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var ld=0,cd={},dd=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=ld++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),cd[i]?(cd[i]++,i+="-"+cd[i]):cd[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Qc(this.vertexSrc,al.PRECISION_VERTEX,Xu.HIGH),this.fragmentSrc=Qc(this.fragmentSrc,al.PRECISION_FRAGMENT,function(){if(!qc){qc=Xu.MEDIUM;var t=Jc();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);qc=e.precision?Xu.HIGH:Xu.MEDIUM}}return qc}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},pd={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};dd.prototype.extractData=function(t,e){var r=Jc();if(r){var i=Hc(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},dd.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=nd(e,o.type),h={type:a,name:o.name,size:ed(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},dd.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=nd(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:Wc(h,s.size)}}return r},pd.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},pd.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},dd.from=function(t,e,r){var i=t+e,n=_l[i];return n||(_l[i]=n=new dd(t,e,r)),n},Object.defineProperties(dd,pd);var fd=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof Mc?e:new Mc(e):new Mc({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},md={uniforms:{configurable:!0}};fd.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},fd.prototype.destroy=function(){this.uniformGroup=null},md.uniforms.get=function(){return this.uniformGroup.uniforms},fd.from=function(t,e,r){var i=dd.from(t,e);return new fd(i,r)},Object.defineProperties(fd.prototype,md);var gd=function(){this.data=0,this.blendMode=Nu.NORMAL,this.polygonOffset=0,this.blend=!0},yd={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};yd.blend.get=function(){return!!(1&this.data)},yd.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},yd.offsets.get=function(){return!!(2&this.data)},yd.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},yd.culling.get=function(){return!!(4&this.data)},yd.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},yd.depthTest.get=function(){return!!(8&this.data)},yd.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},yd.clockwiseFrontFace.get=function(){return!!(16&this.data)},yd.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},yd.blendMode.get=function(){return this._blendMode},yd.blendMode.set=function(t){this.blend=t!==Nu.NONE,this._blendMode=t},yd.polygonOffset.get=function(){return this._polygonOffset},yd.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},gd.for2d=function(){var t=new gd;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(gd.prototype,yd);var vd=function(t){function e(r,i,n){var s=dd.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=al.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new gd}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(fd);vd.SOURCE_KEY_MAP={};var _d=new Ml,bd=function(t,e){this._texture=t,this.mapCoord=new Ml,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},xd={texture:{configurable:!0}};xd.texture.get=function(){return this._texture},xd.texture.set=function(t){this._texture=t,this._updateID=-1},bd.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},bd.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(_d.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(_d));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(bd.prototype,xd);var Td=function(t){function e(e){var r=new Ml;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new bd(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(vd),Ed=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new Vc;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case Gu.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case Gu.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case Gu.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Gu.SCISSOR:this.renderer.scissor.pop();break;case Gu.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Gu.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Gu.SPRITE;else if(t.type=Gu.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=Gu.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new Td(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(lc),wd=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(lc),Sd=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(wd),Id=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(wd),Ad=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ml,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(lc),Cd=new zl,Od=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new zl,this.destinationFrame=new zl}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(Cd.width=s.realWidth,Cd.height=s.realHeight,r=Cd),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(Cd.width=n.width,Cd.height=n.height,r=Cd),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(lc),Rd=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};Rd.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var Nd=0,Pd={textureCount:0},Md=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=Nd++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof ad)return ad;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");ad=!0===t({a:"b"},"a","b")}catch(t){ad=!1}return ad}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(Pd.textureCount=0,this.syncUniformGroup(t.uniformGroup,Pd)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?sd:od)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=Hc(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:Wc(h.type,h.size)}}var u=new Rd(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(lc);var Dd=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Nu.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new gd,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[Nu.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.ADD]=[t.ONE,t.ONE],e[Nu.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.NONE]=[0,0],e[Nu.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Nu.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Nu.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Nu.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Nu.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Nu.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Nu.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Nu.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Nu.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Nu.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Nu.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(lc),Fd=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=al.GC_MAX_IDLE,this.checkCountMax=al.GC_MAX_CHECK_COUNT,this.mode=al.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==ju.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(lc),Ld=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},kd=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ic}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new Ld(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Ld(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new Ld(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===Fu.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&ml(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==Uu.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=ku.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Lu.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Lu.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Lu.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===Lu.LINEAR?r.LINEAR:r.NEAREST)},e}(lc),Ud=new Ml;V.a;var Bd=function(){this.texArray=null,this.blend=0,this.type=Pu.TRIANGLES,this.start=0,this.size=0,this.data=null},jd=function(){this.elements=[],this.ids=[],this.count=0};jd.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var Xd=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},Gd={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Gd.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Gd.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Gd.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Gd.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Gd.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Xd.prototype.view=function(t){return this[t+"View"]},Xd.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Xd.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Xd.prototype,Gd);var zd=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=gd.for2d(),this.size=4*al.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;al.PREFER_ENV===Ou.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),al.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=hd.replace(/%forloop%/gi,ud(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Bd);for(;r.length<n;)r.push(new jd);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++ic._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;ic._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=cl[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;al.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),al.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=dl(Math.ceil(t/8)),r=fl(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new Xd(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=dl(Math.ceil(t/12)),r=fl(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(Lc);zd._drawCallPool=[],zd._textureArrayPool=[];var Vd=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};Vd.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=Mc.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new dd(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ml,default:this.defaultGroupCache[t]};return new fd(this.programCache[t],n)},Vd.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var Hd=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new Ec(null,e,!1),this._indexBuffer=new Ec(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Fu.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Fu.FLOAT).addAttribute("aColor",this._buffer,4,!0,Fu.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Fu.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Oc),$d="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Wd="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Yd=function(){},qd={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};Yd.create=function(t){var e=Object.assign({vertex:$d,fragment:Wd,geometryClass:Hd,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new Vd(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(zd)},qd.defaultVertexSrc.get=function(){return $d},qd.defaultFragmentTemplate.get=function(){return Wd},Object.defineProperties(Yd,qd);Yd.create();
/*!
 * @pixi/mesh - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Kd=function(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0};Kd.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}};var Zd=new Cl,Jd=new Vl,Qd=function(t){function e(e,r,i,n){void 0===n&&(n=Pu.TRIANGLES),t.call(this),this.geometry=e,e.refCount++,this.shader=r,this.state=i||gd.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=0,this._transformID=-1,this.tint=16777215,this.blendMode=Nu.NORMAL,this._roundPixels=al.ROUND_PIXELS,this.batchUvs=null}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={uvBuffer:{configurable:!0},verticesBuffer:{configurable:!0},material:{configurable:!0},blendMode:{configurable:!0},roundPixels:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return r.uvBuffer.get=function(){return this.geometry.buffers[1]},r.verticesBuffer.get=function(){return this.geometry.buffers[0]},r.material.set=function(t){this.shader=t},r.material.get=function(){return this.shader},r.blendMode.set=function(t){this.state.blendMode=t},r.blendMode.get=function(){return this.state.blendMode},r.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},r.roundPixels.get=function(){return this._roundPixels},r.tint.get=function(){return this.shader.tint},r.tint.set=function(t){this.shader.tint=t},r.texture.get=function(){return this.shader.texture},r.texture.set=function(t){this.shader.texture=t},e.prototype._render=function(t){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Pu.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var r=this.transform.worldTransform,i=r.a,n=r.b,s=r.c,o=r.d,a=r.tx,h=r.ty,u=this.vertexData,l=0;l<u.length/2;l++){var c=e[2*l],d=e[2*l+1];u[2*l]=i*c+s*d+a,u[2*l+1]=n*c+o*d+h}if(this._roundPixels)for(var p=al.RESOLUTION,f=0;f<u.length;++f)u[f]=Math.round((u[f]*p|0)/p);this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Kd(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Zd);for(var e=this.geometry.getBuffer("aVertexPosition").data,r=Jd.points,i=this.geometry.getIndex().data,n=i.length,s=4===this.drawMode?3:1,o=0;o+2<n;o+=s){var a=2*i[o],h=2*i[o+1],u=2*i[o+2];if(r[0]=e[a],r[1]=e[a+1],r[2]=e[h],r[3]=e[h+1],r[4]=e[u],r[5]=e[u+1],Jd.contains(Zd.x,Zd.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Object.defineProperties(e.prototype,r),e}(Yl);Qd.BATCHABLE_SIZE=100;var tp=function(t){function e(e,r){var i={uSampler:e,alpha:1,uTextureMatrix:Ml.IDENTITY,uColor:new Float32Array([1,1,1,1])};(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(i,r.uniforms),t.call(this,r.program||dd.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),i),this._colorDirty=!1,this.uvMatrix=new bd(e),this.batchable=void 0===r.program,this.pluginName=r.pluginName,this.tint=r.tint,this.alpha=r.alpha}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={texture:{configurable:!0},alpha:{configurable:!0},tint:{configurable:!0}};return r.texture.get=function(){return this.uniforms.uSampler},r.texture.set=function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},r.alpha.set=function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},r.alpha.get=function(){return this._alpha},r.tint.set=function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},r.tint.get=function(){return this._tint},e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;e=this._tint,r=this._alpha,i=this.uniforms.uColor,n=t.alphaMode,(i=i||new Float32Array(4))[0]=(e>>16&255)/255,i[1]=(e>>8&255)/255,i[2]=(255&e)/255,(n||void 0===n)&&(i[0]*=r,i[1]*=r,i[2]*=r),i[3]=r}var e,r,i,n;this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},Object.defineProperties(e.prototype,r),e}(fd),ep=function(t){function e(e,r,i){t.call(this);var n=new Ec(e),s=new Ec(r,!0),o=new Ec(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,Fu.FLOAT).addAttribute("aTextureCoord",s,2,!1,Fu.FLOAT).addIndex(o),this._updateId=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={vertexDirtyId:{configurable:!0}};return r.vertexDirtyId.get=function(){return this.buffers[0]._updateID},Object.defineProperties(e.prototype,r),e}(Oc),rp=function(t){function e(e,r,i,n){void 0===e&&(e=100),void 0===r&&(r=100),void 0===i&&(i=10),void 0===n&&(n=10),t.call(this),this.segWidth=i,this.segHeight=n,this.width=e,this.height=r,this.build()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],r=[],i=[],n=this.segWidth-1,s=this.segHeight-1,o=this.width/n,a=this.height/s,h=0;h<t;h++){var u=h%this.segWidth,l=h/this.segWidth|0;e.push(u*o,l*a),r.push(u/n,l/s)}for(var c=n*s,d=0;d<c;d++){var p=d%n,f=d/n|0,m=f*this.segWidth+p,g=f*this.segWidth+p+1,y=(f+1)*this.segWidth+p,v=(f+1)*this.segWidth+p+1;i.push(m,g,y,g,v,y)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(ep),ip=function(t){function e(e,r,i){void 0===e&&(e=200),void 0===i&&(i=0),t.call(this,new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1))),this.points=r,this.width=e,this.textureScale=i,this.build()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),i=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),r.data=new Float32Array(4*t.length),i.data=new Uint16Array(6*(t.length-1)));var n=r.data,s=i.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;for(var o=0,a=t[0],h=this.width*this.textureScale,u=t.length,l=0;l<u;l++){var c=4*l;if(this.textureScale>0){var d=a.x-t[l].x,p=a.y-t[l].y,f=Math.sqrt(d*d+p*p);a=t[l],o+=f/h}else o=l/(u-1);n[c]=o,n[c+1]=0,n[c+2]=o,n[c+3]=1}for(var m=0,g=0;g<u-1;g++){var y=2*g;s[m++]=y,s[m++]=y+1,s[m++]=y+2,s[m++]=y+2,s[m++]=y+1,s[m++]=y+3}r.update(),i.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,r=t[0],i=0,n=0,s=this.buffers[0].data,o=t.length,a=0;a<o;a++){var h=t[a],u=4*a;n=-((e=a<t.length-1?t[a+1]:h).x-r.x),i=e.y-r.y;var l=Math.sqrt(i*i+n*n),c=this.textureScale>0?this.textureScale*this.width/2:this.width/2;i/=l,n/=l,i*=c,n*=c,s[u]=h.x+i,s[u+1]=h.y+n,s[u+2]=h.x-i,s[u+3]=h.y-n,r=h}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(ep),np=function(t){function e(e,r,i){void 0===i&&(i=0);var n=new ip(e.height,r,i),s=new tp(e);i>0&&(e.baseTexture.wrapMode=ku.REPEAT),t.call(this,n,s),this.autoUpdate=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._render=function(e){(this.autoUpdate||this.geometry.width!==this.shader.texture.height)&&(this.geometry.width=this.shader.texture.height,this.geometry.update()),t.prototype._render.call(this,e)},e}(Qd),sp=function(t){function e(e,r,i){var n=new rp(e.width,e.height,r,i),s=new tp(yc.WHITE);t.call(this,n,s),this.texture=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={texture:{configurable:!0}};return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this.geometry.width=this.shader.texture.width,this.geometry.height=this.shader.texture.height,this.geometry.build()},r.texture.set=function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},r.texture.get=function(){return this.shader.texture},e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},Object.defineProperties(e.prototype,r),e}(Qd),op=function(t){function e(e,r,i,n,s){void 0===e&&(e=yc.EMPTY);var o=new ep(r,i,n);o.getBuffer("aVertexPosition").static=!1;var a=new tp(e);t.call(this,o,a,null,s),this.autoUpdate=!0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={vertices:{configurable:!0}};return r.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data},r.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},Object.defineProperties(e.prototype,r),e}(Qd),ap=function(t){function e(e,r,i,n,s){t.call(this,yc.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=void 0!==r?r:10,this._rightWidth=void 0!==n?n:10,this._topHeight=void 0!==i?i:10,this._bottomHeight=void 0!==s?s:10,this.texture=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={vertices:{configurable:!0},width:{configurable:!0},height:{configurable:!0},leftWidth:{configurable:!0},rightWidth:{configurable:!0},topHeight:{configurable:!0},bottomHeight:{configurable:!0}};return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},r.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data},r.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,r=this._topHeight+this._bottomHeight,i=this._height>r?1:this._height/r;return Math.min(e,i)},r.width.get=function(){return this._width},r.width.set=function(t){this._width=t,this._refresh()},r.height.get=function(){return this._height},r.height.set=function(t){this._height=t,this._refresh()},r.leftWidth.get=function(){return this._leftWidth},r.leftWidth.set=function(t){this._leftWidth=t,this._refresh()},r.rightWidth.get=function(){return this._rightWidth},r.rightWidth.set=function(t){this._rightWidth=t,this._refresh()},r.topHeight.get=function(){return this._topHeight},r.topHeight.set=function(t){this._topHeight=t,this._refresh()},r.bottomHeight.get=function(){return this._bottomHeight},r.bottomHeight.set=function(t){this._bottomHeight=t,this._refresh()},e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var r=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=r*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-r*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},Object.defineProperties(e.prototype,r),e}(sp),hp=function(t){this.renderer=t};hp.prototype.render=function(t){var e=this.renderer,r=t.worldTransform;e.context.globalAlpha=t.worldAlpha,e.setBlendMode(t.blendMode),e.setContextTransform(r,t.roundPixels),t.drawMode!==Pu.TRIANGLES?this._renderTriangleMesh(t):this._renderTriangles(t)},hp.prototype._renderTriangleMesh=function(t){for(var e=t.geometry.buffers[0].data.length,r=0;r<e-2;r++){var i=2*r;this._renderDrawTriangle(t,i,i+2,i+4)}},hp.prototype._renderTriangles=function(t){for(var e=t.geometry.getIndex().data,r=e.length,i=0;i<r;i+=3){var n=2*e[i],s=2*e[i+1],o=2*e[i+2];this._renderDrawTriangle(t,n,s,o)}},hp.prototype._renderDrawTriangle=function(t,e,r,i){var n=this.renderer.context,s=t.geometry.buffers[0].data,o=t.uvs,a=t.texture;if(a.valid){var h=a.baseTexture,u=h.getDrawableSource(),l=h.width,c=h.height,d=o[e]*h.width,p=o[r]*h.width,f=o[i]*h.width,m=o[e+1]*h.height,g=o[r+1]*h.height,y=o[i+1]*h.height,v=s[e],_=s[r],b=s[i],x=s[e+1],T=s[r+1],E=s[i+1],w=t.canvasPadding/this.renderer.resolution;if(w>0){var S=w/Math.abs(t.worldTransform.a),I=w/Math.abs(t.worldTransform.d),A=(v+_+b)/3,C=(x+T+E)/3,O=v-A,R=x-C,N=Math.sqrt(O*O+R*R);v=A+O/N*(N+S),x=C+R/N*(N+I),R=T-C,_=A+(O=_-A)/(N=Math.sqrt(O*O+R*R))*(N+S),T=C+R/N*(N+I),R=E-C,b=A+(O=b-A)/(N=Math.sqrt(O*O+R*R))*(N+S),E=C+R/N*(N+I)}n.save(),n.beginPath(),n.moveTo(v,x),n.lineTo(_,T),n.lineTo(b,E),n.closePath(),n.clip();var P=d*g+m*f+p*y-g*f-m*p-d*y,M=v*g+m*b+_*y-g*b-m*_-v*y,D=d*_+v*f+p*b-_*f-v*p-d*b,F=d*g*b+m*_*f+v*p*y-v*g*f-m*p*b-d*_*y,L=x*g+m*E+T*y-g*E-m*T-x*y,k=d*T+x*f+p*E-T*f-x*p-d*E,U=d*g*E+m*T*f+x*p*y-x*g*f-m*p*E-d*T*y;n.transform(M/P,L/P,D/P,k/P,F/P,U/P),n.drawImage(u,0,0,l*h.resolution,c*h.resolution,0,0,l,c),n.restore(),this.renderer.invalidateBlendMode()}},hp.prototype.renderMeshFlat=function(t){var e=this.renderer.context,r=t.geometry.getBuffer("aVertexPosition").data,i=r.length/2;e.beginPath();for(var n=1;n<i-2;++n){var s=2*n,o=r[s],a=r[s+1],h=r[s+2],u=r[s+3],l=r[s+4],c=r[s+5];e.moveTo(o,a),e.lineTo(h,u),e.lineTo(l,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},hp.prototype.destroy=function(){this.renderer=null},al.MESH_CANVAS_PADDING=0,tp.prototype._renderCanvas=function(t,e){t.plugins.mesh.render(e)},ap.prototype._cachedTint=16777215,ap.prototype._tintedCanvas=null,ap.prototype._canvasUvs=null,ap.prototype._renderCanvas=function(t){var e=t.context,r=this.worldTransform,i=16777215!==this.tint,n=this.texture;if(n.valid){i&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedCanvas=Cu.getTintedCanvas(this,this.tint));var s=i?this._tintedCanvas:n.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var o=this.vertices,a=this._canvasUvs,h=i?0:n.frame.x,u=i?0:n.frame.y,l=h+n.frame.width,c=u+n.frame.height;a[0]=h,a[1]=h+this._leftWidth,a[2]=l-this._rightWidth,a[3]=l,a[4]=u,a[5]=u+this._topHeight,a[6]=c-this._bottomHeight,a[7]=c;for(var d=0;d<8;d++)a[d]*=n.baseTexture.resolution;e.globalAlpha=this.worldAlpha,t.setBlendMode(this.blendMode),t.setContextTransform(r,this.roundPixels);for(var p=0;p<3;p++)for(var f=0;f<3;f++){var m=2*f+8*p,g=Math.max(1,a[f+1]-a[f]),y=Math.max(1,a[p+5]-a[p+4]),v=Math.max(1,o[m+10]-o[m]),_=Math.max(1,o[m+11]-o[m+1]);e.drawImage(s,a[f],a[p+4],g,y,o[m],o[m+1],v,_)}}},Qd.prototype._renderCanvas=function(t){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas(t,this)},Qd.prototype._canvasPadding=null,Object.defineProperty(Qd.prototype,"canvasPadding",{get:function(){return null!==this._canvasPadding?this._canvasPadding:al.MESH_CANVAS_PADDING},set:function(t){this._canvasPadding=t}}),op.prototype._renderCanvas=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(t,this)},np.prototype._renderCanvas=function(t){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(t,this)};
/*!
 * @pixi/math - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var up,lp=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),cp=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),dp=2*Math.PI,pp=180/Math.PI,fp=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(up||(up={}));var mp=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new lp;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new lp;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(dp-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),gp=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],yp=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vp=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],_p=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],bp=[],xp=[],Tp=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];bp.push(e);for(var r=0;r<16;r++)for(var i=Tp(gp[t]*gp[r]+vp[t]*yp[r]),n=Tp(yp[t]*gp[r]+_p[t]*yp[r]),s=Tp(gp[t]*vp[r]+vp[t]*_p[r]),o=Tp(yp[t]*vp[r]+_p[t]*_p[r]),a=0;a<16;a++)if(gp[a]===i&&yp[a]===n&&vp[a]===s&&_p[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new mp;h.set(gp[t],yp[t],vp[t],_p[t],0,0),xp.push(h)}}();var Ep={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return gp[t]},uY:function(t){return yp[t]},vX:function(t){return vp[t]},vY:function(t){return _p[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return bp[t][e]},sub:function(t,e){return bp[t][Ep.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Ep.S:Ep.N:2*Math.abs(e)<=Math.abs(t)?t>0?Ep.E:Ep.W:e>0?t>0?Ep.SE:Ep.SW:t>0?Ep.NE:Ep.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=xp[Ep.inv(e)];n.tx=r,n.ty=i,t.append(n)}},wp=function(){function t(){this.worldTransform=new mp,this.localTransform=new mp,this.position=new cp(this.onChange,this,0,0),this.scale=new cp(this.onChange,this,1,1),this.pivot=new cp(this.onChange,this,0,0),this.skew=new cp(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),Sp=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=up.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}(),Ip=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=up.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new Sp(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}(),Ap=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=up.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new Sp(this.x-this.width,this.y-this.height,this.width,this.height)},t}(),Cp=function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof lp){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=up.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r},t}(),Op=function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=up.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1},t}(),Rp=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(Rp.prototype,{dispatch:{value:Rp.prototype.emit},run:{value:Rp.prototype.emit}});var Np=/iPhone/i,Pp=/iPod/i,Mp=/iPad/i,Dp=/\biOS-universal(?:.+)Mac\b/i,Fp=/\bAndroid(?:.+)Mobile\b/i,Lp=/Android/i,kp=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Up=/Silk/i,Bp=/Windows Phone/i,jp=/\bWindows(?:.+)ARM\b/i,Xp=/BlackBerry/i,Gp=/BB10/i,zp=/Opera Mini/i,Vp=/\b(CriOS|Chrome)(?:.+)Mobile/i,Hp=/Mobile(?:.+)Firefox\b/i,$p=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Wp=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(Np)&&!n(Bp),ipod:n(Pp),tablet:!n(Np)&&(n(Mp)||$p(e))&&!n(Bp),universal:n(Dp),device:(n(Np)||n(Pp)||n(Mp)||n(Dp)||$p(e))&&!n(Bp)},amazon:{phone:n(kp),tablet:!n(kp)&&n(Up),device:n(kp)||n(Up)},android:{phone:!n(Bp)&&n(kp)||!n(Bp)&&n(Fp),tablet:!n(Bp)&&!n(kp)&&!n(Fp)&&(n(Up)||n(Lp)),device:!n(Bp)&&(n(kp)||n(Up)||n(Fp)||n(Lp))||n(/\bokhttp\b/i)},windows:{phone:n(Bp),tablet:n(jp),device:n(Bp)||n(jp)},other:{blackberry:n(Xp),blackberry10:n(Gp),opera:n(zp),firefox:n(Hp),chrome:n(Vp),device:n(Xp)||n(Gp)||n(zp)||n(Hp)||n(Vp)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var Yp,qp,Kp,Zp,Jp,Qp,tf,ef,rf,nf,sf,of,af,hf,uf={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(Wp.tablet||Wp.phone){if(e=!1,Wp.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(Wp.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:Wp.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!Wp.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};
/*!
 * @pixi/constants - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(Yp||(Yp={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(qp||(qp={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Kp||(Kp={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Zp||(Zp={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Jp||(Jp={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Qp||(Qp={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(tf||(tf={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(ef||(ef={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(rf||(rf={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(nf||(nf={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(sf||(sf={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(of||(of={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(af||(af={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(hf||(hf={})),
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
uf.RETINA_PREFIX=/@([0-9\.]+)x/,uf.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var lf,cf=!1;function df(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}var pf=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[Kp.NORMAL_NPM]=Kp.NORMAL,t[Kp.ADD_NPM]=Kp.ADD,t[Kp.SCREEN_NPM]=Kp.SCREEN,e[Kp.NORMAL]=Kp.NORMAL_NPM,e[Kp.ADD]=Kp.ADD_NPM,e[Kp.SCREEN]=Kp.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();function ff(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}Float32Array,Uint32Array,Int32Array,Uint8Array;function mf(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function gf(t){return!(t&t-1||!t)}function yf(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function vf(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}var _f=0;function bf(){return++_f}var xf={};function Tf(t,e,r){if(void 0===r&&(r=3),!xf[e]){var i=(new Error).stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),xf[e]=!0}}var Ef={},wf=Object.create(null),Sf=Object.create(null);!function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||uf.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0})}();var If,Af;function Cf(t,e){var r=uf.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */uf.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(Af||(Af={}));var Of=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Rf=function(){function t(){var t=this;this._head=new Of(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/uf.TARGET_FPMS,this.elapsedMS=1/uf.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=Af.NORMAL),this._addListener(new Of(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=Af.NORMAL),this._addListener(new Of(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*uf.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,uf.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}();!function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Af.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Rf.shared:new Rf,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
uf.SORTABLE_CHILDREN=!1;var Nf=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};Nf.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Nf.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Nf.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Sp.EMPTY:((t=t||new Sp(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Nf.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Nf.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},Nf.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},Nf.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},Nf.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},Nf.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},Nf.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},Nf.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},Nf.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Nf.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},Nf.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Nf.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},Nf.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var Pf=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new wp,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Nf,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Sp),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Sp),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*pp},r.angle.set=function(t){this.transform.rotation=t*fp},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function Mf(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}Pf.prototype.displayObjectUpdateTransform=Pf.prototype.updateTransform;var Df=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=uf.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);vf(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,vf(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,vf(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Mf),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(Pf);Df.prototype.containerUpdateTransform=Df.prototype.updateTransform;
/*!
 * @pixi/core - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Ff=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Rp("setRealSize",2),this.onUpdate=new Rp("update"),this.onError=new Rp("onError",1)},Lf={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};Ff.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},Ff.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},Ff.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},Lf.valid.get=function(){return!!this._width&&!!this._height},Ff.prototype.update=function(){this.destroyed||this.onUpdate.run()},Ff.prototype.load=function(){return Promise.resolve()},Lf.width.get=function(){return this._width},Lf.height.get=function(){return this._height},Ff.prototype.upload=function(t,e,r){return!1},Ff.prototype.style=function(t,e,r){return!1},Ff.prototype.dispose=function(){},Ff.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(Ff.prototype,Lf);var kf=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,If||(If=document.createElement("a")),If.href=t;var r=Object(W.parse)(If.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===sf.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(Ff),Uf=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:uf.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===sf.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(kf),Bf=[];function jf(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=Bf.length-1;n>=0;--n){var s=Bf[n];if(s.test&&s.test(t,r))return new s(t,e)}return new Uf(t,e)}var Xf=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===sf.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(Ff),Gf={scaleMode:ef.NEAREST,format:Jp.RGBA,alphaMode:sf.NPM},zf=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof Ff||((e=jf(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||uf.RESOLUTION,this.mipmap=void 0!==n?n:uf.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:uf.ANISOTROPIC_LEVEL,this.wrapMode=u||uf.WRAP_MODE,this.scaleMode=void 0!==o?o:uf.SCALE_MODE,this.format=l||Jp.RGBA,this.type=c||tf.UNSIGNED_BYTE,this.target=d||Qp.TEXTURE_2D,this.alphaMode=void 0!==i?i:sf.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=bf(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=gf(this.realWidth)&&gf(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Sf[this.cacheId],delete wf[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=uf.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+bf()),s=t._pixiId);var o=Sf[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new Xf(t,{width:r,height:i}),o=t instanceof Float32Array?tf.FLOAT:tf.UNSIGNED_BYTE;return new e(s,Object.assign(Gf,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Sf[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Sf[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Sf[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Sf[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Sf[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);zf._globalBatch=0;var Vf=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new zf;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(jf(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Qp.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(Ff),Hf=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(kf),$f=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=Qp.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Qp.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(Vf);$f.SIDES=6;var Wf=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+bf(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(kf);Wf.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Yf=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=Rf.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Rf.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Rf.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&Rf.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Rf.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Rf.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(kf);Yf.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var qf=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(kf);Bf.push(Uf,qf,Hf,Yf,Wf,Xf,$f,Vf);var Kf=function(t){this.renderer=t};Kf.prototype.destroy=function(){this.renderer=null};var Zf=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===sf.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(Xf),Jf=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Rp("disposeFramebuffer",2)},Qf={colorTexture:{configurable:!0}};Qf.colorTexture.get=function(){return this.colorTextures[0]},Jf.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new zf(null,{scaleMode:ef.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Jf.prototype.addDepthTexture=function(t){return this.depthTexture=t||new zf(new Zf(null,{width:this.width,height:this.height}),{scaleMode:ef.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:Jp.DEPTH_COMPONENT,type:tf.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},Jf.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Jf.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Jf.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},Jf.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(Jf.prototype,Qf);var tm=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new Jf(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(zf),em=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};em.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=Ep.add(r,Ep.NW),this.x0=a+s*Ep.uX(r),this.y0=h+o*Ep.uY(r),r=Ep.add(r,2),this.x1=a+s*Ep.uX(r),this.y1=h+o*Ep.uY(r),r=Ep.add(r,2),this.x2=a+s*Ep.uX(r),this.y2=h+o*Ep.uY(r),r=Ep.add(r,2),this.x3=a+s*Ep.uX(r),this.y3=h+o*Ep.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var rm=new em,im=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new Sp(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=rm,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new lp(a.x,a.y):new lp(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&wf[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===rm&&(this._uvs=new em),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=uf.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+bf()),s=t._pixiId);var o=wf[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=Cf(t)),(o=new e(new zf(t,r))).baseTexture.cacheId=s,zf.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(zf.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new Uf(t);n.url=r;var s=new e(new zf(n,{scaleMode:uf.SCALE_MODE,resolution:Cf(r)}));return i||(i=r),zf.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(zf.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),wf[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),wf[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=wf[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete wf[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)wf[t.textureCacheIds[i]]===t&&delete wf[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function nm(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}im.EMPTY=new im(new zf),nm(im.EMPTY),nm(im.EMPTY.baseTexture),im.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new im(new zf(new Hf(t)))}(),nm(im.WHITE),nm(im.WHITE.baseTexture);var sm=function(t){function e(e,r){var i=null;if(!(e instanceof tm)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new tm({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new tm(t))},e}(im),om=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};om.prototype.createTexture=function(t,e){var r=new tm(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new sm(r)},om.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=om.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=mf(t)))<<16|65535&(e=mf(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},om.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},om.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},om.prototype.returnFilterTexture=function(t){this.returnTexture(t)},om.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},om.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=om.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},om.SCREEN_KEY="screen";var am=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};am.prototype.destroy=function(){this.buffer=null},am.from=function(t,e,r,i,n){return new am(t,e,r,i,n)};var hm=0,um=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=hm++,this.disposeRunner=new Rp("disposeBuffer",2)};function lm(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}um.prototype.update=function(t){this.data=t||this.data,this._updateID++},um.prototype.dispose=function(){this.disposeRunner.run(this,!1)},um.prototype.destroy=function(){this.dispose(),this.data=null},um.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new um(t)};var cm={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var dm={5126:4,5123:2,5121:1},pm=0,fm={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},mm=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=pm++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Rp("disposeGeometry",2),this.refCount=0};mm.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new um(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new am(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},mm.prototype.getAttribute=function(t){return this.attributes[t]},mm.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},mm.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new um(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},mm.prototype.getIndex=function(){return this.indexBuffer},mm.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new um;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*dm[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=lm(c);n[d]||(n[d]=new cm[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},mm.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},mm.prototype.dispose=function(){this.disposeRunner.run(this,!1)},mm.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},mm.prototype.clone=function(){for(var t=new mm,e=0;e<this.buffers.length;e++)t.buffers[e]=new um(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new am(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},mm.merge=function(t){for(var e,r=new mm,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(fm[lm(e.buffers[h].data)])(n[h]),r.buffers[h]=new um(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*dm[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var gm=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(mm),ym=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new um(this.vertices),this.uvBuffer=new um(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(mm),vm=0,_m=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=vm++,this.static=!!e};_m.prototype.update=function(){this.dirtyId++},_m.prototype.add=function(t,e,r){this.uniforms[t]=new _m(e,r)},_m.from=function(t,e){return new _m(t,e)};var bm=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new Sp,this.destinationFrame=new Sp,this.filters=[]};bm.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var xm=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new om,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new gm,this.quadUv=new ym,this.tempRect=new Sp,this.activeState={},this.globalUniforms=new _m({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new bm,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Zp.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Zp.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(mp.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(Kf),Tm=function(t){this.renderer=t};Tm.prototype.flush=function(){},Tm.prototype.destroy=function(){this.renderer=null},Tm.prototype.start=function(){},Tm.prototype.stop=function(){this.flush()},Tm.prototype.render=function(t){};var Em=function(t){function e(e){t.call(this,e),this.emptyRenderer=new Tm(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(Kf);uf.PREFER_ENV=Wp.any?Yp.WEBGL:Yp.WEBGL2,uf.STRICT_TEXTURE_CACHE=!1;var wm=0,Sm=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=wm++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=wm++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(uf.PREFER_ENV>=Yp.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(Kf),Im=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new Jf(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Sp,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;uf.PREFER_ENV===Yp.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Sp},Object.defineProperties(e.prototype,r),e}(Kf),Am=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},Cm={5126:4,5123:2,5121:1},Om=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;uf.PREFER_ENV===Yp.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Cm[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*Cm[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*Cm[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new Am(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(Kf),Rm=function(t){this.type=hf.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function Nm(t,e,r,i){var n=Pm(t,t.VERTEX_SHADER,e),s=Pm(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function Pm(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function Mm(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return Dm(2*e);case"bvec3":return Dm(3*e);case"bvec4":return Dm(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Dm(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}Rm.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=hf.NONE,this.autoDetect=!0),this._target=null},Rm.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var Fm,Lm={},km=Lm;function Um(){if(km===Lm||km&&km.isContextLost()){var t,e=document.createElement("canvas");uf.PREFER_ENV>=Yp.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),km=t}return km}function Bm(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===af.HIGH&&r!==af.HIGH&&(i=af.MEDIUM),"precision "+i+" float;\n"+t}return r!==af.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var jm={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Xm(t){return jm[t]}var Gm=null,zm={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function Vm(t,e){if(!Gm){var r=Object.keys(zm);Gm={};for(var i=0;i<r.length;++i){var n=r[i];Gm[t[n]]=zm[n]}}return Gm[e]}var Hm={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},$m={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Wm,Ym=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function qm(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var Km=0,Zm={},Jm=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=Km++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Zm[i]?(Zm[i]++,i+="-"+Zm[i]):Zm[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Bm(this.vertexSrc,uf.PRECISION_VERTEX,af.HIGH),this.fragmentSrc=Bm(this.fragmentSrc,uf.PRECISION_FRAGMENT,function(){if(!Fm){Fm=af.MEDIUM;var t=Um();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Fm=e.precision?af.HIGH:af.MEDIUM}}return Fm}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},Qm={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};Jm.prototype.extractData=function(t,e){var r=Um();if(r){var i=Nm(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},Jm.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=Vm(e,o.type),h={type:a,name:o.name,size:Xm(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},Jm.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=Vm(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:Mm(h,s.size)}}return r},Qm.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},Qm.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},Jm.from=function(t,e,r){var i=t+e,n=Ef[i];return n||(Ef[i]=n=new Jm(t,e,r)),n},Object.defineProperties(Jm,Qm);var tg=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof _m?e:new _m(e):new _m({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},eg={uniforms:{configurable:!0}};tg.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},tg.prototype.destroy=function(){this.uniformGroup=null},eg.uniforms.get=function(){return this.uniformGroup.uniforms},tg.from=function(t,e,r){var i=Jm.from(t,e);return new tg(i,r)},Object.defineProperties(tg.prototype,eg);var rg=function(){this.data=0,this.blendMode=Kp.NORMAL,this.polygonOffset=0,this.blend=!0},ig={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};ig.blend.get=function(){return!!(1&this.data)},ig.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},ig.offsets.get=function(){return!!(2&this.data)},ig.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},ig.culling.get=function(){return!!(4&this.data)},ig.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},ig.depthTest.get=function(){return!!(8&this.data)},ig.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},ig.clockwiseFrontFace.get=function(){return!!(16&this.data)},ig.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},ig.blendMode.get=function(){return this._blendMode},ig.blendMode.set=function(t){this.blend=t!==Kp.NONE,this._blendMode=t},ig.polygonOffset.get=function(){return this._polygonOffset},ig.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},rg.for2d=function(){var t=new rg;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(rg.prototype,ig);var ng=function(t){function e(r,i,n){var s=Jm.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=uf.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new rg}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(tg);ng.SOURCE_KEY_MAP={};var sg=new mp,og=function(t,e){this._texture=t,this.mapCoord=new mp,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},ag={texture:{configurable:!0}};ag.texture.get=function(){return this._texture},ag.texture.set=function(t){this._texture=t,this._updateID=-1},og.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},og.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(sg.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(sg));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(og.prototype,ag);var hg=function(t){function e(e){var r=new mp;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new og(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(ng),ug=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new Rm;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case hf.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case hf.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case hf.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case hf.SCISSOR:this.renderer.scissor.pop();break;case hf.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case hf.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=hf.SPRITE;else if(t.type=hf.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=hf.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new hg(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(Kf),lg=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(Kf),cg=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(lg),dg=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(lg),pg=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new mp,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(Kf),fg=new Sp,mg=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Sp,this.destinationFrame=new Sp}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(fg.width=s.realWidth,fg.height=s.realHeight,r=fg),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(fg.width=n.width,fg.height=n.height,r=fg),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(Kf),gg=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};gg.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var yg=0,vg={textureCount:0},_g=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=yg++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Wm)return Wm;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Wm=!0===t({a:"b"},"a","b")}catch(t){Wm=!1}return Wm}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(vg.textureCount=0,this.syncUniformGroup(t.uniformGroup,vg)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?Hm:$m)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=Nm(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:Mm(h.type,h.size)}}var u=new gg(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(Kf);var bg=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Kp.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new rg,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[Kp.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.ADD]=[t.ONE,t.ONE],e[Kp.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.NONE]=[0,0],e[Kp.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Kp.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Kp.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Kp.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Kp.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Kp.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Kp.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Kp.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Kp.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Kp.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Kp.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(Kf),xg=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=uf.GC_MAX_IDLE,this.checkCountMax=uf.GC_MAX_CHECK_COUNT,this.mode=uf.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==of.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(Kf),Tg=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},Eg=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new zf}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new Tg(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Tg(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new Tg(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===tf.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&vf(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==nf.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=rf.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ef.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===ef.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ef.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===ef.LINEAR?r.LINEAR:r.NEAREST)},e}(Kf),wg=new mp;V.a;var Sg=function(){this.texArray=null,this.blend=0,this.type=Zp.TRIANGLES,this.start=0,this.size=0,this.data=null},Ig=function(){this.elements=[],this.ids=[],this.count=0};Ig.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var Ag=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},Cg={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Cg.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Cg.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Cg.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Cg.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Cg.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Ag.prototype.view=function(t){return this[t+"View"]},Ag.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Ag.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Ag.prototype,Cg);var Og=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=rg.for2d(),this.size=4*uf.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;uf.PREFER_ENV===Yp.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),uf.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=Ym.replace(/%forloop%/gi,qm(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Sg);for(;r.length<n;)r.push(new Ig);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++zf._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;zf._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=pf[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;uf.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),uf.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=mf(Math.ceil(t/8)),r=yf(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new Ag(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=mf(Math.ceil(t/12)),r=yf(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?ff(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(Tm);Og._drawCallPool=[],Og._textureArrayPool=[];var Rg=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};Rg.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=_m.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Jm(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new mp,default:this.defaultGroupCache[t]};return new tg(this.programCache[t],n)},Rg.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var Ng=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new um(null,e,!1),this._indexBuffer=new um(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,tf.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,tf.FLOAT).addAttribute("aColor",this._buffer,4,!0,tf.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,tf.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(mm),Pg="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Mg="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Dg=function(){},Fg={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};Dg.create=function(t){var e=Object.assign({vertex:Pg,fragment:Mg,geometryClass:Ng,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new Rg(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Og)},Fg.defaultVertexSrc.get=function(){return Pg},Fg.defaultFragmentTemplate.get=function(){return Mg},Object.defineProperties(Dg,Fg);Dg.create();
/*!
 * @pixi/graphics - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Lg={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},kg=function(){this.reset()};kg.prototype.clone=function(){var t=new kg;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},kg.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=im.WHITE,this.matrix=null,this.visible=!1},kg.prototype.destroy=function(){this.texture=null,this.matrix=null};var Ug={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var r=t.points,i=t.holes,n=e.points,s=e.indices;if(r.length>=6){for(var o=[],a=0;a<i.length;a++){var h=i[a];o.push(r.length/2),r=r.concat(h.points)}var u=$()(r,o,2);if(!u)return;for(var l=n.length/2,c=0;c<u.length;c+=3)s.push(u[c]+l),s.push(u[c+1]+l),s.push(u[c+2]+l);for(var d=0;d<r.length;d++)n.push(r[d])}}},Bg={build:function(t){var e,r,i=t.shape,n=t.points,s=i.x,o=i.y;if(n.length=0,t.type===up.CIRC?(e=i.radius,r=i.radius):(e=i.width,r=i.height),0!==e&&0!==r){var a=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(i.width+i.height));a/=2.3;for(var h=2*Math.PI/a,u=0;u<a-.5;u++)n.push(s+Math.sin(-h*u)*e,o+Math.cos(-h*u)*r);n.push(n[0],n[1])}},triangulate:function(t,e){var r=t.points,i=e.points,n=e.indices,s=i.length/2,o=s,a=t.shape,h=t.matrix,u=a.x,l=a.y;i.push(t.matrix?h.a*u+h.c*l+h.tx:u,t.matrix?h.b*u+h.d*l+h.ty:l);for(var c=0;c<r.length;c+=2)i.push(r[c],r[c+1]),n.push(s++,o,s)}},jg={build:function(t){var e=t.shape,r=e.x,i=e.y,n=e.width,s=e.height,o=t.points;o.length=0,o.push(r,i,r+n,i,r+n,i+s,r,i+s)},triangulate:function(t,e){var r=t.points,i=e.points,n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},Xg={build:function(t){var e=t.shape,r=t.points,i=e.x,n=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));r.length=0,a?(zg(i,n+a,i,n,i+a,n,r),zg(i+s-a,n,i+s,n,i+s,n+a,r),zg(i+s,n+o-a,i+s,n+o,i+s-a,n+o,r),zg(i+a,n+o,i,n+o,i,n+o-a,r)):r.push(i,n,i+s,n,i+s,n+o,i,n+o)},triangulate:function(t,e){for(var r=t.points,i=e.points,n=e.indices,s=i.length/2,o=$()(r,null,2),a=0,h=o.length;a<h;a+=3)n.push(o[a]+s),n.push(o[a+1]+s),n.push(o[a+2]+s);for(var u=0,l=r.length;u<l;u++)i.push(r[u],r[++u])}};function Gg(t,e,r){return t+(e-t)*r}function zg(t,e,r,i,n,s,o){void 0===o&&(o=[]);for(var a=o,h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0;f<=20;++f)h=Gg(t,r,m=f/20),u=Gg(e,i,m),l=Gg(r,n,m),c=Gg(i,s,m),d=Gg(h,l,m),p=Gg(u,c,m),a.push(d,p);return a}function Vg(t,e){t.lineStyle.native?function(t,e){var r=0,i=t.shape,n=t.points||i.points,s=i.type!==up.POLY||i.closeStroke;if(0===n.length)return;var o=e.points,a=e.indices,h=n.length/2,u=o.length/2,l=u;for(o.push(n[0],n[1]),r=1;r<h;r++)o.push(n[2*r],n[2*r+1]),a.push(l,l+1),l++;s&&a.push(l,u)}(t,e):function(t,e){var r=t.shape,i=t.points||r.points.slice(),n=e.closePointEps;if(0===i.length)return;var s=t.lineStyle,o=new lp(i[0],i[1]),a=new lp(i[i.length-2],i[i.length-1]),h=r.type!==up.POLY||r.closeStroke,u=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(h){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var l=a.x+.5*(o.x-a.x),c=a.y+.5*(o.y-a.y);i.unshift(l,c),i.push(l,c)}var d=e.points,p=i.length/2,f=i.length,m=d.length/2,g=s.width/2,y=i[0],v=i[1],_=i[2],b=i[3],x=0,T=0,E=-(v-b),w=y-_,S=0,I=0,A=0,C=0,O=Math.sqrt(E*E+w*w);E/=O,w/=O,E*=g,w*=g;var R=s.alignment,N=2*(1-R),P=2*R;d.push(y-E*N,v-w*N),d.push(y+E*P,v+w*P);for(var M=1;M<p-1;++M){y=i[2*(M-1)],v=i[2*(M-1)+1],_=i[2*M],b=i[2*M+1],x=i[2*(M+1)],T=i[2*(M+1)+1],E=-(v-b),w=y-_,O=Math.sqrt(E*E+w*w),E/=O,w/=O,E*=g,w*=g,S=-(b-T),I=_-x,O=Math.sqrt(S*S+I*I),S/=O,I/=O;var D=-w+v-(-w+b),F=-E+_-(-E+y),L=(-E+y)*(-w+b)-(-E+_)*(-w+v),k=-(I*=g)+T-(-I+b),U=-(S*=g)+_-(-S+x),B=(-S+x)*(-I+b)-(-S+_)*(-I+T),j=D*U-k*F;if(Math.abs(j)<.1)j+=10.1,d.push(_-E*N,b-w*N),d.push(_+E*P,b+w*P);else{var X=(F*B-U*L)/j,G=(k*L-D*B)/j;(X-_)*(X-_)+(G-b)*(G-b)>196*g*g?(A=E-S,C=w-I,O=Math.sqrt(A*A+C*C),A/=O,C/=O,A*=g,C*=g,d.push(_-A*N,b-C*N),d.push(_+A*P,b+C*P),d.push(_-A*P*N,b-C*N),f++):(d.push(_+(X-_)*N,b+(G-b)*N),d.push(_-(X-_)*P,b-(G-b)*P))}}y=i[2*(p-2)],v=i[2*(p-2)+1],_=i[2*(p-1)],b=i[2*(p-1)+1],E=-(v-b),w=y-_,O=Math.sqrt(E*E+w*w),E/=O,w/=O,E*=g,w*=g,d.push(_-E*N,b-w*N),d.push(_+E*P,b+w*P);for(var z=e.indices,V=0;V<f-2;++V)z.push(m,m+1,m+2),m++}(t,e)}var Hg=function(t){function e(e,r,i,n,s,o){s=s||n/2;for(var a=-1*Math.PI/2+o,h=2*i,u=dp/h,l=[],c=0;c<h;c++){var d=c%2?s:n,p=c*u+a;l.push(e+d*Math.cos(p),r+d*Math.sin(p))}t.call(this,l)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Cp),$g=function(){};$g.curveTo=function(t,e,r,i,n,s){var o=s[s.length-2],a=s[s.length-1]-e,h=o-t,u=i-e,l=r-t,c=Math.abs(a*l-h*u);if(c<1e-8||0===n)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var d=a*a+h*h,p=u*u+l*l,f=a*u+h*l,m=n*Math.sqrt(d)/c,g=n*Math.sqrt(p)/c,y=m*f/d,v=g*f/p,_=m*l+g*h,b=m*u+g*a,x=h*(g+y),T=a*(g+y),E=l*(m+v),w=u*(m+v);return{cx:_+t,cy:b+e,radius:n,startAngle:Math.atan2(T-b,x-_),endAngle:Math.atan2(w-b,E-_),anticlockwise:h*u>l*a}},$g.arc=function(t,e,r,i,n,s,o,a,h){for(var u=o-s,l=Lg._segmentsCount(Math.abs(u)*n,40*Math.ceil(Math.abs(u)/dp)),c=u/(2*l),d=2*c,p=Math.cos(c),f=Math.sin(c),m=l-1,g=m%1/m,y=0;y<=m;++y){var v=c+s+d*(y+g*y),_=Math.cos(v),b=-Math.sin(v);h.push((p*_+f*b)*n+r,(p*-b+f*_)*n+i)}};var Wg=function(){};Wg.curveLength=function(t,e,r,i,n,s,o,a){for(var h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=t,b=e,x=1;x<=10;++x)y=_-(m=(f=(p=(d=1-(u=x/10))*d)*d)*t+3*p*u*r+3*d*(l=u*u)*n+(c=l*u)*o),v=b-(g=f*e+3*p*u*i+3*d*l*s+c*a),_=m,b=g,h+=Math.sqrt(y*y+v*v);return h},Wg.curveTo=function(t,e,r,i,n,s,o){var a=o[o.length-2],h=o[o.length-1];o.length-=2;var u=Lg._segmentsCount(Wg.curveLength(a,h,t,e,r,i,n,s)),l=0,c=0,d=0,p=0,f=0;o.push(a,h);for(var m=1,g=0;m<=u;++m)d=(c=(l=1-(g=m/u))*l)*l,f=(p=g*g)*g,o.push(d*a+3*c*g*t+3*l*p*r+f*n,d*h+3*c*g*e+3*l*p*i+f*s)};var Yg=function(){};Yg.curveLength=function(t,e,r,i,n,s){var o=t-2*r+n,a=e-2*i+s,h=2*r-2*t,u=2*i-2*e,l=4*(o*o+a*a),c=4*(o*h+a*u),d=h*h+u*u,p=2*Math.sqrt(l+c+d),f=Math.sqrt(l),m=2*l*f,g=2*Math.sqrt(d),y=c/f;return(m*p+f*c*(p-g)+(4*d*l-c*c)*Math.log((2*f+y+p)/(y+g)))/(4*m)},Yg.curveTo=function(t,e,r,i,n){for(var s=n[n.length-2],o=n[n.length-1],a=Lg._segmentsCount(Yg.curveLength(s,o,t,e,r,i)),h=0,u=0,l=1;l<=a;++l){var c=l/a;h=s+(t-s)*c,u=o+(e-o)*c,n.push(h+(t+(r-t)*c-h)*c,u+(e+(i-e)*c-u)*c)}};var qg=function(){this.reset()};qg.prototype.begin=function(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r},qg.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},qg.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0};var Kg={};Kg[up.POLY]=Ug,Kg[up.CIRC]=Bg,Kg[up.ELIP]=Bg,Kg[up.RECT]=jg,Kg[up.RREC]=Xg;var Zg=[],Jg=[],Qg=function(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type,this.points=[],this.holes=[]};Qg.prototype.clone=function(){return new Qg(this.shape,this.fillStyle,this.lineStyle,this.matrix)},Qg.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null};var ty=new lp,ey=new Nf,ry=function(t){function e(){t.call(this),this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeIndex=0,this._bounds=new Nf,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.uvsFloat32=null,this.closePointEps=1e-4}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={bounds:{configurable:!0}};return r.bounds.get=function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].textures.length=0,Jg.push(this.drawCalls[t]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var r=this.batches[e];r.reset(),Zg.push(r)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,r,i){var n=new Qg(t,e,r,i);return this.graphicsData.push(n),this.dirty++,this},e.prototype.drawHole=function(t,e){if(!this.graphicsData.length)return null;var r=new Qg(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var r=0;r<this.graphicsData.length;++r)this.graphicsData[r].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,r=0;r<e.length;++r){var i=e[r];if(i.fillStyle.visible&&(i.shape&&(i.matrix?i.matrix.applyInverse(t,ty):ty.copyFrom(t),i.shape.contains(ty.x,ty.y)))){var n=!1;if(i.holes)for(var s=0;s<i.holes.length;s++){if(i.holes[s].shape.contains(ty.x,ty.y)){n=!0;break}}if(!n)return!0}}return!1},e.prototype.updateBatches=function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,e=this.graphicsData,r=null,i=null;this.batches.length>0&&(i=(r=this.batches[this.batches.length-1]).style);for(var n=this.shapeIndex;n<e.length;n++){this.shapeIndex++;var s=e[n],o=s.fillStyle,a=s.lineStyle;Kg[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var h=0;h<2;h++){var u=0===h?o:a;if(u.visible){var l=u.texture.baseTexture,c=this.indices.length,d=this.points.length/2;l.wrapMode=rf.REPEAT,0===h?this.processFill(s):this.processLine(s);var p=this.points.length/2-d;0!==p&&(r&&!this._compareStyles(i,u)&&(r.end(c,d),r=null),r||((r=Zg.pop()||new qg).begin(u,c,d),this.batches.push(r),i=u),this.addUvs(this.points,t,u.texture,d,p,u.matrix))}}}if(r){var f=this.indices.length,m=this.points.length/2;r.end(f,m)}0!==this.batches.length?(this.indicesUint16=new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()):this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var r=this.graphicsData[t],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,r=t.length;e<r;e++)for(var i=t[e],n=0;n<i.size;n++){var s=i.start+n;this.indicesUint16[s]=this.indicesUint16[s]-i.attribStart}},e.prototype.isBatchable=function(){for(var t=this.batches,r=0;r<t.length;r++)if(t[r].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++zf._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].textures.length=0,Jg.push(this.drawCalls[e]);this.drawCalls.length=0;var r=this.colors,i=this.textureIds,n=Jg.pop();n||((n=new Sg).textures=new Ig),n.textures.count=0,n.start=0,n.size=0,n.type=Zp.TRIANGLES;var s=0,o=null,a=0,h=!1,u=Zp.TRIANGLES,l=0;this.drawCalls.push(n);for(var c=0;c<this.batches.length;c++){var d=this.batches[c],p=d.style,f=p.texture.baseTexture;h!==!!p.native&&(u=(h=!!p.native)?Zp.LINES:Zp.TRIANGLES,o=null,s=8,t++),o!==f&&(o=f,f._batchEnabled!==t&&(8===s&&(t++,s=0,n.size>0&&((n=Jg.pop())||((n=new Sg).textures=new Ig),this.drawCalls.push(n)),n.start=l,n.size=0,n.textures.count=0,n.type=u),f.touched=1,f._batchEnabled=t,f._batchLocation=s,f.wrapMode=10497,n.textures.elements[n.textures.count++]=f,s++)),n.size+=d.size,l+=d.size,a=f._batchLocation,this.addColors(r,p.color,p.alpha,d.attribSize),this.addTextureIds(i,a,d.attribSize)}zf._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(3*t.length*4),s=new Float32Array(n),o=new Uint32Array(n),a=0,h=0;h<t.length/2;h++)s[a++]=t[2*h],s[a++]=t[2*h+1],s[a++]=e[2*h],s[a++]=e[2*h+1],o[a++]=r[h],s[a++]=i[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),Ug.triangulate(t,this)):Kg[t.type].triangulate(t,this)},e.prototype.processLine=function(t){Vg(t,this);for(var e=0;e<t.holes.length;e++)Vg(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var r=t[e];Kg[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=ey,r=mp.IDENTITY;this._bounds.clear(),e.clear();for(var i=0;i<this.graphicsData.length;i++){var n=this.graphicsData[i],s=n.shape,o=n.type,a=n.lineStyle,h=n.matrix||mp.IDENTITY,u=0;if(a&&a.visible){var l=a.alignment;u=a.width,o===up.POLY?u*=.5+Math.abs(.5-l):u*=Math.max(0,l)}r!==h&&(e.isEmpty()||(t.addBoundsMatrix(e,r),e.clear()),r=h),o===up.RECT||o===up.RREC?e.addFramePad(s.x,s.y,s.x+s.width,s.y+s.height,u,u):o===up.CIRC?e.addFramePad(s.x,s.y,s.x,s.y,s.radius+u,s.radius+u):o===up.ELIP?e.addFramePad(s.x,s.y,s.x,s.y,s.width+u,s.height+u):t.addVerticesMatrix(r,s.points,0,s.points.length,u,u)}e.isEmpty()||t.addBoundsMatrix(e,r),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var r=0;r<t.length/2;r++){var i=t[2*r],n=t[2*r+1];t[2*r]=e.a*i+e.c*n+e.tx,t[2*r+1]=e.b*i+e.d*n+e.ty}},e.prototype.addColors=function(t,e,r,i){for(var n=ff((e>>16)+(65280&e)+((255&e)<<16),r);i-- >0;)t.push(n)},e.prototype.addTextureIds=function(t,e,r){for(;r-- >0;)t.push(e)},e.prototype.addUvs=function(t,e,r,i,n,s){for(var o=0,a=e.length,h=r.frame;o<n;){var u=t[2*(i+o)],l=t[2*(i+o)+1];if(s){var c=s.a*u+s.c*l+s.tx;l=s.b*u+s.d*l+s.ty,u=c}o++,e.push(u/h.width,l/h.height)}var d=r.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,r,a,n)},e.prototype.adjustUvs=function(t,e,r,i){for(var n=e.baseTexture,s=r+2*i,o=e.frame,a=o.width/n.width,h=o.height/n.height,u=o.x/o.width,l=o.y/o.height,c=Math.floor(t[r]+1e-6),d=Math.floor(t[r+1]+1e-6),p=r+2;p<s;p+=2)c=Math.min(c,Math.floor(t[p]+1e-6)),d=Math.min(d,Math.floor(t[p+1]+1e-6));u-=c,l-=d;for(var f=r;f<s;f+=2)t[f]=(t[f]+u)*a,t[f+1]=(t[f+1]+l)*h},Object.defineProperties(e.prototype,r),e}(Ng);ry.BATCHABLE_SIZE=100;var iy=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.width=0,this.alignment=.5,this.native=!1},e}(kg),ny=new Float32Array(3),sy={},oy=function(t){function e(e){void 0===e&&(e=null),t.call(this),this.geometry=e||new ry,this.geometry.refCount++,this.shader=null,this.state=rg.for2d(),this._fillStyle=new kg,this._lineStyle=new iy,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.vertexData=null,this._transformID=-1,this.batchDirty=-1,this.pluginName="batch",this.tint=16777215,this.blendMode=Kp.NORMAL}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0},tint:{configurable:!0},fill:{configurable:!0},line:{configurable:!0}};return e.prototype.clone=function(){return this.finishPoly(),new e(this.geometry)},r.blendMode.set=function(t){this.state.blendMode=t},r.blendMode.get=function(){return this.state.blendMode},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t},r.fill.get=function(){return this._fillStyle},r.line.get=function(){return this._lineStyle},e.prototype.lineStyle=function(t){if("number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){if("number"==typeof t){Tf("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var e=arguments[0],r=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],o=arguments[5],a=arguments[6];t={width:e,texture:r,color:i,alpha:n,matrix:s,alignment:o,native:a},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({width:0,texture:im.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1},t),this.currentPath&&this.startPoly();var h=t.width>0&&t.alpha>0;return h?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:h},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Cp,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Cp,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return i===t&&n===e||r.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,r,i){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),Yg.curveTo(t,e,r,i,n),this},e.prototype.bezierCurveTo=function(t,e,r,i,n,s){return this._initCurve(),Wg.curveTo(t,e,r,i,n,s,this.currentPath.points),this},e.prototype.arcTo=function(t,e,r,i,n){this._initCurve(t,e);var s=this.currentPath.points,o=$g.curveTo(t,e,r,i,n,s);if(o){var a=o.cx,h=o.cy,u=o.radius,l=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(a,h,u,l,c,d)}return this},e.prototype.arc=function(t,e,r,i,n,s){if(void 0===s&&(s=!1),i===n)return this;if(!s&&n<=i?n+=dp:s&&i<=n&&(i+=dp),0===n-i)return this;var o=t+Math.cos(i)*r,a=e+Math.sin(i)*r,h=this.geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var l=Math.abs(u[u.length-2]-o),c=Math.abs(u[u.length-1]-a);l<h&&c<h||u.push(o,a)}else this.moveTo(o,a),u=this.currentPath.points;return $g.arc(o,a,t,e,r,i,n,s,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:im.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){if(t instanceof im){Tf("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments[0],r=arguments[1],i=arguments[2],n=arguments[3];t={texture:e,color:r,alpha:i,matrix:n},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({texture:im.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var s=t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:s},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,r,i){return this.drawShape(new Sp(t,e,r,i))},e.prototype.drawRoundedRect=function(t,e,r,i,n){return this.drawShape(new Op(t,e,r,i,n))},e.prototype.drawCircle=function(t,e,r){return this.drawShape(new Ip(t,e,r))},e.prototype.drawEllipse=function(t,e,r,i){return this.drawShape(new Ap(t,e,r,i))},e.prototype.drawPolygon=function(t){var e=arguments,r=t,i=!0;if(r.points&&(i=r.closeStroke,r=r.points),!Array.isArray(r)){r=new Array(arguments.length);for(var n=0;n<r.length;++n)r[n]=e[n]}var s=new Cp(r);return s.closeStroke=i,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this.geometry.drawHole(t,this._matrix):this.geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,e,r,i,n,s){return void 0===s&&(s=0),this.drawPolygon(new Hg(t,e,r,i,n,s))},e.prototype.clear=function(){return this.geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){return 1===this.geometry.graphicsData.length&&this.geometry.graphicsData[0].shape.type===up.RECT&&!this.geometry.graphicsData[0].lineWidth},e.prototype._render=function(t){this.finishPoly();var e=this.geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this.geometry,e=this.blendMode;this.batches=[],this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.vertexData=new Float32Array(t.points);for(var r=0,i=t.batches.length;r<i;r++){var n=t.batches[r],s=n.style.color,o=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),h={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:a,_batchRGB:df(s),_tintRGB:s,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,r=this.batches.length;e<r;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),r=this.geometry,i=this.tint,n=this.worldAlpha,s=e.uniforms,o=r.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(i>>16&255)/255*n,s.tint[1]=(i>>8&255)/255*n,s.tint[2]=(255&i)/255*n,s.tint[3]=n,t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(var a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,r.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var r=e.textures,i=e.type,n=e.size,s=e.start,o=r.count,a=0;a<o;a++)t.texture.bind(r.elements[a],a);t.geometry.draw(i,n,s)},e.prototype._resolveDirectShader=function(t){var e=this.shader,r=this.pluginName;if(!e){if(!sy[r]){for(var i=new Int32Array(16),n=0;n<16;n++)i[n]=n;var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new mp,default:_m.from({uSamplers:i},!0)},o=t.plugins[r]._shader.program;sy[r]=new tg(o,s)}e=sy[r]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this.geometry;if(t.graphicsData.length){var e=t.bounds,r=e.minX,i=e.minY,n=e.maxX,s=e.maxY;this._bounds.addFrame(this.transform,r,i,n,s)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this.geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=df(this.tint,ny),e=0;e<this.batches.length;e++){var r=this.batches[e],i=r._batchRGB,n=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);r._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID;for(var t=this.transform.worldTransform,e=t.a,r=t.b,i=t.c,n=t.d,s=t.tx,o=t.ty,a=this.geometry.points,h=this.vertexData,u=0,l=0;l<a.length;l+=2){var c=a[l],d=a[l+1];h[u++]=e*c+i*d+s,h[u++]=n*d+r*c+o}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this.geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},Object.defineProperties(e.prototype,r),e}(Df);oy._TEMP_POINT=new lp;
/*!
 * @pixi/canvas-graphics - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/canvas-graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var ay,hy=function(t){this.renderer=t,this._svgMatrix=null};hy.prototype._calcCanvasStyle=function(t,e){var r;return t.texture?t.texture.valid?(r=Cu.getTintedPattern(t.texture,e),this.setPatternTransform(r,t.matrix||mp.IDENTITY)):r="#808080":r="#"+("00000"+(0|e).toString(16)).substr(-6),r},hy.prototype.render=function(t){var e=this.renderer,r=e.context,i=t.worldAlpha,n=t.transform.worldTransform;e.setContextTransform(n),t.canvasTintDirty===t.geometry.dirty&&t._prevTint===t.tint||this.updateGraphicsTint(t),e.setBlendMode(t.blendMode);for(var s,o,a=t.geometry.graphicsData,h=0;h<a.length;h++){var u=a[h],l=u.shape,c=u.fillStyle,d=u.lineStyle;if(c.visible&&(s=this._calcCanvasStyle(c,u._fillTint)),d.visible&&(o=this._calcCanvasStyle(d,u._lineTint)),r.lineWidth=d.width,u.type===up.POLY){r.beginPath();var p=l.points,f=u.holes,m=void 0,g=void 0,y=void 0,v=void 0;r.moveTo(p[0],p[1]);for(var _=2;_<p.length;_+=2)r.lineTo(p[_],p[_+1]);if(l.closeStroke&&r.closePath(),f.length>0){m=0,y=p[0],v=p[1];for(var b=2;b+2<p.length;b+=2)m+=(p[b]-y)*(p[b+3]-v)-(p[b+2]-y)*(p[b+1]-v);for(var x=0;x<f.length;x++)if(p=f[x].shape.points){g=0,y=p[0],v=p[1];for(var T=2;T+2<p.length;T+=2)g+=(p[T]-y)*(p[T+3]-v)-(p[T+2]-y)*(p[T+1]-v);if(g*m<0){r.moveTo(p[0],p[1]);for(var E=2;E<p.length;E+=2)r.lineTo(p[E],p[E+1])}else{r.moveTo(p[p.length-2],p[p.length-1]);for(var w=p.length-4;w>=0;w-=2)r.lineTo(p[w],p[w+1])}f[x].shape.closeStroke&&r.closePath()}}c.visible&&(r.globalAlpha=c.alpha*i,r.fillStyle=s,r.fill()),d.visible&&(r.globalAlpha=d.alpha*i,r.strokeStyle=o,r.stroke())}else if(u.type===up.RECT)c.visible&&(r.globalAlpha=c.alpha*i,r.fillStyle=s,r.fillRect(l.x,l.y,l.width,l.height)),d.visible&&(r.globalAlpha=d.alpha*i,r.strokeStyle=o,r.strokeRect(l.x,l.y,l.width,l.height));else if(u.type===up.CIRC)r.beginPath(),r.arc(l.x,l.y,l.radius,0,2*Math.PI),r.closePath(),c.visible&&(r.globalAlpha=c.alpha*i,r.fillStyle=s,r.fill()),d.visible&&(r.globalAlpha=d.alpha*i,r.strokeStyle=o,r.stroke());else if(u.type===up.ELIP){var S=2*l.width,I=2*l.height,A=l.x-S/2,C=l.y-I/2;r.beginPath();var O=S/2*.5522848,R=I/2*.5522848,N=A+S,P=C+I,M=A+S/2,D=C+I/2;r.moveTo(A,D),r.bezierCurveTo(A,D-R,M-O,C,M,C),r.bezierCurveTo(M+O,C,N,D-R,N,D),r.bezierCurveTo(N,D+R,M+O,P,M,P),r.bezierCurveTo(M-O,P,A,D+R,A,D),r.closePath(),c.visible&&(r.globalAlpha=c.alpha*i,r.fillStyle=s,r.fill()),d.visible&&(r.globalAlpha=d.alpha*i,r.strokeStyle=o,r.stroke())}else if(u.type===up.RREC){var F=l.x,L=l.y,k=l.width,U=l.height,B=l.radius,j=Math.min(k,U)/2|0;B=B>j?j:B,r.beginPath(),r.moveTo(F,L+B),r.lineTo(F,L+U-B),r.quadraticCurveTo(F,L+U,F+B,L+U),r.lineTo(F+k-B,L+U),r.quadraticCurveTo(F+k,L+U,F+k,L+U-B),r.lineTo(F+k,L+B),r.quadraticCurveTo(F+k,L,F+k-B,L),r.lineTo(F+B,L),r.quadraticCurveTo(F,L,F,L+B),r.closePath(),c.visible&&(r.globalAlpha=c.alpha*i,r.fillStyle=s,r.fill()),d.visible&&(r.globalAlpha=d.alpha*i,r.strokeStyle=o,r.stroke())}}},hy.prototype.updateGraphicsTint=function(t){t._prevTint=t.tint,t.canvasTintDirty=t.geometry.dirty;for(var e=(t.tint>>16&255)/255,r=(t.tint>>8&255)/255,i=(255&t.tint)/255,n=t.geometry.graphicsData,s=0;s<n.length;++s){var o=n[s],a=0|o.fillStyle.color,h=0|o.lineStyle.color;o._fillTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*r*255<<8)+(255&a)/255*i*255,o._lineTint=((h>>16&255)/255*e*255<<16)+((h>>8&255)/255*r*255<<8)+(255&h)/255*i*255}},hy.prototype.setPatternTransform=function(t,e){if(!1!==this._svgMatrix){if(!this._svgMatrix){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r&&r.createSVGMatrix&&(this._svgMatrix=r.createSVGMatrix()),!this._svgMatrix||!t.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=e.a,this._svgMatrix.b=e.b,this._svgMatrix.c=e.c,this._svgMatrix.d=e.d,this._svgMatrix.e=e.tx,this._svgMatrix.f=e.ty,t.setTransform(this._svgMatrix.inverse())}},hy.prototype.destroy=function(){this.renderer=null};var uy,ly,cy,dy,py,fy,my,gy,yy,vy,_y,by,xy,Ty,Ey=new mp;oy.prototype.generateCanvasTexture=function(t,e){void 0===e&&(e=1);var r=this.getLocalBounds(),i=sm.create(r.width,r.height,t,e);ay||(ay=new Au),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(Ey),Ey.invert(),Ey.tx-=r.x,Ey.ty-=r.y,ay.render(this,i,!0,Ey);var n=im.from(i.baseTexture._canvasRenderTarget.canvas,{scaleMode:t});return n.baseTexture.resolution=e,n.baseTexture.update(),n},oy.prototype.cachedGraphicsData=[],oy.prototype._renderCanvas=function(t){!0!==this.isMask&&(this.finishPoly(),t.plugins.graphics.render(this))},function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(uy||(uy={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(ly||(ly={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(cy||(cy={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(dy||(dy={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(py||(py={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(fy||(fy={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(my||(my={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(gy||(gy={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(yy||(yy={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(vy||(vy={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(_y||(_y={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(by||(by={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(xy||(xy={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Ty||(Ty={}));
/*!
 * @pixi/math - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var wy,Sy=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),Iy=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),Ay=2*Math.PI,Cy=180/Math.PI,Oy=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(wy||(wy={}));var Ry=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new Sy;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Sy;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(Ay-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),Ny=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Py=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],My=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Dy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Fy=[],Ly=[],ky=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Fy.push(e);for(var r=0;r<16;r++)for(var i=ky(Ny[t]*Ny[r]+My[t]*Py[r]),n=ky(Py[t]*Ny[r]+Dy[t]*Py[r]),s=ky(Ny[t]*My[r]+My[t]*Dy[r]),o=ky(Py[t]*My[r]+Dy[t]*Dy[r]),a=0;a<16;a++)if(Ny[a]===i&&Py[a]===n&&My[a]===s&&Dy[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new Ry;h.set(Ny[t],Py[t],My[t],Dy[t],0,0),Ly.push(h)}}();var Uy={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Ny[t]},uY:function(t){return Py[t]},vX:function(t){return My[t]},vY:function(t){return Dy[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Fy[t][e]},sub:function(t,e){return Fy[t][Uy.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Uy.S:Uy.N:2*Math.abs(e)<=Math.abs(t)?t>0?Uy.E:Uy.W:e>0?t>0?Uy.SE:Uy.SW:t>0?Uy.NE:Uy.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=Ly[Uy.inv(e)];n.tx=r,n.ty=i,t.append(n)}},By=function(){function t(){this.worldTransform=new Ry,this.localTransform=new Ry,this.position=new Iy(this.onChange,this,0,0),this.scale=new Iy(this.onChange,this,1,1),this.pivot=new Iy(this.onChange,this,0,0),this.skew=new Iy(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),jy=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=wy.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}(),Xy=(function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=wy.CIRC}t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new jy(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}(),function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=wy.ELIP}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new jy(this.x-this.width,this.y-this.height,this.width,this.height)}}(),function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof Sy){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=wy.POLY,this.closeStroke=!0}t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r}}(),function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=wy.RREC}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1}}(),/iPhone/i),Gy=/iPod/i,zy=/iPad/i,Vy=/\biOS-universal(?:.+)Mac\b/i,Hy=/\bAndroid(?:.+)Mobile\b/i,$y=/Android/i,Wy=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Yy=/Silk/i,qy=/Windows Phone/i,Ky=/\bWindows(?:.+)ARM\b/i,Zy=/BlackBerry/i,Jy=/BB10/i,Qy=/Opera Mini/i,tv=/\b(CriOS|Chrome)(?:.+)Mobile/i,ev=/Mobile(?:.+)Firefox\b/i,rv=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var iv=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(Xy)&&!n(qy),ipod:n(Gy),tablet:!n(Xy)&&(n(zy)||rv(e))&&!n(qy),universal:n(Vy),device:(n(Xy)||n(Gy)||n(zy)||n(Vy)||rv(e))&&!n(qy)},amazon:{phone:n(Wy),tablet:!n(Wy)&&n(Yy),device:n(Wy)||n(Yy)},android:{phone:!n(qy)&&n(Wy)||!n(qy)&&n(Hy),tablet:!n(qy)&&!n(Wy)&&!n(Hy)&&(n(Yy)||n($y)),device:!n(qy)&&(n(Wy)||n(Yy)||n(Hy)||n($y))||n(/\bokhttp\b/i)},windows:{phone:n(qy),tablet:n(Ky),device:n(qy)||n(Ky)},other:{blackberry:n(Zy),blackberry10:n(Jy),opera:n(Qy),firefox:n(ev),chrome:n(tv),device:n(Zy)||n(Jy)||n(Qy)||n(ev)||n(tv)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var nv,sv={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(iv.tablet||iv.phone){if(e=!1,iv.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(iv.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:iv.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!iv.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1,
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
RETINA_PREFIX:/@([0-9\.]+)x/,FAIL_IF_MAJOR_PERFORMANCE_CAVEAT:!0},ov=!1;var av=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[cy.NORMAL_NPM]=cy.NORMAL,t[cy.ADD_NPM]=cy.ADD,t[cy.SCREEN_NPM]=cy.SCREEN,e[cy.NORMAL]=cy.NORMAL_NPM,e[cy.ADD]=cy.ADD_NPM,e[cy.SCREEN]=cy.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();Float32Array,Uint32Array,Int32Array,Uint8Array;function hv(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function uv(t){return!(t&t-1||!t)}function lv(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function cv(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}function dv(t){return 0===t?0:t<0?-1:1}var pv=0;function fv(){return++pv}var mv={};var gv={},yv=Object.create(null),vv=Object.create(null);!function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||sv.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0})}();var _v;function bv(t,e){var r=sv.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/runner - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var xv,Tv=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(Tv.prototype,{dispatch:{value:Tv.prototype.emit},run:{value:Tv.prototype.emit}}),
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
sv.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(xv||(xv={}));var Ev=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),wv=function(){function t(){var t=this;this._head=new Ev(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/sv.TARGET_FPMS,this.elapsedMS=1/sv.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=xv.NORMAL),this._addListener(new Ev(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=xv.NORMAL),this._addListener(new Ev(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*sv.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,sv.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}();!function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,xv.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?wv.shared:new wv,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
sv.SORTABLE_CHILDREN=!1;var Sv=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};Sv.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Sv.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Sv.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?jy.EMPTY:((t=t||new jy(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Sv.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Sv.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},Sv.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},Sv.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},Sv.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},Sv.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},Sv.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},Sv.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},Sv.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Sv.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},Sv.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Sv.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},Sv.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var Iv=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new By,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Sv,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new jy),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new jy),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*Cy},r.angle.set=function(t){this.transform.rotation=t*Oy},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function Av(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}Iv.prototype.displayObjectUpdateTransform=Iv.prototype.updateTransform;var Cv=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=sv.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);cv(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,cv(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,cv(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Av),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(Iv);Cv.prototype.containerUpdateTransform=Cv.prototype.updateTransform;
/*!
 * @pixi/core - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Ov=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Tv("setRealSize",2),this.onUpdate=new Tv("update"),this.onError=new Tv("onError",1)},Rv={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};Ov.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},Ov.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},Ov.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},Rv.valid.get=function(){return!!this._width&&!!this._height},Ov.prototype.update=function(){this.destroyed||this.onUpdate.run()},Ov.prototype.load=function(){return Promise.resolve()},Rv.width.get=function(){return this._width},Rv.height.get=function(){return this._height},Ov.prototype.upload=function(t,e,r){return!1},Ov.prototype.style=function(t,e,r){return!1},Ov.prototype.dispose=function(){},Ov.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(Ov.prototype,Rv);var Nv=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,_v||(_v=document.createElement("a")),_v.href=t;var r=Object(W.parse)(_v.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===_y.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(Ov),Pv=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:sv.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===_y.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(Nv),Mv=[];function Dv(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=Mv.length-1;n>=0;--n){var s=Mv[n];if(s.test&&s.test(t,r))return new s(t,e)}return new Pv(t,e)}var Fv=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===_y.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(Ov),Lv={scaleMode:gy.NEAREST,format:py.RGBA,alphaMode:_y.NPM},kv=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof Ov||((e=Dv(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||sv.RESOLUTION,this.mipmap=void 0!==n?n:sv.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:sv.ANISOTROPIC_LEVEL,this.wrapMode=u||sv.WRAP_MODE,this.scaleMode=void 0!==o?o:sv.SCALE_MODE,this.format=l||py.RGBA,this.type=c||my.UNSIGNED_BYTE,this.target=d||fy.TEXTURE_2D,this.alphaMode=void 0!==i?i:_y.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=fv(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=uv(this.realWidth)&&uv(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete vv[this.cacheId],delete yv[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=sv.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+fv()),s=t._pixiId);var o=vv[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new Fv(t,{width:r,height:i}),o=t instanceof Float32Array?my.FLOAT:my.UNSIGNED_BYTE;return new e(s,Object.assign(Lv,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),vv[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),vv[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=vv[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete vv[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete vv[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);kv._globalBatch=0;var Uv=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new kv;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(Dv(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=fy.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(Ov),Bv=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(Nv),jv=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=fy.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=fy.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(Uv);jv.SIDES=6;var Xv=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+fv(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(Nv);Xv.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Gv=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=wv.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(wv.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(wv.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&wv.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(wv.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(wv.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(Nv);Gv.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var zv=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(Nv);Mv.push(Pv,zv,Bv,Gv,Xv,Fv,jv,Uv);var Vv=function(t){this.renderer=t};Vv.prototype.destroy=function(){this.renderer=null};var Hv=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===_y.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(Fv),$v=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Tv("disposeFramebuffer",2)},Wv={colorTexture:{configurable:!0}};Wv.colorTexture.get=function(){return this.colorTextures[0]},$v.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new kv(null,{scaleMode:gy.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},$v.prototype.addDepthTexture=function(t){return this.depthTexture=t||new kv(new Hv(null,{width:this.width,height:this.height}),{scaleMode:gy.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:py.DEPTH_COMPONENT,type:my.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},$v.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},$v.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},$v.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},$v.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties($v.prototype,Wv);var Yv=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new $v(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(kv),qv=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};qv.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=Uy.add(r,Uy.NW),this.x0=a+s*Uy.uX(r),this.y0=h+o*Uy.uY(r),r=Uy.add(r,2),this.x1=a+s*Uy.uX(r),this.y1=h+o*Uy.uY(r),r=Uy.add(r,2),this.x2=a+s*Uy.uX(r),this.y2=h+o*Uy.uY(r),r=Uy.add(r,2),this.x3=a+s*Uy.uX(r),this.y3=h+o*Uy.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var Kv=new qv,Zv=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new jy(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=Kv,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new Sy(a.x,a.y):new Sy(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&yv[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===Kv&&(this._uvs=new qv),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=sv.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+fv()),s=t._pixiId);var o=yv[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=bv(t)),(o=new e(new kv(t,r))).baseTexture.cacheId=s,kv.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(kv.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new Pv(t);n.url=r;var s=new e(new kv(n,{scaleMode:sv.SCALE_MODE,resolution:bv(r)}));return i||(i=r),kv.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(kv.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),yv[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),yv[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=yv[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete yv[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)yv[t.textureCacheIds[i]]===t&&delete yv[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function Jv(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Zv.EMPTY=new Zv(new kv),Jv(Zv.EMPTY),Jv(Zv.EMPTY.baseTexture),Zv.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Zv(new kv(new Bv(t)))}(),Jv(Zv.WHITE),Jv(Zv.WHITE.baseTexture);var Qv=function(t){function e(e,r){var i=null;if(!(e instanceof Yv)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new Yv({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new Yv(t))},e}(Zv),t_=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};t_.prototype.createTexture=function(t,e){var r=new Yv(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Qv(r)},t_.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=t_.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=hv(t)))<<16|65535&(e=hv(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},t_.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},t_.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t_.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t_.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},t_.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=t_.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},t_.SCREEN_KEY="screen";var e_=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};e_.prototype.destroy=function(){this.buffer=null},e_.from=function(t,e,r,i,n){return new e_(t,e,r,i,n)};var r_=0,i_=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=r_++,this.disposeRunner=new Tv("disposeBuffer",2)};function n_(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}i_.prototype.update=function(t){this.data=t||this.data,this._updateID++},i_.prototype.dispose=function(){this.disposeRunner.run(this,!1)},i_.prototype.destroy=function(){this.dispose(),this.data=null},i_.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new i_(t)};var s_={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var o_={5126:4,5123:2,5121:1},a_=0,h_={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},u_=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=a_++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Tv("disposeGeometry",2),this.refCount=0};u_.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new i_(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new e_(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},u_.prototype.getAttribute=function(t){return this.attributes[t]},u_.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},u_.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new i_(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},u_.prototype.getIndex=function(){return this.indexBuffer},u_.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new i_;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*o_[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=n_(c);n[d]||(n[d]=new s_[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},u_.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},u_.prototype.dispose=function(){this.disposeRunner.run(this,!1)},u_.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},u_.prototype.clone=function(){for(var t=new u_,e=0;e<this.buffers.length;e++)t.buffers[e]=new i_(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new e_(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},u_.merge=function(t){for(var e,r=new u_,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(h_[n_(e.buffers[h].data)])(n[h]),r.buffers[h]=new i_(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*o_[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var l_=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(u_),c_=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new i_(this.vertices),this.uvBuffer=new i_(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(u_),d_=0,p_=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=d_++,this.static=!!e};p_.prototype.update=function(){this.dirtyId++},p_.prototype.add=function(t,e,r){this.uniforms[t]=new p_(e,r)},p_.from=function(t,e){return new p_(t,e)};var f_=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new jy,this.destinationFrame=new jy,this.filters=[]};f_.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var m_=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new t_,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new l_,this.quadUv=new c_,this.tempRect=new jy,this.activeState={},this.globalUniforms=new p_({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new f_,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(dy.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(dy.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(Ry.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(Vv),g_=function(t){this.renderer=t};g_.prototype.flush=function(){},g_.prototype.destroy=function(){this.renderer=null},g_.prototype.start=function(){},g_.prototype.stop=function(){this.flush()},g_.prototype.render=function(t){};var y_=function(t){function e(e){t.call(this,e),this.emptyRenderer=new g_(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(Vv);sv.PREFER_ENV=iv.any?uy.WEBGL:uy.WEBGL2,sv.STRICT_TEXTURE_CACHE=!1;var v_=0,__=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=v_++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=v_++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(sv.PREFER_ENV>=uy.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(Vv),b_=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new $v(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new jy,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;sv.PREFER_ENV===uy.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new jy},Object.defineProperties(e.prototype,r),e}(Vv),x_=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},T_={5126:4,5123:2,5121:1},E_=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;sv.PREFER_ENV===uy.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*T_[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*T_[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*T_[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new x_(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(Vv),w_=function(t){this.type=Ty.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function S_(t,e,r,i){var n=I_(t,t.VERTEX_SHADER,e),s=I_(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function I_(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function A_(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return C_(2*e);case"bvec3":return C_(3*e);case"bvec4":return C_(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function C_(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}w_.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Ty.NONE,this.autoDetect=!0),this._target=null},w_.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var O_,R_={},N_=R_;function P_(){if(N_===R_||N_&&N_.isContextLost()){var t,e=document.createElement("canvas");sv.PREFER_ENV>=uy.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),N_=t}return N_}function M_(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===xy.HIGH&&r!==xy.HIGH&&(i=xy.MEDIUM),"precision "+i+" float;\n"+t}return r!==xy.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var D_={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function F_(t){return D_[t]}var L_=null,k_={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function U_(t,e){if(!L_){var r=Object.keys(k_);L_={};for(var i=0;i<r.length;++i){var n=r[i];L_[t[n]]=k_[n]}}return L_[e]}var B_={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},j_={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var X_,G_=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function z_(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var V_=0,H_={},$_=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=V_++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),H_[i]?(H_[i]++,i+="-"+H_[i]):H_[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=M_(this.vertexSrc,sv.PRECISION_VERTEX,xy.HIGH),this.fragmentSrc=M_(this.fragmentSrc,sv.PRECISION_FRAGMENT,function(){if(!O_){O_=xy.MEDIUM;var t=P_();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);O_=e.precision?xy.HIGH:xy.MEDIUM}}return O_}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},W_={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};$_.prototype.extractData=function(t,e){var r=P_();if(r){var i=S_(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},$_.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=U_(e,o.type),h={type:a,name:o.name,size:F_(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},$_.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=U_(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:A_(h,s.size)}}return r},W_.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},W_.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},$_.from=function(t,e,r){var i=t+e,n=gv[i];return n||(gv[i]=n=new $_(t,e,r)),n},Object.defineProperties($_,W_);var Y_=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof p_?e:new p_(e):new p_({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},q_={uniforms:{configurable:!0}};Y_.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},Y_.prototype.destroy=function(){this.uniformGroup=null},q_.uniforms.get=function(){return this.uniformGroup.uniforms},Y_.from=function(t,e,r){var i=$_.from(t,e);return new Y_(i,r)},Object.defineProperties(Y_.prototype,q_);var K_=function(){this.data=0,this.blendMode=cy.NORMAL,this.polygonOffset=0,this.blend=!0},Z_={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};Z_.blend.get=function(){return!!(1&this.data)},Z_.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Z_.offsets.get=function(){return!!(2&this.data)},Z_.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},Z_.culling.get=function(){return!!(4&this.data)},Z_.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Z_.depthTest.get=function(){return!!(8&this.data)},Z_.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},Z_.clockwiseFrontFace.get=function(){return!!(16&this.data)},Z_.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Z_.blendMode.get=function(){return this._blendMode},Z_.blendMode.set=function(t){this.blend=t!==cy.NONE,this._blendMode=t},Z_.polygonOffset.get=function(){return this._polygonOffset},Z_.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},K_.for2d=function(){var t=new K_;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(K_.prototype,Z_);var J_=function(t){function e(r,i,n){var s=$_.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=sv.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new K_}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(Y_);J_.SOURCE_KEY_MAP={};var Q_=new Ry,tb=function(t,e){this._texture=t,this.mapCoord=new Ry,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},eb={texture:{configurable:!0}};eb.texture.get=function(){return this._texture},eb.texture.set=function(t){this._texture=t,this._updateID=-1},tb.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},tb.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(Q_.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Q_));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(tb.prototype,eb);var rb=function(t){function e(e){var r=new Ry;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new tb(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(J_),ib=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new w_;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case Ty.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case Ty.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case Ty.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Ty.SCISSOR:this.renderer.scissor.pop();break;case Ty.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Ty.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Ty.SPRITE;else if(t.type=Ty.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=Ty.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new rb(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(Vv),nb=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(Vv),sb=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(nb),ob=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(nb),ab=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ry,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(Vv),hb=new jy,ub=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new jy,this.destinationFrame=new jy}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(hb.width=s.realWidth,hb.height=s.realHeight,r=hb),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(hb.width=n.width,hb.height=n.height,r=hb),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(Vv),lb=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};lb.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var cb=0,db={textureCount:0},pb=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=cb++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof X_)return X_;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");X_=!0===t({a:"b"},"a","b")}catch(t){X_=!1}return X_}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(db.textureCount=0,this.syncUniformGroup(t.uniformGroup,db)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?B_:j_)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=S_(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:A_(h.type,h.size)}}var u=new lb(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(Vv);var fb=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=cy.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new K_,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[cy.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.ADD]=[t.ONE,t.ONE],e[cy.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.NONE]=[0,0],e[cy.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[cy.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[cy.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[cy.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[cy.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[cy.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[cy.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[cy.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[cy.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[cy.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[cy.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(Vv),mb=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=sv.GC_MAX_IDLE,this.checkCountMax=sv.GC_MAX_CHECK_COUNT,this.mode=sv.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==by.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(Vv),gb=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},yb=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new kv}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new gb(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new gb(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new gb(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===my.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&cv(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==vy.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=yy.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===gy.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===gy.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===gy.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===gy.LINEAR?r.LINEAR:r.NEAREST)},e}(Vv),vb=new Ry;V.a;var _b=function(){this.texArray=null,this.blend=0,this.type=dy.TRIANGLES,this.start=0,this.size=0,this.data=null},bb=function(){this.elements=[],this.ids=[],this.count=0};bb.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var xb=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},Tb={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Tb.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Tb.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Tb.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Tb.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Tb.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},xb.prototype.view=function(t){return this[t+"View"]},xb.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},xb.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(xb.prototype,Tb);var Eb=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=K_.for2d(),this.size=4*sv.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;sv.PREFER_ENV===uy.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),sv.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=G_.replace(/%forloop%/gi,z_(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new _b);for(;r.length<n;)r.push(new bb);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++kv._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;kv._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=av[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;sv.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),sv.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=hv(Math.ceil(t/8)),r=lv(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new xb(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=hv(Math.ceil(t/12)),r=lv(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(g_);Eb._drawCallPool=[],Eb._textureArrayPool=[];var wb=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};wb.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=p_.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new $_(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ry,default:this.defaultGroupCache[t]};return new Y_(this.programCache[t],n)},wb.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var Sb=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new i_(null,e,!1),this._indexBuffer=new i_(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,my.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,my.FLOAT).addAttribute("aColor",this._buffer,4,!0,my.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,my.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(u_),Ib="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Ab="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Cb=function(){},Ob={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};Cb.create=function(t){var e=Object.assign({vertex:Ib,fragment:Ab,geometryClass:Sb,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new wb(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Eb)},Ob.defaultVertexSrc.get=function(){return Ib},Ob.defaultFragmentTemplate.get=function(){return Ab},Object.defineProperties(Cb,Ob);Cb.create();
/*!
 * @pixi/sprite - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Rb=new Sy,Nb=new Uint16Array([0,1,2,0,2,3]),Pb=function(t){function e(e){t.call(this),this._anchor=new Iy(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=cy.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=e||Zv.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Nb,this.pluginName="batch",this.isSprite=!0,this._roundPixels=sv.ROUND_PIXELS}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=dv(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=dv(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,d=0,p=0,f=0,m=0;if(u?(d=(p=u.x-c._x*l.width)+u.width,f=(m=u.y-c._y*l.height)+u.height):(d=(p=-c._x*l.width)+l.width,f=(m=-c._y*l.height)+l.height),h[0]=r*p+n*m+o,h[1]=s*m+i*p+a,h[2]=r*d+n*m+o,h[3]=s*m+i*d+a,h[4]=r*d+n*f+o,h[5]=s*f+i*d+a,h[6]=r*p+n*f+o,h[7]=s*f+i*p+a,this._roundPixels)for(var g=sv.RESOLUTION,y=0;y<h.length;++y)h[y]=Math.round((h[y]*g|0)/g)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,i=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=-i._x*r.width,d=c+r.width,p=-i._y*r.height,f=p+r.height;e[0]=s*c+a*p+u,e[1]=h*p+o*c+l,e[2]=s*d+a*p+u,e[3]=h*p+o*d+l,e[4]=s*d+a*f+u,e[5]=h*f+o*d+l,e[6]=s*c+a*f+u,e[7]=h*f+o*c+l},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new jy),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Rb);var e=this._texture.orig.width,r=this._texture.orig.height,i=-e*this.anchor.x,n=0;return Rb.x>=i&&Rb.x<i+e&&(n=-r*this.anchor.y,Rb.y>=n&&Rb.y<n+r)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var r="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null,this.shader=null},e.from=function(t,r){return new e(t instanceof Zv?t:Zv.from(t,r))},r.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},r.roundPixels.get=function(){return this._roundPixels},r.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},r.width.set=function(t){var e=dv(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},r.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},r.height.set=function(t){var e=dv(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},r.anchor.get=function(){return this._anchor},r.anchor.set=function(t){this._anchor.copyFrom(t)},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},r.texture.get=function(){return this._texture},r.texture.set=function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Zv.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},Object.defineProperties(e.prototype,r),e}(Cv),Mb=new Ry,Db=function(t){this.renderer=t};Db.prototype.render=function(t){var e=t._texture,r=this.renderer,i=r.context,n=e._frame.width,s=e._frame.height,o=t.transform.worldTransform,a=0,h=0,u=e.baseTexture.getDrawableSource();if(!(e.orig.width<=0||e.orig.height<=0)&&e.valid&&u&&e.valid){r.setBlendMode(t.blendMode,!0),r.context.globalAlpha=t.worldAlpha;var l=e.baseTexture.scaleMode===gy.LINEAR;r.smoothProperty&&r.context[r.smoothProperty]!==l&&(i[r.smoothProperty]=l),e.trim?(a=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,h=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(a=(.5-t.anchor.x)*e.orig.width,h=(.5-t.anchor.y)*e.orig.height),e.rotate&&(o.copyTo(Mb),o=Mb,Uy.matrixAppendRotationInv(o,e.rotate,a,h),a=0,h=0),a-=n/2,h-=s/2,r.setContextTransform(o,t.roundPixels,1),t.roundPixels&&(a|=0,h|=0);var c=e.baseTexture.resolution,d=r._outerBlend;d&&(i.save(),i.beginPath(),i.rect(a*r.resolution,h*r.resolution,n*r.resolution,s*r.resolution),i.clip()),16777215!==t.tint?(t._cachedTint===t.tint&&t._tintedCanvas.tintId===t._texture._updateID||(t._cachedTint=t.tint,t._tintedCanvas=Cu.getTintedCanvas(t,t.tint)),i.drawImage(t._tintedCanvas,0,0,Math.floor(n*c),Math.floor(s*c),Math.floor(a*r.resolution),Math.floor(h*r.resolution),Math.floor(n*r.resolution),Math.floor(s*r.resolution))):i.drawImage(u,e._frame.x*c,e._frame.y*c,Math.floor(n*c),Math.floor(s*c),Math.floor(a*r.resolution),Math.floor(h*r.resolution),Math.floor(n*r.resolution),Math.floor(s*r.resolution)),d&&i.restore(),r.setBlendMode(cy.NORMAL)}},Db.prototype.destroy=function(){this.renderer=null},Pb.prototype._tintedCanvas=null,Pb.prototype._renderCanvas=function(t){t.plugins.sprite.render(this)};
/*!
 * @pixi/runner - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Fb=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(Fb.prototype,{dispatch:{value:Fb.prototype.emit},run:{value:Fb.prototype.emit}});var Lb=/iPhone/i,kb=/iPod/i,Ub=/iPad/i,Bb=/\biOS-universal(?:.+)Mac\b/i,jb=/\bAndroid(?:.+)Mobile\b/i,Xb=/Android/i,Gb=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,zb=/Silk/i,Vb=/Windows Phone/i,Hb=/\bWindows(?:.+)ARM\b/i,$b=/BlackBerry/i,Wb=/BB10/i,Yb=/Opera Mini/i,qb=/\b(CriOS|Chrome)(?:.+)Mobile/i,Kb=/Mobile(?:.+)Firefox\b/i,Zb=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Jb=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(Lb)&&!n(Vb),ipod:n(kb),tablet:!n(Lb)&&(n(Ub)||Zb(e))&&!n(Vb),universal:n(Bb),device:(n(Lb)||n(kb)||n(Ub)||n(Bb)||Zb(e))&&!n(Vb)},amazon:{phone:n(Gb),tablet:!n(Gb)&&n(zb),device:n(Gb)||n(zb)},android:{phone:!n(Vb)&&n(Gb)||!n(Vb)&&n(jb),tablet:!n(Vb)&&!n(Gb)&&!n(jb)&&(n(zb)||n(Xb)),device:!n(Vb)&&(n(Gb)||n(zb)||n(jb)||n(Xb))||n(/\bokhttp\b/i)},windows:{phone:n(Vb),tablet:n(Hb),device:n(Vb)||n(Hb)},other:{blackberry:n($b),blackberry10:n(Wb),opera:n(Yb),firefox:n(Kb),chrome:n(qb),device:n($b)||n(Wb)||n(Yb)||n(Kb)||n(qb)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var Qb,tx,ex,rx,ix,nx,sx,ox,ax,hx,ux,lx,cx,dx,px={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(Jb.tablet||Jb.phone){if(e=!1,Jb.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(Jb.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:Jb.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!Jb.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};
/*!
 * @pixi/constants - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(Qb||(Qb={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(tx||(tx={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(ex||(ex={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(rx||(rx={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(ix||(ix={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(nx||(nx={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(sx||(sx={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(ox||(ox={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(ax||(ax={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(hx||(hx={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(ux||(ux={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(lx||(lx={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(cx||(cx={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(dx||(dx={})),
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
px.RETINA_PREFIX=/@([0-9\.]+)x/,px.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var fx,mx=!1;var gx=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[ex.NORMAL_NPM]=ex.NORMAL,t[ex.ADD_NPM]=ex.ADD,t[ex.SCREEN_NPM]=ex.SCREEN,e[ex.NORMAL]=ex.NORMAL_NPM,e[ex.ADD]=ex.ADD_NPM,e[ex.SCREEN]=ex.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();Float32Array,Uint32Array,Int32Array,Uint8Array;function yx(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function vx(t){return!(t&t-1||!t)}function _x(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function bx(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}var xx=0;function Tx(){return++xx}var Ex={};var wx={},Sx=Object.create(null),Ix=Object.create(null);var Ax=function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||px.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0}),t}();var Cx,Ox;function Rx(t,e){var r=px.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */px.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(Ox||(Ox={}));var Nx,Px=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Mx=function(){function t(){var t=this;this._head=new Px(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/px.TARGET_FPMS,this.elapsedMS=1/px.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=Ox.NORMAL),this._addListener(new Px(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=Ox.NORMAL),this._addListener(new Px(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*px.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,px.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),Dx=(function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Ox.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Mx.shared:new Mx,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}(),function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}()),Fx=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),Lx=2*Math.PI,kx=180/Math.PI,Ux=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(Nx||(Nx={}));var Bx=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new Dx;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Dx;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(Lx-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),jx=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Xx=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Gx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],zx=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Vx=[],Hx=[],$x=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Vx.push(e);for(var r=0;r<16;r++)for(var i=$x(jx[t]*jx[r]+Gx[t]*Xx[r]),n=$x(Xx[t]*jx[r]+zx[t]*Xx[r]),s=$x(jx[t]*Gx[r]+Gx[t]*zx[r]),o=$x(Xx[t]*Gx[r]+zx[t]*zx[r]),a=0;a<16;a++)if(jx[a]===i&&Xx[a]===n&&Gx[a]===s&&zx[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new Bx;h.set(jx[t],Xx[t],Gx[t],zx[t],0,0),Hx.push(h)}}();var Wx={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return jx[t]},uY:function(t){return Xx[t]},vX:function(t){return Gx[t]},vY:function(t){return zx[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Vx[t][e]},sub:function(t,e){return Vx[t][Wx.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Wx.S:Wx.N:2*Math.abs(e)<=Math.abs(t)?t>0?Wx.E:Wx.W:e>0?t>0?Wx.SE:Wx.SW:t>0?Wx.NE:Wx.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=Hx[Wx.inv(e)];n.tx=r,n.ty=i,t.append(n)}},Yx=function(){function t(){this.worldTransform=new Bx,this.localTransform=new Bx,this.position=new Fx(this.onChange,this,0,0),this.scale=new Fx(this.onChange,this,1,1),this.pivot=new Fx(this.onChange,this,0,0),this.skew=new Fx(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),qx=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=Nx.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}();(function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=Nx.CIRC}t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new qx(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}})(),function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=Nx.ELIP}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new qx(this.x-this.width,this.y-this.height,this.width,this.height)}}(),function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof Dx){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=Nx.POLY,this.closeStroke=!0}t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r}}(),function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=Nx.RREC}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1}}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
px.SORTABLE_CHILDREN=!1;var Kx=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};Kx.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Kx.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Kx.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?qx.EMPTY:((t=t||new qx(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Kx.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Kx.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},Kx.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},Kx.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},Kx.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},Kx.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},Kx.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},Kx.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},Kx.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Kx.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},Kx.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Kx.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},Kx.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var Zx=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new Yx,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Kx,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new qx),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new qx),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*kx},r.angle.set=function(t){this.transform.rotation=t*Ux},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function Jx(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}Zx.prototype.displayObjectUpdateTransform=Zx.prototype.updateTransform;var Qx=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=px.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);bx(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,bx(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,bx(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Jx),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(Zx);Qx.prototype.containerUpdateTransform=Qx.prototype.updateTransform;
/*!
 * @pixi/core - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var tT=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Fb("setRealSize",2),this.onUpdate=new Fb("update"),this.onError=new Fb("onError",1)},eT={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};tT.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},tT.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},tT.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},eT.valid.get=function(){return!!this._width&&!!this._height},tT.prototype.update=function(){this.destroyed||this.onUpdate.run()},tT.prototype.load=function(){return Promise.resolve()},eT.width.get=function(){return this._width},eT.height.get=function(){return this._height},tT.prototype.upload=function(t,e,r){return!1},tT.prototype.style=function(t,e,r){return!1},tT.prototype.dispose=function(){},tT.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(tT.prototype,eT);var rT=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,Cx||(Cx=document.createElement("a")),Cx.href=t;var r=Object(W.parse)(Cx.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ux.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(tT),iT=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:px.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===ux.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(rT),nT=[];function sT(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=nT.length-1;n>=0;--n){var s=nT[n];if(s.test&&s.test(t,r))return new s(t,e)}return new iT(t,e)}var oT=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ux.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(tT),aT={scaleMode:ox.NEAREST,format:ix.RGBA,alphaMode:ux.NPM},hT=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof tT||((e=sT(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||px.RESOLUTION,this.mipmap=void 0!==n?n:px.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:px.ANISOTROPIC_LEVEL,this.wrapMode=u||px.WRAP_MODE,this.scaleMode=void 0!==o?o:px.SCALE_MODE,this.format=l||ix.RGBA,this.type=c||sx.UNSIGNED_BYTE,this.target=d||nx.TEXTURE_2D,this.alphaMode=void 0!==i?i:ux.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=Tx(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=vx(this.realWidth)&&vx(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ix[this.cacheId],delete Sx[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=px.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+Tx()),s=t._pixiId);var o=Ix[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new oT(t,{width:r,height:i}),o=t instanceof Float32Array?sx.FLOAT:sx.UNSIGNED_BYTE;return new e(s,Object.assign(aT,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Ix[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Ix[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Ix[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Ix[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Ix[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);hT._globalBatch=0;var uT=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new hT;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(sT(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=nx.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(tT),lT=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(rT),cT=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=nx.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=nx.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(uT);cT.SIDES=6;var dT=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+Tx(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(rT);dT.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var pT=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=Mx.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Mx.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Mx.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&Mx.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Mx.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Mx.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(rT);pT.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var fT=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(rT);nT.push(iT,fT,lT,pT,dT,oT,cT,uT);var mT=function(t){this.renderer=t};mT.prototype.destroy=function(){this.renderer=null};var gT=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ux.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(oT),yT=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Fb("disposeFramebuffer",2)},vT={colorTexture:{configurable:!0}};vT.colorTexture.get=function(){return this.colorTextures[0]},yT.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new hT(null,{scaleMode:ox.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},yT.prototype.addDepthTexture=function(t){return this.depthTexture=t||new hT(new gT(null,{width:this.width,height:this.height}),{scaleMode:ox.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:ix.DEPTH_COMPONENT,type:sx.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},yT.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},yT.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},yT.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},yT.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(yT.prototype,vT);var _T=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new yT(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(hT),bT=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};bT.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=Wx.add(r,Wx.NW),this.x0=a+s*Wx.uX(r),this.y0=h+o*Wx.uY(r),r=Wx.add(r,2),this.x1=a+s*Wx.uX(r),this.y1=h+o*Wx.uY(r),r=Wx.add(r,2),this.x2=a+s*Wx.uX(r),this.y2=h+o*Wx.uY(r),r=Wx.add(r,2),this.x3=a+s*Wx.uX(r),this.y3=h+o*Wx.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var xT=new bT,TT=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new qx(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=xT,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new Dx(a.x,a.y):new Dx(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&Sx[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===xT&&(this._uvs=new bT),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=px.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+Tx()),s=t._pixiId);var o=Sx[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=Rx(t)),(o=new e(new hT(t,r))).baseTexture.cacheId=s,hT.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(hT.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new iT(t);n.url=r;var s=new e(new hT(n,{scaleMode:px.SCALE_MODE,resolution:Rx(r)}));return i||(i=r),hT.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(hT.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Sx[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Sx[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Sx[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Sx[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)Sx[t.textureCacheIds[i]]===t&&delete Sx[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function ET(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}TT.EMPTY=new TT(new hT),ET(TT.EMPTY),ET(TT.EMPTY.baseTexture),TT.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new TT(new hT(new lT(t)))}(),ET(TT.WHITE),ET(TT.WHITE.baseTexture);var wT=function(t){function e(e,r){var i=null;if(!(e instanceof _T)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new _T({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new _T(t))},e}(TT),ST=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};ST.prototype.createTexture=function(t,e){var r=new _T(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new wT(r)},ST.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=ST.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=yx(t)))<<16|65535&(e=yx(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},ST.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},ST.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},ST.prototype.returnFilterTexture=function(t){this.returnTexture(t)},ST.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},ST.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=ST.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},ST.SCREEN_KEY="screen";var IT=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};IT.prototype.destroy=function(){this.buffer=null},IT.from=function(t,e,r,i,n){return new IT(t,e,r,i,n)};var AT=0,CT=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=AT++,this.disposeRunner=new Fb("disposeBuffer",2)};function OT(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}CT.prototype.update=function(t){this.data=t||this.data,this._updateID++},CT.prototype.dispose=function(){this.disposeRunner.run(this,!1)},CT.prototype.destroy=function(){this.dispose(),this.data=null},CT.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new CT(t)};var RT={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var NT={5126:4,5123:2,5121:1},PT=0,MT={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},DT=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=PT++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Fb("disposeGeometry",2),this.refCount=0};DT.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new CT(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new IT(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},DT.prototype.getAttribute=function(t){return this.attributes[t]},DT.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},DT.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new CT(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},DT.prototype.getIndex=function(){return this.indexBuffer},DT.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new CT;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*NT[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=OT(c);n[d]||(n[d]=new RT[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},DT.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},DT.prototype.dispose=function(){this.disposeRunner.run(this,!1)},DT.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},DT.prototype.clone=function(){for(var t=new DT,e=0;e<this.buffers.length;e++)t.buffers[e]=new CT(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new IT(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},DT.merge=function(t){for(var e,r=new DT,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(MT[OT(e.buffers[h].data)])(n[h]),r.buffers[h]=new CT(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*NT[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var FT=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(DT),LT=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new CT(this.vertices),this.uvBuffer=new CT(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(DT),kT=0,UT=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=kT++,this.static=!!e};UT.prototype.update=function(){this.dirtyId++},UT.prototype.add=function(t,e,r){this.uniforms[t]=new UT(e,r)},UT.from=function(t,e){return new UT(t,e)};var BT=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new qx,this.destinationFrame=new qx,this.filters=[]};BT.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var jT=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new ST,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new FT,this.quadUv=new LT,this.tempRect=new qx,this.activeState={},this.globalUniforms=new UT({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new BT,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(rx.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(rx.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(Bx.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(mT),XT=function(t){this.renderer=t};XT.prototype.flush=function(){},XT.prototype.destroy=function(){this.renderer=null},XT.prototype.start=function(){},XT.prototype.stop=function(){this.flush()},XT.prototype.render=function(t){};var GT=function(t){function e(e){t.call(this,e),this.emptyRenderer=new XT(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(mT);px.PREFER_ENV=Jb.any?Qb.WEBGL:Qb.WEBGL2,px.STRICT_TEXTURE_CACHE=!1;var zT=0,VT=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=zT++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=zT++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(px.PREFER_ENV>=Qb.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(mT),HT=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new yT(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new qx,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;px.PREFER_ENV===Qb.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new qx},Object.defineProperties(e.prototype,r),e}(mT),$T=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},WT={5126:4,5123:2,5121:1},YT=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;px.PREFER_ENV===Qb.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*WT[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*WT[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*WT[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new $T(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(mT),qT=function(t){this.type=dx.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function KT(t,e,r,i){var n=ZT(t,t.VERTEX_SHADER,e),s=ZT(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function ZT(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function JT(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return QT(2*e);case"bvec3":return QT(3*e);case"bvec4":return QT(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function QT(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}qT.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=dx.NONE,this.autoDetect=!0),this._target=null},qT.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var tE,eE={},rE=eE;function iE(){if(rE===eE||rE&&rE.isContextLost()){var t,e=document.createElement("canvas");px.PREFER_ENV>=Qb.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),rE=t}return rE}function nE(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===cx.HIGH&&r!==cx.HIGH&&(i=cx.MEDIUM),"precision "+i+" float;\n"+t}return r!==cx.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var sE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function oE(t){return sE[t]}var aE=null,hE={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function uE(t,e){if(!aE){var r=Object.keys(hE);aE={};for(var i=0;i<r.length;++i){var n=r[i];aE[t[n]]=hE[n]}}return aE[e]}var lE={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},cE={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var dE,pE=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function fE(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var mE=0,gE={},yE=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=mE++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),gE[i]?(gE[i]++,i+="-"+gE[i]):gE[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=nE(this.vertexSrc,px.PRECISION_VERTEX,cx.HIGH),this.fragmentSrc=nE(this.fragmentSrc,px.PRECISION_FRAGMENT,function(){if(!tE){tE=cx.MEDIUM;var t=iE();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);tE=e.precision?cx.HIGH:cx.MEDIUM}}return tE}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},vE={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};yE.prototype.extractData=function(t,e){var r=iE();if(r){var i=KT(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},yE.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=uE(e,o.type),h={type:a,name:o.name,size:oE(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},yE.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=uE(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:JT(h,s.size)}}return r},vE.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},vE.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},yE.from=function(t,e,r){var i=t+e,n=wx[i];return n||(wx[i]=n=new yE(t,e,r)),n},Object.defineProperties(yE,vE);var _E=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof UT?e:new UT(e):new UT({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},bE={uniforms:{configurable:!0}};_E.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},_E.prototype.destroy=function(){this.uniformGroup=null},bE.uniforms.get=function(){return this.uniformGroup.uniforms},_E.from=function(t,e,r){var i=yE.from(t,e);return new _E(i,r)},Object.defineProperties(_E.prototype,bE);var xE=function(){this.data=0,this.blendMode=ex.NORMAL,this.polygonOffset=0,this.blend=!0},TE={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};TE.blend.get=function(){return!!(1&this.data)},TE.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},TE.offsets.get=function(){return!!(2&this.data)},TE.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},TE.culling.get=function(){return!!(4&this.data)},TE.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},TE.depthTest.get=function(){return!!(8&this.data)},TE.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},TE.clockwiseFrontFace.get=function(){return!!(16&this.data)},TE.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},TE.blendMode.get=function(){return this._blendMode},TE.blendMode.set=function(t){this.blend=t!==ex.NONE,this._blendMode=t},TE.polygonOffset.get=function(){return this._polygonOffset},TE.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},xE.for2d=function(){var t=new xE;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(xE.prototype,TE);var EE=function(t){function e(r,i,n){var s=yE.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=px.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new xE}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(_E);EE.SOURCE_KEY_MAP={};var wE=new Bx,SE=function(t,e){this._texture=t,this.mapCoord=new Bx,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},IE={texture:{configurable:!0}};IE.texture.get=function(){return this._texture},IE.texture.set=function(t){this._texture=t,this._updateID=-1},SE.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},SE.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(wE.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(wE));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(SE.prototype,IE);var AE=function(t){function e(e){var r=new Bx;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new SE(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(EE),CE=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new qT;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case dx.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case dx.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case dx.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case dx.SCISSOR:this.renderer.scissor.pop();break;case dx.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case dx.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=dx.SPRITE;else if(t.type=dx.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=dx.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new AE(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(mT),OE=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(mT),RE=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(OE),NE=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(OE),PE=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Bx,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(mT),ME=new qx,DE=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new qx,this.destinationFrame=new qx}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(ME.width=s.realWidth,ME.height=s.realHeight,r=ME),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(ME.width=n.width,ME.height=n.height,r=ME),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(mT),FE=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};FE.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var LE=0,kE={textureCount:0},UE=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=LE++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof dE)return dE;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");dE=!0===t({a:"b"},"a","b")}catch(t){dE=!1}return dE}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(kE.textureCount=0,this.syncUniformGroup(t.uniformGroup,kE)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?lE:cE)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=KT(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:JT(h.type,h.size)}}var u=new FE(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(mT);var BE=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ex.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new xE,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[ex.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.ADD]=[t.ONE,t.ONE],e[ex.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.NONE]=[0,0],e[ex.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[ex.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ex.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[ex.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[ex.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ex.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[ex.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[ex.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[ex.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[ex.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ex.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(mT),jE=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=px.GC_MAX_IDLE,this.checkCountMax=px.GC_MAX_CHECK_COUNT,this.mode=px.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==lx.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(mT),XE=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},GE=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new hT}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new XE(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new XE(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new XE(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===sx.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&bx(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==hx.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=ax.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ox.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===ox.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ox.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===ox.LINEAR?r.LINEAR:r.NEAREST)},e}(mT),zE=new Bx;V.a;var VE=function(){this.texArray=null,this.blend=0,this.type=rx.TRIANGLES,this.start=0,this.size=0,this.data=null},HE=function(){this.elements=[],this.ids=[],this.count=0};HE.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var $E=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},WE={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};WE.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},WE.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},WE.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},WE.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},WE.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},$E.prototype.view=function(t){return this[t+"View"]},$E.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},$E.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties($E.prototype,WE);var YE=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=xE.for2d(),this.size=4*px.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;px.PREFER_ENV===Qb.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),px.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=pE.replace(/%forloop%/gi,fE(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new VE);for(;r.length<n;)r.push(new HE);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++hT._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;hT._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=gx[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;px.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),px.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=yx(Math.ceil(t/8)),r=_x(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new $E(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=yx(Math.ceil(t/12)),r=_x(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(XT);YE._drawCallPool=[],YE._textureArrayPool=[];var qE=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};qE.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=UT.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new yE(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Bx,default:this.defaultGroupCache[t]};return new _E(this.programCache[t],n)},qE.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var KE=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new CT(null,e,!1),this._indexBuffer=new CT(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,sx.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,sx.FLOAT).addAttribute("aColor",this._buffer,4,!0,sx.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,sx.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(DT),ZE="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",JE="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",QE=function(){},tw={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};QE.create=function(t){var e=Object.assign({vertex:ZE,fragment:JE,geometryClass:KE,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new qE(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(YE)},tw.defaultVertexSrc.get=function(){return ZE},tw.defaultFragmentTemplate.get=function(){return JE},Object.defineProperties(QE,tw);QE.create();
/*!
 * @pixi/canvas-extract - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/canvas-extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ew=new qx,rw=function(t){this.renderer=t,t.extract=this};rw.prototype.image=function(t,e,r){var i=new Image;return i.src=this.base64(t,e,r),i},rw.prototype.base64=function(t,e,r){return this.canvas(t).toDataURL(e,r)},rw.prototype.canvas=function(t){var e,r,i,n,s=this.renderer;t&&(n=t instanceof wT?t:s.generateTexture(t)),n?(e=n.baseTexture._canvasRenderTarget.context,r=n.baseTexture._canvasRenderTarget.resolution,i=n.frame):(e=s.rootContext,r=s.resolution,(i=ew).width=this.renderer.width,i.height=this.renderer.height);var o=Math.floor(i.width*r+1e-4),a=Math.floor(i.height*r+1e-4),h=new Ax(o,a,1),u=e.getImageData(i.x*r,i.y*r,o,a);return h.context.putImageData(u,0,0),h.canvas},rw.prototype.pixels=function(t){var e,r,i,n,s=this.renderer;return t&&(n=t instanceof wT?t:s.generateTexture(t)),n?(e=n.baseTexture._canvasRenderTarget.context,r=n.baseTexture._canvasRenderTarget.resolution,i=n.frame):(e=s.rootContext,(i=ew).width=s.width,i.height=s.height),e.getImageData(0,0,i.width*r,i.height*r).data},rw.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null};
/*!
 * @pixi/runner - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var iw=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(iw.prototype,{dispatch:{value:iw.prototype.emit},run:{value:iw.prototype.emit}});var nw=/iPhone/i,sw=/iPod/i,ow=/iPad/i,aw=/\biOS-universal(?:.+)Mac\b/i,hw=/\bAndroid(?:.+)Mobile\b/i,uw=/Android/i,lw=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,cw=/Silk/i,dw=/Windows Phone/i,pw=/\bWindows(?:.+)ARM\b/i,fw=/BlackBerry/i,mw=/BB10/i,gw=/Opera Mini/i,yw=/\b(CriOS|Chrome)(?:.+)Mobile/i,vw=/Mobile(?:.+)Firefox\b/i,_w=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var bw=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(nw)&&!n(dw),ipod:n(sw),tablet:!n(nw)&&(n(ow)||_w(e))&&!n(dw),universal:n(aw),device:(n(nw)||n(sw)||n(ow)||n(aw)||_w(e))&&!n(dw)},amazon:{phone:n(lw),tablet:!n(lw)&&n(cw),device:n(lw)||n(cw)},android:{phone:!n(dw)&&n(lw)||!n(dw)&&n(hw),tablet:!n(dw)&&!n(lw)&&!n(hw)&&(n(cw)||n(uw)),device:!n(dw)&&(n(lw)||n(cw)||n(hw)||n(uw))||n(/\bokhttp\b/i)},windows:{phone:n(dw),tablet:n(pw),device:n(dw)||n(pw)},other:{blackberry:n(fw),blackberry10:n(mw),opera:n(gw),firefox:n(vw),chrome:n(yw),device:n(fw)||n(mw)||n(gw)||n(vw)||n(yw)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var xw,Tw,Ew,ww,Sw,Iw,Aw,Cw,Ow,Rw,Nw,Pw,Mw,Dw,Fw={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(bw.tablet||bw.phone){if(e=!1,bw.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(bw.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:bw.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!bw.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};
/*!
 * @pixi/constants - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(xw||(xw={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(Tw||(Tw={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Ew||(Ew={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(ww||(ww={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Sw||(Sw={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Iw||(Iw={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Aw||(Aw={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Cw||(Cw={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Ow||(Ow={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(Rw||(Rw={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Nw||(Nw={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Pw||(Pw={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Mw||(Mw={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Dw||(Dw={})),
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Fw.RETINA_PREFIX=/@([0-9\.]+)x/,Fw.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var Lw,kw=!1;function Uw(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function Bw(t){var e=t.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)}var jw=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[Ew.NORMAL_NPM]=Ew.NORMAL,t[Ew.ADD_NPM]=Ew.ADD,t[Ew.SCREEN_NPM]=Ew.SCREEN,e[Ew.NORMAL]=Ew.NORMAL_NPM,e[Ew.ADD]=Ew.ADD_NPM,e[Ew.SCREEN]=Ew.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();function Xw(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}Float32Array,Uint32Array,Int32Array,Uint8Array;function Gw(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function zw(t){return!(t&t-1||!t)}function Vw(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function Hw(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}function $w(t){return 0===t?0:t<0?-1:1}var Ww=0;function Yw(){return++Ww}var qw={};function Kw(t,e,r){if(void 0===r&&(r=3),!qw[e]){var i=(new Error).stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),qw[e]=!0}}var Zw={},Jw=Object.create(null),Qw=Object.create(null);!function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||Fw.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0})}();var tS,eS;function rS(t,e){var r=Fw.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Fw.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(eS||(eS={}));var iS,nS=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),sS=function(){function t(){var t=this;this._head=new nS(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Fw.TARGET_FPMS,this.elapsedMS=1/Fw.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=eS.NORMAL),this._addListener(new nS(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=eS.NORMAL),this._addListener(new nS(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Fw.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,Fw.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),oS=(function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,eS.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?sS.shared:new sS,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}(),function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}()),aS=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),hS=2*Math.PI,uS=180/Math.PI,lS=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(iS||(iS={}));var cS=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new oS;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new oS;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(hS-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),dS=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],pS=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],fS=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],mS=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],gS=[],yS=[],vS=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];gS.push(e);for(var r=0;r<16;r++)for(var i=vS(dS[t]*dS[r]+fS[t]*pS[r]),n=vS(pS[t]*dS[r]+mS[t]*pS[r]),s=vS(dS[t]*fS[r]+fS[t]*mS[r]),o=vS(pS[t]*fS[r]+mS[t]*mS[r]),a=0;a<16;a++)if(dS[a]===i&&pS[a]===n&&fS[a]===s&&mS[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new cS;h.set(dS[t],pS[t],fS[t],mS[t],0,0),yS.push(h)}}();var _S={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return dS[t]},uY:function(t){return pS[t]},vX:function(t){return fS[t]},vY:function(t){return mS[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return gS[t][e]},sub:function(t,e){return gS[t][_S.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?_S.S:_S.N:2*Math.abs(e)<=Math.abs(t)?t>0?_S.E:_S.W:e>0?t>0?_S.SE:_S.SW:t>0?_S.NE:_S.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=yS[_S.inv(e)];n.tx=r,n.ty=i,t.append(n)}},bS=function(){function t(){this.worldTransform=new cS,this.localTransform=new cS,this.position=new aS(this.onChange,this,0,0),this.scale=new aS(this.onChange,this,1,1),this.pivot=new aS(this.onChange,this,0,0),this.skew=new aS(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),xS=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=iS.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}(),TS=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=iS.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new xS(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}(),ES=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=iS.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new xS(this.x-this.width,this.y-this.height,this.width,this.height)},t}(),wS=function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof oS){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=iS.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r},t}(),SS=function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=iS.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1},t}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Fw.SORTABLE_CHILDREN=!1;var IS=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};IS.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},IS.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},IS.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?xS.EMPTY:((t=t||new xS(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},IS.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},IS.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},IS.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},IS.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},IS.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},IS.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},IS.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},IS.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},IS.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},IS.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},IS.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},IS.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},IS.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var AS=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new bS,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new IS,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new xS),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new xS),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*uS},r.angle.set=function(t){this.transform.rotation=t*lS},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function CS(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}AS.prototype.displayObjectUpdateTransform=AS.prototype.updateTransform;var OS=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=Fw.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);Hw(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,Hw(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Hw(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(CS),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(AS);OS.prototype.containerUpdateTransform=OS.prototype.updateTransform;
/*!
 * @pixi/core - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var RS=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new iw("setRealSize",2),this.onUpdate=new iw("update"),this.onError=new iw("onError",1)},NS={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};RS.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},RS.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},RS.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},NS.valid.get=function(){return!!this._width&&!!this._height},RS.prototype.update=function(){this.destroyed||this.onUpdate.run()},RS.prototype.load=function(){return Promise.resolve()},NS.width.get=function(){return this._width},NS.height.get=function(){return this._height},RS.prototype.upload=function(t,e,r){return!1},RS.prototype.style=function(t,e,r){return!1},RS.prototype.dispose=function(){},RS.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(RS.prototype,NS);var PS=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,tS||(tS=document.createElement("a")),tS.href=t;var r=Object(W.parse)(tS.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Nw.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(RS),MS=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:Fw.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===Nw.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(PS),DS=[];function FS(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=DS.length-1;n>=0;--n){var s=DS[n];if(s.test&&s.test(t,r))return new s(t,e)}return new MS(t,e)}var LS=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Nw.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(RS),kS={scaleMode:Cw.NEAREST,format:Sw.RGBA,alphaMode:Nw.NPM},US=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof RS||((e=FS(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||Fw.RESOLUTION,this.mipmap=void 0!==n?n:Fw.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:Fw.ANISOTROPIC_LEVEL,this.wrapMode=u||Fw.WRAP_MODE,this.scaleMode=void 0!==o?o:Fw.SCALE_MODE,this.format=l||Sw.RGBA,this.type=c||Aw.UNSIGNED_BYTE,this.target=d||Iw.TEXTURE_2D,this.alphaMode=void 0!==i?i:Nw.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=Yw(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=zw(this.realWidth)&&zw(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Qw[this.cacheId],delete Jw[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=Fw.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+Yw()),s=t._pixiId);var o=Qw[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new LS(t,{width:r,height:i}),o=t instanceof Float32Array?Aw.FLOAT:Aw.UNSIGNED_BYTE;return new e(s,Object.assign(kS,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Qw[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Qw[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Qw[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Qw[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Qw[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);US._globalBatch=0;var BS=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new US;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(FS(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Iw.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(RS),jS=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(PS),XS=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=Iw.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Iw.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(BS);XS.SIDES=6;var GS=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+Yw(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(PS);GS.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var zS=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=sS.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(sS.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(sS.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&sS.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(sS.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(sS.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(PS);zS.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var VS=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(PS);DS.push(MS,VS,jS,zS,GS,LS,XS,BS);var HS=function(t){this.renderer=t};HS.prototype.destroy=function(){this.renderer=null};var $S=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Nw.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(LS),WS=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new iw("disposeFramebuffer",2)},YS={colorTexture:{configurable:!0}};YS.colorTexture.get=function(){return this.colorTextures[0]},WS.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new US(null,{scaleMode:Cw.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},WS.prototype.addDepthTexture=function(t){return this.depthTexture=t||new US(new $S(null,{width:this.width,height:this.height}),{scaleMode:Cw.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:Sw.DEPTH_COMPONENT,type:Aw.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},WS.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},WS.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},WS.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},WS.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(WS.prototype,YS);var qS=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new WS(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(US),KS=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};KS.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=_S.add(r,_S.NW),this.x0=a+s*_S.uX(r),this.y0=h+o*_S.uY(r),r=_S.add(r,2),this.x1=a+s*_S.uX(r),this.y1=h+o*_S.uY(r),r=_S.add(r,2),this.x2=a+s*_S.uX(r),this.y2=h+o*_S.uY(r),r=_S.add(r,2),this.x3=a+s*_S.uX(r),this.y3=h+o*_S.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var ZS=new KS,JS=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new xS(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=ZS,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new oS(a.x,a.y):new oS(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&Jw[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===ZS&&(this._uvs=new KS),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=Fw.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+Yw()),s=t._pixiId);var o=Jw[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=rS(t)),(o=new e(new US(t,r))).baseTexture.cacheId=s,US.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(US.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new MS(t);n.url=r;var s=new e(new US(n,{scaleMode:Fw.SCALE_MODE,resolution:rS(r)}));return i||(i=r),US.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(US.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Jw[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Jw[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Jw[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Jw[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)Jw[t.textureCacheIds[i]]===t&&delete Jw[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function QS(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}JS.EMPTY=new JS(new US),QS(JS.EMPTY),QS(JS.EMPTY.baseTexture),JS.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new JS(new US(new jS(t)))}(),QS(JS.WHITE),QS(JS.WHITE.baseTexture);var tI=function(t){function e(e,r){var i=null;if(!(e instanceof qS)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new qS({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new qS(t))},e}(JS),eI=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};eI.prototype.createTexture=function(t,e){var r=new qS(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new tI(r)},eI.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=eI.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=Gw(t)))<<16|65535&(e=Gw(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},eI.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},eI.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},eI.prototype.returnFilterTexture=function(t){this.returnTexture(t)},eI.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},eI.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=eI.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},eI.SCREEN_KEY="screen";var rI=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};rI.prototype.destroy=function(){this.buffer=null},rI.from=function(t,e,r,i,n){return new rI(t,e,r,i,n)};var iI=0,nI=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=iI++,this.disposeRunner=new iw("disposeBuffer",2)};function sI(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}nI.prototype.update=function(t){this.data=t||this.data,this._updateID++},nI.prototype.dispose=function(){this.disposeRunner.run(this,!1)},nI.prototype.destroy=function(){this.dispose(),this.data=null},nI.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new nI(t)};var oI={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var aI={5126:4,5123:2,5121:1},hI=0,uI={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},lI=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=hI++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new iw("disposeGeometry",2),this.refCount=0};lI.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new nI(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new rI(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},lI.prototype.getAttribute=function(t){return this.attributes[t]},lI.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},lI.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new nI(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},lI.prototype.getIndex=function(){return this.indexBuffer},lI.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new nI;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*aI[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=sI(c);n[d]||(n[d]=new oI[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},lI.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},lI.prototype.dispose=function(){this.disposeRunner.run(this,!1)},lI.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},lI.prototype.clone=function(){for(var t=new lI,e=0;e<this.buffers.length;e++)t.buffers[e]=new nI(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new rI(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},lI.merge=function(t){for(var e,r=new lI,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(uI[sI(e.buffers[h].data)])(n[h]),r.buffers[h]=new nI(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*aI[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var cI=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(lI),dI=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new nI(this.vertices),this.uvBuffer=new nI(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(lI),pI=0,fI=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=pI++,this.static=!!e};fI.prototype.update=function(){this.dirtyId++},fI.prototype.add=function(t,e,r){this.uniforms[t]=new fI(e,r)},fI.from=function(t,e){return new fI(t,e)};var mI=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new xS,this.destinationFrame=new xS,this.filters=[]};mI.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var gI=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new eI,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new cI,this.quadUv=new dI,this.tempRect=new xS,this.activeState={},this.globalUniforms=new fI({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new mI,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(ww.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(ww.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(cS.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(HS),yI=function(t){this.renderer=t};yI.prototype.flush=function(){},yI.prototype.destroy=function(){this.renderer=null},yI.prototype.start=function(){},yI.prototype.stop=function(){this.flush()},yI.prototype.render=function(t){};var vI=function(t){function e(e){t.call(this,e),this.emptyRenderer=new yI(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(HS);Fw.PREFER_ENV=bw.any?xw.WEBGL:xw.WEBGL2,Fw.STRICT_TEXTURE_CACHE=!1;var _I=0,bI=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=_I++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=_I++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(Fw.PREFER_ENV>=xw.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(HS),xI=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new WS(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new xS,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;Fw.PREFER_ENV===xw.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new xS},Object.defineProperties(e.prototype,r),e}(HS),TI=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},EI={5126:4,5123:2,5121:1},wI=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;Fw.PREFER_ENV===xw.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*EI[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*EI[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*EI[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new TI(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(HS),SI=function(t){this.type=Dw.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function II(t,e,r,i){var n=AI(t,t.VERTEX_SHADER,e),s=AI(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function AI(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function CI(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return OI(2*e);case"bvec3":return OI(3*e);case"bvec4":return OI(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function OI(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}SI.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Dw.NONE,this.autoDetect=!0),this._target=null},SI.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var RI,NI={},PI=NI;function MI(){if(PI===NI||PI&&PI.isContextLost()){var t,e=document.createElement("canvas");Fw.PREFER_ENV>=xw.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),PI=t}return PI}function DI(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===Mw.HIGH&&r!==Mw.HIGH&&(i=Mw.MEDIUM),"precision "+i+" float;\n"+t}return r!==Mw.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var FI={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function LI(t){return FI[t]}var kI=null,UI={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function BI(t,e){if(!kI){var r=Object.keys(UI);kI={};for(var i=0;i<r.length;++i){var n=r[i];kI[t[n]]=UI[n]}}return kI[e]}var jI={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},XI={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var GI,zI=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function VI(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var HI=0,$I={},WI=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=HI++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),$I[i]?($I[i]++,i+="-"+$I[i]):$I[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=DI(this.vertexSrc,Fw.PRECISION_VERTEX,Mw.HIGH),this.fragmentSrc=DI(this.fragmentSrc,Fw.PRECISION_FRAGMENT,function(){if(!RI){RI=Mw.MEDIUM;var t=MI();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);RI=e.precision?Mw.HIGH:Mw.MEDIUM}}return RI}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},YI={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};WI.prototype.extractData=function(t,e){var r=MI();if(r){var i=II(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},WI.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=BI(e,o.type),h={type:a,name:o.name,size:LI(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},WI.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=BI(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:CI(h,s.size)}}return r},YI.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},YI.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},WI.from=function(t,e,r){var i=t+e,n=Zw[i];return n||(Zw[i]=n=new WI(t,e,r)),n},Object.defineProperties(WI,YI);var qI=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof fI?e:new fI(e):new fI({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},KI={uniforms:{configurable:!0}};qI.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},qI.prototype.destroy=function(){this.uniformGroup=null},KI.uniforms.get=function(){return this.uniformGroup.uniforms},qI.from=function(t,e,r){var i=WI.from(t,e);return new qI(i,r)},Object.defineProperties(qI.prototype,KI);var ZI=function(){this.data=0,this.blendMode=Ew.NORMAL,this.polygonOffset=0,this.blend=!0},JI={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};JI.blend.get=function(){return!!(1&this.data)},JI.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},JI.offsets.get=function(){return!!(2&this.data)},JI.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},JI.culling.get=function(){return!!(4&this.data)},JI.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},JI.depthTest.get=function(){return!!(8&this.data)},JI.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},JI.clockwiseFrontFace.get=function(){return!!(16&this.data)},JI.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},JI.blendMode.get=function(){return this._blendMode},JI.blendMode.set=function(t){this.blend=t!==Ew.NONE,this._blendMode=t},JI.polygonOffset.get=function(){return this._polygonOffset},JI.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},ZI.for2d=function(){var t=new ZI;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(ZI.prototype,JI);var QI=function(t){function e(r,i,n){var s=WI.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=Fw.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new ZI}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(qI);QI.SOURCE_KEY_MAP={};var tA=new cS,eA=function(t,e){this._texture=t,this.mapCoord=new cS,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},rA={texture:{configurable:!0}};rA.texture.get=function(){return this._texture},rA.texture.set=function(t){this._texture=t,this._updateID=-1},eA.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},eA.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(tA.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(tA));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(eA.prototype,rA);var iA=function(t){function e(e){var r=new cS;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new eA(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(QI),nA=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new SI;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case Dw.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case Dw.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case Dw.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Dw.SCISSOR:this.renderer.scissor.pop();break;case Dw.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Dw.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Dw.SPRITE;else if(t.type=Dw.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=Dw.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new iA(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(HS),sA=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(HS),oA=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(sA),aA=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(sA),hA=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new cS,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(HS),uA=new xS,lA=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new xS,this.destinationFrame=new xS}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(uA.width=s.realWidth,uA.height=s.realHeight,r=uA),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(uA.width=n.width,uA.height=n.height,r=uA),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(HS),cA=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};cA.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var dA=0,pA={textureCount:0},fA=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=dA++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof GI)return GI;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");GI=!0===t({a:"b"},"a","b")}catch(t){GI=!1}return GI}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(pA.textureCount=0,this.syncUniformGroup(t.uniformGroup,pA)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?jI:XI)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=II(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:CI(h.type,h.size)}}var u=new cA(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(HS);var mA=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Ew.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new ZI,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[Ew.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.ADD]=[t.ONE,t.ONE],e[Ew.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.NONE]=[0,0],e[Ew.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Ew.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ew.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Ew.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Ew.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Ew.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Ew.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Ew.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Ew.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Ew.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Ew.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(HS),gA=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=Fw.GC_MAX_IDLE,this.checkCountMax=Fw.GC_MAX_CHECK_COUNT,this.mode=Fw.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Pw.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(HS),yA=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},vA=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new US}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new yA(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new yA(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new yA(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===Aw.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&Hw(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==Rw.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=Ow.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Cw.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Cw.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Cw.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===Cw.LINEAR?r.LINEAR:r.NEAREST)},e}(HS),_A=new cS;V.a;var bA=function(){this.texArray=null,this.blend=0,this.type=ww.TRIANGLES,this.start=0,this.size=0,this.data=null},xA=function(){this.elements=[],this.ids=[],this.count=0};xA.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var TA=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},EA={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};EA.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},EA.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},EA.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},EA.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},EA.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},TA.prototype.view=function(t){return this[t+"View"]},TA.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},TA.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(TA.prototype,EA);var wA=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=ZI.for2d(),this.size=4*Fw.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;Fw.PREFER_ENV===xw.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Fw.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=zI.replace(/%forloop%/gi,VI(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new bA);for(;r.length<n;)r.push(new xA);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++US._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;US._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=jw[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;Fw.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Fw.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=Gw(Math.ceil(t/8)),r=Vw(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new TA(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=Gw(Math.ceil(t/12)),r=Vw(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?Xw(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(yI);wA._drawCallPool=[],wA._textureArrayPool=[];var SA=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};SA.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=fI.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new WI(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new cS,default:this.defaultGroupCache[t]};return new qI(this.programCache[t],n)},SA.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var IA=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new nI(null,e,!1),this._indexBuffer=new nI(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Aw.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Aw.FLOAT).addAttribute("aColor",this._buffer,4,!0,Aw.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Aw.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(lI),AA="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",CA="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",OA=function(){},RA={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};OA.create=function(t){var e=Object.assign({vertex:AA,fragment:CA,geometryClass:IA,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new SA(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(wA)},RA.defaultVertexSrc.get=function(){return AA},RA.defaultFragmentTemplate.get=function(){return CA},Object.defineProperties(OA,RA);OA.create();
/*!
 * @pixi/graphics - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var NA={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},PA=function(){this.reset()};PA.prototype.clone=function(){var t=new PA;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},PA.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=JS.WHITE,this.matrix=null,this.visible=!1},PA.prototype.destroy=function(){this.texture=null,this.matrix=null};var MA={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var r=t.points,i=t.holes,n=e.points,s=e.indices;if(r.length>=6){for(var o=[],a=0;a<i.length;a++){var h=i[a];o.push(r.length/2),r=r.concat(h.points)}var u=$()(r,o,2);if(!u)return;for(var l=n.length/2,c=0;c<u.length;c+=3)s.push(u[c]+l),s.push(u[c+1]+l),s.push(u[c+2]+l);for(var d=0;d<r.length;d++)n.push(r[d])}}},DA={build:function(t){var e,r,i=t.shape,n=t.points,s=i.x,o=i.y;if(n.length=0,t.type===iS.CIRC?(e=i.radius,r=i.radius):(e=i.width,r=i.height),0!==e&&0!==r){var a=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(i.width+i.height));a/=2.3;for(var h=2*Math.PI/a,u=0;u<a-.5;u++)n.push(s+Math.sin(-h*u)*e,o+Math.cos(-h*u)*r);n.push(n[0],n[1])}},triangulate:function(t,e){var r=t.points,i=e.points,n=e.indices,s=i.length/2,o=s,a=t.shape,h=t.matrix,u=a.x,l=a.y;i.push(t.matrix?h.a*u+h.c*l+h.tx:u,t.matrix?h.b*u+h.d*l+h.ty:l);for(var c=0;c<r.length;c+=2)i.push(r[c],r[c+1]),n.push(s++,o,s)}},FA={build:function(t){var e=t.shape,r=e.x,i=e.y,n=e.width,s=e.height,o=t.points;o.length=0,o.push(r,i,r+n,i,r+n,i+s,r,i+s)},triangulate:function(t,e){var r=t.points,i=e.points,n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},LA={build:function(t){var e=t.shape,r=t.points,i=e.x,n=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));r.length=0,a?(UA(i,n+a,i,n,i+a,n,r),UA(i+s-a,n,i+s,n,i+s,n+a,r),UA(i+s,n+o-a,i+s,n+o,i+s-a,n+o,r),UA(i+a,n+o,i,n+o,i,n+o-a,r)):r.push(i,n,i+s,n,i+s,n+o,i,n+o)},triangulate:function(t,e){for(var r=t.points,i=e.points,n=e.indices,s=i.length/2,o=$()(r,null,2),a=0,h=o.length;a<h;a+=3)n.push(o[a]+s),n.push(o[a+1]+s),n.push(o[a+2]+s);for(var u=0,l=r.length;u<l;u++)i.push(r[u],r[++u])}};function kA(t,e,r){return t+(e-t)*r}function UA(t,e,r,i,n,s,o){void 0===o&&(o=[]);for(var a=o,h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0;f<=20;++f)h=kA(t,r,m=f/20),u=kA(e,i,m),l=kA(r,n,m),c=kA(i,s,m),d=kA(h,l,m),p=kA(u,c,m),a.push(d,p);return a}function BA(t,e){t.lineStyle.native?function(t,e){var r=0,i=t.shape,n=t.points||i.points,s=i.type!==iS.POLY||i.closeStroke;if(0===n.length)return;var o=e.points,a=e.indices,h=n.length/2,u=o.length/2,l=u;for(o.push(n[0],n[1]),r=1;r<h;r++)o.push(n[2*r],n[2*r+1]),a.push(l,l+1),l++;s&&a.push(l,u)}(t,e):function(t,e){var r=t.shape,i=t.points||r.points.slice(),n=e.closePointEps;if(0===i.length)return;var s=t.lineStyle,o=new oS(i[0],i[1]),a=new oS(i[i.length-2],i[i.length-1]),h=r.type!==iS.POLY||r.closeStroke,u=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(h){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var l=a.x+.5*(o.x-a.x),c=a.y+.5*(o.y-a.y);i.unshift(l,c),i.push(l,c)}var d=e.points,p=i.length/2,f=i.length,m=d.length/2,g=s.width/2,y=i[0],v=i[1],_=i[2],b=i[3],x=0,T=0,E=-(v-b),w=y-_,S=0,I=0,A=0,C=0,O=Math.sqrt(E*E+w*w);E/=O,w/=O,E*=g,w*=g;var R=s.alignment,N=2*(1-R),P=2*R;d.push(y-E*N,v-w*N),d.push(y+E*P,v+w*P);for(var M=1;M<p-1;++M){y=i[2*(M-1)],v=i[2*(M-1)+1],_=i[2*M],b=i[2*M+1],x=i[2*(M+1)],T=i[2*(M+1)+1],E=-(v-b),w=y-_,O=Math.sqrt(E*E+w*w),E/=O,w/=O,E*=g,w*=g,S=-(b-T),I=_-x,O=Math.sqrt(S*S+I*I),S/=O,I/=O;var D=-w+v-(-w+b),F=-E+_-(-E+y),L=(-E+y)*(-w+b)-(-E+_)*(-w+v),k=-(I*=g)+T-(-I+b),U=-(S*=g)+_-(-S+x),B=(-S+x)*(-I+b)-(-S+_)*(-I+T),j=D*U-k*F;if(Math.abs(j)<.1)j+=10.1,d.push(_-E*N,b-w*N),d.push(_+E*P,b+w*P);else{var X=(F*B-U*L)/j,G=(k*L-D*B)/j;(X-_)*(X-_)+(G-b)*(G-b)>196*g*g?(A=E-S,C=w-I,O=Math.sqrt(A*A+C*C),A/=O,C/=O,A*=g,C*=g,d.push(_-A*N,b-C*N),d.push(_+A*P,b+C*P),d.push(_-A*P*N,b-C*N),f++):(d.push(_+(X-_)*N,b+(G-b)*N),d.push(_-(X-_)*P,b-(G-b)*P))}}y=i[2*(p-2)],v=i[2*(p-2)+1],_=i[2*(p-1)],b=i[2*(p-1)+1],E=-(v-b),w=y-_,O=Math.sqrt(E*E+w*w),E/=O,w/=O,E*=g,w*=g,d.push(_-E*N,b-w*N),d.push(_+E*P,b+w*P);for(var z=e.indices,V=0;V<f-2;++V)z.push(m,m+1,m+2),m++}(t,e)}var jA=function(t){function e(e,r,i,n,s,o){s=s||n/2;for(var a=-1*Math.PI/2+o,h=2*i,u=hS/h,l=[],c=0;c<h;c++){var d=c%2?s:n,p=c*u+a;l.push(e+d*Math.cos(p),r+d*Math.sin(p))}t.call(this,l)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(wS),XA=function(){};XA.curveTo=function(t,e,r,i,n,s){var o=s[s.length-2],a=s[s.length-1]-e,h=o-t,u=i-e,l=r-t,c=Math.abs(a*l-h*u);if(c<1e-8||0===n)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var d=a*a+h*h,p=u*u+l*l,f=a*u+h*l,m=n*Math.sqrt(d)/c,g=n*Math.sqrt(p)/c,y=m*f/d,v=g*f/p,_=m*l+g*h,b=m*u+g*a,x=h*(g+y),T=a*(g+y),E=l*(m+v),w=u*(m+v);return{cx:_+t,cy:b+e,radius:n,startAngle:Math.atan2(T-b,x-_),endAngle:Math.atan2(w-b,E-_),anticlockwise:h*u>l*a}},XA.arc=function(t,e,r,i,n,s,o,a,h){for(var u=o-s,l=NA._segmentsCount(Math.abs(u)*n,40*Math.ceil(Math.abs(u)/hS)),c=u/(2*l),d=2*c,p=Math.cos(c),f=Math.sin(c),m=l-1,g=m%1/m,y=0;y<=m;++y){var v=c+s+d*(y+g*y),_=Math.cos(v),b=-Math.sin(v);h.push((p*_+f*b)*n+r,(p*-b+f*_)*n+i)}};var GA=function(){};GA.curveLength=function(t,e,r,i,n,s,o,a){for(var h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=t,b=e,x=1;x<=10;++x)y=_-(m=(f=(p=(d=1-(u=x/10))*d)*d)*t+3*p*u*r+3*d*(l=u*u)*n+(c=l*u)*o),v=b-(g=f*e+3*p*u*i+3*d*l*s+c*a),_=m,b=g,h+=Math.sqrt(y*y+v*v);return h},GA.curveTo=function(t,e,r,i,n,s,o){var a=o[o.length-2],h=o[o.length-1];o.length-=2;var u=NA._segmentsCount(GA.curveLength(a,h,t,e,r,i,n,s)),l=0,c=0,d=0,p=0,f=0;o.push(a,h);for(var m=1,g=0;m<=u;++m)d=(c=(l=1-(g=m/u))*l)*l,f=(p=g*g)*g,o.push(d*a+3*c*g*t+3*l*p*r+f*n,d*h+3*c*g*e+3*l*p*i+f*s)};var zA=function(){};zA.curveLength=function(t,e,r,i,n,s){var o=t-2*r+n,a=e-2*i+s,h=2*r-2*t,u=2*i-2*e,l=4*(o*o+a*a),c=4*(o*h+a*u),d=h*h+u*u,p=2*Math.sqrt(l+c+d),f=Math.sqrt(l),m=2*l*f,g=2*Math.sqrt(d),y=c/f;return(m*p+f*c*(p-g)+(4*d*l-c*c)*Math.log((2*f+y+p)/(y+g)))/(4*m)},zA.curveTo=function(t,e,r,i,n){for(var s=n[n.length-2],o=n[n.length-1],a=NA._segmentsCount(zA.curveLength(s,o,t,e,r,i)),h=0,u=0,l=1;l<=a;++l){var c=l/a;h=s+(t-s)*c,u=o+(e-o)*c,n.push(h+(t+(r-t)*c-h)*c,u+(e+(i-e)*c-u)*c)}};var VA=function(){this.reset()};VA.prototype.begin=function(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r},VA.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},VA.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0};var HA={};HA[iS.POLY]=MA,HA[iS.CIRC]=DA,HA[iS.ELIP]=DA,HA[iS.RECT]=FA,HA[iS.RREC]=LA;var $A=[],WA=[],YA=function(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type,this.points=[],this.holes=[]};YA.prototype.clone=function(){return new YA(this.shape,this.fillStyle,this.lineStyle,this.matrix)},YA.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null};var qA=new oS,KA=new IS,ZA=function(t){function e(){t.call(this),this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeIndex=0,this._bounds=new IS,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.uvsFloat32=null,this.closePointEps=1e-4}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={bounds:{configurable:!0}};return r.bounds.get=function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].textures.length=0,WA.push(this.drawCalls[t]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var r=this.batches[e];r.reset(),$A.push(r)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,r,i){var n=new YA(t,e,r,i);return this.graphicsData.push(n),this.dirty++,this},e.prototype.drawHole=function(t,e){if(!this.graphicsData.length)return null;var r=new YA(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var r=0;r<this.graphicsData.length;++r)this.graphicsData[r].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,r=0;r<e.length;++r){var i=e[r];if(i.fillStyle.visible&&(i.shape&&(i.matrix?i.matrix.applyInverse(t,qA):qA.copyFrom(t),i.shape.contains(qA.x,qA.y)))){var n=!1;if(i.holes)for(var s=0;s<i.holes.length;s++){if(i.holes[s].shape.contains(qA.x,qA.y)){n=!0;break}}if(!n)return!0}}return!1},e.prototype.updateBatches=function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,e=this.graphicsData,r=null,i=null;this.batches.length>0&&(i=(r=this.batches[this.batches.length-1]).style);for(var n=this.shapeIndex;n<e.length;n++){this.shapeIndex++;var s=e[n],o=s.fillStyle,a=s.lineStyle;HA[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var h=0;h<2;h++){var u=0===h?o:a;if(u.visible){var l=u.texture.baseTexture,c=this.indices.length,d=this.points.length/2;l.wrapMode=Ow.REPEAT,0===h?this.processFill(s):this.processLine(s);var p=this.points.length/2-d;0!==p&&(r&&!this._compareStyles(i,u)&&(r.end(c,d),r=null),r||((r=$A.pop()||new VA).begin(u,c,d),this.batches.push(r),i=u),this.addUvs(this.points,t,u.texture,d,p,u.matrix))}}}if(r){var f=this.indices.length,m=this.points.length/2;r.end(f,m)}0!==this.batches.length?(this.indicesUint16=new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()):this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var r=this.graphicsData[t],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,r=t.length;e<r;e++)for(var i=t[e],n=0;n<i.size;n++){var s=i.start+n;this.indicesUint16[s]=this.indicesUint16[s]-i.attribStart}},e.prototype.isBatchable=function(){for(var t=this.batches,r=0;r<t.length;r++)if(t[r].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++US._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].textures.length=0,WA.push(this.drawCalls[e]);this.drawCalls.length=0;var r=this.colors,i=this.textureIds,n=WA.pop();n||((n=new bA).textures=new xA),n.textures.count=0,n.start=0,n.size=0,n.type=ww.TRIANGLES;var s=0,o=null,a=0,h=!1,u=ww.TRIANGLES,l=0;this.drawCalls.push(n);for(var c=0;c<this.batches.length;c++){var d=this.batches[c],p=d.style,f=p.texture.baseTexture;h!==!!p.native&&(u=(h=!!p.native)?ww.LINES:ww.TRIANGLES,o=null,s=8,t++),o!==f&&(o=f,f._batchEnabled!==t&&(8===s&&(t++,s=0,n.size>0&&((n=WA.pop())||((n=new bA).textures=new xA),this.drawCalls.push(n)),n.start=l,n.size=0,n.textures.count=0,n.type=u),f.touched=1,f._batchEnabled=t,f._batchLocation=s,f.wrapMode=10497,n.textures.elements[n.textures.count++]=f,s++)),n.size+=d.size,l+=d.size,a=f._batchLocation,this.addColors(r,p.color,p.alpha,d.attribSize),this.addTextureIds(i,a,d.attribSize)}US._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(3*t.length*4),s=new Float32Array(n),o=new Uint32Array(n),a=0,h=0;h<t.length/2;h++)s[a++]=t[2*h],s[a++]=t[2*h+1],s[a++]=e[2*h],s[a++]=e[2*h+1],o[a++]=r[h],s[a++]=i[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),MA.triangulate(t,this)):HA[t.type].triangulate(t,this)},e.prototype.processLine=function(t){BA(t,this);for(var e=0;e<t.holes.length;e++)BA(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var r=t[e];HA[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=KA,r=cS.IDENTITY;this._bounds.clear(),e.clear();for(var i=0;i<this.graphicsData.length;i++){var n=this.graphicsData[i],s=n.shape,o=n.type,a=n.lineStyle,h=n.matrix||cS.IDENTITY,u=0;if(a&&a.visible){var l=a.alignment;u=a.width,o===iS.POLY?u*=.5+Math.abs(.5-l):u*=Math.max(0,l)}r!==h&&(e.isEmpty()||(t.addBoundsMatrix(e,r),e.clear()),r=h),o===iS.RECT||o===iS.RREC?e.addFramePad(s.x,s.y,s.x+s.width,s.y+s.height,u,u):o===iS.CIRC?e.addFramePad(s.x,s.y,s.x,s.y,s.radius+u,s.radius+u):o===iS.ELIP?e.addFramePad(s.x,s.y,s.x,s.y,s.width+u,s.height+u):t.addVerticesMatrix(r,s.points,0,s.points.length,u,u)}e.isEmpty()||t.addBoundsMatrix(e,r),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var r=0;r<t.length/2;r++){var i=t[2*r],n=t[2*r+1];t[2*r]=e.a*i+e.c*n+e.tx,t[2*r+1]=e.b*i+e.d*n+e.ty}},e.prototype.addColors=function(t,e,r,i){for(var n=Xw((e>>16)+(65280&e)+((255&e)<<16),r);i-- >0;)t.push(n)},e.prototype.addTextureIds=function(t,e,r){for(;r-- >0;)t.push(e)},e.prototype.addUvs=function(t,e,r,i,n,s){for(var o=0,a=e.length,h=r.frame;o<n;){var u=t[2*(i+o)],l=t[2*(i+o)+1];if(s){var c=s.a*u+s.c*l+s.tx;l=s.b*u+s.d*l+s.ty,u=c}o++,e.push(u/h.width,l/h.height)}var d=r.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,r,a,n)},e.prototype.adjustUvs=function(t,e,r,i){for(var n=e.baseTexture,s=r+2*i,o=e.frame,a=o.width/n.width,h=o.height/n.height,u=o.x/o.width,l=o.y/o.height,c=Math.floor(t[r]+1e-6),d=Math.floor(t[r+1]+1e-6),p=r+2;p<s;p+=2)c=Math.min(c,Math.floor(t[p]+1e-6)),d=Math.min(d,Math.floor(t[p+1]+1e-6));u-=c,l-=d;for(var f=r;f<s;f+=2)t[f]=(t[f]+u)*a,t[f+1]=(t[f+1]+l)*h},Object.defineProperties(e.prototype,r),e}(IA);ZA.BATCHABLE_SIZE=100;var JA=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.width=0,this.alignment=.5,this.native=!1},e}(PA),QA=new Float32Array(3),tC={},eC=function(t){function e(e){void 0===e&&(e=null),t.call(this),this.geometry=e||new ZA,this.geometry.refCount++,this.shader=null,this.state=ZI.for2d(),this._fillStyle=new PA,this._lineStyle=new JA,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.vertexData=null,this._transformID=-1,this.batchDirty=-1,this.pluginName="batch",this.tint=16777215,this.blendMode=Ew.NORMAL}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0},tint:{configurable:!0},fill:{configurable:!0},line:{configurable:!0}};return e.prototype.clone=function(){return this.finishPoly(),new e(this.geometry)},r.blendMode.set=function(t){this.state.blendMode=t},r.blendMode.get=function(){return this.state.blendMode},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t},r.fill.get=function(){return this._fillStyle},r.line.get=function(){return this._lineStyle},e.prototype.lineStyle=function(t){if("number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){if("number"==typeof t){Kw("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var e=arguments[0],r=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],o=arguments[5],a=arguments[6];t={width:e,texture:r,color:i,alpha:n,matrix:s,alignment:o,native:a},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({width:0,texture:JS.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1},t),this.currentPath&&this.startPoly();var h=t.width>0&&t.alpha>0;return h?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:h},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new wS,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new wS,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return i===t&&n===e||r.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,r,i){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),zA.curveTo(t,e,r,i,n),this},e.prototype.bezierCurveTo=function(t,e,r,i,n,s){return this._initCurve(),GA.curveTo(t,e,r,i,n,s,this.currentPath.points),this},e.prototype.arcTo=function(t,e,r,i,n){this._initCurve(t,e);var s=this.currentPath.points,o=XA.curveTo(t,e,r,i,n,s);if(o){var a=o.cx,h=o.cy,u=o.radius,l=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(a,h,u,l,c,d)}return this},e.prototype.arc=function(t,e,r,i,n,s){if(void 0===s&&(s=!1),i===n)return this;if(!s&&n<=i?n+=hS:s&&i<=n&&(i+=hS),0===n-i)return this;var o=t+Math.cos(i)*r,a=e+Math.sin(i)*r,h=this.geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var l=Math.abs(u[u.length-2]-o),c=Math.abs(u[u.length-1]-a);l<h&&c<h||u.push(o,a)}else this.moveTo(o,a),u=this.currentPath.points;return XA.arc(o,a,t,e,r,i,n,s,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:JS.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){if(t instanceof JS){Kw("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments[0],r=arguments[1],i=arguments[2],n=arguments[3];t={texture:e,color:r,alpha:i,matrix:n},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({texture:JS.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var s=t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:s},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,r,i){return this.drawShape(new xS(t,e,r,i))},e.prototype.drawRoundedRect=function(t,e,r,i,n){return this.drawShape(new SS(t,e,r,i,n))},e.prototype.drawCircle=function(t,e,r){return this.drawShape(new TS(t,e,r))},e.prototype.drawEllipse=function(t,e,r,i){return this.drawShape(new ES(t,e,r,i))},e.prototype.drawPolygon=function(t){var e=arguments,r=t,i=!0;if(r.points&&(i=r.closeStroke,r=r.points),!Array.isArray(r)){r=new Array(arguments.length);for(var n=0;n<r.length;++n)r[n]=e[n]}var s=new wS(r);return s.closeStroke=i,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this.geometry.drawHole(t,this._matrix):this.geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,e,r,i,n,s){return void 0===s&&(s=0),this.drawPolygon(new jA(t,e,r,i,n,s))},e.prototype.clear=function(){return this.geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){return 1===this.geometry.graphicsData.length&&this.geometry.graphicsData[0].shape.type===iS.RECT&&!this.geometry.graphicsData[0].lineWidth},e.prototype._render=function(t){this.finishPoly();var e=this.geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this.geometry,e=this.blendMode;this.batches=[],this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.vertexData=new Float32Array(t.points);for(var r=0,i=t.batches.length;r<i;r++){var n=t.batches[r],s=n.style.color,o=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),h={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:a,_batchRGB:Uw(s),_tintRGB:s,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,r=this.batches.length;e<r;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),r=this.geometry,i=this.tint,n=this.worldAlpha,s=e.uniforms,o=r.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(i>>16&255)/255*n,s.tint[1]=(i>>8&255)/255*n,s.tint[2]=(255&i)/255*n,s.tint[3]=n,t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(var a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,r.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var r=e.textures,i=e.type,n=e.size,s=e.start,o=r.count,a=0;a<o;a++)t.texture.bind(r.elements[a],a);t.geometry.draw(i,n,s)},e.prototype._resolveDirectShader=function(t){var e=this.shader,r=this.pluginName;if(!e){if(!tC[r]){for(var i=new Int32Array(16),n=0;n<16;n++)i[n]=n;var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new cS,default:fI.from({uSamplers:i},!0)},o=t.plugins[r]._shader.program;tC[r]=new qI(o,s)}e=tC[r]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this.geometry;if(t.graphicsData.length){var e=t.bounds,r=e.minX,i=e.minY,n=e.maxX,s=e.maxY;this._bounds.addFrame(this.transform,r,i,n,s)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this.geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Uw(this.tint,QA),e=0;e<this.batches.length;e++){var r=this.batches[e],i=r._batchRGB,n=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);r._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID;for(var t=this.transform.worldTransform,e=t.a,r=t.b,i=t.c,n=t.d,s=t.tx,o=t.ty,a=this.geometry.points,h=this.vertexData,u=0,l=0;l<a.length;l+=2){var c=a[l],d=a[l+1];h[u++]=e*c+i*d+s,h[u++]=n*d+r*c+o}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this.geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},Object.defineProperties(e.prototype,r),e}(OS);eC._TEMP_POINT=new oS;
/*!
 * @pixi/sprite - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var rC=new oS,iC=new Uint16Array([0,1,2,0,2,3]),nC=function(t){function e(e){t.call(this),this._anchor=new aS(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=Ew.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=e||JS.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=iC,this.pluginName="batch",this.isSprite=!0,this._roundPixels=Fw.ROUND_PIXELS}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=$w(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=$w(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,d=0,p=0,f=0,m=0;if(u?(d=(p=u.x-c._x*l.width)+u.width,f=(m=u.y-c._y*l.height)+u.height):(d=(p=-c._x*l.width)+l.width,f=(m=-c._y*l.height)+l.height),h[0]=r*p+n*m+o,h[1]=s*m+i*p+a,h[2]=r*d+n*m+o,h[3]=s*m+i*d+a,h[4]=r*d+n*f+o,h[5]=s*f+i*d+a,h[6]=r*p+n*f+o,h[7]=s*f+i*p+a,this._roundPixels)for(var g=Fw.RESOLUTION,y=0;y<h.length;++y)h[y]=Math.round((h[y]*g|0)/g)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,i=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=-i._x*r.width,d=c+r.width,p=-i._y*r.height,f=p+r.height;e[0]=s*c+a*p+u,e[1]=h*p+o*c+l,e[2]=s*d+a*p+u,e[3]=h*p+o*d+l,e[4]=s*d+a*f+u,e[5]=h*f+o*d+l,e[6]=s*c+a*f+u,e[7]=h*f+o*c+l},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new xS),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,rC);var e=this._texture.orig.width,r=this._texture.orig.height,i=-e*this.anchor.x,n=0;return rC.x>=i&&rC.x<i+e&&(n=-r*this.anchor.y,rC.y>=n&&rC.y<n+r)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var r="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null,this.shader=null},e.from=function(t,r){return new e(t instanceof JS?t:JS.from(t,r))},r.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},r.roundPixels.get=function(){return this._roundPixels},r.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},r.width.set=function(t){var e=$w(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},r.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},r.height.set=function(t){var e=$w(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},r.anchor.get=function(){return this._anchor},r.anchor.set=function(t){this._anchor.copyFrom(t)},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},r.texture.get=function(){return this._texture},r.texture.set=function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||JS.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},Object.defineProperties(e.prototype,r),e}(OS),sC=0,oC={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:sC,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},aC=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],hC=function(t){this.styleID=0,this.reset(),dC(this,t,t)},uC={align:{configurable:!0},breakWords:{configurable:!0},dropShadow:{configurable:!0},dropShadowAlpha:{configurable:!0},dropShadowAngle:{configurable:!0},dropShadowBlur:{configurable:!0},dropShadowColor:{configurable:!0},dropShadowDistance:{configurable:!0},fill:{configurable:!0},fillGradientType:{configurable:!0},fillGradientStops:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontStyle:{configurable:!0},fontVariant:{configurable:!0},fontWeight:{configurable:!0},letterSpacing:{configurable:!0},lineHeight:{configurable:!0},leading:{configurable:!0},lineJoin:{configurable:!0},miterLimit:{configurable:!0},padding:{configurable:!0},stroke:{configurable:!0},strokeThickness:{configurable:!0},textBaseline:{configurable:!0},trim:{configurable:!0},whiteSpace:{configurable:!0},wordWrap:{configurable:!0},wordWrapWidth:{configurable:!0}};function lC(t){return"number"==typeof t?Bw(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function cC(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=lC(t[e]);return t}return lC(t)}function dC(t,e,r){for(var i in r)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}hC.prototype.clone=function(){var t={};return dC(t,this,oC),new hC(t)},hC.prototype.reset=function(){dC(this,oC,oC)},uC.align.get=function(){return this._align},uC.align.set=function(t){this._align!==t&&(this._align=t,this.styleID++)},uC.breakWords.get=function(){return this._breakWords},uC.breakWords.set=function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},uC.dropShadow.get=function(){return this._dropShadow},uC.dropShadow.set=function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},uC.dropShadowAlpha.get=function(){return this._dropShadowAlpha},uC.dropShadowAlpha.set=function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},uC.dropShadowAngle.get=function(){return this._dropShadowAngle},uC.dropShadowAngle.set=function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},uC.dropShadowBlur.get=function(){return this._dropShadowBlur},uC.dropShadowBlur.set=function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},uC.dropShadowColor.get=function(){return this._dropShadowColor},uC.dropShadowColor.set=function(t){var e=cC(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},uC.dropShadowDistance.get=function(){return this._dropShadowDistance},uC.dropShadowDistance.set=function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},uC.fill.get=function(){return this._fill},uC.fill.set=function(t){var e=cC(t);this._fill!==e&&(this._fill=e,this.styleID++)},uC.fillGradientType.get=function(){return this._fillGradientType},uC.fillGradientType.set=function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},uC.fillGradientStops.get=function(){return this._fillGradientStops},uC.fillGradientStops.set=function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},uC.fontFamily.get=function(){return this._fontFamily},uC.fontFamily.set=function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},uC.fontSize.get=function(){return this._fontSize},uC.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},uC.fontStyle.get=function(){return this._fontStyle},uC.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},uC.fontVariant.get=function(){return this._fontVariant},uC.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},uC.fontWeight.get=function(){return this._fontWeight},uC.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},uC.letterSpacing.get=function(){return this._letterSpacing},uC.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},uC.lineHeight.get=function(){return this._lineHeight},uC.lineHeight.set=function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},uC.leading.get=function(){return this._leading},uC.leading.set=function(t){this._leading!==t&&(this._leading=t,this.styleID++)},uC.lineJoin.get=function(){return this._lineJoin},uC.lineJoin.set=function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},uC.miterLimit.get=function(){return this._miterLimit},uC.miterLimit.set=function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},uC.padding.get=function(){return this._padding},uC.padding.set=function(t){this._padding!==t&&(this._padding=t,this.styleID++)},uC.stroke.get=function(){return this._stroke},uC.stroke.set=function(t){var e=cC(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},uC.strokeThickness.get=function(){return this._strokeThickness},uC.strokeThickness.set=function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},uC.textBaseline.get=function(){return this._textBaseline},uC.textBaseline.set=function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},uC.trim.get=function(){return this._trim},uC.trim.set=function(t){this._trim!==t&&(this._trim=t,this.styleID++)},uC.whiteSpace.get=function(){return this._whiteSpace},uC.whiteSpace.set=function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},uC.wordWrap.get=function(){return this._wordWrap},uC.wordWrap.set=function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},uC.wordWrapWidth.get=function(){return this._wordWrapWidth},uC.wordWrapWidth.set=function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},hC.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var i=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&aC.indexOf(i)<0&&(i='"'+i+'"'),e[r]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},Object.defineProperties(hC.prototype,uC);var pC=function(t,e,r,i,n,s,o,a,h){this.text=t,this.style=e,this.width=r,this.height=i,this.lines=n,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h};pC.measureText=function(t,e,r,i){void 0===i&&(i=pC._canvas),r=null==r?e.wordWrap:r;var n=e.toFontString(),s=pC.measureFont(n);0===s.fontSize&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var o=i.getContext("2d");o.font=n;for(var a=(r?pC.wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),h=new Array(a.length),u=0,l=0;l<a.length;l++){var c=o.measureText(a[l]).width+(a[l].length-1)*e.letterSpacing;h[l]=c,u=Math.max(u,c)}var d=u+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);var p=e.lineHeight||s.fontSize+e.strokeThickness,f=Math.max(p,s.fontSize+e.strokeThickness)+(a.length-1)*(p+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new pC(t,e,d,f,a,h,p+e.leading,u,s)},pC.wordWrap=function(t,e,r){void 0===r&&(r=pC._canvas);for(var i=r.getContext("2d"),n=0,s="",o="",a={},h=e.letterSpacing,u=e.whiteSpace,l=pC.collapseSpaces(u),c=pC.collapseNewlines(u),d=!l,p=e.wordWrapWidth+h,f=pC.tokenize(t),m=0;m<f.length;m++){var g=f[m];if(pC.isNewline(g)){if(!c){o+=pC.addLine(s),d=!l,s="",n=0;continue}g=" "}if(l){var y=pC.isBreakingSpace(g),v=pC.isBreakingSpace(s[s.length-1]);if(y&&v)continue}var _=pC.getFromCache(g,h,a,i);if(_>p)if(""!==s&&(o+=pC.addLine(s),s="",n=0),pC.canBreakWords(g,e.breakWords))for(var b=pC.wordWrapSplit(g),x=0;x<b.length;x++){for(var T=b[x],E=1;b[x+E];){var w=b[x+E],S=T[T.length-1];if(pC.canBreakChars(S,w,g,x,e.breakWords))break;T+=w,E++}x+=T.length-1;var I=pC.getFromCache(T,h,a,i);I+n>p&&(o+=pC.addLine(s),d=!1,s="",n=0),s+=T,n+=I}else{s.length>0&&(o+=pC.addLine(s),s="",n=0);var A=m===f.length-1;o+=pC.addLine(g,!A),d=!1,s="",n=0}else _+n>p&&(d=!1,o+=pC.addLine(s),s="",n=0),(s.length>0||!pC.isBreakingSpace(g)||d)&&(s+=g,n+=_)}return o+=pC.addLine(s,!1)},pC.addLine=function(t,e){return void 0===e&&(e=!0),t=pC.trimRight(t),t=e?t+"\n":t},pC.getFromCache=function(t,e,r,i){var n=r[t];if(void 0===n){var s=t.length*e;n=i.measureText(t).width+s,r[t]=n}return n},pC.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},pC.collapseNewlines=function(t){return"normal"===t},pC.trimRight=function(t){if("string"!=typeof t)return"";for(var e=t.length-1;e>=0;e--){var r=t[e];if(!pC.isBreakingSpace(r))break;t=t.slice(0,-1)}return t},pC.isNewline=function(t){return"string"==typeof t&&pC._newlines.indexOf(t.charCodeAt(0))>=0},pC.isBreakingSpace=function(t){return"string"==typeof t&&pC._breakingSpaces.indexOf(t.charCodeAt(0))>=0},pC.tokenize=function(t){var e=[],r="";if("string"!=typeof t)return e;for(var i=0;i<t.length;i++){var n=t[i];pC.isBreakingSpace(n)||pC.isNewline(n)?(""!==r&&(e.push(r),r=""),e.push(n)):r+=n}return""!==r&&e.push(r),e},pC.canBreakWords=function(t,e){return e},pC.canBreakChars=function(t,e,r,i,n){return!0},pC.wordWrapSplit=function(t){return t.split("")},pC.measureFont=function(t){if(pC._fonts[t])return pC._fonts[t];var e={},r=pC._canvas,i=pC._context;i.font=t;var n=pC.METRICS_STRING+pC.BASELINE_SYMBOL,s=Math.ceil(i.measureText(n).width),o=Math.ceil(i.measureText(pC.BASELINE_SYMBOL).width),a=2*o;o=o*pC.BASELINE_MULTIPLIER|0,r.width=s,r.height=a,i.fillStyle="#f00",i.fillRect(0,0,s,a),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,o);var h=i.getImageData(0,0,s,a).data,u=h.length,l=4*s,c=0,d=0,p=!1;for(c=0;c<o;++c){for(var f=0;f<l;f+=4)if(255!==h[d+f]){p=!0;break}if(p)break;d+=l}for(e.ascent=o-c,d=u-l,p=!1,c=a;c>o;--c){for(var m=0;m<l;m+=4)if(255!==h[d+m]){p=!0;break}if(p)break;d-=l}return e.descent=c-o,e.fontSize=e.ascent+e.descent,pC._fonts[t]=e,e},pC.clearMetrics=function(t){void 0===t&&(t=""),t?delete pC._fonts[t]:pC._fonts={}};var fC=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();fC.width=fC.height=10,pC._canvas=fC,pC._context=fC.getContext("2d"),pC._fonts={},pC.METRICS_STRING="|q",pC.BASELINE_SYMBOL="M",pC.BASELINE_MULTIPLIER=1.4,pC._newlines=[10,13],pC._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var mC={texture:!0,children:!1,baseTexture:!0},gC=function(t){function e(e,r,i){var n=!1;i||(i=document.createElement("canvas"),n=!0),i.width=3,i.height=3;var s=JS.from(i);s.orig=new xS,s.trim=new xS,t.call(this,s),this._ownCanvas=n,this.canvas=i,this.context=this.canvas.getContext("2d"),this._resolution=Fw.RESOLUTION,this._autoResolution=!0,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0},style:{configurable:!0},text:{configurable:!0},resolution:{configurable:!0}};return e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var r,i,n=this.context,s=pC.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,h=s.lines,u=s.lineHeight,l=s.lineWidths,c=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil((Math.max(1,o)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;for(var p,f=e.dropShadow?2:1,m=0;m<f;++m){var g=e.dropShadow&&0===m,y=g?2*a:0,v=y*this.resolution;if(g){n.fillStyle="black",n.strokeStyle="black";var _=e.dropShadowColor,b=Uw("number"==typeof _?_:("string"==typeof(p=_)&&"#"===p[0]&&(p=p.substr(1)),parseInt(p,16)));n.shadowColor="rgba("+255*b[0]+","+255*b[1]+","+255*b[2]+","+e.dropShadowAlpha+")",n.shadowBlur=e.dropShadowBlur,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+v}else n.fillStyle=this._generateFillStyle(e,h,s),n.strokeStyle=e.stroke,n.shadowColor=0,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var x=0;x<h.length;x++)r=e.strokeThickness/2,i=e.strokeThickness/2+x*u+d.ascent,"right"===e.align?r+=c-l[x]:"center"===e.align&&(r+=(c-l[x])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[x],r+e.padding,i+e.padding-y,!0),e.fill&&this.drawLetterSpacing(h[x],r+e.padding,i+e.padding-y)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,r,i){void 0===i&&(i=!1);var n=this._style.letterSpacing;if(0!==n)for(var s=e,o=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,h=0,u=0;u<o.length;++u){var l=o[u];i?this.context.strokeText(l,s,r):this.context.fillText(l,s,r),s+=a-(h=this.context.measureText(t.substring(u+1)).width)+n,a=h}else i?this.context.strokeText(t,e,r):this.context.fillText(t,e,r)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=function(t){var e,r,i,n=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,n,s).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(r=e/4%n,i=~~(e/4/n),null===u.top&&(u.top=i),null===u.left?u.left=r:r<u.left&&(u.left=r),null===u.right?u.right=r+1:u.right<r&&(u.right=r+1),null===u.bottom?u.bottom=i:u.bottom<i&&(u.bottom=i));return null!==u.top&&(n=u.right-u.left,s=u.bottom-u.top+1,l=o.getImageData(u.left,u.top,n,s)),{height:s,width:n,data:l}}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var r=this._texture,i=this._style,n=i.trim?0:i.padding,s=r.baseTexture;r.trim.width=r._frame.width=Math.ceil(t.width/this._resolution),r.trim.height=r._frame.height=Math.ceil(t.height/this._resolution),r.trim.x=-n,r.trim.y=-n,r.orig.width=r._frame.width-2*n,r.orig.height=r._frame.height-2*n,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e,r){if(!Array.isArray(t.fill))return t.fill;if(1===t.fill.length)return t.fill[0];var i,n=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,o=Math.ceil(this.canvas.width/this._resolution)-n-2*s,a=Math.ceil(this.canvas.height/this._resolution)-n-2*s,h=t.fill.slice(),u=t.fillGradientStops.slice();if(!u.length)for(var l=h.length+1,c=1;c<l;++c)u.push(c/l);if(h.unshift(t.fill[0]),u.unshift(0),h.push(t.fill[t.fill.length-1]),u.push(1),t.fillGradientType===sC){i=this.context.createLinearGradient(o/2,s,o/2,a+s);for(var d=0,p=(r.fontProperties.fontSize+t.strokeThickness)/a,f=0;f<e.length;f++)for(var m=r.lineHeight*f,g=0;g<h.length;g++){var y=m/a+("number"==typeof u[g]?u[g]:g/h.length)*p,v=Math.max(d,y);v=Math.min(v,1),i.addColorStop(v,h[g]),d=v}}else{i=this.context.createLinearGradient(s,a/2,o+s,a/2);for(var _=h.length+1,b=1,x=0;x<h.length;x++){var T=void 0;T="number"==typeof u[x]?u[x]:b/_,i.addColorStop(T,h[x]),b++}}return i},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},mC,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},r.width.get=function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},r.width.set=function(t){this.updateText(!0);var e=$w(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},r.height.get=function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},r.height.set=function(t){this.updateText(!0);var e=$w(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},r.style.get=function(){return this._style},r.style.set=function(t){t=t||{},this._style=t instanceof hC?t:new hC(t),this.localStyleID=-1,this.dirty=!0},r.text.get=function(){return this._text},r.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},r.resolution.get=function(){return this._resolution},r.resolution.set=function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},Object.defineProperties(e.prototype,r),e}(nC);
/*!
 * @pixi/prepare - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Fw.UPLOADS_PER_FRAME=4;var yC=function(t){this.maxItemsPerFrame=t,this.itemsLeft=0};yC.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},yC.prototype.allowedToUpload=function(){return this.itemsLeft-- >0};var vC=function(t){var e=this;this.limiter=new yC(Fw.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(wC),this.registerFindHook(SC),this.registerFindHook(_C),this.registerFindHook(bC),this.registerFindHook(xC),this.registerUploadHook(TC),this.registerUploadHook(EC)};function _C(t,e){var r=!1;if(t&&t._textures&&t._textures.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof JS){var n=t._textures[i].baseTexture;-1===e.indexOf(n)&&(e.push(n),r=!0)}return r}function bC(t,e){if(t.baseTexture instanceof US){var r=t.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function xC(t,e){if(t._texture&&t._texture instanceof JS){var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function TC(t,e){return e instanceof gC&&(e.updateText(!0),!0)}function EC(t,e){if(e instanceof hC){var r=e.toFontString();return pC.measureFont(r),!0}return!1}function wC(t,e){if(t instanceof gC){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function SC(t,e){return t instanceof hC&&(-1===e.indexOf(t)&&e.push(t),!0)}vC.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,sS.system.addOnce(this.tick,this,eS.UTILITY))):e&&e()},vC.prototype.tick=function(){setTimeout(this.delayedTick,0)},vC.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)sS.system.addOnce(this.tick,this,eS.UTILITY);else{this.ticking=!1;var n=this.completes.slice(0);this.completes.length=0;for(var s=0,o=n.length;s<o;s++)n[s]()}},vC.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},vC.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},vC.prototype.add=function(t){for(var e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof OS)for(var i=t.children.length-1;i>=0;i--)this.add(t.children[i]);return this},vC.prototype.destroy=function(){this.ticking&&sS.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null};var IC=function(t){this.maxMilliseconds=t,this.frameStart=0};IC.prototype.beginFrame=function(){this.frameStart=Date.now()},IC.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds};
/*!
 * @pixi/canvas-prepare - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/canvas-prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var AC=function(t){function e(e){t.call(this,e),this.uploadHookHelper=this,this.canvas=document.createElement("canvas"),this.canvas.width=16,this.canvas.height=16,this.ctx=this.canvas.getContext("2d"),this.registerUploadHook(CC)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.destroy=function(){t.prototype.destroy.call(this),this.ctx=null,this.canvas=null},e}(vC);function CC(t,e){if(e instanceof US){var r=e.source,i=0===r.width?t.canvas.width:Math.min(t.canvas.width,r.width),n=0===r.height?t.canvas.height:Math.min(t.canvas.height,r.height);return t.ctx.drawImage(r,0,0,i,n,0,0,t.canvas.width,t.canvas.height),!0}return!1}
/*!
 * @pixi/runner - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var OC=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(OC.prototype,{dispatch:{value:OC.prototype.emit},run:{value:OC.prototype.emit}});var RC=/iPhone/i,NC=/iPod/i,PC=/iPad/i,MC=/\biOS-universal(?:.+)Mac\b/i,DC=/\bAndroid(?:.+)Mobile\b/i,FC=/Android/i,LC=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,kC=/Silk/i,UC=/Windows Phone/i,BC=/\bWindows(?:.+)ARM\b/i,jC=/BlackBerry/i,XC=/BB10/i,GC=/Opera Mini/i,zC=/\b(CriOS|Chrome)(?:.+)Mobile/i,VC=/Mobile(?:.+)Firefox\b/i,HC=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var $C=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(RC)&&!n(UC),ipod:n(NC),tablet:!n(RC)&&(n(PC)||HC(e))&&!n(UC),universal:n(MC),device:(n(RC)||n(NC)||n(PC)||n(MC)||HC(e))&&!n(UC)},amazon:{phone:n(LC),tablet:!n(LC)&&n(kC),device:n(LC)||n(kC)},android:{phone:!n(UC)&&n(LC)||!n(UC)&&n(DC),tablet:!n(UC)&&!n(LC)&&!n(DC)&&(n(kC)||n(FC)),device:!n(UC)&&(n(LC)||n(kC)||n(DC)||n(FC))||n(/\bokhttp\b/i)},windows:{phone:n(UC),tablet:n(BC),device:n(UC)||n(BC)},other:{blackberry:n(jC),blackberry10:n(XC),opera:n(GC),firefox:n(VC),chrome:n(zC),device:n(jC)||n(XC)||n(GC)||n(VC)||n(zC)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var WC,YC,qC,KC,ZC,JC,QC,tO,eO,rO,iO,nO,sO,oO,aO={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if($C.tablet||$C.phone){if(e=!1,$C.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if($C.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:$C.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!$C.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};
/*!
 * @pixi/constants - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(WC||(WC={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(YC||(YC={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(qC||(qC={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(KC||(KC={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(ZC||(ZC={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(JC||(JC={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(QC||(QC={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(tO||(tO={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(eO||(eO={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(rO||(rO={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(iO||(iO={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(nO||(nO={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(sO||(sO={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(oO||(oO={})),
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
aO.RETINA_PREFIX=/@([0-9\.]+)x/,aO.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var hO,uO=!1;var lO=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[qC.NORMAL_NPM]=qC.NORMAL,t[qC.ADD_NPM]=qC.ADD,t[qC.SCREEN_NPM]=qC.SCREEN,e[qC.NORMAL]=qC.NORMAL_NPM,e[qC.ADD]=qC.ADD_NPM,e[qC.SCREEN]=qC.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();Float32Array,Uint32Array,Int32Array,Uint8Array;function cO(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function dO(t){return!(t&t-1||!t)}function pO(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function fO(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}function mO(t){return 0===t?0:t<0?-1:1}var gO=0;function yO(){return++gO}var vO={};var _O={},bO=Object.create(null),xO=Object.create(null);var TO=function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||aO.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0}),t}();var EO,wO;function SO(t,e){var r=aO.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */aO.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(wO||(wO={}));var IO,AO=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),CO=function(){function t(){var t=this;this._head=new AO(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/aO.TARGET_FPMS,this.elapsedMS=1/aO.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=wO.NORMAL),this._addListener(new AO(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=wO.NORMAL),this._addListener(new AO(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*aO.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,aO.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),OO=(function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,wO.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?CO.shared:new CO,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}(),function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}()),RO=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),NO=2*Math.PI,PO=180/Math.PI,MO=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(IO||(IO={}));var DO=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new OO;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new OO;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(NO-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),FO=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],LO=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],kO=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],UO=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],BO=[],jO=[],XO=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];BO.push(e);for(var r=0;r<16;r++)for(var i=XO(FO[t]*FO[r]+kO[t]*LO[r]),n=XO(LO[t]*FO[r]+UO[t]*LO[r]),s=XO(FO[t]*kO[r]+kO[t]*UO[r]),o=XO(LO[t]*kO[r]+UO[t]*UO[r]),a=0;a<16;a++)if(FO[a]===i&&LO[a]===n&&kO[a]===s&&UO[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new DO;h.set(FO[t],LO[t],kO[t],UO[t],0,0),jO.push(h)}}();var GO={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return FO[t]},uY:function(t){return LO[t]},vX:function(t){return kO[t]},vY:function(t){return UO[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return BO[t][e]},sub:function(t,e){return BO[t][GO.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?GO.S:GO.N:2*Math.abs(e)<=Math.abs(t)?t>0?GO.E:GO.W:e>0?t>0?GO.SE:GO.SW:t>0?GO.NE:GO.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=jO[GO.inv(e)];n.tx=r,n.ty=i,t.append(n)}},zO=function(){function t(){this.worldTransform=new DO,this.localTransform=new DO,this.position=new RO(this.onChange,this,0,0),this.scale=new RO(this.onChange,this,1,1),this.pivot=new RO(this.onChange,this,0,0),this.skew=new RO(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),VO=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=IO.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}();(function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=IO.CIRC}t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new VO(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}})(),function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=IO.ELIP}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new VO(this.x-this.width,this.y-this.height,this.width,this.height)}}(),function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof OO){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=IO.POLY,this.closeStroke=!0}t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r}}(),function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=IO.RREC}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1}}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
aO.SORTABLE_CHILDREN=!1;var HO=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};HO.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},HO.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},HO.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?VO.EMPTY:((t=t||new VO(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},HO.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},HO.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},HO.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},HO.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},HO.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},HO.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},HO.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},HO.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},HO.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},HO.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},HO.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},HO.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},HO.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var $O=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new zO,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new HO,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new VO),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new VO),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*PO},r.angle.set=function(t){this.transform.rotation=t*MO},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function WO(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}$O.prototype.displayObjectUpdateTransform=$O.prototype.updateTransform;var YO=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=aO.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);fO(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,fO(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,fO(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(WO),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}($O);YO.prototype.containerUpdateTransform=YO.prototype.updateTransform;
/*!
 * @pixi/core - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var qO=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new OC("setRealSize",2),this.onUpdate=new OC("update"),this.onError=new OC("onError",1)},KO={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};qO.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},qO.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},qO.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},KO.valid.get=function(){return!!this._width&&!!this._height},qO.prototype.update=function(){this.destroyed||this.onUpdate.run()},qO.prototype.load=function(){return Promise.resolve()},KO.width.get=function(){return this._width},KO.height.get=function(){return this._height},qO.prototype.upload=function(t,e,r){return!1},qO.prototype.style=function(t,e,r){return!1},qO.prototype.dispose=function(){},qO.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(qO.prototype,KO);var ZO=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,EO||(EO=document.createElement("a")),EO.href=t;var r=Object(W.parse)(EO.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===iO.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(qO),JO=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:aO.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===iO.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(ZO),QO=[];function tR(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=QO.length-1;n>=0;--n){var s=QO[n];if(s.test&&s.test(t,r))return new s(t,e)}return new JO(t,e)}var eR=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===iO.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(qO),rR={scaleMode:tO.NEAREST,format:ZC.RGBA,alphaMode:iO.NPM},iR=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof qO||((e=tR(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||aO.RESOLUTION,this.mipmap=void 0!==n?n:aO.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:aO.ANISOTROPIC_LEVEL,this.wrapMode=u||aO.WRAP_MODE,this.scaleMode=void 0!==o?o:aO.SCALE_MODE,this.format=l||ZC.RGBA,this.type=c||QC.UNSIGNED_BYTE,this.target=d||JC.TEXTURE_2D,this.alphaMode=void 0!==i?i:iO.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=yO(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=dO(this.realWidth)&&dO(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete xO[this.cacheId],delete bO[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=aO.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+yO()),s=t._pixiId);var o=xO[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new eR(t,{width:r,height:i}),o=t instanceof Float32Array?QC.FLOAT:QC.UNSIGNED_BYTE;return new e(s,Object.assign(rR,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),xO[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),xO[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=xO[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete xO[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete xO[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);iR._globalBatch=0;var nR=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new iR;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(tR(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=JC.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(qO),sR=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(ZO),oR=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=JC.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=JC.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(nR);oR.SIDES=6;var aR=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+yO(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(ZO);aR.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var hR=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=CO.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(CO.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(CO.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&CO.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(CO.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(CO.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(ZO);hR.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var uR=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(ZO);QO.push(JO,uR,sR,hR,aR,eR,oR,nR);var lR=function(t){this.renderer=t};lR.prototype.destroy=function(){this.renderer=null};var cR=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===iO.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(eR),dR=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new OC("disposeFramebuffer",2)},pR={colorTexture:{configurable:!0}};pR.colorTexture.get=function(){return this.colorTextures[0]},dR.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new iR(null,{scaleMode:tO.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},dR.prototype.addDepthTexture=function(t){return this.depthTexture=t||new iR(new cR(null,{width:this.width,height:this.height}),{scaleMode:tO.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:ZC.DEPTH_COMPONENT,type:QC.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},dR.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},dR.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},dR.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},dR.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(dR.prototype,pR);var fR=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new dR(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(iR),mR=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};mR.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=GO.add(r,GO.NW),this.x0=a+s*GO.uX(r),this.y0=h+o*GO.uY(r),r=GO.add(r,2),this.x1=a+s*GO.uX(r),this.y1=h+o*GO.uY(r),r=GO.add(r,2),this.x2=a+s*GO.uX(r),this.y2=h+o*GO.uY(r),r=GO.add(r,2),this.x3=a+s*GO.uX(r),this.y3=h+o*GO.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var gR=new mR,yR=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new VO(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=gR,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new OO(a.x,a.y):new OO(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&bO[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===gR&&(this._uvs=new mR),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=aO.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+yO()),s=t._pixiId);var o=bO[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=SO(t)),(o=new e(new iR(t,r))).baseTexture.cacheId=s,iR.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(iR.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new JO(t);n.url=r;var s=new e(new iR(n,{scaleMode:aO.SCALE_MODE,resolution:SO(r)}));return i||(i=r),iR.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(iR.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),bO[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),bO[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=bO[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete bO[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)bO[t.textureCacheIds[i]]===t&&delete bO[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function vR(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}yR.EMPTY=new yR(new iR),vR(yR.EMPTY),vR(yR.EMPTY.baseTexture),yR.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new yR(new iR(new sR(t)))}(),vR(yR.WHITE),vR(yR.WHITE.baseTexture);var _R=function(t){function e(e,r){var i=null;if(!(e instanceof fR)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new fR({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new fR(t))},e}(yR),bR=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};bR.prototype.createTexture=function(t,e){var r=new fR(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new _R(r)},bR.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=bR.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=cO(t)))<<16|65535&(e=cO(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},bR.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},bR.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},bR.prototype.returnFilterTexture=function(t){this.returnTexture(t)},bR.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},bR.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=bR.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},bR.SCREEN_KEY="screen";var xR=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};xR.prototype.destroy=function(){this.buffer=null},xR.from=function(t,e,r,i,n){return new xR(t,e,r,i,n)};var TR=0,ER=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=TR++,this.disposeRunner=new OC("disposeBuffer",2)};function wR(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}ER.prototype.update=function(t){this.data=t||this.data,this._updateID++},ER.prototype.dispose=function(){this.disposeRunner.run(this,!1)},ER.prototype.destroy=function(){this.dispose(),this.data=null},ER.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new ER(t)};var SR={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var IR={5126:4,5123:2,5121:1},AR=0,CR={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},OR=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=AR++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new OC("disposeGeometry",2),this.refCount=0};OR.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new ER(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new xR(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},OR.prototype.getAttribute=function(t){return this.attributes[t]},OR.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},OR.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new ER(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},OR.prototype.getIndex=function(){return this.indexBuffer},OR.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new ER;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*IR[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=wR(c);n[d]||(n[d]=new SR[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},OR.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},OR.prototype.dispose=function(){this.disposeRunner.run(this,!1)},OR.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},OR.prototype.clone=function(){for(var t=new OR,e=0;e<this.buffers.length;e++)t.buffers[e]=new ER(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new xR(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},OR.merge=function(t){for(var e,r=new OR,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(CR[wR(e.buffers[h].data)])(n[h]),r.buffers[h]=new ER(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*IR[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var RR=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(OR),NR=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ER(this.vertices),this.uvBuffer=new ER(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(OR),PR=0,MR=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=PR++,this.static=!!e};MR.prototype.update=function(){this.dirtyId++},MR.prototype.add=function(t,e,r){this.uniforms[t]=new MR(e,r)},MR.from=function(t,e){return new MR(t,e)};var DR=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new VO,this.destinationFrame=new VO,this.filters=[]};DR.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var FR=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new bR,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new RR,this.quadUv=new NR,this.tempRect=new VO,this.activeState={},this.globalUniforms=new MR({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new DR,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(KC.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(KC.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(DO.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(lR),LR=function(t){this.renderer=t};LR.prototype.flush=function(){},LR.prototype.destroy=function(){this.renderer=null},LR.prototype.start=function(){},LR.prototype.stop=function(){this.flush()},LR.prototype.render=function(t){};var kR=function(t){function e(e){t.call(this,e),this.emptyRenderer=new LR(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(lR);aO.PREFER_ENV=$C.any?WC.WEBGL:WC.WEBGL2,aO.STRICT_TEXTURE_CACHE=!1;var UR=0,BR=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=UR++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=UR++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(aO.PREFER_ENV>=WC.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(lR),jR=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new dR(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new VO,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;aO.PREFER_ENV===WC.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new VO},Object.defineProperties(e.prototype,r),e}(lR),XR=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},GR={5126:4,5123:2,5121:1},zR=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;aO.PREFER_ENV===WC.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*GR[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*GR[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*GR[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new XR(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(lR),VR=function(t){this.type=oO.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function HR(t,e,r,i){var n=$R(t,t.VERTEX_SHADER,e),s=$R(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function $R(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function WR(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return YR(2*e);case"bvec3":return YR(3*e);case"bvec4":return YR(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function YR(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}VR.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=oO.NONE,this.autoDetect=!0),this._target=null},VR.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var qR,KR={},ZR=KR;function JR(){if(ZR===KR||ZR&&ZR.isContextLost()){var t,e=document.createElement("canvas");aO.PREFER_ENV>=WC.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),ZR=t}return ZR}function QR(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===sO.HIGH&&r!==sO.HIGH&&(i=sO.MEDIUM),"precision "+i+" float;\n"+t}return r!==sO.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var tN={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function eN(t){return tN[t]}var rN=null,iN={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function nN(t,e){if(!rN){var r=Object.keys(iN);rN={};for(var i=0;i<r.length;++i){var n=r[i];rN[t[n]]=iN[n]}}return rN[e]}var sN={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},oN={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var aN,hN=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function uN(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var lN=0,cN={},dN=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=lN++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),cN[i]?(cN[i]++,i+="-"+cN[i]):cN[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=QR(this.vertexSrc,aO.PRECISION_VERTEX,sO.HIGH),this.fragmentSrc=QR(this.fragmentSrc,aO.PRECISION_FRAGMENT,function(){if(!qR){qR=sO.MEDIUM;var t=JR();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);qR=e.precision?sO.HIGH:sO.MEDIUM}}return qR}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},pN={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};dN.prototype.extractData=function(t,e){var r=JR();if(r){var i=HR(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},dN.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=nN(e,o.type),h={type:a,name:o.name,size:eN(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},dN.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=nN(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:WR(h,s.size)}}return r},pN.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},pN.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},dN.from=function(t,e,r){var i=t+e,n=_O[i];return n||(_O[i]=n=new dN(t,e,r)),n},Object.defineProperties(dN,pN);var fN=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof MR?e:new MR(e):new MR({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},mN={uniforms:{configurable:!0}};fN.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},fN.prototype.destroy=function(){this.uniformGroup=null},mN.uniforms.get=function(){return this.uniformGroup.uniforms},fN.from=function(t,e,r){var i=dN.from(t,e);return new fN(i,r)},Object.defineProperties(fN.prototype,mN);var gN=function(){this.data=0,this.blendMode=qC.NORMAL,this.polygonOffset=0,this.blend=!0},yN={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};yN.blend.get=function(){return!!(1&this.data)},yN.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},yN.offsets.get=function(){return!!(2&this.data)},yN.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},yN.culling.get=function(){return!!(4&this.data)},yN.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},yN.depthTest.get=function(){return!!(8&this.data)},yN.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},yN.clockwiseFrontFace.get=function(){return!!(16&this.data)},yN.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},yN.blendMode.get=function(){return this._blendMode},yN.blendMode.set=function(t){this.blend=t!==qC.NONE,this._blendMode=t},yN.polygonOffset.get=function(){return this._polygonOffset},yN.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},gN.for2d=function(){var t=new gN;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(gN.prototype,yN);var vN=function(t){function e(r,i,n){var s=dN.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=aO.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new gN}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(fN);vN.SOURCE_KEY_MAP={};var _N=new DO,bN=function(t,e){this._texture=t,this.mapCoord=new DO,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},xN={texture:{configurable:!0}};xN.texture.get=function(){return this._texture},xN.texture.set=function(t){this._texture=t,this._updateID=-1},bN.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},bN.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(_N.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(_N));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(bN.prototype,xN);var TN=function(t){function e(e){var r=new DO;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new bN(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(vN),EN=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new VR;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case oO.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case oO.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case oO.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case oO.SCISSOR:this.renderer.scissor.pop();break;case oO.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case oO.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=oO.SPRITE;else if(t.type=oO.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=oO.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new TN(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(lR),wN=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(lR),SN=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(wN),IN=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(wN),AN=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new DO,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(lR),CN=new VO,ON=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new VO,this.destinationFrame=new VO}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(CN.width=s.realWidth,CN.height=s.realHeight,r=CN),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(CN.width=n.width,CN.height=n.height,r=CN),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(lR),RN=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};RN.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var NN=0,PN={textureCount:0},MN=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=NN++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof aN)return aN;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");aN=!0===t({a:"b"},"a","b")}catch(t){aN=!1}return aN}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(PN.textureCount=0,this.syncUniformGroup(t.uniformGroup,PN)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?sN:oN)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=HR(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:WR(h.type,h.size)}}var u=new RN(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(lR);var DN=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=qC.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new gN,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[qC.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.ADD]=[t.ONE,t.ONE],e[qC.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.NONE]=[0,0],e[qC.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[qC.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[qC.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[qC.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[qC.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[qC.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[qC.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[qC.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[qC.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[qC.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[qC.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(lR),FN=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=aO.GC_MAX_IDLE,this.checkCountMax=aO.GC_MAX_CHECK_COUNT,this.mode=aO.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==nO.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(lR),LN=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},kN=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new iR}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new LN(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new LN(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new LN(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===QC.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&fO(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==rO.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=eO.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===tO.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===tO.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===tO.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===tO.LINEAR?r.LINEAR:r.NEAREST)},e}(lR),UN=new DO;V.a;var BN=function(){this.texArray=null,this.blend=0,this.type=KC.TRIANGLES,this.start=0,this.size=0,this.data=null},jN=function(){this.elements=[],this.ids=[],this.count=0};jN.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var XN=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},GN={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};GN.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},GN.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},GN.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},GN.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},GN.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},XN.prototype.view=function(t){return this[t+"View"]},XN.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},XN.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(XN.prototype,GN);var zN=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=gN.for2d(),this.size=4*aO.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;aO.PREFER_ENV===WC.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),aO.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=hN.replace(/%forloop%/gi,uN(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new BN);for(;r.length<n;)r.push(new jN);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++iR._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;iR._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=lO[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;aO.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),aO.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=cO(Math.ceil(t/8)),r=pO(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new XN(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=cO(Math.ceil(t/12)),r=pO(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(LR);zN._drawCallPool=[],zN._textureArrayPool=[];var VN=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};VN.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=MR.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new dN(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new DO,default:this.defaultGroupCache[t]};return new fN(this.programCache[t],n)},VN.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var HN=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new ER(null,e,!1),this._indexBuffer=new ER(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,QC.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,QC.FLOAT).addAttribute("aColor",this._buffer,4,!0,QC.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,QC.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(OR),$N="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",WN=function(){},YN={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};WN.create=function(t){var e=Object.assign({vertex:$N,fragment:"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",geometryClass:HN,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new VN(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(zN)},YN.defaultVertexSrc.get=function(){return $N},YN.defaultFragmentTemplate.get=function(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"},Object.defineProperties(WN,YN);WN.create();
/*!
 * @pixi/sprite - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var qN,KN,ZN,JN,QN,tP,eP,rP,iP,nP,sP,oP,aP,hP,uP=new OO,lP=new Uint16Array([0,1,2,0,2,3]),cP=function(t){function e(e){t.call(this),this._anchor=new RO(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=qC.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=e||yR.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=lP,this.pluginName="batch",this.isSprite=!0,this._roundPixels=aO.ROUND_PIXELS}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=mO(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=mO(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,d=0,p=0,f=0,m=0;if(u?(d=(p=u.x-c._x*l.width)+u.width,f=(m=u.y-c._y*l.height)+u.height):(d=(p=-c._x*l.width)+l.width,f=(m=-c._y*l.height)+l.height),h[0]=r*p+n*m+o,h[1]=s*m+i*p+a,h[2]=r*d+n*m+o,h[3]=s*m+i*d+a,h[4]=r*d+n*f+o,h[5]=s*f+i*d+a,h[6]=r*p+n*f+o,h[7]=s*f+i*p+a,this._roundPixels)for(var g=aO.RESOLUTION,y=0;y<h.length;++y)h[y]=Math.round((h[y]*g|0)/g)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,i=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=-i._x*r.width,d=c+r.width,p=-i._y*r.height,f=p+r.height;e[0]=s*c+a*p+u,e[1]=h*p+o*c+l,e[2]=s*d+a*p+u,e[3]=h*p+o*d+l,e[4]=s*d+a*f+u,e[5]=h*f+o*d+l,e[6]=s*c+a*f+u,e[7]=h*f+o*c+l},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new VO),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,uP);var e=this._texture.orig.width,r=this._texture.orig.height,i=-e*this.anchor.x,n=0;return uP.x>=i&&uP.x<i+e&&(n=-r*this.anchor.y,uP.y>=n&&uP.y<n+r)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var r="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null,this.shader=null},e.from=function(t,r){return new e(t instanceof yR?t:yR.from(t,r))},r.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},r.roundPixels.get=function(){return this._roundPixels},r.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},r.width.set=function(t){var e=mO(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},r.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},r.height.set=function(t){var e=mO(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},r.anchor.get=function(){return this._anchor},r.anchor.set=function(t){this._anchor.copyFrom(t)},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},r.texture.get=function(){return this._texture},r.texture.set=function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||yR.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},Object.defineProperties(e.prototype,r),e}(YO),dP=new OO,pP=function(t){function e(e,r,i){void 0===r&&(r=100),void 0===i&&(i=100),t.call(this,e),this.tileTransform=new zO,this._width=r,this._height=i,this._canvasPattern=null,this.uvMatrix=e.uvMatrix||new bN(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={clampMargin:{configurable:!0},tileScale:{configurable:!0},tilePosition:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return r.clampMargin.get=function(){return this.uvMatrix.clampMargin},r.clampMargin.set=function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},r.tileScale.get=function(){return this.tileTransform.scale},r.tileScale.set=function(t){this.tileTransform.scale.copyFrom(t)},r.tilePosition.get=function(){return this.tileTransform.position},r.tilePosition.set=function(t){this.tileTransform.position.copyFrom(t)},e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,r,i)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new VO),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,dP);var e=this._width,r=this._height,i=-e*this.anchor._x;if(dP.x>=i&&dP.x<i+e){var n=-r*this.anchor._y;if(dP.y>=n&&dP.y<n+r)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,r,i){return new e(yR.from(t),r,i)},e.fromFrame=function(t,r,i){var n=bO[t];if(!n)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(n,r,i)},e.fromImage=function(t,r,i,n){return n&&"object"!=typeof n&&(n={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}),new e(yR.from(t,n),r,i)},r.width.get=function(){return this._width},r.width.set=function(t){this._width=t},r.height.get=function(){return this._height},r.height.set=function(t){this._height=t},Object.defineProperties(e.prototype,r),e}(cP);new DO;
/*!
 * @pixi/canvas-sprite-tiling - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/canvas-sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
pP.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.valid){var r=t.context,i=this.worldTransform,n=e.baseTexture,s=n.getDrawableSource(),o=n.resolution,a=this.tilePosition.x/this.tileScale.x%e._frame.width*o,h=this.tilePosition.y/this.tileScale.y%e._frame.height*o;if(this._textureID!==this._texture._updateID||this._cachedTint!==this.tint){this._textureID=this._texture._updateID;var u=new TO(e._frame.width,e._frame.height,o);16777215!==this.tint?(this._tintedCanvas=Cu.getTintedCanvas(this,this.tint),u.context.drawImage(this._tintedCanvas,0,0)):u.context.drawImage(s,-e._frame.x*o,-e._frame.y*o),this._cachedTint=this.tint,this._canvasPattern=u.context.createPattern(u.canvas,"repeat")}r.globalAlpha=this.worldAlpha,t.setBlendMode(this.blendMode),t.setContextTransform(i),r.fillStyle=this._canvasPattern,r.scale(this.tileScale.x/o,this.tileScale.y/o);var l=this.anchor.x*-this._width,c=this.anchor.y*-this._height;this.uvRespectAnchor?(r.translate(a,h),r.fillRect(-a+l,-h+c,this._width/this.tileScale.x*o,this._height/this.tileScale.y*o)):(r.translate(a+l,h+c),r.fillRect(-a,-h,this._width/this.tileScale.x*o,this._height/this.tileScale.y*o))}},function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(qN||(qN={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(KN||(KN={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(ZN||(ZN={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(JN||(JN={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(QN||(QN={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(tP||(tP={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(eP||(eP={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(rP||(rP={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(iP||(iP={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(nP||(nP={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(sP||(sP={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(oP||(oP={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(aP||(aP={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(hP||(hP={}));var fP=/iPhone/i,mP=/iPod/i,gP=/iPad/i,yP=/\biOS-universal(?:.+)Mac\b/i,vP=/\bAndroid(?:.+)Mobile\b/i,_P=/Android/i,bP=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,xP=/Silk/i,TP=/Windows Phone/i,EP=/\bWindows(?:.+)ARM\b/i,wP=/BlackBerry/i,SP=/BB10/i,IP=/Opera Mini/i,AP=/\b(CriOS|Chrome)(?:.+)Mobile/i,CP=/Mobile(?:.+)Firefox\b/i,OP=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var RP=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(fP)&&!n(TP),ipod:n(mP),tablet:!n(fP)&&(n(gP)||OP(e))&&!n(TP),universal:n(yP),device:(n(fP)||n(mP)||n(gP)||n(yP)||OP(e))&&!n(TP)},amazon:{phone:n(bP),tablet:!n(bP)&&n(xP),device:n(bP)||n(xP)},android:{phone:!n(TP)&&n(bP)||!n(TP)&&n(vP),tablet:!n(TP)&&!n(bP)&&!n(vP)&&(n(xP)||n(_P)),device:!n(TP)&&(n(bP)||n(xP)||n(vP)||n(_P))||n(/\bokhttp\b/i)},windows:{phone:n(TP),tablet:n(EP),device:n(TP)||n(EP)},other:{blackberry:n(wP),blackberry10:n(SP),opera:n(IP),firefox:n(CP),chrome:n(AP),device:n(wP)||n(SP)||n(IP)||n(CP)||n(AP)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var NP,PP={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(RP.tablet||RP.phone){if(e=!1,RP.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(RP.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:RP.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!RP.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1,
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
RETINA_PREFIX:/@([0-9\.]+)x/,FAIL_IF_MAJOR_PERFORMANCE_CAVEAT:!0},MP=!1;function DP(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}var FP=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[ZN.NORMAL_NPM]=ZN.NORMAL,t[ZN.ADD_NPM]=ZN.ADD,t[ZN.SCREEN_NPM]=ZN.SCREEN,e[ZN.NORMAL]=ZN.NORMAL_NPM,e[ZN.ADD]=ZN.ADD_NPM,e[ZN.SCREEN]=ZN.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();function LP(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}Float32Array,Uint32Array,Int32Array,Uint8Array;function kP(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function UP(t){return!(t&t-1||!t)}function BP(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function jP(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}var XP=0;function GP(){return++XP}var zP={};var VP={},HP=Object.create(null),$P=Object.create(null);!function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||PP.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0})}();var WP;function YP(t,e){var r=PP.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/math - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var qP,KP=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),ZP=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),JP=2*Math.PI,QP=180/Math.PI,tM=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(qP||(qP={}));var eM=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new KP;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new KP;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(JP-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),rM=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],iM=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],nM=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],sM=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],oM=[],aM=[],hM=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];oM.push(e);for(var r=0;r<16;r++)for(var i=hM(rM[t]*rM[r]+nM[t]*iM[r]),n=hM(iM[t]*rM[r]+sM[t]*iM[r]),s=hM(rM[t]*nM[r]+nM[t]*sM[r]),o=hM(iM[t]*nM[r]+sM[t]*sM[r]),a=0;a<16;a++)if(rM[a]===i&&iM[a]===n&&nM[a]===s&&sM[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new eM;h.set(rM[t],iM[t],nM[t],sM[t],0,0),aM.push(h)}}();var uM={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return rM[t]},uY:function(t){return iM[t]},vX:function(t){return nM[t]},vY:function(t){return sM[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return oM[t][e]},sub:function(t,e){return oM[t][uM.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?uM.S:uM.N:2*Math.abs(e)<=Math.abs(t)?t>0?uM.E:uM.W:e>0?t>0?uM.SE:uM.SW:t>0?uM.NE:uM.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=aM[uM.inv(e)];n.tx=r,n.ty=i,t.append(n)}},lM=function(){function t(){this.worldTransform=new eM,this.localTransform=new eM,this.position=new ZP(this.onChange,this,0,0),this.scale=new ZP(this.onChange,this,1,1),this.pivot=new ZP(this.onChange,this,0,0),this.skew=new ZP(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),cM=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=qP.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}();(function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=qP.CIRC}t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new cM(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}})(),function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=qP.ELIP}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new cM(this.x-this.width,this.y-this.height,this.width,this.height)}}(),function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof KP){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=qP.POLY,this.closeStroke=!0}t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r}}(),function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=qP.RREC}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1}}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
PP.SORTABLE_CHILDREN=!1;var dM=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};dM.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},dM.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},dM.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?cM.EMPTY:((t=t||new cM(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},dM.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},dM.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},dM.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},dM.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},dM.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},dM.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},dM.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},dM.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},dM.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},dM.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},dM.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},dM.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},dM.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var pM=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new lM,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new dM,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new cM),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new cM),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*QP},r.angle.set=function(t){this.transform.rotation=t*tM},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function fM(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}pM.prototype.displayObjectUpdateTransform=pM.prototype.updateTransform;var mM=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=PP.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);jP(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,jP(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,jP(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(fM),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(pM);mM.prototype.containerUpdateTransform=mM.prototype.updateTransform;
/*!
 * @pixi/runner - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var gM,yM=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(yM.prototype,{dispatch:{value:yM.prototype.emit},run:{value:yM.prototype.emit}}),
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
PP.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(gM||(gM={}));var vM=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),_M=function(){function t(){var t=this;this._head=new vM(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/PP.TARGET_FPMS,this.elapsedMS=1/PP.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=gM.NORMAL),this._addListener(new vM(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=gM.NORMAL),this._addListener(new vM(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*PP.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,PP.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),bM=(function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,gM.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?_M.shared:new _M,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}(),function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new yM("setRealSize",2),this.onUpdate=new yM("update"),this.onError=new yM("onError",1)}),xM={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};bM.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},bM.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},bM.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},xM.valid.get=function(){return!!this._width&&!!this._height},bM.prototype.update=function(){this.destroyed||this.onUpdate.run()},bM.prototype.load=function(){return Promise.resolve()},xM.width.get=function(){return this._width},xM.height.get=function(){return this._height},bM.prototype.upload=function(t,e,r){return!1},bM.prototype.style=function(t,e,r){return!1},bM.prototype.dispose=function(){},bM.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(bM.prototype,xM);var TM=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,WP||(WP=document.createElement("a")),WP.href=t;var r=Object(W.parse)(WP.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===sP.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(bM),EM=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:PP.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===sP.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(TM),wM=[];function SM(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=wM.length-1;n>=0;--n){var s=wM[n];if(s.test&&s.test(t,r))return new s(t,e)}return new EM(t,e)}var IM=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===sP.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(bM),AM={scaleMode:rP.NEAREST,format:QN.RGBA,alphaMode:sP.NPM},CM=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof bM||((e=SM(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||PP.RESOLUTION,this.mipmap=void 0!==n?n:PP.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:PP.ANISOTROPIC_LEVEL,this.wrapMode=u||PP.WRAP_MODE,this.scaleMode=void 0!==o?o:PP.SCALE_MODE,this.format=l||QN.RGBA,this.type=c||eP.UNSIGNED_BYTE,this.target=d||tP.TEXTURE_2D,this.alphaMode=void 0!==i?i:sP.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=GP(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=UP(this.realWidth)&&UP(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete $P[this.cacheId],delete HP[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=PP.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+GP()),s=t._pixiId);var o=$P[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new IM(t,{width:r,height:i}),o=t instanceof Float32Array?eP.FLOAT:eP.UNSIGNED_BYTE;return new e(s,Object.assign(AM,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),$P[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),$P[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=$P[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete $P[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete $P[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);CM._globalBatch=0;var OM=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new CM;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(SM(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=tP.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(bM),RM=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(TM),NM=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=tP.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=tP.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(OM);NM.SIDES=6;var PM=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+GP(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(TM);PM.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var MM=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=_M.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(_M.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(_M.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&_M.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(_M.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(_M.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(TM);MM.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var DM=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(TM);wM.push(EM,DM,RM,MM,PM,IM,NM,OM);var FM=function(t){this.renderer=t};FM.prototype.destroy=function(){this.renderer=null};var LM=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===sP.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(IM),kM=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new yM("disposeFramebuffer",2)},UM={colorTexture:{configurable:!0}};UM.colorTexture.get=function(){return this.colorTextures[0]},kM.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new CM(null,{scaleMode:rP.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},kM.prototype.addDepthTexture=function(t){return this.depthTexture=t||new CM(new LM(null,{width:this.width,height:this.height}),{scaleMode:rP.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:QN.DEPTH_COMPONENT,type:eP.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},kM.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},kM.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},kM.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},kM.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(kM.prototype,UM);var BM=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new kM(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(CM),jM=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};jM.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=uM.add(r,uM.NW),this.x0=a+s*uM.uX(r),this.y0=h+o*uM.uY(r),r=uM.add(r,2),this.x1=a+s*uM.uX(r),this.y1=h+o*uM.uY(r),r=uM.add(r,2),this.x2=a+s*uM.uX(r),this.y2=h+o*uM.uY(r),r=uM.add(r,2),this.x3=a+s*uM.uX(r),this.y3=h+o*uM.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var XM=new jM,GM=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new cM(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=XM,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new KP(a.x,a.y):new KP(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&HP[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===XM&&(this._uvs=new jM),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=PP.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+GP()),s=t._pixiId);var o=HP[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=YP(t)),(o=new e(new CM(t,r))).baseTexture.cacheId=s,CM.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(CM.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new EM(t);n.url=r;var s=new e(new CM(n,{scaleMode:PP.SCALE_MODE,resolution:YP(r)}));return i||(i=r),CM.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(CM.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),HP[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),HP[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=HP[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete HP[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)HP[t.textureCacheIds[i]]===t&&delete HP[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function zM(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}GM.EMPTY=new GM(new CM),zM(GM.EMPTY),zM(GM.EMPTY.baseTexture),GM.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new GM(new CM(new RM(t)))}(),zM(GM.WHITE),zM(GM.WHITE.baseTexture);var VM=function(t){function e(e,r){var i=null;if(!(e instanceof BM)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new BM({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new BM(t))},e}(GM),HM=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};HM.prototype.createTexture=function(t,e){var r=new BM(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new VM(r)},HM.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=HM.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=kP(t)))<<16|65535&(e=kP(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},HM.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},HM.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},HM.prototype.returnFilterTexture=function(t){this.returnTexture(t)},HM.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},HM.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=HM.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},HM.SCREEN_KEY="screen";var $M=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};$M.prototype.destroy=function(){this.buffer=null},$M.from=function(t,e,r,i,n){return new $M(t,e,r,i,n)};var WM=0,YM=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=WM++,this.disposeRunner=new yM("disposeBuffer",2)};function qM(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}YM.prototype.update=function(t){this.data=t||this.data,this._updateID++},YM.prototype.dispose=function(){this.disposeRunner.run(this,!1)},YM.prototype.destroy=function(){this.dispose(),this.data=null},YM.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new YM(t)};var KM={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var ZM={5126:4,5123:2,5121:1},JM=0,QM={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},tD=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=JM++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new yM("disposeGeometry",2),this.refCount=0};tD.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new YM(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new $M(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},tD.prototype.getAttribute=function(t){return this.attributes[t]},tD.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},tD.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new YM(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},tD.prototype.getIndex=function(){return this.indexBuffer},tD.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new YM;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*ZM[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=qM(c);n[d]||(n[d]=new KM[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},tD.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},tD.prototype.dispose=function(){this.disposeRunner.run(this,!1)},tD.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},tD.prototype.clone=function(){for(var t=new tD,e=0;e<this.buffers.length;e++)t.buffers[e]=new YM(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new $M(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},tD.merge=function(t){for(var e,r=new tD,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(QM[qM(e.buffers[h].data)])(n[h]),r.buffers[h]=new YM(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*ZM[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var eD=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(tD),rD=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new YM(this.vertices),this.uvBuffer=new YM(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(tD),iD=0,nD=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=iD++,this.static=!!e};nD.prototype.update=function(){this.dirtyId++},nD.prototype.add=function(t,e,r){this.uniforms[t]=new nD(e,r)},nD.from=function(t,e){return new nD(t,e)};var sD=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new cM,this.destinationFrame=new cM,this.filters=[]};sD.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var oD=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new HM,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new eD,this.quadUv=new rD,this.tempRect=new cM,this.activeState={},this.globalUniforms=new nD({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new sD,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(JN.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(JN.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(eM.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(FM),aD=function(t){this.renderer=t};aD.prototype.flush=function(){},aD.prototype.destroy=function(){this.renderer=null},aD.prototype.start=function(){},aD.prototype.stop=function(){this.flush()},aD.prototype.render=function(t){};var hD=function(t){function e(e){t.call(this,e),this.emptyRenderer=new aD(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(FM);PP.PREFER_ENV=RP.any?qN.WEBGL:qN.WEBGL2,PP.STRICT_TEXTURE_CACHE=!1;var uD=0,lD=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=uD++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=uD++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(PP.PREFER_ENV>=qN.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(FM),cD=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new kM(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new cM,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;PP.PREFER_ENV===qN.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new cM},Object.defineProperties(e.prototype,r),e}(FM),dD=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},pD={5126:4,5123:2,5121:1},fD=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;PP.PREFER_ENV===qN.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*pD[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*pD[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*pD[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new dD(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(FM),mD=function(t){this.type=hP.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function gD(t,e,r,i){var n=yD(t,t.VERTEX_SHADER,e),s=yD(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function yD(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function vD(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return _D(2*e);case"bvec3":return _D(3*e);case"bvec4":return _D(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function _D(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}mD.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=hP.NONE,this.autoDetect=!0),this._target=null},mD.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var bD,xD={},TD=xD;function ED(){if(TD===xD||TD&&TD.isContextLost()){var t,e=document.createElement("canvas");PP.PREFER_ENV>=qN.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),TD=t}return TD}function wD(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===aP.HIGH&&r!==aP.HIGH&&(i=aP.MEDIUM),"precision "+i+" float;\n"+t}return r!==aP.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var SD={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function ID(t){return SD[t]}var AD=null,CD={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function OD(t,e){if(!AD){var r=Object.keys(CD);AD={};for(var i=0;i<r.length;++i){var n=r[i];AD[t[n]]=CD[n]}}return AD[e]}var RD={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},ND={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var PD,MD=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function DD(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var FD=0,LD={},kD=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=FD++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),LD[i]?(LD[i]++,i+="-"+LD[i]):LD[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=wD(this.vertexSrc,PP.PRECISION_VERTEX,aP.HIGH),this.fragmentSrc=wD(this.fragmentSrc,PP.PRECISION_FRAGMENT,function(){if(!bD){bD=aP.MEDIUM;var t=ED();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);bD=e.precision?aP.HIGH:aP.MEDIUM}}return bD}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},UD={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};kD.prototype.extractData=function(t,e){var r=ED();if(r){var i=gD(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},kD.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=OD(e,o.type),h={type:a,name:o.name,size:ID(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},kD.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=OD(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:vD(h,s.size)}}return r},UD.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},UD.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},kD.from=function(t,e,r){var i=t+e,n=VP[i];return n||(VP[i]=n=new kD(t,e,r)),n},Object.defineProperties(kD,UD);var BD=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof nD?e:new nD(e):new nD({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},jD={uniforms:{configurable:!0}};BD.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},BD.prototype.destroy=function(){this.uniformGroup=null},jD.uniforms.get=function(){return this.uniformGroup.uniforms},BD.from=function(t,e,r){var i=kD.from(t,e);return new BD(i,r)},Object.defineProperties(BD.prototype,jD);var XD=function(){this.data=0,this.blendMode=ZN.NORMAL,this.polygonOffset=0,this.blend=!0},GD={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};GD.blend.get=function(){return!!(1&this.data)},GD.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},GD.offsets.get=function(){return!!(2&this.data)},GD.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},GD.culling.get=function(){return!!(4&this.data)},GD.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},GD.depthTest.get=function(){return!!(8&this.data)},GD.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},GD.clockwiseFrontFace.get=function(){return!!(16&this.data)},GD.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},GD.blendMode.get=function(){return this._blendMode},GD.blendMode.set=function(t){this.blend=t!==ZN.NONE,this._blendMode=t},GD.polygonOffset.get=function(){return this._polygonOffset},GD.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},XD.for2d=function(){var t=new XD;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(XD.prototype,GD);var zD=function(t){function e(r,i,n){var s=kD.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=PP.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new XD}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(BD);zD.SOURCE_KEY_MAP={};var VD=new eM,HD=function(t,e){this._texture=t,this.mapCoord=new eM,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},$D={texture:{configurable:!0}};$D.texture.get=function(){return this._texture},$D.texture.set=function(t){this._texture=t,this._updateID=-1},HD.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},HD.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(VD.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(VD));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(HD.prototype,$D);var WD=function(t){function e(e){var r=new eM;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new HD(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(zD),YD=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new mD;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case hP.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case hP.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case hP.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case hP.SCISSOR:this.renderer.scissor.pop();break;case hP.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case hP.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=hP.SPRITE;else if(t.type=hP.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=hP.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new WD(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(FM),qD=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(FM),KD=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(qD),ZD=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(qD),JD=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new eM,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(FM),QD=new cM,tF=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new cM,this.destinationFrame=new cM}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(QD.width=s.realWidth,QD.height=s.realHeight,r=QD),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(QD.width=n.width,QD.height=n.height,r=QD),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(FM),eF=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};eF.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var rF=0,iF={textureCount:0},nF=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=rF++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof PD)return PD;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");PD=!0===t({a:"b"},"a","b")}catch(t){PD=!1}return PD}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(iF.textureCount=0,this.syncUniformGroup(t.uniformGroup,iF)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?RD:ND)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=gD(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:vD(h.type,h.size)}}var u=new eF(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(FM);var sF=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ZN.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new XD,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[ZN.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.ADD]=[t.ONE,t.ONE],e[ZN.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.NONE]=[0,0],e[ZN.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[ZN.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ZN.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[ZN.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[ZN.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ZN.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[ZN.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[ZN.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[ZN.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[ZN.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ZN.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(FM),oF=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=PP.GC_MAX_IDLE,this.checkCountMax=PP.GC_MAX_CHECK_COUNT,this.mode=PP.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==oP.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(FM),aF=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},hF=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new CM}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new aF(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new aF(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new aF(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===eP.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&jP(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==nP.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=iP.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===rP.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===rP.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===rP.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===rP.LINEAR?r.LINEAR:r.NEAREST)},e}(FM),uF=new eM;V.a;var lF=function(){this.texArray=null,this.blend=0,this.type=JN.TRIANGLES,this.start=0,this.size=0,this.data=null},cF=function(){this.elements=[],this.ids=[],this.count=0};cF.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var dF=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},pF={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};pF.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},pF.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},pF.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},pF.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},pF.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},dF.prototype.view=function(t){return this[t+"View"]},dF.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},dF.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(dF.prototype,pF);var fF=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=XD.for2d(),this.size=4*PP.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;PP.PREFER_ENV===qN.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),PP.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=MD.replace(/%forloop%/gi,DD(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new lF);for(;r.length<n;)r.push(new cF);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++CM._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;CM._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=FP[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;PP.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),PP.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=kP(Math.ceil(t/8)),r=BP(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new dF(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=kP(Math.ceil(t/12)),r=BP(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?LP(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(aD);fF._drawCallPool=[],fF._textureArrayPool=[];var mF=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};mF.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=nD.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new kD(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new eM,default:this.defaultGroupCache[t]};return new BD(this.programCache[t],n)},mF.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var gF=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new YM(null,e,!1),this._indexBuffer=new YM(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,eP.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,eP.FLOAT).addAttribute("aColor",this._buffer,4,!0,eP.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,eP.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(tD),yF="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",vF="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",_F=function(){},bF={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};_F.create=function(t){var e=Object.assign({vertex:yF,fragment:vF,geometryClass:gF,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new mF(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(fF)},bF.defaultVertexSrc.get=function(){return yF},bF.defaultFragmentTemplate.get=function(){return vF},Object.defineProperties(_F,bF);_F.create();
/*!
 * @pixi/particles - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/particles is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var xF=function(t){function e(e,r,i,n){void 0===e&&(e=1500),void 0===i&&(i=16384),void 0===n&&(n=!1),t.call(this);i>16384&&(i=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=i,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=ZN.NORMAL,this.autoResize=n,this.roundPixels=!0,this.baseTexture=null,this.setProperties(r),this._tint=0,this.tintRgb=new Float32Array(4),this.tint=16777215}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={tint:{configurable:!0}};return e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t,DP(t,this.tintRgb)},e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},Object.defineProperties(e.prototype,r),e}(mM),TF=function(t,e,r){this.geometry=new tD,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var n=t[i];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||eP.FLOAT,offset:n.offset},e[i]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()};TF.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new YM(function(t,e){void 0===e&&(e=null);var r=6*t;if((e=e||new Uint16Array(r)).length!==r)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+r);for(var i=0,n=0;i<r;i+=6,n+=4)e[i+0]=n+0,e[i+1]=n+1,e[i+2]=n+2,e[i+3]=n+0,e[i+4]=n+2,e[i+5]=n+3;return e}(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){var i=this.dynamicProperties[r];i.offset=e,e+=i.size,this.dynamicStride+=i.size}var n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new YM(this.dynamicData,!1,!1);var s=0;this.staticStride=0;for(var o=0;o<this.staticProperties.length;++o){var a=this.staticProperties[o];a.offset=s,s+=a.size,this.staticStride+=a.size}var h=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(h),this.staticDataUint32=new Uint32Array(h),this.staticBuffer=new YM(this.staticData,!0,!1);for(var u=0;u<this.dynamicProperties.length;++u){var l=this.dynamicProperties[u];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===eP.UNSIGNED_BYTE,l.type,4*this.dynamicStride,4*l.offset)}for(var c=0;c<this.staticProperties.length;++c){var d=this.staticProperties[c];t.addAttribute(d.attributeName,this.staticBuffer,0,d.type===eP.UNSIGNED_BYTE,d.type,4*this.staticStride,4*d.offset)}},TF.prototype.uploadDynamic=function(t,e,r){for(var i=0;i<this.dynamicProperties.length;i++){var n=this.dynamicProperties[i];n.uploadFunction(t,e,r,n.type===eP.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++},TF.prototype.uploadStatic=function(t,e,r){for(var i=0;i<this.staticProperties.length;i++){var n=this.staticProperties[i];n.uploadFunction(t,e,r,n.type===eP.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++},TF.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()};
/*!
 * @pixi/canvas-particles - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/canvas-particles is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
xF.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,r=this.worldTransform,i=!0,n=0,s=0,o=0,a=0;t.setBlendMode(this.blendMode),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var h=0;h<this.children.length;++h){var u=this.children[h];if(u.visible&&u._texture.valid){var l=u._texture.frame;if(e.globalAlpha=this.worldAlpha*u.alpha,u.rotation%(2*Math.PI)==0)i&&(t.setContextTransform(r,!1,1),i=!1),n=u.anchor.x*(-l.width*u.scale.x)+u.position.x+.5,s=u.anchor.y*(-l.height*u.scale.y)+u.position.y+.5,o=l.width*u.scale.x,a=l.height*u.scale.y;else{i||(i=!0),u.displayObjectUpdateTransform();var c=u.worldTransform;t.setContextTransform(c,this.roundPixels,1),n=u.anchor.x*-l.width+.5,s=u.anchor.y*-l.height+.5,o=l.width,a=l.height}var d=u._texture.baseTexture.resolution;e.drawImage(u._texture.baseTexture.getDrawableSource(),l.x*d,l.y*d,l.width*d,l.height*d,n*t.resolution,s*t.resolution,o*t.resolution,a*t.resolution)}}}};var EF=/iPhone/i,wF=/iPod/i,SF=/iPad/i,IF=/\biOS-universal(?:.+)Mac\b/i,AF=/\bAndroid(?:.+)Mobile\b/i,CF=/Android/i,OF=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,RF=/Silk/i,NF=/Windows Phone/i,PF=/\bWindows(?:.+)ARM\b/i,MF=/BlackBerry/i,DF=/BB10/i,FF=/Opera Mini/i,LF=/\b(CriOS|Chrome)(?:.+)Mobile/i,kF=/Mobile(?:.+)Firefox\b/i,UF=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var BF=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(EF)&&!n(NF),ipod:n(wF),tablet:!n(EF)&&(n(SF)||UF(e))&&!n(NF),universal:n(IF),device:(n(EF)||n(wF)||n(SF)||n(IF)||UF(e))&&!n(NF)},amazon:{phone:n(OF),tablet:!n(OF)&&n(RF),device:n(OF)||n(RF)},android:{phone:!n(NF)&&n(OF)||!n(NF)&&n(AF),tablet:!n(NF)&&!n(OF)&&!n(AF)&&(n(RF)||n(CF)),device:!n(NF)&&(n(OF)||n(RF)||n(AF)||n(CF))||n(/\bokhttp\b/i)},windows:{phone:n(NF),tablet:n(PF),device:n(NF)||n(PF)},other:{blackberry:n(MF),blackberry10:n(DF),opera:n(FF),firefox:n(kF),chrome:n(LF),device:n(MF)||n(DF)||n(FF)||n(kF)||n(LF)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var jF,XF={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(BF.tablet||BF.phone){if(e=!1,BF.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(BF.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:BF.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!BF.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},GF=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),zF=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),VF=2*Math.PI,HF=180/Math.PI,$F=Math.PI/180;
/*!
 * @pixi/math - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(jF||(jF={}));var WF=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new GF;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new GF;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(VF-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),YF=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],qF=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],KF=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ZF=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],JF=[],QF=[],tL=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];JF.push(e);for(var r=0;r<16;r++)for(var i=tL(YF[t]*YF[r]+KF[t]*qF[r]),n=tL(qF[t]*YF[r]+ZF[t]*qF[r]),s=tL(YF[t]*KF[r]+KF[t]*ZF[r]),o=tL(qF[t]*KF[r]+ZF[t]*ZF[r]),a=0;a<16;a++)if(YF[a]===i&&qF[a]===n&&KF[a]===s&&ZF[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new WF;h.set(YF[t],qF[t],KF[t],ZF[t],0,0),QF.push(h)}}();var eL,rL,iL,nL,sL,oL,aL,hL,uL,lL,cL,dL,pL,fL,mL=function(){function t(){this.worldTransform=new WF,this.localTransform=new WF,this.position=new zF(this.onChange,this,0,0),this.scale=new zF(this.onChange,this,1,1),this.pivot=new zF(this.onChange,this,0,0),this.skew=new zF(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),gL=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=jF.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}();(function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=jF.CIRC}t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new gL(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}})(),function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=jF.ELIP}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new gL(this.x-this.width,this.y-this.height,this.width,this.height)}}(),function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof GF){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=jF.POLY,this.closeStroke=!0}t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r}}(),function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=jF.RREC}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1}}();!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(eL||(eL={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(rL||(rL={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(iL||(iL={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(nL||(nL={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(sL||(sL={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(oL||(oL={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(aL||(aL={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(hL||(hL={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(uL||(uL={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(lL||(lL={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(cL||(cL={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(dL||(dL={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(pL||(pL={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(fL||(fL={})),
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
XF.RETINA_PREFIX=/@([0-9\.]+)x/,XF.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;!function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[iL.NORMAL_NPM]=iL.NORMAL,t[iL.ADD_NPM]=iL.ADD,t[iL.SCREEN_NPM]=iL.SCREEN,e[iL.NORMAL]=iL.NORMAL_NPM,e[iL.ADD]=iL.ADD_NPM,e[iL.SCREEN]=iL.SCREEN_NPM;var i=[];i.push(e),i.push(t)}();Float32Array,Uint32Array,Int32Array,Uint8Array;function yL(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}Object.create(null),Object.create(null);!function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||XF.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0})}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
XF.SORTABLE_CHILDREN=!1;var vL=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};vL.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},vL.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},vL.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?gL.EMPTY:((t=t||new gL(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},vL.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},vL.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},vL.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},vL.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},vL.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},vL.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},vL.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},vL.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},vL.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},vL.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},vL.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},vL.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},vL.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var _L=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new mL,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new vL,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new gL),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new gL),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*HF},r.angle.set=function(t){this.transform.rotation=t*$F},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function bL(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}_L.prototype.displayObjectUpdateTransform=_L.prototype.updateTransform;var xL=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=XF.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);yL(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,yL(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,yL(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(bL),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(_L);xL.prototype.containerUpdateTransform=xL.prototype.updateTransform,
/*!
 * @pixi/canvas-display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/canvas-display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
xL.prototype._renderCanvas=function(t){},xL.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},_L.prototype.renderCanvas=function(t){};
/*!
 * @pixi/math - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var TL,EL=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),wL=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),SL=2*Math.PI,IL=180/Math.PI,AL=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(TL||(TL={}));var CL=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new EL;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new EL;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(SL-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),OL=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],RL=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],NL=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],PL=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ML=[],DL=[],FL=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];ML.push(e);for(var r=0;r<16;r++)for(var i=FL(OL[t]*OL[r]+NL[t]*RL[r]),n=FL(RL[t]*OL[r]+PL[t]*RL[r]),s=FL(OL[t]*NL[r]+NL[t]*PL[r]),o=FL(RL[t]*NL[r]+PL[t]*PL[r]),a=0;a<16;a++)if(OL[a]===i&&RL[a]===n&&NL[a]===s&&PL[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new CL;h.set(OL[t],RL[t],NL[t],PL[t],0,0),DL.push(h)}}();var LL={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return OL[t]},uY:function(t){return RL[t]},vX:function(t){return NL[t]},vY:function(t){return PL[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return ML[t][e]},sub:function(t,e){return ML[t][LL.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?LL.S:LL.N:2*Math.abs(e)<=Math.abs(t)?t>0?LL.E:LL.W:e>0?t>0?LL.SE:LL.SW:t>0?LL.NE:LL.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=DL[LL.inv(e)];n.tx=r,n.ty=i,t.append(n)}},kL=function(){function t(){this.worldTransform=new CL,this.localTransform=new CL,this.position=new wL(this.onChange,this,0,0),this.scale=new wL(this.onChange,this,1,1),this.pivot=new wL(this.onChange,this,0,0),this.skew=new wL(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),UL=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=TL.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}(),BL=(function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=TL.CIRC}t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new UL(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}(),function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=TL.ELIP}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new UL(this.x-this.width,this.y-this.height,this.width,this.height)}}(),function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof EL){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=TL.POLY,this.closeStroke=!0}t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r}}(),function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=TL.RREC}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1}}(),/iPhone/i),jL=/iPod/i,XL=/iPad/i,GL=/\biOS-universal(?:.+)Mac\b/i,zL=/\bAndroid(?:.+)Mobile\b/i,VL=/Android/i,HL=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,$L=/Silk/i,WL=/Windows Phone/i,YL=/\bWindows(?:.+)ARM\b/i,qL=/BlackBerry/i,KL=/BB10/i,ZL=/Opera Mini/i,JL=/\b(CriOS|Chrome)(?:.+)Mobile/i,QL=/Mobile(?:.+)Firefox\b/i,tk=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var ek=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(BL)&&!n(WL),ipod:n(jL),tablet:!n(BL)&&(n(XL)||tk(e))&&!n(WL),universal:n(GL),device:(n(BL)||n(jL)||n(XL)||n(GL)||tk(e))&&!n(WL)},amazon:{phone:n(HL),tablet:!n(HL)&&n($L),device:n(HL)||n($L)},android:{phone:!n(WL)&&n(HL)||!n(WL)&&n(zL),tablet:!n(WL)&&!n(HL)&&!n(zL)&&(n($L)||n(VL)),device:!n(WL)&&(n(HL)||n($L)||n(zL)||n(VL))||n(/\bokhttp\b/i)},windows:{phone:n(WL),tablet:n(YL),device:n(WL)||n(YL)},other:{blackberry:n(qL),blackberry10:n(KL),opera:n(ZL),firefox:n(QL),chrome:n(JL),device:n(qL)||n(KL)||n(ZL)||n(QL)||n(JL)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(window.navigator);var rk,ik,nk,sk,ok,ak,hk,uk,lk,ck,dk,pk,fk,mk,gk={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(ek.tablet||ek.phone){if(e=!1,ek.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(ek.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:ek.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!ek.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};
/*!
 * @pixi/constants - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(rk||(rk={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(ik||(ik={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(nk||(nk={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(sk||(sk={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(ok||(ok={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(ak||(ak={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(hk||(hk={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(uk||(uk={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(lk||(lk={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(ck||(ck={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(dk||(dk={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(pk||(pk={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(fk||(fk={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(mk||(mk={})),
/*!
 * @pixi/utils - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
gk.RETINA_PREFIX=/@([0-9\.]+)x/,gk.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var yk,vk=!1;function _k(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function bk(t){var e=t.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)}var xk=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[nk.NORMAL_NPM]=nk.NORMAL,t[nk.ADD_NPM]=nk.ADD,t[nk.SCREEN_NPM]=nk.SCREEN,e[nk.NORMAL]=nk.NORMAL_NPM,e[nk.ADD]=nk.ADD_NPM,e[nk.SCREEN]=nk.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();Float32Array,Uint32Array,Int32Array,Uint8Array;function Tk(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Ek(t){return!(t&t-1||!t)}function wk(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function Sk(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}function Ik(t){return 0===t?0:t<0?-1:1}var Ak=0;function Ck(){return++Ak}var Ok={};var Rk={},Nk=Object.create(null),Pk=Object.create(null);!function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||gk.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0})}();var Mk;function Dk(t,e){var r=gk.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/runner - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Fk,Lk=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(Lk.prototype,{dispatch:{value:Lk.prototype.emit},run:{value:Lk.prototype.emit}}),
/*!
 * @pixi/ticker - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
gk.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(Fk||(Fk={}));var kk=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Uk=function(){function t(){var t=this;this._head=new kk(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/gk.TARGET_FPMS,this.elapsedMS=1/gk.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=Fk.NORMAL),this._addListener(new kk(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=Fk.NORMAL),this._addListener(new kk(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*gk.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,gk.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}();!function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Fk.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Uk.shared:new Uk,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}();
/*!
 * @pixi/display - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
gk.SORTABLE_CHILDREN=!1;var Bk=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};Bk.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Bk.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Bk.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?UL.EMPTY:((t=t||new UL(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Bk.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Bk.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},Bk.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},Bk.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},Bk.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},Bk.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},Bk.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},Bk.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},Bk.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Bk.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},Bk.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},Bk.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},Bk.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var jk=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new kL,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Bk,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new UL),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new UL),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*IL},r.angle.set=function(t){this.transform.rotation=t*AL},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function Xk(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}jk.prototype.displayObjectUpdateTransform=jk.prototype.updateTransform;var Gk=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=gk.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);Sk(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,Sk(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Sk(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Xk),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(jk);Gk.prototype.containerUpdateTransform=Gk.prototype.updateTransform;
/*!
 * @pixi/core - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var zk=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Lk("setRealSize",2),this.onUpdate=new Lk("update"),this.onError=new Lk("onError",1)},Vk={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};zk.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},zk.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},zk.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},Vk.valid.get=function(){return!!this._width&&!!this._height},zk.prototype.update=function(){this.destroyed||this.onUpdate.run()},zk.prototype.load=function(){return Promise.resolve()},Vk.width.get=function(){return this._width},Vk.height.get=function(){return this._height},zk.prototype.upload=function(t,e,r){return!1},zk.prototype.style=function(t,e,r){return!1},zk.prototype.dispose=function(){},zk.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(zk.prototype,Vk);var Hk=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,Mk||(Mk=document.createElement("a")),Mk.href=t;var r=Object(W.parse)(Mk.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===dk.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(zk),$k=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:gk.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){e.url=e.source.src;var i=e.source,n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===dk.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(Hk),Wk=[];function Yk(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=Wk.length-1;n>=0;--n){var s=Wk[n];if(s.test&&s.test(t,r))return new s(t,e)}return new $k(t,e)}var qk=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===dk.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(zk),Kk={scaleMode:uk.NEAREST,format:ok.RGBA,alphaMode:dk.NPM},Zk=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof zk||((e=Yk(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||gk.RESOLUTION,this.mipmap=void 0!==n?n:gk.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:gk.ANISOTROPIC_LEVEL,this.wrapMode=u||gk.WRAP_MODE,this.scaleMode=void 0!==o?o:gk.SCALE_MODE,this.format=l||ok.RGBA,this.type=c||hk.UNSIGNED_BYTE,this.target=d||ak.TEXTURE_2D,this.alphaMode=void 0!==i?i:dk.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=Ck(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=Ek(this.realWidth)&&Ek(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Pk[this.cacheId],delete Nk[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=gk.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+Ck()),s=t._pixiId);var o=Pk[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new qk(t,{width:r,height:i}),o=t instanceof Float32Array?hk.FLOAT:hk.UNSIGNED_BYTE;return new e(s,Object.assign(Kk,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Pk[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Pk[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Pk[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Pk[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Pk[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);Zk._globalBatch=0;var Jk=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new Zk;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(Yk(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=ak.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(zk),Qk=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(Hk),tU=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=ak.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=ak.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(Jk);tU.SIDES=6;var eU=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){e._resolve&&(r.onerror=null,e.onError.run(t))},r.onload=function(){if(e._resolve){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+Ck(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(Hk);eU.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var rU=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=Uk.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Uk.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Uk.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&Uk.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Uk.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Uk.shared.add(this.update,this),this._isConnectedToTicker=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(Hk);rU.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var iU=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(Hk);Wk.push($k,iU,Qk,rU,eU,qk,tU,Jk);var nU=function(t){this.renderer=t};nU.prototype.destroy=function(){this.renderer=null};var sU=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===dk.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(qk),oU=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Lk("disposeFramebuffer",2)},aU={colorTexture:{configurable:!0}};aU.colorTexture.get=function(){return this.colorTextures[0]},oU.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new Zk(null,{scaleMode:uk.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},oU.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Zk(new sU(null,{width:this.width,height:this.height}),{scaleMode:uk.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:ok.DEPTH_COMPONENT,type:hk.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},oU.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},oU.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},oU.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},oU.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(oU.prototype,aU);var hU=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new oU(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(Zk),uU=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};uU.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=LL.add(r,LL.NW),this.x0=a+s*LL.uX(r),this.y0=h+o*LL.uY(r),r=LL.add(r,2),this.x1=a+s*LL.uX(r),this.y1=h+o*LL.uY(r),r=LL.add(r,2),this.x2=a+s*LL.uX(r),this.y2=h+o*LL.uY(r),r=LL.add(r,2),this.x3=a+s*LL.uX(r),this.y3=h+o*LL.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var lU=new uU,cU=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new UL(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=lU,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new EL(a.x,a.y):new EL(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&Nk[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===lU&&(this._uvs=new uU),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=gk.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+Ck()),s=t._pixiId);var o=Nk[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=Dk(t)),(o=new e(new Zk(t,r))).baseTexture.cacheId=s,Zk.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(Zk.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new $k(t);n.url=r;var s=new e(new Zk(n,{scaleMode:gk.SCALE_MODE,resolution:Dk(r)}));return i||(i=r),Zk.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(Zk.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Nk[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Nk[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Nk[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Nk[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)Nk[t.textureCacheIds[i]]===t&&delete Nk[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function dU(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}cU.EMPTY=new cU(new Zk),dU(cU.EMPTY),dU(cU.EMPTY.baseTexture),cU.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new cU(new Zk(new Qk(t)))}(),dU(cU.WHITE),dU(cU.WHITE.baseTexture);var pU=function(t){function e(e,r){var i=null;if(!(e instanceof hU)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new hU({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new hU(t))},e}(cU),fU=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};fU.prototype.createTexture=function(t,e){var r=new hU(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new pU(r)},fU.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=fU.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=Tk(t)))<<16|65535&(e=Tk(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},fU.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},fU.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},fU.prototype.returnFilterTexture=function(t){this.returnTexture(t)},fU.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},fU.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=fU.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},fU.SCREEN_KEY="screen";var mU=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};mU.prototype.destroy=function(){this.buffer=null},mU.from=function(t,e,r,i,n){return new mU(t,e,r,i,n)};var gU=0,yU=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=gU++,this.disposeRunner=new Lk("disposeBuffer",2)};function vU(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}yU.prototype.update=function(t){this.data=t||this.data,this._updateID++},yU.prototype.dispose=function(){this.disposeRunner.run(this,!1)},yU.prototype.destroy=function(){this.dispose(),this.data=null},yU.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new yU(t)};var _U={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var bU={5126:4,5123:2,5121:1},xU=0,TU={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},EU=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=xU++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Lk("disposeGeometry",2),this.refCount=0};EU.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new yU(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new mU(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},EU.prototype.getAttribute=function(t){return this.attributes[t]},EU.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},EU.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new yU(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},EU.prototype.getIndex=function(){return this.indexBuffer},EU.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new yU;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*bU[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=vU(c);n[d]||(n[d]=new _U[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},EU.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},EU.prototype.dispose=function(){this.disposeRunner.run(this,!1)},EU.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},EU.prototype.clone=function(){for(var t=new EU,e=0;e<this.buffers.length;e++)t.buffers[e]=new yU(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new mU(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},EU.merge=function(t){for(var e,r=new EU,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(TU[vU(e.buffers[h].data)])(n[h]),r.buffers[h]=new yU(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*bU[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var wU=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(EU),SU=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new yU(this.vertices),this.uvBuffer=new yU(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(EU),IU=0,AU=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=IU++,this.static=!!e};AU.prototype.update=function(){this.dirtyId++},AU.prototype.add=function(t,e,r){this.uniforms[t]=new AU(e,r)},AU.from=function(t,e){return new AU(t,e)};var CU=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new UL,this.destinationFrame=new UL,this.filters=[]};CU.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var OU=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new fU,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new wU,this.quadUv=new SU,this.tempRect=new UL,this.activeState={},this.globalUniforms=new AU({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new CU,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(sk.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(sk.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(CL.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(nU),RU=function(t){this.renderer=t};RU.prototype.flush=function(){},RU.prototype.destroy=function(){this.renderer=null},RU.prototype.start=function(){},RU.prototype.stop=function(){this.flush()},RU.prototype.render=function(t){};var NU=function(t){function e(e){t.call(this,e),this.emptyRenderer=new RU(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(nU);gk.PREFER_ENV=ek.any?rk.WEBGL:rk.WEBGL2,gk.STRICT_TEXTURE_CACHE=!1;var PU=0,MU=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=PU++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=PU++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(gk.PREFER_ENV>=rk.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(nU),DU=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new oU(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new UL,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;gk.PREFER_ENV===rk.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new UL},Object.defineProperties(e.prototype,r),e}(nU),FU=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},LU={5126:4,5123:2,5121:1},kU=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;gk.PREFER_ENV===rk.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*LU[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*LU[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*LU[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new FU(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(nU),UU=function(t){this.type=mk.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function BU(t,e,r,i){var n=jU(t,t.VERTEX_SHADER,e),s=jU(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function jU(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function XU(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return GU(2*e);case"bvec3":return GU(3*e);case"bvec4":return GU(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function GU(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}UU.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=mk.NONE,this.autoDetect=!0),this._target=null},UU.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var zU,VU={},HU=VU;function $U(){if(HU===VU||HU&&HU.isContextLost()){var t,e=document.createElement("canvas");gk.PREFER_ENV>=rk.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),HU=t}return HU}function WU(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===fk.HIGH&&r!==fk.HIGH&&(i=fk.MEDIUM),"precision "+i+" float;\n"+t}return r!==fk.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var YU={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function qU(t){return YU[t]}var KU=null,ZU={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function JU(t,e){if(!KU){var r=Object.keys(ZU);KU={};for(var i=0;i<r.length;++i){var n=r[i];KU[t[n]]=ZU[n]}}return KU[e]}var QU={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},tB={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var eB,rB=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function iB(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var nB=0,sB={},oB=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=nB++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),sB[i]?(sB[i]++,i+="-"+sB[i]):sB[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=WU(this.vertexSrc,gk.PRECISION_VERTEX,fk.HIGH),this.fragmentSrc=WU(this.fragmentSrc,gk.PRECISION_FRAGMENT,function(){if(!zU){zU=fk.MEDIUM;var t=$U();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);zU=e.precision?fk.HIGH:fk.MEDIUM}}return zU}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},aB={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};oB.prototype.extractData=function(t,e){var r=$U();if(r){var i=BU(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},oB.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=JU(e,o.type),h={type:a,name:o.name,size:qU(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},oB.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=JU(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:XU(h,s.size)}}return r},aB.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},aB.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},oB.from=function(t,e,r){var i=t+e,n=Rk[i];return n||(Rk[i]=n=new oB(t,e,r)),n},Object.defineProperties(oB,aB);var hB=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof AU?e:new AU(e):new AU({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},uB={uniforms:{configurable:!0}};hB.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},hB.prototype.destroy=function(){this.uniformGroup=null},uB.uniforms.get=function(){return this.uniformGroup.uniforms},hB.from=function(t,e,r){var i=oB.from(t,e);return new hB(i,r)},Object.defineProperties(hB.prototype,uB);var lB=function(){this.data=0,this.blendMode=nk.NORMAL,this.polygonOffset=0,this.blend=!0},cB={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};cB.blend.get=function(){return!!(1&this.data)},cB.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},cB.offsets.get=function(){return!!(2&this.data)},cB.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},cB.culling.get=function(){return!!(4&this.data)},cB.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},cB.depthTest.get=function(){return!!(8&this.data)},cB.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},cB.clockwiseFrontFace.get=function(){return!!(16&this.data)},cB.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},cB.blendMode.get=function(){return this._blendMode},cB.blendMode.set=function(t){this.blend=t!==nk.NONE,this._blendMode=t},cB.polygonOffset.get=function(){return this._polygonOffset},cB.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},lB.for2d=function(){var t=new lB;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(lB.prototype,cB);var dB=function(t){function e(r,i,n){var s=oB.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=gk.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new lB}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(hB);dB.SOURCE_KEY_MAP={};var pB=new CL,fB=function(t,e){this._texture=t,this.mapCoord=new CL,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},mB={texture:{configurable:!0}};mB.texture.get=function(){return this._texture},mB.texture.set=function(t){this._texture=t,this._updateID=-1},fB.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},fB.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(pB.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(pB));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(fB.prototype,mB);var gB=function(t){function e(e){var r=new CL;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new fB(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(dB),yB=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new UU;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case mk.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case mk.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case mk.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case mk.SCISSOR:this.renderer.scissor.pop();break;case mk.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case mk.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=mk.SPRITE;else if(t.type=mk.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=mk.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new gB(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(nU),vB=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(nU),_B=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(vB),bB=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(vB),xB=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new CL,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(nU),TB=new UL,EB=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new UL,this.destinationFrame=new UL}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(TB.width=s.realWidth,TB.height=s.realHeight,r=TB),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(TB.width=n.width,TB.height=n.height,r=TB),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(nU),wB=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};wB.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var SB=0,IB={textureCount:0},AB=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=SB++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof eB)return eB;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");eB=!0===t({a:"b"},"a","b")}catch(t){eB=!1}return eB}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(IB.textureCount=0,this.syncUniformGroup(t.uniformGroup,IB)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?QU:tB)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=BU(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:XU(h.type,h.size)}}var u=new wB(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(nU);var CB=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=nk.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new lB,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[nk.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.ADD]=[t.ONE,t.ONE],e[nk.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.NONE]=[0,0],e[nk.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[nk.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[nk.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[nk.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[nk.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[nk.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[nk.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[nk.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[nk.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[nk.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[nk.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(nU),OB=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=gk.GC_MAX_IDLE,this.checkCountMax=gk.GC_MAX_CHECK_COUNT,this.mode=gk.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==pk.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(nU),RB=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},NB=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Zk}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new RB(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new RB(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new RB(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===hk.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&Sk(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==ck.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=lk.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===uk.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===uk.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===uk.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===uk.LINEAR?r.LINEAR:r.NEAREST)},e}(nU),PB=new CL;V.a;var MB=function(){this.texArray=null,this.blend=0,this.type=sk.TRIANGLES,this.start=0,this.size=0,this.data=null},DB=function(){this.elements=[],this.ids=[],this.count=0};DB.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var FB=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},LB={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};LB.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},LB.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},LB.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},LB.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},LB.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},FB.prototype.view=function(t){return this[t+"View"]},FB.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},FB.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(FB.prototype,LB);var kB=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=lB.for2d(),this.size=4*gk.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;gk.PREFER_ENV===rk.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),gk.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=rB.replace(/%forloop%/gi,iB(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new MB);for(;r.length<n;)r.push(new DB);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++Zk._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;Zk._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=xk[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;gk.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),gk.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=Tk(Math.ceil(t/8)),r=wk(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new FB(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=Tk(Math.ceil(t/12)),r=wk(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(RU);kB._drawCallPool=[],kB._textureArrayPool=[];var UB=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};UB.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=AU.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new oB(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new CL,default:this.defaultGroupCache[t]};return new hB(this.programCache[t],n)},UB.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var BB=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new yU(null,e,!1),this._indexBuffer=new yU(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,hk.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,hk.FLOAT).addAttribute("aColor",this._buffer,4,!0,hk.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,hk.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(EU),jB="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",XB="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",GB=function(){},zB={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};GB.create=function(t){var e=Object.assign({vertex:jB,fragment:XB,geometryClass:BB,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new UB(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(kB)},zB.defaultVertexSrc.get=function(){return jB},zB.defaultFragmentTemplate.get=function(){return XB},Object.defineProperties(GB,zB);GB.create();
/*!
 * @pixi/sprite - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var VB=new EL,HB=new Uint16Array([0,1,2,0,2,3]),$B=function(t){function e(e){t.call(this),this._anchor=new wL(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=nk.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=e||cU.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=HB,this.pluginName="batch",this.isSprite=!0,this._roundPixels=gk.ROUND_PIXELS}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Ik(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Ik(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,d=0,p=0,f=0,m=0;if(u?(d=(p=u.x-c._x*l.width)+u.width,f=(m=u.y-c._y*l.height)+u.height):(d=(p=-c._x*l.width)+l.width,f=(m=-c._y*l.height)+l.height),h[0]=r*p+n*m+o,h[1]=s*m+i*p+a,h[2]=r*d+n*m+o,h[3]=s*m+i*d+a,h[4]=r*d+n*f+o,h[5]=s*f+i*d+a,h[6]=r*p+n*f+o,h[7]=s*f+i*p+a,this._roundPixels)for(var g=gk.RESOLUTION,y=0;y<h.length;++y)h[y]=Math.round((h[y]*g|0)/g)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,i=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=-i._x*r.width,d=c+r.width,p=-i._y*r.height,f=p+r.height;e[0]=s*c+a*p+u,e[1]=h*p+o*c+l,e[2]=s*d+a*p+u,e[3]=h*p+o*d+l,e[4]=s*d+a*f+u,e[5]=h*f+o*d+l,e[6]=s*c+a*f+u,e[7]=h*f+o*c+l},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new UL),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,VB);var e=this._texture.orig.width,r=this._texture.orig.height,i=-e*this.anchor.x,n=0;return VB.x>=i&&VB.x<i+e&&(n=-r*this.anchor.y,VB.y>=n&&VB.y<n+r)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var r="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null,this.shader=null},e.from=function(t,r){return new e(t instanceof cU?t:cU.from(t,r))},r.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},r.roundPixels.get=function(){return this._roundPixels},r.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},r.width.set=function(t){var e=Ik(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},r.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},r.height.set=function(t){var e=Ik(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},r.anchor.get=function(){return this._anchor},r.anchor.set=function(t){this._anchor.copyFrom(t)},r.tint.get=function(){return this._tint},r.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},r.texture.get=function(){return this._texture},r.texture.set=function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||cU.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},Object.defineProperties(e.prototype,r),e}(Gk),WB=0,YB={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:WB,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},qB=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],KB=function(t){this.styleID=0,this.reset(),tj(this,t,t)},ZB={align:{configurable:!0},breakWords:{configurable:!0},dropShadow:{configurable:!0},dropShadowAlpha:{configurable:!0},dropShadowAngle:{configurable:!0},dropShadowBlur:{configurable:!0},dropShadowColor:{configurable:!0},dropShadowDistance:{configurable:!0},fill:{configurable:!0},fillGradientType:{configurable:!0},fillGradientStops:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontStyle:{configurable:!0},fontVariant:{configurable:!0},fontWeight:{configurable:!0},letterSpacing:{configurable:!0},lineHeight:{configurable:!0},leading:{configurable:!0},lineJoin:{configurable:!0},miterLimit:{configurable:!0},padding:{configurable:!0},stroke:{configurable:!0},strokeThickness:{configurable:!0},textBaseline:{configurable:!0},trim:{configurable:!0},whiteSpace:{configurable:!0},wordWrap:{configurable:!0},wordWrapWidth:{configurable:!0}};function JB(t){return"number"==typeof t?bk(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function QB(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=JB(t[e]);return t}return JB(t)}function tj(t,e,r){for(var i in r)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}KB.prototype.clone=function(){var t={};return tj(t,this,YB),new KB(t)},KB.prototype.reset=function(){tj(this,YB,YB)},ZB.align.get=function(){return this._align},ZB.align.set=function(t){this._align!==t&&(this._align=t,this.styleID++)},ZB.breakWords.get=function(){return this._breakWords},ZB.breakWords.set=function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},ZB.dropShadow.get=function(){return this._dropShadow},ZB.dropShadow.set=function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},ZB.dropShadowAlpha.get=function(){return this._dropShadowAlpha},ZB.dropShadowAlpha.set=function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},ZB.dropShadowAngle.get=function(){return this._dropShadowAngle},ZB.dropShadowAngle.set=function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},ZB.dropShadowBlur.get=function(){return this._dropShadowBlur},ZB.dropShadowBlur.set=function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},ZB.dropShadowColor.get=function(){return this._dropShadowColor},ZB.dropShadowColor.set=function(t){var e=QB(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},ZB.dropShadowDistance.get=function(){return this._dropShadowDistance},ZB.dropShadowDistance.set=function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},ZB.fill.get=function(){return this._fill},ZB.fill.set=function(t){var e=QB(t);this._fill!==e&&(this._fill=e,this.styleID++)},ZB.fillGradientType.get=function(){return this._fillGradientType},ZB.fillGradientType.set=function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},ZB.fillGradientStops.get=function(){return this._fillGradientStops},ZB.fillGradientStops.set=function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},ZB.fontFamily.get=function(){return this._fontFamily},ZB.fontFamily.set=function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},ZB.fontSize.get=function(){return this._fontSize},ZB.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},ZB.fontStyle.get=function(){return this._fontStyle},ZB.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},ZB.fontVariant.get=function(){return this._fontVariant},ZB.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},ZB.fontWeight.get=function(){return this._fontWeight},ZB.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},ZB.letterSpacing.get=function(){return this._letterSpacing},ZB.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},ZB.lineHeight.get=function(){return this._lineHeight},ZB.lineHeight.set=function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},ZB.leading.get=function(){return this._leading},ZB.leading.set=function(t){this._leading!==t&&(this._leading=t,this.styleID++)},ZB.lineJoin.get=function(){return this._lineJoin},ZB.lineJoin.set=function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},ZB.miterLimit.get=function(){return this._miterLimit},ZB.miterLimit.set=function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},ZB.padding.get=function(){return this._padding},ZB.padding.set=function(t){this._padding!==t&&(this._padding=t,this.styleID++)},ZB.stroke.get=function(){return this._stroke},ZB.stroke.set=function(t){var e=QB(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},ZB.strokeThickness.get=function(){return this._strokeThickness},ZB.strokeThickness.set=function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},ZB.textBaseline.get=function(){return this._textBaseline},ZB.textBaseline.set=function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},ZB.trim.get=function(){return this._trim},ZB.trim.set=function(t){this._trim!==t&&(this._trim=t,this.styleID++)},ZB.whiteSpace.get=function(){return this._whiteSpace},ZB.whiteSpace.set=function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},ZB.wordWrap.get=function(){return this._wordWrap},ZB.wordWrap.set=function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},ZB.wordWrapWidth.get=function(){return this._wordWrapWidth},ZB.wordWrapWidth.set=function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},KB.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var i=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&qB.indexOf(i)<0&&(i='"'+i+'"'),e[r]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},Object.defineProperties(KB.prototype,ZB);var ej=function(t,e,r,i,n,s,o,a,h){this.text=t,this.style=e,this.width=r,this.height=i,this.lines=n,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h};ej.measureText=function(t,e,r,i){void 0===i&&(i=ej._canvas),r=null==r?e.wordWrap:r;var n=e.toFontString(),s=ej.measureFont(n);0===s.fontSize&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var o=i.getContext("2d");o.font=n;for(var a=(r?ej.wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),h=new Array(a.length),u=0,l=0;l<a.length;l++){var c=o.measureText(a[l]).width+(a[l].length-1)*e.letterSpacing;h[l]=c,u=Math.max(u,c)}var d=u+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);var p=e.lineHeight||s.fontSize+e.strokeThickness,f=Math.max(p,s.fontSize+e.strokeThickness)+(a.length-1)*(p+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new ej(t,e,d,f,a,h,p+e.leading,u,s)},ej.wordWrap=function(t,e,r){void 0===r&&(r=ej._canvas);for(var i=r.getContext("2d"),n=0,s="",o="",a={},h=e.letterSpacing,u=e.whiteSpace,l=ej.collapseSpaces(u),c=ej.collapseNewlines(u),d=!l,p=e.wordWrapWidth+h,f=ej.tokenize(t),m=0;m<f.length;m++){var g=f[m];if(ej.isNewline(g)){if(!c){o+=ej.addLine(s),d=!l,s="",n=0;continue}g=" "}if(l){var y=ej.isBreakingSpace(g),v=ej.isBreakingSpace(s[s.length-1]);if(y&&v)continue}var _=ej.getFromCache(g,h,a,i);if(_>p)if(""!==s&&(o+=ej.addLine(s),s="",n=0),ej.canBreakWords(g,e.breakWords))for(var b=ej.wordWrapSplit(g),x=0;x<b.length;x++){for(var T=b[x],E=1;b[x+E];){var w=b[x+E],S=T[T.length-1];if(ej.canBreakChars(S,w,g,x,e.breakWords))break;T+=w,E++}x+=T.length-1;var I=ej.getFromCache(T,h,a,i);I+n>p&&(o+=ej.addLine(s),d=!1,s="",n=0),s+=T,n+=I}else{s.length>0&&(o+=ej.addLine(s),s="",n=0);var A=m===f.length-1;o+=ej.addLine(g,!A),d=!1,s="",n=0}else _+n>p&&(d=!1,o+=ej.addLine(s),s="",n=0),(s.length>0||!ej.isBreakingSpace(g)||d)&&(s+=g,n+=_)}return o+=ej.addLine(s,!1)},ej.addLine=function(t,e){return void 0===e&&(e=!0),t=ej.trimRight(t),t=e?t+"\n":t},ej.getFromCache=function(t,e,r,i){var n=r[t];if(void 0===n){var s=t.length*e;n=i.measureText(t).width+s,r[t]=n}return n},ej.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},ej.collapseNewlines=function(t){return"normal"===t},ej.trimRight=function(t){if("string"!=typeof t)return"";for(var e=t.length-1;e>=0;e--){var r=t[e];if(!ej.isBreakingSpace(r))break;t=t.slice(0,-1)}return t},ej.isNewline=function(t){return"string"==typeof t&&ej._newlines.indexOf(t.charCodeAt(0))>=0},ej.isBreakingSpace=function(t){return"string"==typeof t&&ej._breakingSpaces.indexOf(t.charCodeAt(0))>=0},ej.tokenize=function(t){var e=[],r="";if("string"!=typeof t)return e;for(var i=0;i<t.length;i++){var n=t[i];ej.isBreakingSpace(n)||ej.isNewline(n)?(""!==r&&(e.push(r),r=""),e.push(n)):r+=n}return""!==r&&e.push(r),e},ej.canBreakWords=function(t,e){return e},ej.canBreakChars=function(t,e,r,i,n){return!0},ej.wordWrapSplit=function(t){return t.split("")},ej.measureFont=function(t){if(ej._fonts[t])return ej._fonts[t];var e={},r=ej._canvas,i=ej._context;i.font=t;var n=ej.METRICS_STRING+ej.BASELINE_SYMBOL,s=Math.ceil(i.measureText(n).width),o=Math.ceil(i.measureText(ej.BASELINE_SYMBOL).width),a=2*o;o=o*ej.BASELINE_MULTIPLIER|0,r.width=s,r.height=a,i.fillStyle="#f00",i.fillRect(0,0,s,a),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,o);var h=i.getImageData(0,0,s,a).data,u=h.length,l=4*s,c=0,d=0,p=!1;for(c=0;c<o;++c){for(var f=0;f<l;f+=4)if(255!==h[d+f]){p=!0;break}if(p)break;d+=l}for(e.ascent=o-c,d=u-l,p=!1,c=a;c>o;--c){for(var m=0;m<l;m+=4)if(255!==h[d+m]){p=!0;break}if(p)break;d-=l}return e.descent=c-o,e.fontSize=e.ascent+e.descent,ej._fonts[t]=e,e},ej.clearMetrics=function(t){void 0===t&&(t=""),t?delete ej._fonts[t]:ej._fonts={}};var rj=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();rj.width=rj.height=10,ej._canvas=rj,ej._context=rj.getContext("2d"),ej._fonts={},ej.METRICS_STRING="|q",ej.BASELINE_SYMBOL="M",ej.BASELINE_MULTIPLIER=1.4,ej._newlines=[10,13],ej._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var ij={texture:!0,children:!1,baseTexture:!0};
/*!
 * @pixi/canvas-text - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * @pixi/canvas-text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
(function(t){function e(e,r,i){var n=!1;i||(i=document.createElement("canvas"),n=!0),i.width=3,i.height=3;var s=cU.from(i);s.orig=new UL,s.trim=new UL,t.call(this,s),this._ownCanvas=n,this.canvas=i,this.context=this.canvas.getContext("2d"),this._resolution=gk.RESOLUTION,this._autoResolution=!0,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0},style:{configurable:!0},text:{configurable:!0},resolution:{configurable:!0}};return e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var r,i,n=this.context,s=ej.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,h=s.lines,u=s.lineHeight,l=s.lineWidths,c=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil((Math.max(1,o)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;for(var p,f=e.dropShadow?2:1,m=0;m<f;++m){var g=e.dropShadow&&0===m,y=g?2*a:0,v=y*this.resolution;if(g){n.fillStyle="black",n.strokeStyle="black";var _=e.dropShadowColor,b=_k("number"==typeof _?_:("string"==typeof(p=_)&&"#"===p[0]&&(p=p.substr(1)),parseInt(p,16)));n.shadowColor="rgba("+255*b[0]+","+255*b[1]+","+255*b[2]+","+e.dropShadowAlpha+")",n.shadowBlur=e.dropShadowBlur,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+v}else n.fillStyle=this._generateFillStyle(e,h,s),n.strokeStyle=e.stroke,n.shadowColor=0,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var x=0;x<h.length;x++)r=e.strokeThickness/2,i=e.strokeThickness/2+x*u+d.ascent,"right"===e.align?r+=c-l[x]:"center"===e.align&&(r+=(c-l[x])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[x],r+e.padding,i+e.padding-y,!0),e.fill&&this.drawLetterSpacing(h[x],r+e.padding,i+e.padding-y)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,r,i){void 0===i&&(i=!1);var n=this._style.letterSpacing;if(0!==n)for(var s=e,o=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,h=0,u=0;u<o.length;++u){var l=o[u];i?this.context.strokeText(l,s,r):this.context.fillText(l,s,r),s+=a-(h=this.context.measureText(t.substring(u+1)).width)+n,a=h}else i?this.context.strokeText(t,e,r):this.context.fillText(t,e,r)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=function(t){var e,r,i,n=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,n,s).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(r=e/4%n,i=~~(e/4/n),null===u.top&&(u.top=i),null===u.left?u.left=r:r<u.left&&(u.left=r),null===u.right?u.right=r+1:u.right<r&&(u.right=r+1),null===u.bottom?u.bottom=i:u.bottom<i&&(u.bottom=i));return null!==u.top&&(n=u.right-u.left,s=u.bottom-u.top+1,l=o.getImageData(u.left,u.top,n,s)),{height:s,width:n,data:l}}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var r=this._texture,i=this._style,n=i.trim?0:i.padding,s=r.baseTexture;r.trim.width=r._frame.width=Math.ceil(t.width/this._resolution),r.trim.height=r._frame.height=Math.ceil(t.height/this._resolution),r.trim.x=-n,r.trim.y=-n,r.orig.width=r._frame.width-2*n,r.orig.height=r._frame.height-2*n,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e,r){if(!Array.isArray(t.fill))return t.fill;if(1===t.fill.length)return t.fill[0];var i,n=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,o=Math.ceil(this.canvas.width/this._resolution)-n-2*s,a=Math.ceil(this.canvas.height/this._resolution)-n-2*s,h=t.fill.slice(),u=t.fillGradientStops.slice();if(!u.length)for(var l=h.length+1,c=1;c<l;++c)u.push(c/l);if(h.unshift(t.fill[0]),u.unshift(0),h.push(t.fill[t.fill.length-1]),u.push(1),t.fillGradientType===WB){i=this.context.createLinearGradient(o/2,s,o/2,a+s);for(var d=0,p=(r.fontProperties.fontSize+t.strokeThickness)/a,f=0;f<e.length;f++)for(var m=r.lineHeight*f,g=0;g<h.length;g++){var y=m/a+("number"==typeof u[g]?u[g]:g/h.length)*p,v=Math.max(d,y);v=Math.min(v,1),i.addColorStop(v,h[g]),d=v}}else{i=this.context.createLinearGradient(s,a/2,o+s,a/2);for(var _=h.length+1,b=1,x=0;x<h.length;x++){var T=void 0;T="number"==typeof u[x]?u[x]:b/_,i.addColorStop(T,h[x]),b++}}return i},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},ij,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},r.width.get=function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},r.width.set=function(t){this.updateText(!0);var e=Ik(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},r.height.get=function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},r.height.set=function(t){this.updateText(!0);var e=Ik(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},r.style.get=function(){return this._style},r.style.set=function(t){t=t||{},this._style=t instanceof KB?t:new KB(t),this.localStyleID=-1,this.dirty=!0},r.text.get=function(){return this._text},r.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},r.resolution.get=function(){return this._resolution},r.resolution.set=function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},Object.defineProperties(e.prototype,r),e})($B).prototype._renderCanvas=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),$B.prototype._renderCanvas.call(this,t)},
/*!
 * pixi.js-legacy - v5.2.4
 * Compiled Sun, 03 May 2020 22:38:52 UTC
 *
 * pixi.js-legacy is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Au.registerPlugin("accessibility",n.AccessibilityManager),Au.registerPlugin("extract",rw),Au.registerPlugin("graphics",hy),Au.registerPlugin("interaction",s.InteractionManager),Au.registerPlugin("mesh",hp),Au.registerPlugin("prepare",AC),Au.registerPlugin("sprite",Db);const nj=/iPhone/i,sj=/iPod/i,oj=/iPad/i,aj=/\bAndroid(?:.+)Mobile\b/i,hj=/Android/i,uj=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,lj=/Silk/i,cj=/Windows Phone/i,dj=/\bWindows(?:.+)ARM\b/i,pj=/BlackBerry/i,fj=/BB10/i,mj=/Opera Mini/i,gj=/\b(CriOS|Chrome)(?:.+)Mobile/i,yj=/Mobile(?:.+)Firefox\b/i;function vj(t,e){return t.test(e)}
/*!
 * @pixi/settings - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var _j=function(t){let e=(t=t||("undefined"!=typeof navigator?navigator.userAgent:"")).split("[FBAN");void 0!==e[1]&&(t=e[0]),e=t.split("Twitter"),void 0!==e[1]&&(t=e[0]);const r={apple:{phone:vj(nj,t)&&!vj(cj,t),ipod:vj(sj,t),tablet:!vj(nj,t)&&vj(oj,t)&&!vj(cj,t),device:(vj(nj,t)||vj(sj,t)||vj(oj,t))&&!vj(cj,t)},amazon:{phone:vj(uj,t),tablet:!vj(uj,t)&&vj(lj,t),device:vj(uj,t)||vj(lj,t)},android:{phone:!vj(cj,t)&&vj(uj,t)||!vj(cj,t)&&vj(aj,t),tablet:!vj(cj,t)&&!vj(uj,t)&&!vj(aj,t)&&(vj(lj,t)||vj(hj,t)),device:!vj(cj,t)&&(vj(uj,t)||vj(lj,t)||vj(aj,t)||vj(hj,t))||vj(/\bokhttp\b/i,t)},windows:{phone:vj(cj,t),tablet:vj(dj,t),device:vj(cj,t)||vj(dj,t)},other:{blackberry:vj(pj,t),blackberry10:vj(fj,t),opera:vj(mj,t),firefox:vj(yj,t),chrome:vj(gj,t),device:vj(pj,t)||vj(fj,t)||vj(mj,t)||vj(yj,t)||vj(gj,t)},any:!1,phone:!1,tablet:!1};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}();var bj,xj,Tj,Ej,wj,Sj,Ij,Aj,Cj,Oj,Rj,Nj,Pj,Mj,Dj={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(_j.tablet||_j.phone){if(e=!1,_j.apple.device){var r=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(r)parseInt(r[1],10)>=11&&(e=!0)}if(_j.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i)parseInt(i[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:_j.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!_j.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};
/*!
 * @pixi/constants - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(bj||(bj={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(xj||(xj={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Tj||(Tj={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Ej||(Ej={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(wj||(wj={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Sj||(Sj={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Ij||(Ij={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Aj||(Aj={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Cj||(Cj={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(Oj||(Oj={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Rj||(Rj={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Nj||(Nj={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Pj||(Pj={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Mj||(Mj={})),
/*!
 * @pixi/utils - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Dj.RETINA_PREFIX=/@([0-9\.]+)x/,Dj.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var Fj,Lj=!1;var kj=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[Tj.NORMAL_NPM]=Tj.NORMAL,t[Tj.ADD_NPM]=Tj.ADD,t[Tj.SCREEN_NPM]=Tj.SCREEN,e[Tj.NORMAL]=Tj.NORMAL_NPM,e[Tj.ADD]=Tj.ADD_NPM,e[Tj.SCREEN]=Tj.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();Float32Array,Uint32Array,Int32Array,Uint8Array;function Uj(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Bj(t){return!(t&t-1||!t)}function jj(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function Xj(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var s=n-(r=e+r>n?n-e:r);for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}}var Gj=0;function zj(){return++Gj}var Vj={};var Hj={},$j=Object.create(null),Wj=Object.create(null);!function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||Dj.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0})}();var Yj;function qj(t,e){var r=Dj.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
 * @pixi/runner - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Kj,Zj=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,i,n,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(Zj.prototype,{dispatch:{value:Zj.prototype.emit},run:{value:Zj.prototype.emit}}),
/*!
 * @pixi/ticker - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Dj.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(Kj||(Kj={}));var Jj,Qj=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),tX=function(){function t(){var t=this;this._head=new Qj(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Dj.TARGET_FPMS,this.elapsedMS=1/Dj.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=Kj.NORMAL),this._addListener(new Qj(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=Kj.NORMAL),this._addListener(new Qj(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Dj.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,Dj.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),eX=(function(){function t(){}t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Kj.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?tX.shared:new tX,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}(),function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}()),rX=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),iX=2*Math.PI,nX=180/Math.PI,sX=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(Jj||(Jj={}));var oX=function(){function t(t,e,r,i,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new eX;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new eX;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),o=Math.atan2(r,e),a=Math.abs(s+o);return a<1e-5||Math.abs(iX-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),aX=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],hX=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],uX=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],lX=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],cX=[],dX=[],pX=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];cX.push(e);for(var r=0;r<16;r++)for(var i=pX(aX[t]*aX[r]+uX[t]*hX[r]),n=pX(hX[t]*aX[r]+lX[t]*hX[r]),s=pX(aX[t]*uX[r]+uX[t]*lX[r]),o=pX(hX[t]*uX[r]+lX[t]*lX[r]),a=0;a<16;a++)if(aX[a]===i&&hX[a]===n&&uX[a]===s&&lX[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new oX;h.set(aX[t],hX[t],uX[t],lX[t],0,0),dX.push(h)}}();var fX={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return aX[t]},uY:function(t){return hX[t]},vX:function(t){return uX[t]},vY:function(t){return lX[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return cX[t][e]},sub:function(t,e){return cX[t][fX.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?fX.S:fX.N:2*Math.abs(e)<=Math.abs(t)?t>0?fX.E:fX.W:e>0?t>0?fX.SE:fX.SW:t>0?fX.NE:fX.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=dX[fX.inv(e)];n.tx=r,n.ty=i,t.append(n)}},mX=function(){function t(){this.worldTransform=new oX,this.localTransform=new oX,this.position=new rX(this.onChange,this,0,0),this.scale=new rX(this.onChange,this,1,1),this.pivot=new rX(this.onChange,this,0,0),this.skew=new rX(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),gX=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=Jj.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t}();(function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=Jj.CIRC}t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new gX(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}})(),function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=Jj.ELIP}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new gX(this.x-this.width,this.y-this.height,this.width,this.height)}}(),function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof eX){for(var i=[],n=0,s=(e=e).length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=Jj.POLY,this.closeStroke=!0}t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,s=i-1;n<i;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(r=!r)}return r}}(),function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=Jj.RREC}t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1}}();
/*!
 * @pixi/display - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Dj.SORTABLE_CHILDREN=!1;var yX=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};yX.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},yX.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},yX.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?gX.EMPTY:((t=t||new gX(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},yX.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},yX.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[2])<e?s:e,r=(o=t[3])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[4])<e?s:e,r=(o=t[5])<r?o:r,i=s>i?s:i,n=o>n?o:n,e=(s=t[6])<e?s:e,r=(o=t[7])<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},yX.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},yX.prototype.addFrameMatrix=function(t,e,r,i,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*r+u,g=o*e+h*r+l;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*r+u)<c?m:c,d=(g=o*i+h*r+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*e+a*n+u)<c?m:c,d=(g=o*e+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,c=(m=s*i+a*n+u)<c?m:c,d=(g=o*i+h*n+l)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},yX.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o},yX.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},yX.prototype.addVerticesMatrix=function(t,e,r,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],v=e[g+1],_=o*y+h*v+l,b=u*v+a*y+c;d=Math.min(d,_-n),f=Math.max(f,_+n),p=Math.min(p,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},yX.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},yX.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},yX.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},yX.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},yX.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},yX.prototype.addFramePad=function(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i};var vX=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new mX,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new yX,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},r._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new gX),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new gX),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=e,i},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r.x.get=function(){return this.position.x},r.x.set=function(t){this.transform.position.x=t},r.y.get=function(){return this.position.y},r.y.set=function(t){this.transform.position.y=t},r.worldTransform.get=function(){return this.transform.worldTransform},r.localTransform.get=function(){return this.transform.localTransform},r.position.get=function(){return this.transform.position},r.position.set=function(t){this.transform.position.copyFrom(t)},r.scale.get=function(){return this.transform.scale},r.scale.set=function(t){this.transform.scale.copyFrom(t)},r.pivot.get=function(){return this.transform.pivot},r.pivot.set=function(t){this.transform.pivot.copyFrom(t)},r.skew.get=function(){return this.transform.skew},r.skew.set=function(t){this.transform.skew.copyFrom(t)},r.rotation.get=function(){return this.transform.rotation},r.rotation.set=function(t){this.transform.rotation=t},r.angle.get=function(){return this.transform.rotation*nX},r.angle.set=function(t){this.transform.rotation=t*sX},r.zIndex.get=function(){return this._zIndex},r.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},r.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},r.mask.get=function(){return this._mask},r.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},Object.defineProperties(e.prototype,r),e}(V.a);function _X(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}vX.prototype.displayObjectUpdateTransform=vX.prototype.updateTransform;var bX=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=Dj.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.addChild(e[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);Xj(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,r=arguments.length;if(r>1)for(var i=0;i<r;i++)this.removeChild(e[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,Xj(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Xj(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var r,i=t,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){r=this.children.splice(i,s);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(_X),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},r.width.get=function(){return this.scale.x*this.getLocalBounds().width},r.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},r.height.get=function(){return this.scale.y*this.getLocalBounds().height},r.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,r),e}(vX);bX.prototype.containerUpdateTransform=bX.prototype.updateTransform;
/*!
 * @pixi/core - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var xX=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Zj("setRealSize",2),this.onUpdate=new Zj("update"),this.onError=new Zj("onError",1)},TX={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};xX.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},xX.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},xX.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},TX.valid.get=function(){return!!this._width&&!!this._height},xX.prototype.update=function(){this.destroyed||this.onUpdate.run()},xX.prototype.load=function(){return Promise.resolve()},TX.width.get=function(){return this._width},TX.height.get=function(){return this._height},xX.prototype.upload=function(t,e,r){return!1},xX.prototype.style=function(t,e,r){return!1},xX.prototype.dispose=function(){},xX.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(xX.prototype,TX);var EX=function(t){function e(e){var r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;t.call(this,r,i),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,Yj||(Yj=document.createElement("a")),Yj.href=t;var r=Object(W.parse)(Yj.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,s=e.realWidth,o=e.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Rj.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,r=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(xX),wX=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;t.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==r.createBitmap?r.createBitmap:Dj.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return void 0!==t&&(this.createBitmap=t),this._load?this._load:(this._load=new Promise((function(t){e.url=e.source.src;var r=e.source,i=function(){e.destroyed||(r.onload=null,r.onerror=null,e.resize(r.width,r.height),e._load=null,e.createBitmap?t(e.process()):t(e))};r.complete&&r.src?i():(r.onload=i,r.onerror=function(t){return e.onError.run(t)})})),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===Rj.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in r._glTextures){var o=r._glTextures[s];if(o!==i&&o.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(EX),SX=[];function IX(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=SX.length-1;n>=0;--n){var s=SX[n];if(s.test&&s.test(t,r))return new s(t,e)}return new wX(t,e)}var AX=function(t){function e(e,r){var i=r||{},n=i.width,s=i.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Rj.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,r.internalFormat,e.width,e.height,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(xX),CX={scaleMode:Aj.NEAREST,format:wj.RGBA,alphaMode:Rj.NPM},OX=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null),t.call(this);var i=(r=r||{}).alphaMode,n=r.mipmap,s=r.anisotropicLevel,o=r.scaleMode,a=r.width,h=r.height,u=r.wrapMode,l=r.format,c=r.type,d=r.target,p=r.resolution,f=r.resourceOptions;!e||e instanceof xX||((e=IX(e,f)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||Dj.RESOLUTION,this.mipmap=void 0!==n?n:Dj.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==s?s:Dj.ANISOTROPIC_LEVEL,this.wrapMode=u||Dj.WRAP_MODE,this.scaleMode=void 0!==o?o:Dj.SCALE_MODE,this.format=l||wj.RGBA,this.type=c||Ij.UNSIGNED_BYTE,this.target=d||Sj.TEXTURE_2D,this.alphaMode=void 0!==i?i:Rj.UNPACK,void 0!==r.premultiplyAlpha&&(this.premultiplyAlpha=r.premultiplyAlpha),this.uid=zj(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={realWidth:{configurable:!0},realHeight:{configurable:!0}};return r.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},r.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=Bj(this.realWidth)&&Bj(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Wj[this.cacheId],delete $j[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,r,i){void 0===i&&(i=Dj.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+zj()),s=t._pixiId);var o=Wj[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var s=new AX(t,{width:r,height:i}),o=t instanceof Float32Array?Ij.FLOAT:Ij.UNSIGNED_BYTE;return new e(s,Object.assign(CX,n||{width:r,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Wj[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Wj[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Wj[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Wj[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Wj[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,r),e}(V.a);OX._globalBatch=0;var RX=function(t){function e(e,r){var i;r=r||{};var n=e;Array.isArray(e)&&(i=e,n=e.length),t.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new OX;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,i)for(var a=0;a<n;a++)this.addResourceAt(IX(i[a],r),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Sj.TEXTURE_2D_ARRAY;for(var r=0;r<this.length;r++)this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),r=e.map((function(t){return t.load()}));return this._load=Promise.all(r).then((function(){var r=e[0],i=r.width,n=r.height;return t.resize(i,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var a=0;a<i;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(xX),NX=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(EX),PX=function(t){function e(r,i){if(i=i||{},t.call(this,r,i),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=Sj.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Sj.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},e}(RX);PX.SIDES=6;var MX=function(t){function e(e,r){r=r||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load)},e.prototype._loadSvg=function(){var e=this,r=new Image;t.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(t){r.onerror=null,e.onError.run(t)},r.onload=function(){var t=r.width,i=r.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*e.scale,s=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*t,s=e._overrideHeight||e._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);var o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+zj(),o.getContext("2d").drawImage(r,0,0,t,i,0,0,n,s),e._resolve(),e._resolve=null}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(EX);MX.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var DX=function(t){function e(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(i,e[0].src||e[0],r.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,s.src=a,s.type=h,i.appendChild(s)}e=i}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==r.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=tX.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(tX.shared.add(this.update,this),this._isAutoUpdating=!0)},e.prototype._onPlayStop=function(){this._isAutoUpdating&&(tX.shared.remove(this.update,this),this._isAutoUpdating=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isAutoUpdating&&tX.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},r.autoUpdate.get=function(){return this._autoUpdate},r.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(tX.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(tX.shared.add(this.update,this),this._isAutoUpdating=!0))},r.updateFPS.get=function(){return this._updateFPS},r.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},Object.defineProperties(e.prototype,r),e}(EX);DX.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var FX=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(EX);SX.push(wX,FX,NX,DX,MX,AX,PX,RX);var LX=function(t){this.renderer=t};LX.prototype.destroy=function(){this.renderer=null};var kX=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,r){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Rj.UNPACK),r.width===e.width&&r.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(r.width=e.width,r.height=e.height,i.texImage2D(e.target,0,i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(AX),UX=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Zj("disposeFramebuffer",2)},BX={colorTexture:{configurable:!0}};BX.colorTexture.get=function(){return this.colorTextures[0]},UX.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new OX(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},UX.prototype.addDepthTexture=function(t){return this.depthTexture=t||new OX(new kX(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:wj.DEPTH_COMPONENT,type:Ij.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},UX.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},UX.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},UX.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},UX.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(UX.prototype,BX);var jX=function(t){function e(e){if("number"==typeof e){var r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new UX(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(OX),XX=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};XX.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var s=t.width/2/i,o=t.height/2/n,a=t.x/i+s,h=t.y/n+o;r=fX.add(r,fX.NW),this.x0=a+s*fX.uX(r),this.y0=h+o*fX.uY(r),r=fX.add(r,2),this.x1=a+s*fX.uX(r),this.y1=h+o*fX.uY(r),r=fX.add(r,2),this.x2=a+s*fX.uX(r),this.y2=h+o*fX.uY(r),r=fX.add(r,2),this.x3=a+s*fX.uX(r),this.y3=h+o*fX.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var GX=new XX,zX=function(t){function e(r,i,n,s,o,a){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new gX(0,0,1,1)),r instanceof e&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=GX,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new eX(a.x,a.y):new eX(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&$j[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===GX&&(this._uvs=new XX),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=Dj.STRICT_TEXTURE_CACHE);var n="string"==typeof t,s=null;n?s=t:(t._pixiId||(t._pixiId="pixiid_"+zj()),s=t._pixiId);var o=$j[s];if(n&&i&&!o)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=qj(t)),(o=new e(new OX(t,r))).baseTexture.cacheId=s,OX.addToCache(o.baseTexture,s),e.addToCache(o,s)),o},e.fromBuffer=function(t,r,i,n){return new e(OX.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new wX(t);n.url=r;var s=new e(new OX(n,{scaleMode:Dj.SCALE_MODE,resolution:qj(r)}));return i||(i=r),OX.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==r&&(OX.addToCache(s.baseTexture,r),e.addToCache(s,r)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),$j[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),$j[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=$j[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete $j[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)$j[t.textureCacheIds[i]]===t&&delete $j[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r.resolution.get=function(){return this.baseTexture.resolution},r.frame.get=function(){return this._frame},r.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,s=e+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},r.rotate.get=function(){return this._rotate},r.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},r.width.get=function(){return this.orig.width},r.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,r),e}(V.a);function VX(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}zX.EMPTY=new zX(new OX),VX(zX.EMPTY),VX(zX.EMPTY.baseTexture),zX.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new zX(new OX(new NX(t)))}(),VX(zX.WHITE),VX(zX.WHITE.baseTexture);var HX=function(t){function e(e,r){var i=null;if(!(e instanceof jX)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,e=new jX({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new jX(t))},e}(zX),$X=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};$X.prototype.createTexture=function(t,e){var r=new jX(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new HX(r)},$X.prototype.getOptimalTexture=function(t,e,r){void 0===r&&(r=1);var i=$X.SCREEN_KEY;t*=r,e*=r,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(i=(65535&(t=Uj(t)))<<16|65535&(e=Uj(e))),this.texturePool[i]||(this.texturePool[i]=[]);var n=this.texturePool[i].pop();return n||(n=this.createTexture(t,e)),n.filterPoolKey=i,n.setResolution(r),n},$X.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},$X.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},$X.prototype.returnFilterTexture=function(t){this.returnTexture(t)},$X.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},$X.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=$X.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},$X.SCREEN_KEY="screen";var WX=function(t,e,r,i,n,s,o){void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o};WX.prototype.destroy=function(){this.buffer=null},WX.from=function(t,e,r,i,n){return new WX(t,e,r,i,n)};var YX=0,qX=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=YX++,this.disposeRunner=new Zj("disposeBuffer",2)};function KX(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}qX.prototype.update=function(t){this.data=t||this.data,this._updateID++},qX.prototype.dispose=function(){this.disposeRunner.run(this,!1)},qX.prototype.destroy=function(){this.dispose(),this.data=null},qX.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new qX(t)};var ZX={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var JX={5126:4,5123:2,5121:1},QX=0,tG={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},eG=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=QX++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Zj("disposeGeometry",2),this.refCount=0};eG.prototype.addAttribute=function(t,e,r,i,n,s,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new qX(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new WX(l,r,i,n,s,o,a),this.instanced=this.instanced||a,this},eG.prototype.getAttribute=function(t){return this.attributes[t]},eG.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},eG.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new qX(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},eG.prototype.getIndex=function(){return this.indexBuffer},eG.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new qX;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),r.push(n.size*JX[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},s=0;s<t.length;s++)i+=e[s],r+=t[s].length;for(var o=new ArrayBuffer(4*r),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=KX(c);n[d]||(n[d]=new ZX[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*i+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},eG.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},eG.prototype.dispose=function(){this.disposeRunner.run(this,!1)},eG.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},eG.prototype.clone=function(){for(var t=new eG,e=0;e<this.buffers.length;e++)t.buffers[e]=new qX(this.buffers[e].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new WX(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},eG.merge=function(t){for(var e,r=new eG,i=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)i[h]=new(tG[KX(e.buffers[h].data)])(n[h]),r.buffers[h]=new qX(i[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)i[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*JX[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,b=0;b<_.length;b++)r.indexBuffer.data[b+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return r};var rG=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(eG),iG=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new qX(this.vertices),this.uvBuffer=new qX(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(eG),nG=0,sG=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=nG++,this.static=!!e};sG.prototype.update=function(){this.dirtyId++},sG.prototype.add=function(t,e,r){this.uniforms[t]=new sG(e,r)},sG.from=function(t,e){return new sG(t,e)};var oG=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new gX,this.destinationFrame=new gX,this.filters=[]};oG.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var aG=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new $X,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new rG,this.quadUv=new iG,this.tempRect=new gX,this.activeState={},this.globalUniforms=new sG({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=e.view.width,this._pixelsHeight=e.view.height}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new oG,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame),r.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.renderTexture.bind(r,r?r.filterFrame:null),i&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Ej.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Ej.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(oX.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(LX),hG=function(t){this.renderer=t};hG.prototype.flush=function(){},hG.prototype.destroy=function(){this.renderer=null},hG.prototype.start=function(){},hG.prototype.stop=function(){this.flush()},hG.prototype.render=function(t){};var uG=function(t){function e(e){t.call(this,e),this.emptyRenderer=new hG(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(LX);Dj.PREFER_ENV=_j.any?bj.WEBGL:bj.WEBGL2,Dj.STRICT_TEXTURE_CACHE=!1;var lG=0,cG=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={isLost:{configurable:!0}};return r.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=lG++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=lG++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var r;if(Dj.PREFER_ENV>=bj.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),r},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,r),e}(LX),dG=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new UX(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new gX,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;Dj.PREFER_ENV===bj.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},r.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,r,i){var n=this.gl;n.clearColor(t,e,r,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1));for(var n=[],s=0;s<i;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},e.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new gX},Object.defineProperties(e.prototype,r),e}(LX),pG=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},fG={5126:4,5123:2,5121:1},mG=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;Dj.PREFER_ENV===bj.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,s){return i.drawElementsInstancedANGLE(t,e,r,n,s)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var s=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(s,0,i.data);else{var o=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(s,i.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var s in r)i[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*fG[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*fG[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*fG[f.type])}o=r.createVertexArray(),r.bindVertexArray(o);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[i]||(y._glBuffers[i]=new pG(r.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in r)if("g"===a[0]){var h=r[a];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(var i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[i];if(e.attributeData[a]){o!==u&&(r.bindBuffer(r.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,r,i){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(LX),gG=function(t){this.type=Mj.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function yG(t,e,r,i){var n=vG(t,t.VERTEX_SHADER,e),s=vG(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),i)for(var a in i)t.bindAttribLocation(o,i[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function vG(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function _G(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return bG(2*e);case"bvec3":return bG(3*e);case"bvec4":return bG(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function bG(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}gG.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Mj.NONE,this.autoDetect=!0),this._target=null},gG.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var xG,TG={},EG=TG;function wG(){if(EG===TG||EG&&EG.isContextLost()){var t,e=document.createElement("canvas");Dj.PREFER_ENV>=bj.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),EG=t}return EG}function SG(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===Pj.HIGH&&r!==Pj.HIGH&&(i=Pj.MEDIUM),"precision "+i+" float;\n"+t}return r!==Pj.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var IG={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function AG(t){return IG[t]}var CG=null,OG={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function RG(t,e){if(!CG){var r=Object.keys(OG);CG={};for(var i=0;i<r.length;++i){var n=r[i];CG[t[n]]=OG[n]}}return CG[e]}var NG={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},PG={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var MG,DG=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function FG(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var LG=0,kG={},UG=function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=LG++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),kG[i]?(kG[i]++,i+="-"+kG[i]):kG[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=SG(this.vertexSrc,Dj.PRECISION_VERTEX,Pj.HIGH),this.fragmentSrc=SG(this.fragmentSrc,Dj.PRECISION_FRAGMENT,function(){if(!xG){xG=Pj.MEDIUM;var t=wG();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);xG=e.precision?Pj.HIGH:Pj.MEDIUM}}return xG}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},BG={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};UG.prototype.extractData=function(t,e){var r=wG();if(r){var i=yG(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},UG.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=RG(e,o.type),h={type:a,name:o.name,size:AG(a),location:0};r[o.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(var u=0;u<i.length;u++)i[u].location=u;return r},UG.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=RG(e,s.type);r[o]={type:h,size:s.size,isArray:a,value:_G(h,s.size)}}return r},BG.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},BG.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},UG.from=function(t,e,r){var i=t+e,n=Hj[i];return n||(Hj[i]=n=new UG(t,e,r)),n},Object.defineProperties(UG,BG);var jG=function(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof sG?e:new sG(e):new sG({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},XG={uniforms:{configurable:!0}};jG.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},jG.prototype.destroy=function(){this.uniformGroup=null},XG.uniforms.get=function(){return this.uniformGroup.uniforms},jG.from=function(t,e,r){var i=UG.from(t,e);return new jG(i,r)},Object.defineProperties(jG.prototype,XG);var GG=function(){this.data=0,this.blendMode=Tj.NORMAL,this.polygonOffset=0,this.blend=!0},zG={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};zG.blend.get=function(){return!!(1&this.data)},zG.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},zG.offsets.get=function(){return!!(2&this.data)},zG.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},zG.culling.get=function(){return!!(4&this.data)},zG.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},zG.depthTest.get=function(){return!!(8&this.data)},zG.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},zG.clockwiseFrontFace.get=function(){return!!(16&this.data)},zG.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},zG.blendMode.get=function(){return this._blendMode},zG.blendMode.set=function(t){this.blend=t!==Tj.NONE,this._blendMode=t},zG.polygonOffset.get=function(){return this._polygonOffset},zG.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},GG.for2d=function(){var t=new GG;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(GG.prototype,zG);var VG=function(t){function e(r,i,n){var s=UG.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=Dj.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new GG}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i,n)},r.blendMode.get=function(){return this.state.blendMode},r.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,r),Object.defineProperties(e,i),e}(jG);VG.SOURCE_KEY_MAP={};var HG=new oX,$G=function(t,e){this._texture=t,this.mapCoord=new oX,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},WG={texture:{configurable:!0}};WG.texture.get=function(){return this._texture},WG.texture.set=function(t){this._texture=t,this._updateID=-1},$G.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e},$G.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(HG.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(HG));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties($G.prototype,WG);var YG=function(t){function e(e){var r=new oX;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new $G(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,r,i))},e}(VG),qG=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var r=this.maskDataPool.pop()||new gG;r.pooled=!0,r.maskObject=e,e=r}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case Mj.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case Mj.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case Mj.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Mj.SCISSOR:this.renderer.scissor.pop();break;case Mj.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Mj.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Mj.SPRITE;else if(t.type=Mj.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(t.type=Mj.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new YG(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(LX),KG=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(LX),ZG=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,s=r.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;i&&(a+=i.tx*o,h+=i.ty*o),e||(h=this.renderer.height-l-h),this.renderer.gl.scissor(a,h,u,l)},e}(KG),JG=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(KG),QG=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new oX,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix;i?(n.a=1/t.width*2*r,n.d=-1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*r,n.d=1/t.height*2*r,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(LX),tz=new gX,ez=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new gX,this.destinationFrame=new gX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,r){void 0===t&&(t=null),this.current=t;var i,n=this.renderer;if(t){var s=t.baseTexture;i=s.resolution,r||(tz.width=s.realWidth,tz.height=s.realHeight,r=tz),e||(e=r),this.renderer.framebuffer.bind(s.framebuffer,r),this.renderer.projection.update(r,e,i,!1),this.renderer.mask.setMaskStack(s.maskStack)}else i=this.renderer.resolution,r||(tz.width=n.width,tz.height=n.height,r=tz),e||(e=r),n.framebuffer.bind(null,r),this.renderer.projection.update(r,e,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=r.x/i,this.destinationFrame.y=r.y/i,this.destinationFrame.width=r.width/i,this.destinationFrame.height=r.height/i,e===r&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(LX),rz=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};rz.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var iz=0,nz={textureCount:0},sz=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=iz++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof MG)return MG;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");MG=!0===t({a:"b"},"a","b")}catch(t){MG=!1}return MG}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(nz.textureCount=0,this.syncUniformGroup(t.uniformGroup,nz)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var i in t.uniforms){var n=e[i];if(n)if("float"===n.type&&1===n.size)r+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[i].a?r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[i].x?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[i].width?r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{r+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+(1===n.size?NG:PG)[n.type].replace("location","ud."+i+".location")+";\n"}else r+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+i+", t);\n            \n            if(ud."+i+".value !== t)\n            {\n                ud."+i+".value = t;\n                gl.uniform1i(ud."+i+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[i].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var s=yG(e,r.vertexSrc,r.fragmentSrc,i),o={};for(var a in r.uniformData){var h=r.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:_G(h.type,h.size)}}var u=new rz(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(LX);var oz=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Tj.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new GG,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[Tj.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.ADD]=[t.ONE,t.ONE],e[Tj.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.NONE]=[0,0],e[Tj.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Tj.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Tj.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Tj.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Tj.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Tj.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Tj.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Tj.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Tj.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Tj.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Tj.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(LX),az=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=Dj.GC_MAX_IDLE,this.checkCountMax=Dj.GC_MAX_CHECK_COUNT,this.mode=Dj.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Nj.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(LX),hz=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},uz=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new OX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new hz(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new hz(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(var n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),r[n]=null)},e.prototype.initTexture=function(t){var e=new hz(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var r=this.renderer.gl;t.type===r.FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA32F),t.type===Ij.HALF_FLOAT&&(e.type=r.HALF_FLOAT),e.type===r.HALF_FLOAT&&t.format===r.RGBA&&(e.internalFormat=r.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&Xj(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==Oj.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=Cj.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Aj.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode?r.LINEAR:r.NEAREST)},e}(LX),lz=new oX;V.a;var cz=function(){this.texArray=null,this.blend=0,this.type=Ej.TRIANGLES,this.start=0,this.size=0,this.data=null},dz=function(){this.elements=[],this.ids=[],this.count=0};dz.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var pz=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},fz={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};fz.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},fz.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},fz.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},fz.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},fz.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},pz.prototype.view=function(t){return this[t+"View"]},pz.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},pz.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(pz.prototype,fz);var mz=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=GG.for2d(),this.size=4*Dj.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;Dj.PREFER_ENV===bj.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Dj.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=DG.replace(/%forloop%/gi,FG(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new cz);for(;r.length<n;)r.push(new dz);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++OX._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,s,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;OX._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this._bufferedElements,s=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,h=e._drawCallPool,u=this._dcIndex,l=this._aIndex,c=this._iIndex,d=h[u];d.start=this._iIndex,d.texArray=t;for(var p=r;p<i;++p){var f=n[p],m=f._texture.baseTexture,g=kj[m.alphaMode?1:0][f.blendMode];n[p]=null,r<p&&d.blend!==g&&(d.size=c-d.start,r=p,(d=h[++u]).texArray=t,d.start=c),this.packInterleavedGeometry(f,s,o,l,c),l+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=g}r<i&&(d.size=c-d.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=c},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;Dj.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Dj.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=Uj(Math.ceil(t/8)),r=jj(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new pz(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=Uj(Math.ceil(t/12)),r=jj(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(var m=0;m<u.length;m++)r[n++]=a+u[m]},e}(hG);mz._drawCallPool=[],mz._textureArrayPool=[];var gz=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};gz.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=sG.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new UG(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new oX,default:this.defaultGroupCache[t]};return new jG(this.programCache[t],n)},gz.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var yz=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new qX(null,e,!1),this._indexBuffer=new qX(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Ij.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Ij.FLOAT).addAttribute("aColor",this._buffer,4,!0,Ij.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Ij.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(eG),vz="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",_z="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",bz=function(){},xz={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};bz.create=function(t){var e=Object.assign({vertex:vz,fragment:_z,geometryClass:yz,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new gz(r,i),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(mz)},xz.defaultVertexSrc.get=function(){return vz},xz.defaultFragmentTemplate.get=function(){return _z},Object.defineProperties(bz,xz);bz.create();
/*!
 * @pixi/loaders - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Tz=function(){};Tz.use=function(t,e){t.data&&t.type===Zi.TYPE.IMAGE&&(t.texture=zX.fromLoader(t.data,t.url,t.name)),e()};var Ez=function(t){function e(r,i){var n=this;t.call(this,r,i),V.a.call(this);for(var s=0;s<e._plugins.length;++s){var o=e._plugins[s],a=o.pre,h=o.use;a&&this.pre(a),h&&this.use(h)}this.onStart.add((function(t){return n.emit("start",t)})),this.onProgress.add((function(t,e){return n.emit("progress",t,e)})),this.onError.add((function(t,e,r){return n.emit("error",t,e,r)})),this.onLoad.add((function(t,e){return n.emit("load",t,e)})),this.onComplete.add((function(t,e){return n.emit("complete",t,e)})),this._protected=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={shared:{configurable:!0}};return e.prototype.destroy=function(){this._protected||(this.removeAllListeners(),this.reset())},r.shared.get=function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},Object.defineProperties(e,r),e}(nn);Object.assign(Ez.prototype,V.a.prototype),Ez._plugins=[],Ez.registerPlugin=function(t){return Ez._plugins.push(t),t.add&&t.add(),Ez},Ez.registerPlugin({use:en.parsing}),Ez.registerPlugin(Tz);var wz=function(){};wz.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Ez.shared:new Ez},wz.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)};var Sz=Zi,Iz=function(){function t(t,e){this._output=e,this._input=t}return Object.defineProperty(t.prototype,"destination",{get:function(){return this._input},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._filters},set:function(t){var e=this;if(this._filters&&(this._filters.forEach((function(t){t&&t.disconnect()})),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();var r=null;t.forEach((function(t){null===r?e._input.connect(t.destination):r.connect(t.destination),r=t})),r.connect(this._output)}},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.filters=null,this._input=null,this._output=null},t}(),Az=function(){function t(t,e){this.init(t,e)}return t.prototype.init=function(t,e){this.destination=t,this.source=e||t},t.prototype.connect=function(t){this.source.connect(t)},t.prototype.disconnect=function(){this.source.disconnect()},t.prototype.destroy=function(){this.disconnect(),this.destination=null,this.source=null},t}(),Cz=function(t,e){return(Cz=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/*!
 * pixi-sound - v3.0.4
 * https://github.com/pixijs/pixi-sound
 * Compiled Thu, 07 Nov 2019 23:26:22 UTC
 *
 * pixi-sound is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */function Oz(t,e){function r(){this.constructor=t}Cz(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Rz,Nz=function(){return(Nz=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function Pz(){return Rz}var Mz,Dz,Fz,Lz,kz=function(){function t(){}return t.setParamValue=function(t,e){if(t.setValueAtTime){var r=Pz().context;t.setValueAtTime(e,r.audioContext.currentTime)}else t.value=e;return e},t}(),Uz=0,Bz=function(t){function e(e){var r=t.call(this)||this;return r.id=Uz++,r._media=null,r._paused=!1,r._muted=!1,r._elapsed=0,r.init(e),r}return Oz(e,t),e.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");return this[t]=e,this},e.prototype.stop=function(){this._source&&(this._internalStop(),this.emit("stop"))},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh(),this._update(!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){if(this._source){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var r=t.volume*(t.muted?0:1),i=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);kz.setParamValue(this._gain.gain,n*i*r),kz.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed)}},e.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,r=this._paused||e.paused||t.paused;r!==this._pausedReal&&(this._pausedReal=r,r?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",r))},e.prototype.play=function(t){var e=t.start,r=t.end,i=t.speed,n=t.loop,s=t.volume,o=t.muted;this._paused=!1;var a=this._media.nodes.cloneBufferSource(),h=a.source,u=a.gain;this._source=h,this._gain=u,this._speed=i,this._volume=s,this._loop=!!n,this._muted=o,this.refresh();var l=this._source.buffer.duration;this._duration=l,this._end=r,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=r,this._source.loopStart=e,this._source.start(0,e)):r?this._source.start(0,e,r-e):this._source.start(0,e),this.emit("start"),this._update(!0),this._enabled=!0},e.prototype._toSec=function(t){return t>10&&(t/=1e3),t||0},Object.defineProperty(e.prototype,"_enabled",{set:function(t){tX.shared.remove(this._updateListener,this),t&&tX.shared.add(this._updateListener,this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1},e.prototype.toString=function(){return"[WebAudioInstance id="+this.id+"]"},e.prototype._now=function(){return this._media.context.audioContext.currentTime},e.prototype._updateListener=function(){this._update()},e.prototype._update=function(t){if(void 0===t&&(t=!1),this._source){var e=this._now(),r=e-this._lastUpdate;if(r>0||t){var i=this._source.playbackRate.value;this._elapsed+=r*i,this._lastUpdate=e;var n=this._duration,s=void 0;if(this._source.loopStart){var o=this._source.loopEnd-this._source.loopStart;s=(this._source.loopStart+this._elapsed%o)/n}else s=this._elapsed%n/n;this._progress=s,this.emit("progress",this._progress,n)}}},e.prototype.init=function(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)},e.prototype._internalStop=function(){this._source&&(this._enabled=!1,this._source.onended=null,this._source.stop(0),this._source.disconnect(),this._source=null)},e.prototype._onComplete=function(){this._source&&(this._enabled=!1,this._source.onended=null,this._source.disconnect()),this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)},e}(V.a),jz=function(t){function e(e){var r=this,i=e.audioContext,n=i.createBufferSource(),s=i.createGain(),o=i.createAnalyser();return n.connect(o),o.connect(s),s.connect(e.destination),(r=t.call(this,o,s)||this).context=e,r.bufferSource=n,r.gain=s,r.analyser=o,r}return Oz(e,t),Object.defineProperty(e.prototype,"script",{get:function(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(e.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null},e.prototype.cloneBufferSource=function(){var t=this.bufferSource,e=this.context.audioContext.createBufferSource();e.buffer=t.buffer,kz.setParamValue(e.playbackRate,t.playbackRate.value),e.loop=t.loop;var r=this.context.audioContext.createGain();return e.connect(r),r.connect(this.destination),{source:e,gain:r}},Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this.script.bufferSize},enumerable:!0,configurable:!0}),e.BUFFER_SIZE=0,e}(Iz),Xz=function(){function t(){}return t.prototype.init=function(t){this.parent=t,this._nodes=new jz(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source},t.prototype.destroy=function(){this.parent=null,this._nodes.destroy(),this._nodes=null,this._source=null,this.source=null},t.prototype.create=function(){return new Bz(this)},Object.defineProperty(t.prototype,"context",{get:function(){return this.parent.context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlayable",{get:function(){return!!this._source&&!!this._source.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._nodes.filters},set:function(t){this._nodes.filters=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._source.buffer.duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this._source.buffer},set:function(t){this._source.buffer=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nodes",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),t.prototype.load=function(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t&&t(new Error("sound.url or sound.source must be set"))},t.prototype._loadUrl=function(t){var e=this,r=new XMLHttpRequest,i=this.parent.url;r.open("GET",i,!0),r.responseType="arraybuffer",r.onload=function(){e.source=r.response,e._decode(r.response,t)},r.send()},t.prototype._decode=function(t,e){var r=this;this.parent.context.decode(t,(function(t,i){if(t)e&&e(t);else{r.parent.isLoaded=!0,r.buffer=i;var n=r.parent.autoPlayStart();e&&e(null,r.parent,n)}}))},t}(),Gz=function(t){function e(){var r=this,i=window,n=new e.AudioContext,s=n.createDynamicsCompressor(),o=n.createAnalyser();return o.connect(s),s.connect(n.destination),(r=t.call(this,o,s)||this)._ctx=n,r._offlineCtx=new e.OfflineAudioContext(1,2,i.OfflineAudioContext?n.sampleRate:44100),r._unlocked=!1,r.compressor=s,r.analyser=o,r.events=new V.a,r.volume=1,r.speed=1,r.muted=!1,r.paused=!1,"running"!==n.state&&(r._unlock(),r._unlock=r._unlock.bind(r),document.addEventListener("mousedown",r._unlock,!0),document.addEventListener("touchstart",r._unlock,!0),document.addEventListener("touchend",r._unlock,!0)),r}return Oz(e,t),e.prototype._unlock=function(){this._unlocked||(this.playEmptySound(),"running"===this._ctx.state&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))},e.prototype.playEmptySound=function(){var t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),"suspended"===t.context.state&&t.context.resume()},Object.defineProperty(e,"AudioContext",{get:function(){var t=window;return t.AudioContext||t.webkitAudioContext||null},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OfflineAudioContext",{get:function(){var t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this);var e=this._ctx;void 0!==e.close&&e.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null},Object.defineProperty(e.prototype,"audioContext",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offlineContext",{get:function(){return this._offlineCtx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){t&&"running"===this._ctx.state?this._ctx.suspend():t||"suspended"!==this._ctx.state||this._ctx.resume(),this._paused=t},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){this.events.emit("refresh")},e.prototype.refreshPaused=function(){this.events.emit("refreshPaused")},e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this._paused},e.prototype.decode=function(t,e){this._offlineCtx.decodeAudioData(t,(function(t){e(null,t)}),(function(t){e(new Error(t.message||"Unable to decode file"))}))},e}(Iz),zz={WebAudioMedia:Xz,WebAudioInstance:Bz,WebAudioNodes:jz,WebAudioContext:Gz,WebAudioUtils:kz},Vz={Filter:Az,EqualizerFilter:function(t){function e(r,i,n,s,o,a,h,u,l,c){void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),void 0===u&&(u=0),void 0===l&&(l=0),void 0===c&&(c=0);var d=this;if(!Pz().useLegacy){var p=[{f:e.F32,type:"lowshelf",gain:r},{f:e.F64,type:"peaking",gain:i},{f:e.F125,type:"peaking",gain:n},{f:e.F250,type:"peaking",gain:s},{f:e.F500,type:"peaking",gain:o},{f:e.F1K,type:"peaking",gain:a},{f:e.F2K,type:"peaking",gain:h},{f:e.F4K,type:"peaking",gain:u},{f:e.F8K,type:"peaking",gain:l},{f:e.F16K,type:"highshelf",gain:c}].map((function(t){var e=Pz().context.audioContext.createBiquadFilter();return e.type=t.type,kz.setParamValue(e.Q,1),e.frequency.value=t.f,kz.setParamValue(e.gain,t.gain),e}));(d=t.call(this,p[0],p[p.length-1])||this).bands=p,d.bandsMap={};for(var f=0;f<d.bands.length;f++){var m=d.bands[f];f>0&&d.bands[f-1].connect(m),d.bandsMap[m.frequency.value]=m}return d}d=t.call(this,null)||this}return Oz(e,t),e.prototype.setGain=function(t,e){if(void 0===e&&(e=0),!this.bandsMap[t])throw new Error("No band found for frequency "+t);kz.setParamValue(this.bandsMap[t].gain,e)},e.prototype.getGain=function(t){if(!this.bandsMap[t])throw new Error("No band found for frequency "+t);return this.bandsMap[t].gain.value},Object.defineProperty(e.prototype,"f32",{get:function(){return this.getGain(e.F32)},set:function(t){this.setGain(e.F32,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f64",{get:function(){return this.getGain(e.F64)},set:function(t){this.setGain(e.F64,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f125",{get:function(){return this.getGain(e.F125)},set:function(t){this.setGain(e.F125,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f250",{get:function(){return this.getGain(e.F250)},set:function(t){this.setGain(e.F250,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f500",{get:function(){return this.getGain(e.F500)},set:function(t){this.setGain(e.F500,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f1k",{get:function(){return this.getGain(e.F1K)},set:function(t){this.setGain(e.F1K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f2k",{get:function(){return this.getGain(e.F2K)},set:function(t){this.setGain(e.F2K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f4k",{get:function(){return this.getGain(e.F4K)},set:function(t){this.setGain(e.F4K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f8k",{get:function(){return this.getGain(e.F8K)},set:function(t){this.setGain(e.F8K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f16k",{get:function(){return this.getGain(e.F16K)},set:function(t){this.setGain(e.F16K,t)},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.bands.forEach((function(t){kz.setParamValue(t.gain,0)}))},e.prototype.destroy=function(){this.bands.forEach((function(t){t.disconnect()})),this.bands=null,this.bandsMap=null},e.F32=32,e.F64=64,e.F125=125,e.F250=250,e.F500=500,e.F1K=1e3,e.F2K=2e3,e.F4K=4e3,e.F8K=8e3,e.F16K=16e3,e}(Az),DistortionFilter:function(t){function e(e){void 0===e&&(e=0);var r=this;if(!Pz().useLegacy){var i=Pz().context.audioContext.createWaveShaper();return(r=t.call(this,i)||this)._distortion=i,r.amount=e,r}r=t.call(this,null)||this}return Oz(e,t),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount},set:function(t){t*=1e3,this._amount=t;for(var e,r=new Float32Array(44100),i=Math.PI/180,n=0;n<44100;++n)e=2*n/44100-1,r[n]=(3+t)*e*20*i/(Math.PI+t*Math.abs(e));this._distortion.curve=r,this._distortion.oversample="4x"},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._distortion=null,t.prototype.destroy.call(this)},e}(Az),StereoFilter:function(t){function e(e){void 0===e&&(e=0);var r=this;if(!Pz().useLegacy){var i,n,s,o=Pz().context.audioContext;return o.createStereoPanner?s=i=o.createStereoPanner():((n=o.createPanner()).panningModel="equalpower",s=n),(r=t.call(this,s)||this)._stereo=i,r._panner=n,r.pan=e,r}r=t.call(this,null)||this}return Oz(e,t),Object.defineProperty(e.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan=t,this._stereo?kz.setParamValue(this._stereo.pan,t):this._panner.setPosition(t,0,1-Math.abs(t))},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this._stereo=null,this._panner=null},e}(Az),ReverbFilter:function(t){function e(e,r,i){void 0===e&&(e=3),void 0===r&&(r=2),void 0===i&&(i=!1);var n=this;if(!Pz().useLegacy)return(n=t.call(this,null)||this)._seconds=n._clamp(e,1,50),n._decay=n._clamp(r,0,100),n._reverse=i,n._rebuild(),n;n=t.call(this,null)||this}return Oz(e,t),e.prototype._clamp=function(t,e,r){return Math.min(r,Math.max(e,t))},Object.defineProperty(e.prototype,"seconds",{get:function(){return this._seconds},set:function(t){this._seconds=this._clamp(t,1,50),this._rebuild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"decay",{get:function(){return this._decay},set:function(t){this._decay=this._clamp(t,0,100),this._rebuild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this._reverse},set:function(t){this._reverse=t,this._rebuild()},enumerable:!0,configurable:!0}),e.prototype._rebuild=function(){for(var t,e=Pz().context.audioContext,r=e.sampleRate,i=r*this._seconds,n=e.createBuffer(2,i,r),s=n.getChannelData(0),o=n.getChannelData(1),a=0;a<i;a++)t=this._reverse?i-a:a,s[a]=(2*Math.random()-1)*Math.pow(1-t/i,this._decay),o[a]=(2*Math.random()-1)*Math.pow(1-t/i,this._decay);var h=Pz().context.audioContext.createConvolver();h.buffer=n,this.init(h)},e}(Az),MonoFilter:function(t){function e(){var e=this;if(!Pz().useLegacy){var r=Pz().context.audioContext,i=r.createChannelSplitter(),n=r.createChannelMerger();return n.connect(i),(e=t.call(this,n,i)||this)._merger=n,e}e=t.call(this,null)||this}return Oz(e,t),e.prototype.destroy=function(){this._merger.disconnect(),this._merger=null,t.prototype.destroy.call(this)},e}(Az),TelephoneFilter:function(t){function e(){if(!Pz().useLegacy){var e=Pz().context.audioContext,r=e.createBiquadFilter(),i=e.createBiquadFilter(),n=e.createBiquadFilter(),s=e.createBiquadFilter();return r.type="lowpass",kz.setParamValue(r.frequency,2e3),i.type="lowpass",kz.setParamValue(i.frequency,2e3),n.type="highpass",kz.setParamValue(n.frequency,500),s.type="highpass",kz.setParamValue(s.frequency,500),r.connect(i),i.connect(n),n.connect(s),t.call(this,r,s)||this}t.call(this,null)}return Oz(e,t),e}(Az)},Hz=0,$z=function(t){function e(e){var r=t.call(this)||this;return r.id=Hz++,r.init(e),r}return Oz(e,t),e.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");return this[t]=e,this},Object.defineProperty(e.prototype,"progress",{get:function(){return this._source.currentTime/this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),e.prototype._onPlay=function(){this._playing=!0},e.prototype._onPause=function(){this._playing=!1},e.prototype.init=function(t){this._playing=!1,this._duration=t.source.duration;var e=this._source=t.source.cloneNode(!1);e.src=t.parent.url,e.onplay=this._onPlay.bind(this),e.onpause=this._onPause.bind(this),t.context.on("refresh",this.refresh,this),t.context.on("refreshPaused",this.refreshPaused,this),this._media=t},e.prototype._internalStop=function(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())},e.prototype.stop=function(){this._internalStop(),this._source&&this.emit("stop")},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var r=t.volume*(t.muted?0:1),i=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);this._source.volume=n*r*i,this._source.playbackRate=this._speed*t.speed*e.speed},e.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,r=this._paused||e.paused||t.paused;r!==this._pausedReal&&(this._pausedReal=r,r?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",r))},e.prototype.play=function(t){var r=this,i=t.start,n=t.end,s=t.speed,o=t.loop,a=t.volume,h=t.muted;this._speed=s,this._volume=a,this._loop=!!o,this._muted=h,this.refresh(),this.loop&&null!==n&&(this.loop=!1),this._start=i,this._end=n||this._duration,this._start=Math.max(0,this._start-e.PADDING),this._end=Math.min(this._end+e.PADDING,this._duration),this._source.onloadedmetadata=function(){r._source&&(r._source.currentTime=i,r._source.onloadedmetadata=null,r.emit("progress",i,r._duration),tX.shared.add(r._onUpdate,r))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")},e.prototype._onUpdate=function(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()},e.prototype._onComplete=function(){tX.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)},e.prototype.destroy=function(){tX.shared.remove(this._onUpdate,this),this.removeAllListeners();var t=this._source;t&&(t.onended=null,t.onplay=null,t.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)},e.prototype.toString=function(){return"[HTMLAudioInstance id="+this.id+"]"},e.PADDING=.1,e}(V.a),Wz=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Oz(e,t),e.prototype.init=function(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)},e.prototype.create=function(){return new $z(this)},Object.defineProperty(e.prototype,"isPlayable",{get:function(){return!!this._source&&4===this._source.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._source.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this.parent.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.load=function(t){var e=this._source,r=this.parent;if(4!==e.readyState){if(!r.url)return t(new Error("sound.url or sound.source must be set"));e.src=r.url;var i=function(){e.removeEventListener("canplaythrough",n),e.removeEventListener("load",n),e.removeEventListener("abort",s),e.removeEventListener("error",o)},n=function(){i(),r.isLoaded=!0;var e=r.autoPlayStart();t&&t(null,r,e)},s=function(){i(),t&&t(new Error("Sound loading has been aborted"))},o=function(){i();var r="Failed to load audio element (code: "+e.error.code+")";t&&t(new Error(r))};e.addEventListener("canplaythrough",n,!1),e.addEventListener("load",n,!1),e.addEventListener("abort",s,!1),e.addEventListener("error",o,!1),e.load()}else{r.isLoaded=!0;var a=r.autoPlayStart();t&&setTimeout((function(){t(null,r,a)}),0)}},e}(V.a),Yz=function(t){function e(){var e=t.call(this)||this;return e.speed=1,e.volume=1,e.muted=!1,e.paused=!1,e}return Oz(e,t),e.prototype.refresh=function(){this.emit("refresh")},e.prototype.refreshPaused=function(){this.emit("refreshPaused")},Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioContext",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this.paused},e.prototype.destroy=function(){this.removeAllListeners()},e}(V.a),qz={HTMLAudioMedia:Wz,HTMLAudioInstance:$z,HTMLAudioContext:Yz},Kz=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid"],Zz=(Mz={m4a:"mp4",oga:"ogg"},Dz=document.createElement("audio"),Fz={},Lz=/^no$/,Kz.forEach((function(t){var e=Mz[t]||t,r=Dz.canPlayType("audio/"+t).replace(Lz,""),i=Dz.canPlayType("audio/"+e).replace(Lz,"");Fz[t]=!!r||!!i})),Object.freeze(Fz)),Jz=/\.(\{([^\}]+)\})(\?.*)?$/;function Qz(t){var e=Jz,r="string"==typeof t?t:t.url;if(e.test(r)){for(var i=e.exec(r),n=i[2].split(","),s=n[n.length-1],o=0,a=n.length;o<a;o++){var h=n[o];if(Zz[h]){s=h;break}}var u=r.replace(i[1],s);return"string"!=typeof t&&(t.extension=s,t.url=u),u}return r}var tV,eV=function(){function t(){}return t.add=function(){t.legacy=Pz().useLegacy},Object.defineProperty(t,"legacy",{set:function(t){var e=Kz;t?e.forEach((function(t){Sz.setExtensionXhrType(t,Sz.XHR_RESPONSE_TYPE.DEFAULT),Sz.setExtensionLoadType(t,Sz.LOAD_TYPE.AUDIO)})):e.forEach((function(t){Sz.setExtensionXhrType(t,Sz.XHR_RESPONSE_TYPE.BUFFER),Sz.setExtensionLoadType(t,Sz.LOAD_TYPE.XHR)}))},enumerable:!0,configurable:!0}),t.pre=function(t,e){Qz(t),e()},t.use=function(t,e){t.data&&Kz.indexOf(t.extension)>-1?t.sound=Pz().add(t.name,{loaded:e,preload:!0,url:t.url,source:t.data}):e()},t}(),rV=function(){function t(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start}return t.prototype.play=function(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})},t.prototype.destroy=function(){this.parent=null},t}(),iV=function(){function t(t,e){this.media=t,this.options=e,this._instances=[],this._sprites={},this.media.init(this);var r=e.complete;this._autoPlayOptions=r?{complete:r}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.singleInstance=e.singleInstance,this.preload=e.preload||this.autoPlay,this.url=e.url,this.speed=e.speed,this.volume=e.volume,this.loop=e.loop,e.sprites&&this.addSprites(e.sprites),this.preload&&this._preload(e.loaded)}return t.from=function(e){var r={};return"string"==typeof e?r.url=e:e instanceof ArrayBuffer||e instanceof HTMLAudioElement?r.source=e:r=e,(r=Nz({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},r)).url&&(r.url=Qz(r.url)),Object.freeze(r),new t(Pz().useLegacy?new Wz:new Xz,r)},Object.defineProperty(t.prototype,"context",{get:function(){return Pz().context},enumerable:!0,configurable:!0}),t.prototype.pause=function(){return this.isPlaying=!1,this.paused=!0,this},t.prototype.resume=function(){return this.isPlaying=this._instances.length>0,this.paused=!1,this},Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this.media.filters},set:function(t){this.media.filters=t},enumerable:!0,configurable:!0}),t.prototype.addSprites=function(t,e){if("object"==typeof t){var r={};for(var i in t)r[i]=this.addSprites(i,t[i]);return r}if("string"==typeof t){var n=new rV(this,e);return this._sprites[t]=n,n}},t.prototype.destroy=function(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null},t.prototype.removeSprites=function(t){if(t){var e=this._sprites[t];void 0!==e&&(e.destroy(),delete this._sprites[t])}else for(var r in this._sprites)this.removeSprites(r);return this},Object.defineProperty(t.prototype,"isPlayable",{get:function(){return this.isLoaded&&this.media&&this.media.isPlayable},enumerable:!0,configurable:!0}),t.prototype.stop=function(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(var t=this._instances.length-1;t>=0;t--)this._instances[t].stop();return this},t.prototype.play=function(t,e){var r,i=this;if("string"==typeof t?r={sprite:s=t,loop:this.loop,complete:e}:"function"==typeof t?(r={}).complete=t:r=t,(r=Nz({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},r||{})).sprite){var n=r.sprite,s=this._sprites[n];r.start=s.start,r.end=s.end,r.speed=s.speed||1,r.loop=s.loop||r.loop,delete r.sprite}if(r.offset&&(r.start=r.offset),!this.isLoaded)return new Promise((function(t,e){i.autoPlay=!0,i._autoPlayOptions=r,i._preload((function(i,n,s){i?e(i):(r.loaded&&r.loaded(i,n,s),t(s))}))}));this.singleInstance&&this._removeInstances();var o=this._createInstance();return this._instances.push(o),this.isPlaying=!0,o.once("end",(function(){r.complete&&r.complete(i),i._onComplete(o)})),o.once("stop",(function(){i._onComplete(o)})),o.play(r),o},t.prototype.refresh=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refresh()},t.prototype.refreshPaused=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refreshPaused()},Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),t.prototype._preload=function(t){this.media.load(t)},Object.defineProperty(t.prototype,"instances",{get:function(){return this._instances},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sprites",{get:function(){return this._sprites},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.media.duration},enumerable:!0,configurable:!0}),t.prototype.autoPlayStart=function(){var t;return this.autoPlay&&(t=this.play(this._autoPlayOptions)),t},t.prototype._removeInstances=function(){for(var t=this._instances.length-1;t>=0;t--)this._poolInstance(this._instances[t]);this._instances.length=0},t.prototype._onComplete=function(t){if(this._instances){var e=this._instances.indexOf(t);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}this._poolInstance(t)},t.prototype._createInstance=function(){if(t._pool.length>0){var e=t._pool.pop();return e.init(this.media),e}return this.media.create()},t.prototype._poolInstance=function(e){e.destroy(),t._pool.indexOf(e)<0&&t._pool.push(e)},t._pool=[],t}(),nV=function(){function t(){this.init()}return t.prototype.init=function(){return this.supported&&(this._webAudioContext=new Gz),this._htmlAudioContext=new Yz,this._sounds={},this.useLegacy=!this.supported,this},Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filtersAll",{get:function(){return this.useLegacy?[]:this._context.filters},set:function(t){this.useLegacy||(this._context.filters=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"supported",{get:function(){return null!==Gz.AudioContext},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){if("object"==typeof t){var r={};for(var i in t){var n=this._getOptions(t[i],e);r[i]=this.add(i,n)}return r}if("string"==typeof t){if(e instanceof iV)return this._sounds[t]=e,e;n=this._getOptions(e);var s=iV.from(n);return this._sounds[t]=s,s}},t.prototype._getOptions=function(t,e){var r;return r="string"==typeof t?{url:t}:t instanceof ArrayBuffer||t instanceof HTMLAudioElement?{source:t}:t,Nz({},r,e||{})},Object.defineProperty(t.prototype,"useLegacy",{get:function(){return this._useLegacy},set:function(t){eV.legacy=t,this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext},enumerable:!0,configurable:!0}),t.prototype.remove=function(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this},Object.defineProperty(t.prototype,"volumeAll",{get:function(){return this._context.volume},set:function(t){this._context.volume=t,this._context.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedAll",{get:function(){return this._context.speed},set:function(t){this._context.speed=t,this._context.refresh()},enumerable:!0,configurable:!0}),t.prototype.togglePauseAll=function(){return this._context.togglePause()},t.prototype.pauseAll=function(){return this._context.paused=!0,this._context.refreshPaused(),this},t.prototype.resumeAll=function(){return this._context.paused=!1,this._context.refreshPaused(),this},t.prototype.toggleMuteAll=function(){return this._context.toggleMute()},t.prototype.muteAll=function(){return this._context.muted=!0,this._context.refresh(),this},t.prototype.unmuteAll=function(){return this._context.muted=!1,this._context.refresh(),this},t.prototype.removeAll=function(){for(var t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this},t.prototype.stopAll=function(){for(var t in this._sounds)this._sounds[t].stop();return this},t.prototype.exists=function(t,e){return void 0===e&&(e=!1),!!this._sounds[t]},t.prototype.find=function(t){return this.exists(t,!0),this._sounds[t]},t.prototype.play=function(t,e){return this.find(t).play(e)},t.prototype.stop=function(t){return this.find(t).stop()},t.prototype.pause=function(t){return this.find(t).pause()},t.prototype.resume=function(t){return this.find(t).resume()},t.prototype.volume=function(t,e){var r=this.find(t);return void 0!==e&&(r.volume=e),r.volume},t.prototype.speed=function(t,e){var r=this.find(t);return void 0!==e&&(r.speed=e),r.speed},t.prototype.duration=function(t){return this.find(t).duration},t.prototype.close=function(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this},t}(),sV=0,oV={get PLAY_ID(){return sV},playOnce:function(t,e){var r="alias"+sV++;return Pz().add(r,{url:t,preload:!0,autoPlay:!0,loaded:function(t){t&&(Pz().remove(r),e&&e(t))},complete:function(){Pz().remove(r),e&&e(null)}}),r},render:function(t,e){var r=document.createElement("canvas");e=Nz({width:512,height:128,fill:"black"},e||{}),r.width=e.width,r.height=e.height;var i=OX.from(r);if(!(t.media instanceof Xz))return i;var n=t.media,s=r.getContext("2d");s.fillStyle=e.fill;for(var o=n.buffer.getChannelData(0),a=Math.ceil(o.length/e.width),h=e.height/2,u=0;u<e.width;u++){for(var l=1,c=-1,d=0;d<a;d++){var p=o[u*a+d];p<l&&(l=p),p>c&&(c=p)}s.fillRect(u,(1+l)*h,1,Math.max(1,(c-l)*h))}return i},resolveUrl:Qz,sineTone:function(t,e){void 0===t&&(t=200),void 0===e&&(e=1);var r=iV.from({singleInstance:!0});if(!(r.media instanceof Xz))return r;for(var i=r.media,n=r.context.audioContext.createBuffer(1,48e3*e,48e3),s=n.getChannelData(0),o=0;o<s.length;o++){var a=t*(o/n.sampleRate)*Math.PI;s[o]=2*Math.sin(a)}return i.buffer=n,r.isLoaded=!0,r},extensions:Kz,supported:Zz},aV=(tV=new nV,Rz=tV,tV);Ez.registerPlugin(eV),Object.defineProperties(aV,{Filterable:{get:function(){return Iz}},filters:{get:function(){return Vz}},htmlaudio:{get:function(){return qz}},Sound:{get:function(){return iV}},SoundLibrary:{get:function(){return nV}},SoundSprite:{get:function(){return rV}},utils:{get:function(){return oV}},webaudio:{get:function(){return zz}},sound:{get:function(){return aV}}});var hV=aV;var uV=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=r};function lV(t){return(lV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cV(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dV(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function pV(t,e){return!e||"object"!==lV(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fV(t){return(fV=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mV(t,e){return(mV=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gV=function(t){function e(){return cV(this,e),pV(this,fV(e).apply(this,arguments))}var r,i,n;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mV(t,e)}(e,t),r=e,(i=[{key:"incrementX",value:function(){this.x+=1}},{key:"decrementX",value:function(){this.x-=1}},{key:"incrementY",value:function(){this.y+=1}},{key:"decrementY",value:function(){this.y-=1}}])&&dV(r.prototype,i),n&&dV(r,n),e}(uV);function yV(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vV(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _V(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var bV=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cells=[new gV(0,0),new gV(0,1),new gV(0,2),new gV(0,3),new gV(0,4)],this.nextDirection="right",this.direction=null,this._graphics=e,this._collision=r}var e,r,i;return e=t,(r=[{key:"right",value:function(){"left"!==this.direction&&(this.nextDirection="right")}},{key:"left",value:function(){"right"!==this.direction&&(this.nextDirection="left")}},{key:"up",value:function(){"down"!==this.direction&&(this.nextDirection="up")}},{key:"down",value:function(){"up"!==this.direction&&(this.nextDirection="down")}},{key:"grow",value:function(){var t=this.cells[this.cells.length-1];this.cells.push(new gV(t.x,t.y))}},{key:"getHead",value:function(){return this.cells[0]}},{key:"getBody",value:function(){var t=vV(this.cells);return t.shift(),t}},{key:"hasCollidedWithSelf",value:function(){return this._collision.hasCollided(this.getHead(),this.getBody())}},{key:"hasGoneOutOfBounds",value:function(){return this._collision.hasGoneOutOfBounds(this.getHead())}},{key:"deepCloneCells",value:function(){return JSON.parse(JSON.stringify(this.cells))}},{key:"moveHead",value:function(){var t,e=this;(yV(t={},"left",(function(){return e.getHead().decrementX()})),yV(t,"right",(function(){return e.getHead().incrementX()})),yV(t,"up",(function(){return e.getHead().decrementY()})),yV(t,"down",(function(){return e.getHead().incrementY()})),t)[this.direction]()}},{key:"move",value:function(){this.direction=this.nextDirection;var t=this.deepCloneCells();this.moveHead(),this.cells=this.cells.map((function(e,r){if(0===r)return e;var i=e,n=t[r-1];return i.x=n.x,i.y=n.y,i}))}},{key:"flash",value:function(){var t=this;this.graphics.clear(),setTimeout((function(){return t.draw()}),200),setTimeout((function(){return t.graphics.clear()}),400),setTimeout((function(){return t.draw()}),600),setTimeout((function(){return t.graphics.clear()}),800),setTimeout((function(){return t.draw()}),1e3)}},{key:"draw",value:function(){var t=this;this.graphics.clear(),this.graphics.beginFill(11403055),this.cells.forEach((function(e){t.graphics.drawRect(11*e.x,11*e.y,10,10)}))}},{key:"graphics",get:function(){return this._graphics}}])&&_V(e.prototype,r),i&&_V(e,i),t}();function xV(t){return(xV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function TV(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function EV(t,e){return!e||"object"!==xV(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wV(t){return(wV=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function SV(t,e){return(SV=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var IV=function(t){function e(t,r,i){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=EV(this,wV(e).call(this,t,r))).graphics=i,n}var r,i,n;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&SV(t,e)}(e,t),r=e,(i=[{key:"randomlyReposition",value:function(t,e){console.log(t,e),this.x=Math.round(Math.random()*t),this.y=Math.round(Math.random()*e)}},{key:"draw",value:function(){this.graphics.clear(),this.graphics.beginFill(16777215),this.graphics.drawRect(11*this.x,11*this.y,10,10)}}])&&TV(r.prototype,i),n&&TV(r,n),e}(uV);function AV(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CV(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var OV="Game is running, hit sacebar to pause",RV=function(){function t(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:OV;AV(this,t),this._graphics=e,this._text=r,this._status=i}var e,r,i;return e=t,(r=[{key:"setRunning",value:function(){this._status=OV}},{key:"setPaused",value:function(){this._status="Game is paused, hit spacebar to resume"}},{key:"setLost",value:function(){this._status="You have lost, refresh to play again..."}},{key:"draw",value:function(){this._text.text.text=this._status}},{key:"graphics",get:function(){return this._text.text}},{key:"status",get:function(){return this._status}}])&&CV(e.prototype,r),i&&CV(e,i),t}(),NV=r(0);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
let PV;function MV(){return null==PV&&(PV=Object(NV.E)().epsilon()),PV}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class DV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,DV.prototype)}}class FV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,FV.prototype)}}class LV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,LV.prototype)}}class kV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,kV.prototype)}}class UV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,UV.prototype)}}Error;
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function BV(t,e){if(Array.isArray(t)){let r=[];for(let i=0;i<e;i++)r=r.concat(t);return r}{const r=new Array(e);return r.fill(t),r}}function jV(t,e){if(!t)throw new UV(e)}function XV(t,e){let r=0;for(const i of t)i===e&&r++;return r}function GV(t){return 1===t.length?t[0]:t}function zV(t){return Array.isArray(t)?t:[t]}function VV(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function HV(t){return t.length<=1?t:-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}let $V={};function WV(t){if(null==t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function YV(t,e={},r={},i="object",n=!1){if("string"==typeof t){const n=t;let s;if(n in r)s=r[n];else if(n in $V)s=$V[n];else if(s=e[n],null==s)throw new LV(`Unknown ${i}: ${t}. `+"This may be due to one of the following reasons:\n"+`1. The ${i} is defined in Python, in which `+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+`2. The custom ${i} is defined in JavaScript, `+"but is not registered properly with tf.serialization.registerClass().");return s}{const s=t;if(null==s.className||null==s.config)throw new LV(`${i}: Improper config format: `+`${JSON.stringify(s)}.\n`+"'className' and 'config' must set.");const o=s.className;let a,h;if(o in r?[a,h]=r[o]:o in $V?[a,h]=$V.className:o in e&&([a,h]=e[o]),null==a)throw new LV(`Unknown ${i}: ${o}. `+"This may be due to one of the following reasons:\n"+`1. The ${i} is defined in Python, in which `+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+`2. The custom ${i} is defined in JavaScript, `+"but is not registered properly with tf.serialization.registerClass().");if(null!=h){const t={};for(const e of Object.keys($V))t[e]=$V[e];for(const e of Object.keys(r))t[e]=r[e];s.config.customObjects=t;const e=Object.assign({},$V);for(const t of Object.keys(r))$V[t]=r[t];!function t(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach(e=>t(e));else{const r=Object.keys(e);for(const i of r){const r=e[i];null!=r&&"object"==typeof r&&(Array.isArray(r)||"ndarray"!==r.type||"number"!=typeof r.value?t(r):e[i]=r.value)}}}(s.config);const i=h(a,s.config,r,n);return $V=Object.assign({},e),i}{const t=Object.assign({},$V);for(const t of Object.keys(r))$V[t]=r[t];const e=new a(s.config);return $V=Object.assign({},t),e}}}function qV(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function KV(t){if(null==t)return t;const e=[];for(const r of t)-1===e.indexOf(r)&&e.push(r);return e}function ZV(t){if(null==t)throw new LV(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function JV(t,e,r){if(null!=r&&t.indexOf(r)<0)throw new LV(`${r} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function QV(t,e,r=0,i=1/0){return jV(r>=0),jV(i>=r),Array.isArray(t)&&t.length>=r&&t.length<=i&&t.every(t=>typeof t===e)}function tH(t,e){Array.isArray(t)?(NV.Cd.assert(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((t,r)=>tH(t,`element ${r+1} of ${e}`))):NV.Cd.assert(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got `+`${function t(e){return null===e?"null":Array.isArray(e)?"["+e.map(e=>t(e)).join(",")+"]":"string"==typeof e?`"${e}"`:`${e}`}(t)}.`)}function eH(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rH(t,e){return Object(NV.ud)(()=>NV.dd(NV.kd(NV.ic(t,t),e,!0)))}class iH extends NV.Lc.Serializable{getConfig(){return{}}}class nH extends iH{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(NV.ud)(()=>{const e=rH(t,this.axis),r=NV.Q(e,0,this.maxValue);return NV.ic(t,NV.ib(r,NV.r(MV(),e)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}nH.className="MaxNorm",NV.Lc.registerClass(nH);class sH extends iH{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(NV.ud)(()=>NV.ib(t,NV.r(MV(),rH(t,this.axis))))}getConfig(){return{axis:this.axis}}}sH.className="UnitNorm",NV.Lc.registerClass(sH);class oH extends iH{apply(t){return NV.Bc(t)}}oH.className="NonNeg",NV.Lc.registerClass(oH);class aH extends iH{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(NV.ud)(()=>{const e=rH(t,this.axis),r=NV.r(NV.ic(this.rate,NV.Q(e,this.minValue,this.maxValue)),NV.ic(1-this.rate,e));return NV.ic(t,NV.ib(r,NV.r(MV(),e)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}aH.className="MinMaxNorm",NV.Lc.registerClass(aH);const hH={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function uH(t){return WV(t)}function lH(t,e={}){return YV(t,NV.Lc.SerializationMap.getMap().classNameMap,e,"constraint")}function cH(t){if(null==t)return null;if("string"==typeof t){return lH({className:t in hH?hH[t]:t,config:{}})}return t instanceof iH?t:lH(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
const dH=["channelsFirst","channelsLast"],pH=["valid","same","causal"],fH=["max","avg"],mH=["sum","mul","concat","ave"],gH=new Map;function yH(t){JV(dH,"DataFormat",t)}function vH(t){JV(pH,"PaddingMode",t)}function _H(t){JV(fH,"PoolMode",t)}const bH=[];function xH(t,e){bH.push(t);try{const t=e();return bH.pop(),t}catch(t){throw bH.pop(),t}}function TH(t){if(!SH(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===bH.length?"":bH.join("/")+"/")+t}function EH(t){if(!SH(t))throw new Error("Not a valid tensor name: '"+t+"'");gH.has(t)||gH.set(t,0);const e=gH.get(t);if(gH.set(t,gH.get(t)+1),e>0){const r=`${t}_${e}`;return gH.set(r,1),r}return t}const wH=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function SH(t){return!!t.match(wH)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function IH(t,e,r){null==e&&(e=0),null==r&&(r=t.length);let i=1;for(let n=e;n<r;++n)i*=t[n];return i}function AH(t){return t=Array.isArray(t)?new Float32Array(t):t,Object(NV.pd)(t)}function CH(t){return NV.ec(AH(t)).dataSync()[0]}function OH(t){return NV.Xb(AH(t)).dataSync()[0]}function RH(t,e){if(e<t)throw new LV(`end (${e}) < begin (${t}) is forbidden.`);const r=[];for(let i=t;i<e;++i)r.push(i);return r}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function NH(t,e){return t.asType(e)}function PH(t,e=-1){const r=t.shape.slice();return e<0&&(e=r.length+e+1),r.splice(e,0,1),t.reshape(r)}function MH(t,e,r){return Object(NV.ud)(()=>{switch(t.rank){case 1:return NV.Tc(t,e,r);case 2:return NV.Uc(t,[e,0],[r,t.shape[1]]);case 3:return NV.Vc(t,[e,0,0],[r,t.shape[1],t.shape[2]]);case 4:return NV.Wc(t,[e,0,0,0],[r,t.shape[1],t.shape[2],t.shape[3]]);case 5:return NV.Sc(t,[e,0,0,0,0],[r,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return NV.Sc(t,[e,0,0,0,0,0],[r,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new LV("sliceAlongFirstAxis() received an unsupported tensor rank: "+`${t.rank}`)}})}function DH(t,e,r){return Object(NV.ud)(()=>{switch(t.rank){case 1:return NV.Tc(t,e,r);case 2:return NV.Uc(t,[0,e],[t.shape[0],r]);case 3:return NV.Vc(t,[0,0,e],[t.shape[0],t.shape[1],r]);case 4:return NV.Wc(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],r]);default:throw new LV("sliceAlongLastAxis() received an unsupported tensor rank: "+`${t.rank}`)}})}function FH(t,e,r,i){return Object(NV.ud)(()=>{switch(t.rank){case 1:return NV.Tc(t,e,r);case 2:switch(i){case 1:return MH(t,e,r);case 2:return DH(t,e,r);default:throw new LV("The axis is not within the rank of the tensor "+`${i}`)}case 3:switch(i){case 1:return MH(t,e,r);case 2:return NV.Vc(t,[0,e,0],[t.shape[0],r,t.shape[2]]);case 3:return DH(t,e,r);default:throw new LV("The axis is not within the rank of the tensor "+`${i}`)}case 4:switch(i){case 1:return MH(t,e,r);case 2:return NV.Wc(t,[0,e,0,0],[t.shape[0],r,t.shape[2],t.shape[3]]);case 3:return NV.Wc(t,[0,0,e,0],[t.shape[0],t.shape[1],r,t.shape[3]]);case 4:return DH(t,e,r);default:throw new LV("The axis is not within the rank of the tensor "+`${i}`)}default:throw new LV("sliceAlongLastAxis() received an unsupported tensor rank: "+`${t.rank}`)}})}function LH(t,e=-1){let r;return e<0&&(r=t[0].rank,e=0!==r?r:0),e===t[0].rank&&(e=-1),NV.S(t,e)}function kH(t,e){switch(t.rank){case 1:return NV.T([t,e]);case 2:return NV.U([t,e],0);case 3:return NV.V([t,e],0);case 4:return NV.W([t,e],0);default:throw new LV("concatAlongFirstAxis() received an unsupported "+`tensor rank: ${t.rank}`)}}function UH(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new LV(`The length of input n (${e.length}) does not match `+`the number of dimensions in input x (${t.rank})`);return NV.vd(t,e)}function BH(t,e=0,r=1,i,n){return NV.uc(t,e,r,i,n)}function jH(t,e,r,i){if(t.rank<2||e.rank<2)throw new kV("dot requires both inputs to be rank >= 2"+` but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){if(t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new kV("If rank y >= 3, then the second last dim"+` of y must equal the last dim of x but got x shape = ${t.shape} and `+` y shape = ${e.shape}`)}if(2===t.rank&&2===e.rank){const n=!1,s=!1;return NV.yb.matMul({a:t,b:e,transposeA:n,transposeB:s,bias:i?zH(t.rank,i,"channelsLast"):null,activation:r})}{const n=t.shape.slice(),s=n.pop();t=t.reshape([-1,s]);const o=e.shape.slice(),a=o.pop(),h=o.pop(),u=[...o,a],l=Array.from({length:e.rank},(t,r)=>0===r?e.rank-2:r<=e.rank-2?r-1:r);e=e.transpose(l).reshape([h,-1]);const c=[...n,...u],d=!1,p=!1;return NV.yb.matMul({a:t,b:e,transposeA:d,transposeB:p,bias:i?zH(t.rank,i,"channelsLast"):null,activation:r}).reshape(c)}}function XH(t,e,r){return Object(NV.ud)(()=>(e=Array.isArray(e)?Object(NV.pd)(e,"int32"):e.toInt(),NV.zb(t,e,r)))}function GH(t){return NV.ic(t,t)}function zH(t,e,r){const i=e.shape;if(1!==e.rank&&e.rank!==t)throw new LV(`Unexpected bias dimensions: ${e.rank}`+`; expected it to be 1 or ${t}`);if(5===t){if("channelsFirst"===r)return 1===i.length?e.reshape([1,i[0],1,1,1]):e.reshape([1,i[3],i[0],i[1],i[2]]);if("channelsLast"===r)return 1===i.length?e.reshape([1,1,1,1,i[0]]):e.reshape([1].concat(i))}else if(4===t){if("channelsFirst"===r)return 1===i.length?e.reshape([1,i[0],1,1]):e.reshape([1,i[2],i[0],i[1]]);if("channelsLast"===r)return 1===i.length?e.reshape([1,1,1,i[0]]):e.reshape([1].concat(i))}else if(3===t){if("channelsFirst"===r)return 1===i.length?e.reshape([1,i[0],1]):e.reshape([1,i[1],i[0]]);if("channelsLast"===r)return 1===i.length?e.reshape([1,1,i[0]]):e.reshape([1].concat(i))}else if(t<3)return e;throw new LV(`Unsupported input rank by biasAdd: ${e.rank}`)}function VH(t,e,r){return Object(NV.ud)(()=>(null==r&&(r="channelsLast"),yH(r),t.add(zH(t.rank,e,r))))}function HH(t,e,r,i){return Object(NV.ud)(()=>NV.kb(t,e,r,i))}function $H(t,e,r=!1){return r?t():e()}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const WH=["fanIn","fanOut","fanAvg"],YH=["normal","uniform","truncatedNormal"];class qH extends NV.Lc.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class KH extends qH{apply(t,e){return Object(NV.Id)(t,e)}}KH.className="Zeros",NV.Lc.registerClass(KH);class ZH extends qH{apply(t,e){return Object(NV.oc)(t,e)}}ZH.className="Ones",NV.Lc.registerClass(ZH);class JH extends qH{constructor(t){if(super(),"object"!=typeof t)throw new LV(`Expected argument of type ConstantConfig but got ${t}`);if(void 0===t.value)throw new LV(`config must have value set but got ${t}`);this.value=t.value}apply(t,e){return Object(NV.ud)(()=>Object(NV.ic)(Object(NV.Hc)(this.value),Object(NV.oc)(t,e)))}getConfig(){return{value:this.value}}}JH.className="Constant",NV.Lc.registerClass(JH);class QH extends qH{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return Object(NV.vc)(t,this.minval,this.maxval,e)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}QH.className="RandomUniform",NV.Lc.registerClass(QH);class t$ extends qH{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new kV(`randomNormal does not support dType ${e}.`);return BH(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}t$.className="RandomNormal",NV.Lc.registerClass(t$);class e$ extends qH{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new kV(`truncatedNormal does not support dType ${e}.`);return Object(NV.zd)(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}e$.className="TruncatedNormal",NV.Lc.registerClass(e$);class r$ extends qH{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return Object(NV.ud)(()=>{if(2!==t.length||t[0]!==t[1])throw new LV("Identity matrix initializer can only be used for 2D square matrices.");return Object(NV.ic)(this.gain,Object(NV.tb)(t[0]))})}getConfig(){return{gain:this.gain}}}r$.className="Identity",NV.Lc.registerClass(r$);class i$ extends qH{constructor(t){if(super(),t.scale<0)throw new LV(`scale must be a positive float. Got: ${t.scale}`);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
var e;this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,e=this.mode,JV(WH,"FanMode",e),this.distribution=null==t.distribution?"normal":t.distribution,function(t){JV(YH,"Distribution",t)}(this.distribution),this.seed=t.seed}apply(t,e){const r=function(t,e="channelsLast"){let r,i;if(yH(e),2===t.length)r=t[0],i=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===e){const e=IH(t,2);r=t[1]*e,i=t[0]*e}else if("channelsLast"===e){const e=IH(t,0,t.length-2);r=t[t.length-2]*e,i=t[t.length-1]*e}}else{const e=IH(t);r=Math.sqrt(e),i=Math.sqrt(e)}return[r,i]}(t),i=r[0],n=r[1];let s=this.scale;if("fanIn"===this.mode?s/=Math.max(1,i):"fanOut"===this.mode?s/=Math.max(1,n):s/=Math.max(1,(i+n)/2),"normal"===this.distribution){const r=Math.sqrt(s);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new kV(`${this.getClassName()} does not support dType ${e}.`);return Object(NV.zd)(t,0,r,e,this.seed)}{const r=Math.sqrt(3*s);return Object(NV.vc)(t,-r,r,e)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}i$.className="VarianceScaling",NV.Lc.registerClass(i$);class n$ extends i${constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return i$.className}}n$.className="GlorotUniform",NV.Lc.registerClass(n$);class s$ extends i${constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return i$.className}}s$.className="GlorotNormal",NV.Lc.registerClass(s$);class o$ extends i${constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return i$.className}}o$.className="HeNormal",NV.Lc.registerClass(o$);class a$ extends i${constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return i$.className}}a$.className="HeUniform",NV.Lc.registerClass(a$);class h$ extends i${constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return i$.className}}h$.className="LeCunNormal",NV.Lc.registerClass(h$);class u$ extends i${constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return i$.className}}u$.className="LeCunNormal",NV.Lc.registerClass(u$);class l$ extends qH{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,null!=this.seed)throw new kV("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,e){return Object(NV.ud)(()=>{if(2!==t.length)throw new kV("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+`than 2000 (${t[0]*t[1]}) elements: `+"Slowness may result.");const e=BH(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32");let r=NV.Nb.gramSchmidt(e);return t[0]>t[1]&&(r=r.transpose()),Object(NV.ic)(this.gain,r)})}getConfig(){return{gain:this.gain,seed:this.seed}}}l$.className="Orthogonal",NV.Lc.registerClass(l$);const c$={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function d$(t,e={}){return YV(t,NV.Lc.SerializationMap.getMap().classNameMap,e,"initializer")}function p$(t){return WV(t)}function f$(t){if("string"==typeof t){const e=t in c$?c$[t]:t;if("GlorotNormal"===e)return new s$;if("GlorotUniform"===e)return new n$;if("HeNormal"===e)return new o$;if("HeUniform"===e)return new a$;if("LeCunNormal"===e)return new h$;if("LeCunUniform"===e)return new u$;{const t={};return t.className=e,t.config={},d$(t)}}return t instanceof qH?t:d$(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
let m$=0;function g$(){return m$++}const y$={};function v$(t=""){return t in y$||(y$[t]=0),y$[t]+=1,t+y$[t].toString()}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _$(t){return Array.isArray(t)&&Array.isArray(t[0])}function b$(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function x$(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new LV(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function T$(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new LV(`Expected exactly 1 Shape; got ${t.length}`)}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function E$(t){let e=0;for(const r of t)0===r.shape.length?e+=1:e+=r.shape.reduce((t,e)=>t*e);return e}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class w${constructor(t,e="float32",r="Variable",i=!0,n=null){this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=g$(),r=null==r?"Variable":r,this.originalName=TH(r),this.name=EH(this.originalName),this.trainable_=i,this.constraint=n,this.val=NV.Dd(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function S$(t){return t.map(t=>t.read())}function I$(t){t.forEach(t=>{t[0].write(t[1])})}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class A${constructor(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class C${constructor(t,e,r,i,n,s,o){this.dtype=t,this.shape=e,this.sourceLayer=r,this.inputs=i,this.callArgs=n,this.outputTensorIndex=o,this.id=g$(),null!=s&&(this.originalName=TH(s),this.name=EH(this.originalName)),this.rank=e.length}}let O$=0;class R${constructor(t,e){this.callArgs=e,this.id=O$++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const e of t.inboundLayers)null!=e&&e.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)null!=e?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let N$=0;class P$ extends NV.Lc.Serializable{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=N$++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=VV(t)+"_"+v$(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let r=null;null!=t.batchSize&&(r=t.batchSize),e=[r].concat(t.inputShape)}this.batchInputShape=e;let r=t.dtype;null==r&&(r=t.inputDType),null==r&&(r="float32"),this.dtype=r}null!=t.weights?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new FV("The layer has never been called "+`and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new LV(`Asked to get ${e} at node ${t}, `+`but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return GV(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return GV(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new DV(`Layer ${this.name}`+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new DV(`Layer ${this.name}`+" is not connected, no input to return.");return GV(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new DV(`Layer ${this.name}`+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new DV(`Layer ${this.name}`+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return GV(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=zV(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=zV(this.inputSpec);if(t.length!==e.length)throw new LV(`Layer ${this.name} expects ${e.length} inputs, `+`but it received ${t.length} input tensors. `+`Input received: ${t}`);for(let r=0;r<t.length;r++){const i=t[r],n=e[r];if(null==n)continue;const s=i.rank;if(null!=n.ndim&&s!==n.ndim)throw new LV(`Input ${r} is incompatible with layer ${this.name}: `+`expected ndim=${n.ndim}, found ndim=${s}`);if(null!=n.maxNDim&&s>n.maxNDim)throw new LV(`Input ${r} is incompatible with layer ${this.name}`+`: expected max_ndim=${n.maxNDim}, found ndim=${s}`);if(null!=n.minNDim&&s<n.minNDim)throw new LV(`Input ${r} is incompatible with layer ${this.name}`+`: expected min_ndim=${n.minNDim}, found ndim=${s}.`);if(null!=n.dtype&&i.dtype!==n.dtype)throw new LV(`Input ${r} is incompatible with layer ${this.name} `+`: expected dtype=${n.dtype}, found dtype=${i.dtype}.`);if(n.axes){const t=i.shape;for(const e in n.axes){const i=Number(e),s=n.axes[e],o=i>=0?t[i]:t[t.length+i];if(null!=s&&-1===[s,null].indexOf(o))throw new LV(`Input ${r} is incompatible with layer `+`${this.name}: expected axis ${i} of input shape to `+`have value ${s} but got shape ${t}.`)}}if(null!=n.shape)for(let t=0;t<n.shape.length;++t){const e=n.shape[t],s=i.shape[t];if(null!=e&&null!=s&&e!==s)throw new LV(`Input ${r} is incompatible with layer `+`${this.name}: expected shape=${n.shape}, `+`found shape=${i.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const r=zV(t);let i=!0;for(const t of r)if(!(t instanceof C$)){i=!1;break}let n=!0;for(const t of r)if(t instanceof C$){n=!1;break}if(i===n)throw new LV("Arguments to apply() must be all SymbolicTensors or all Tensors");return xH(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const r of zV(t))e.push(r.shape);this.build(GV(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&n&&(this._refCount=1)}if(this.assertInputCompatibility(t),n){let i=this.call(t,e);const n=zV(i),s=[];for(let t of n)-1!==r.indexOf(t)&&(t=t.clone()),s.push(t);if(i=GV(s),null!=this.activityRegularizer)throw new kV("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}{const r=function(t){t=zV(t);const e=[];for(const r of t)e.push(r.shape);return GV(e)}(t),i=this.computeOutputShape(r);let n;const s="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?r[0]:r),n=null!=i&&i.length>0&&Array.isArray(i[0])?i.map((r,i)=>new C$(s,r,this,zV(t),e,this.name,i)):new C$(s,i,this,zV(t),e,this.name),this.addInboundNode(t,n,null,null,r,i,e),this._refCount++,null!=this.activityRegularizer)throw new kV("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return n}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+`${JSON.stringify(t)}) does not match that of the `+`batchInputShape (${JSON.stringify(this.batchInputShape)}) `+`of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((r,i)=>{null!=r&&null!=t[i]&&t[i]!==r&&(e=!0)}),e&&console.warn("The shape of the input tensor "+`(${JSON.stringify(t)}) does not `+`match the expectation of layer ${this.name}: `+`${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new DV(`The layer ${this.name} has never been called and thus has no `+"defined output shape.");const t=[];for(const e of this.inboundNodes){const r=JSON.stringify(e.outputShapes);-1===t.indexOf(r)&&t.push(r)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new DV(`The layer ${this.name} has multiple inbound nodes with different `+'output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new FV(`You tried to call countParams() on ${this.name}, `+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return E$(this.weights)}build(t){this.built=!0}getWeights(t=!1){return S$(t?this.trainableWeights:this.weights)}setWeights(t){Object(NV.ud)(()=>{const e=this.weights;if(e.length!==t.length)throw new LV(`You called setWeights(weights) on layer "${this.name}" `+`with a weight list of length ${t.length}, `+`but the layer was expecting ${e.length} weights. `+`Provided weights: ${t}...`);if(0===e.length)return;const r=[],i=S$(e);for(let n=0;n<i.length;++n){const s=i[n],o=e[n],a=t[n];if(!NV.Cd.arraysEqual(s.shape,a.shape))throw new LV(`Layer weight shape ${s.shape} `+`not compatible with provided weight shape ${a.shape}`);r.push([o,a])}I$(r)})}addWeight(t,e,r,i,n,s,o){if(-1!==this._addedWeightNames.indexOf(t))throw new LV(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==r&&(r="float32"),this.fastWeightInitDuringBuild&&(i=f$("zeros"));const a=i.apply(e,r),h=new w$(a,r,t,s,o);return a.dispose(),null!=n&&this.addLoss(()=>n.apply(h.read())),null==s&&(s=!0),s?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=zV(t),void 0!==this._losses&&null!==this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, `+"but was passed an inputMask.");e.forEach(t=>{if(null!=t)throw new TypeError(`Layer ${this.name} does not support masking, `+"but was passed an inputMask.")})}return null}return e}addInboundNode(t,e,r,i,n,s,o=null){const a=zV(t);e=zV(e),r=zV(r),i=zV(i),n=b$(n),s=b$(s);const h=[],u=[],l=[];for(const t of a)h.push(t.sourceLayer),u.push(t.nodeIndex),l.push(t.tensorIndex);new R$({outboundLayer:this,inboundLayers:h,nodeIndices:u,tensorIndices:l,inputTensors:a,outputTensors:e,inputMasks:r,outputMasks:i,inputShapes:n,outputShapes:s},o);for(let t=0;t<e.length;t++)e[t].sourceLayer=this,e[t].nodeIndex=this.inboundNodes.length-1,e[t].tensorIndex=t}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been `+"built yet.");if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used `+"yet.");this.assertNotDisposed();let t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class M$ extends P${constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:v$("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new LV("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new LV("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new LV("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=t.dtype||"float32";this.batchInputShape=e,this.dtype=r,this.inputSpec=[{shape:e}];const i=new C$(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new R$({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new LV("Cannot pass any input to an "+`InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function D$(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new LV("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let r=t.dtype;return null==r&&(r="float32"),new M$({batchInputShape:e,name:t.name,dtype:r,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function F$(t){if(null==t)return;const e=[],r=[],i=[];for(const n in t){const s=t[n];if("number"!=typeof s){const t=s;e.push(t.data()),r.push(n),i.push(t)}}if(e.length>0){const n=await Promise.all(e);for(let e=0;e<n.length;++e)t[r[e]]=n[e][0];Object(NV.hb)(i)}}function L$(t){if(null!=t)for(const e in t){const r=t[e];"number"!=typeof r&&r.dispose()}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var k$;M$.className="InputLayer",NV.Lc.registerClass(M$),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(k$||(k$={}));class U${constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class B${constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const r of this.callbacks)await r.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const r of this.callbacks)await r.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const r of this.callbacks)await r.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const r of this.callbacks)await r.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class j$ extends U${constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const r=null==e.size?0:e.size;this.seen+=r;for(const t in e){const i=e[t];if("number"==typeof i)this.totals.hasOwnProperty(t)||(this.totals[t]=0),this.totals[t]=this.totals[t]+i*r;else{let e;t in this.totals?e=this.totals[t]:this.totals[t]=0;const n=Object(NV.ud)(()=>Object(NV.r)(this.totals[t],Object(NV.ic)(i,r)));this.totals[t]=n,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const t of this.params.metrics)null!=this.totals[t]&&("number"==typeof this.totals[t]?e[t]=this.totals[t]/this.seen:Object(NV.ud)(()=>{const r=Object(NV.ic)(Object(NV.ib)(1,this.seen),this.totals[t]);e[t]=r,this.totals[t].dispose(),Object(NV.Ib)(e[t])}))}}class X$ extends U${async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const t in e)null==this.history[t]&&(this.history[t]=[]),this.history[t].push(e[t])}async syncData(){const t=[],e=[],r=[];for(const i in this.history){const n=this.history[i];for(let s=0;s<n.length;++s)if("number"!=typeof n[s]){const o=n[s];t.push(o.data()),e.push(i),r.push(s)}}const i=await Promise.all(t);for(let t=0;t<i.length;++t){this.history[e[t]][r[t]].dispose(),this.history[e[t]][r[t]]=i[t][0]}}}class G$ extends U${constructor(t,e){if(super(),this.currentEpoch=0,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");NV.Cd.isNumber(this.yieldEvery)&&(this.maybeWait=function(t,e){let r,i=NV.Cd.now();return(...n)=>{const s=NV.Cd.now();return s-i<e?r:(i=s,r=t(...n),r)}}(this.maybeWait.bind(this),this.yieldEvery)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,r){const i=[];null!=this.yield&&(await F$(r),i.push(this.yield(t,e,r))),i.push(Object(NV.lc)()),await Promise.all(i)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await F$(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const r=[];null!=this.epochEnd&&(await F$(e),r.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&r.push(Object(NV.lc)()),await Promise.all(r)}async onBatchBegin(t,e){null!=this.batchBegin&&(await F$(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const r=[];null!=this.batchEnd&&(await F$(e),r.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?r.push(Object(NV.lc)()):NV.Cd.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(r)}async onTrainBegin(t){null!=this.trainBegin&&(await F$(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await F$(t),await this.trainEnd(t))}}function z$(t,e){if(null==t&&(t={}),t instanceof U$)return[t];if(Array.isArray(t)&&t[0]instanceof U$)return t;return zV(t).map(t=>new G$(t,e))}class V${constructor(){}static registerCallbackConstructor(t,e){NV.Cd.assert(t>=0&&Number.isInteger(t),()=>"Verbosity level is expected to be an integer >= 0, "+`but got ${t}`),V$.checkForDuplicate(e),null==V$.constructors[t]&&(V$.constructors[t]=[]),V$.constructors[t].push(e)}static checkForDuplicate(t){for(const e in V$.constructors){V$.constructors[+e].forEach(e=>{if(e===t)throw new LV("Duplicate callback constructor.")})}}static clear(){V$.constructors={}}static createCallbacks(t){const e=[];for(const r in V$.constructors){const i=+r;t>=i&&e.push(...V$.constructors[i])}return e.map(t=>new t)}}function H$(t,e,r,i,n,s,o,a,h){const u=new X$,l=[new j$,...V$.createCallbacks(e)];null!=t&&l.push(...t),l.push(u);const c=new B$(l);return c.setParams({epochs:r,initialEpoch:i,samples:n,steps:s,batchSize:o,verbose:e,doValidation:a,metrics:h}),{callbackList:c,history:u}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $$(t,e={},r=!1){return YV(t,NV.Lc.SerializationMap.getMap().classNameMap,e,"layer",r)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function W$(t,e){return Object(NV.ud)(()=>{"float32"!==t.dtype&&(t=t.asType("float32"));const r=NV.kd(GH(t),e,!0),i=NV.vb(r.shape,MV()),n=NV.dd(NV.bc(r,i));return NV.ib(t,n)})}function Y$(t,e){return Object(NV.ud)(()=>NV.cc(GH(NV.jd(e,t)),-1))}function q$(t,e){return Object(NV.ud)(()=>NV.cc(NV.o(NV.jd(e,t)),-1))}function K$(t,e){return Object(NV.ud)(()=>{const r=NV.jd(t,e),i=NV.Q(NV.o(t),MV(),Number.MAX_VALUE),n=NV.o(NV.ib(r,i));return NV.ic(100,NV.cc(n,-1))})}function Z$(t,e){return Object(NV.ud)(()=>{const r=NV.Q(e,MV(),Number.MAX_VALUE),i=NV.Qb(NV.r(1,r)),n=NV.Q(t,MV(),Number.MAX_VALUE),s=NV.Qb(NV.r(1,n));return NV.cc(GH(NV.jd(i,s)),-1)})}function J$(t,e,r=!1){return Object(NV.ud)(()=>{if(r)e=NV.Yc(e);else{const t=NV.kd(e,e.shape.length-1,!0);e=NV.ib(e,t)}return e=NV.Q(e,MV(),1-MV()),NV.kc(NV.kd(NV.ic(t.toFloat(),NV.Qb(e)),e.shape.length-1))})}function Q$(t,e,r=!1){return Object(NV.ud)(()=>{const i=NV.wb(function(t){const e=[IH(t.shape)];return t.reshape(e)}(t)).toInt(),n=(e=NV.Q(e,MV(),1-MV())).shape;return J$(NV.nc(i,n[n.length-1]).reshape(n),e,r)})}function tW(t,e){return Object(NV.ud)(()=>{let r;return r=NV.Q(e,MV(),1-MV()),r=NV.Qb(NV.ib(r,NV.jd(1,r))),NV.cc(function(t,e){if(!NV.Cd.arraysEqual(t.shape,e.shape))throw new LV("logits and labels must have the same shape, but got shapes "+`${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return Object(NV.ud)(()=>{const r=e.relu(),i=e.abs().neg();return r.sub(e.mul(t)).add(i.exp().log1p())})}(t,r),-1)})}function eW(t,e){return Object(NV.ud)(()=>{const r=NV.Q(t,MV(),1),i=NV.Q(e,MV(),1);return NV.kd(NV.ic(t,NV.Qb(NV.ib(r,i))),-1)})}function rW(t,e){return Object(NV.ud)(()=>{const r=W$(t,-1),i=W$(e,-1),n=NV.ic(r,i);return NV.kc(NV.kd(n,-1))})}V$.constructors={};const iW={meanSquaredError:Y$,meanAbsoluteError:q$,meanAbsolutePercentageError:K$,meanSquaredLogarithmicError:Z$,squaredHinge:function(t,e){return Object(NV.ud)(()=>{const r=NV.bc(0,NV.jd(1,NV.ic(t,e)));return NV.cc(GH(r),-1)})},hinge:function(t,e){return Object(NV.ud)(()=>{const r=NV.bc(0,NV.jd(1,NV.ic(t,e)));return NV.cc(r,-1)})},categoricalHinge:function(t,e){return Object(NV.ud)(()=>{const r=NV.kd(NV.ic(t,e),-1),i=NV.Xb(NV.ic(NV.jd(1,t),e),-1);return NV.bc(0,NV.r(1,NV.jd(i,r)))})},logcosh:function(t,e){return Object(NV.ud)(()=>{const r=Math.log(2),i=NV.jd(e,t),n=NV.jd(NV.r(i,NV.Zc(NV.ic(-2,i))),r);return NV.cc(n,-1)})},categoricalCrossentropy:J$,sparseCategoricalCrossentropy:Q$,binaryCrossentropy:tW,kullbackLeiblerDivergence:eW,poisson:function(t,e){return Object(NV.ud)(()=>{const r=NV.Qb(NV.r(MV(),e));return NV.cc(NV.jd(e,NV.ic(t,r)),-1)})},cosineProximity:rW};function nW(t){if("string"==typeof t){if(t in iW)return iW[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. `+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new LV(e)}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sW(t,e){return Object(NV.ud)(()=>{const r=NV.ic(.5,NV.pc(e)),i=NH(NV.Bb(e,r),t.dtype);return NV.cc(NV.ob(t,i),-1)})}function oW(t,e){return Object(NV.ud)(()=>NH(NV.ob(NV.v(t,-1),NV.v(e,-1)),"float32"))}function aW(t,e){return Object(NV.ud)(()=>NV.Tb(t.equal(1),e.equal(1)).sum().cast("float32"))}function hW(t,e){return Object(NV.ud)(()=>{const r=aW(t,e),i=function(t,e){return Object(NV.ud)(()=>NV.Tb(t.equal(0),e.equal(1)).sum().cast("float32"))}(t,e),n=r.add(i);return NV.Gd(NV.Bb(n,0),r.div(n),0).cast("float32")})}function uW(t,e){return tW(t,e)}function lW(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),NV.ob(t,e).asType("float32")}const cW=J$,dW=Q$,pW={binaryAccuracy:sW,categoricalAccuracy:oW,precision:hW,categoricalCrossentropy:cW,sparseCategoricalCrossentropy:dW,mse:Y$,MSE:Y$,mae:q$,MAE:q$,mape:K$,MAPE:K$,cosine:rW};function fW(t){if("string"==typeof t&&t in pW)return pW[t];if("string"!=typeof t&&null!=t)return t;throw new LV(`Unknown metric ${t}`)}function mW(t){if(jV(null!==t,`Unknown LossOrMetricFn ${t}`),"string"==typeof t)return t;{let e;for(const r of Object.keys(iW))if(iW[r]===t){e=r;break}if(void 0!==e)return e;for(const r of Object.keys(pW))if(pW[r]===t){e=r;break}return void 0!==e?e:t.name}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gW(t,e,r=!1){if(null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!function t(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const r=Object.keys(e);for(const i of r){if("string"!=typeof i)return!1;if(!t(e[i]))return!1}return!0}if(Array.isArray(e)){for(const r of e)if(!t(r))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(r){const r=JSON.stringify(t);r.length>1048576&&console.warn(`User-defined metadata of model "${e}" is too large in `+`size (length=${r.length} when serialized). It is not `+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.")}}function yW(t,e,r,i=console.log){const n=function(t){let e=!0;const r=[],i=[];for(const e in t.nodesByDepth)r.push(t.nodesByDepth[e]);for(const t of r){if(t.length>1||1===t.length&&t[0].inboundLayers.length>1){e=!1;break}i.push(...t)}if(e)for(const r of t.layers){let t=!1;for(const n of r.inboundNodes)if(-1!==i.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),s=["Layer (type)","Output shape","Param #"];let o;if(n?(e=e||65,r=r||[.45,.85,1]):(e=e||98,r=r||[.33,.55,.67,1]),r[r.length-1]<=1&&(r=r.map(t=>Math.floor(e*t))),!n){s.push("Receives inputs"),o=[];for(const e in t.nodesByDepth)o.push(...t.nodesByDepth[e])}i("_".repeat(e)),vW(s,r,i),i("=".repeat(e));const a=t.layers;for(let t=0;t<a.length;++t)n?_W(a[t],r,i):bW(a[t],r,o,i),i((t===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const h=function(t){let e;e=null!=t.collectedTrainableWeights?E$(t.collectedTrainableWeights):E$(t.trainableWeights);return e}(t),u=E$(t.nonTrainableWeights);i(`Total params: ${h+u}`),i(`Trainable params: ${h}`),i(`Non-trainable params: ${u}`),i("_".repeat(e))}function vW(t,e,r=console.log){let i="";for(let r=0;r<t.length;++r)r>0&&(i=i.slice(0,i.length-1)+" "),i+=t[r],i=i.slice(0,e[r]),i+=" ".repeat(e[r]-i.length);r(i)}function _W(t,e,r){let i;try{i=JSON.stringify(t.outputShape)}catch(t){i="multiple"}vW([`${t.name} (${t.getClassName()})`,i,t.countParams().toString()],e,r)}function bW(t,e,r,i){let n;try{n=JSON.stringify(t.outputShape)}catch(t){n="multiple"}const s=[];for(const e of t.inboundNodes)if(!(null!=r&&r.length>0&&-1===r.indexOf(e)))for(let t=0;t<e.inboundLayers.length;++t){const r=e.inboundLayers[t].name,i=e.nodeIndices[t],n=e.tensorIndices[t];s.push(`${r}[${i}][${n}]`)}const o=t.name,a=t.getClassName(),h=0===s.length?"":s[0];vW([`${o} (${a})`,n,t.countParams().toString(),h],e,i);for(let t=1;t<s.length;++t)vW(["","","",s[t]],e,i)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xW(t,e,r){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof r}function TW(t,e){if(null===t)return null;if("string"==typeof t)return HV(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){const r=[],i=t.length;for(let n=0;n<i;++n){const i=t[n];xW(e,n,i)?r.push(i):r.push(TW(i,e))}return r}{const e={};for(const r of Object.keys(t)){const i=t[r];if("name"===r&&"string"==typeof i)e[r]=i;else{const t=HV(r);e[t]=TW(i,t)}}return e}}class EW{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof EW)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,r){if(null!=this.id2Value[t.id])throw new LV(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return Object(NV.O)(e,t.dtype)}catch(r){throw new LV(`The dtype of the feed (${e.dtype}) can not be cast to the dtype `+`of the key '${t.name}' (${t.dtype}).`)}}(t,e),this.name2Id[t.name]=t.id,null!=r&&(this.id2Mask[t.id]=r),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof C$){if(null==this.id2Value[t.id])throw new LV(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new LV(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof C$){if(null==this.id2Value[t.id])throw new LV(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new LV(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&Object(NV.hb)(this.id2Mask)}}const wW={},SW={};function IW(t,e,r,i){const n=null!=r&&r.training,s=Array.isArray(t),o=s?t:[t],a=o.map(t=>t.name),h=[],u=e.names();for(const t of a)-1!==u.indexOf(t)?h.push(e.getValue(t)):h.push(null);null!=i&&(i.maxNumTensors=-1/0,i.minNumTensors=1/0);const l=a.join(",")+"|"+e.names().join(",");let c,d;if(null==wW[l]){const t=function(t,e){NV.Cd.assert(null!=t&&t.length>0,()=>"Expected at least one fetch, got none");let r=[],i={};if(1===t.length){const n=CW(t[0],e);r=n.sorted,i=n.recipientMap}else{const n=new Set;for(const s of t){const{sorted:t,recipientMap:o}=CW(s,e);for(const e of t)n.has(e.name)||(r.push(e),n.add(e.name));for(const t in o)null==i[t]&&(i[t]=new Set),o[t].forEach(e=>i[t].add(e))}}return{sorted:r,recipientCounts:AW(i)}}(o,e);c=t.sorted,d=t.recipientCounts,wW[l]=c,SW[l]=d}c=wW[l],d={},n||Object.assign(d,SW[l]);const p=new EW(e);for(let t=0;t<c.length;++t){if(null!=i){const t=Object(NV.dc)().numTensors;t>i.maxNumTensors&&(i.maxNumTensors=t),t<i.minNumTensors&&(i.minNumTensors=t)}const s=c[t],o=s.sourceLayer;if(o instanceof M$)continue;const u=[],l=[],f=[];let m=!1;for(const t of s.inputs){const r=p.getValue(t),i=p.getMask(t);u.push(r),l.push(i),null!=i&&(m=!0),n||(d[t.name]--,0!==d[t.name]||e.hasKey(t)||-1!==a.indexOf(t.name)||r.isDisposed||!0===t.sourceLayer.stateful||f.push(r))}m&&((r=r||{}).mask=l[0]);const g=zV(o.apply(u,r));let y=null;o.supportsMasking&&(y=o.computeMask(u,l));const v=OW(s),_=Array.isArray(v)?v:[v];for(let t=0;t<_.length;++t){p.hasKey(_[t])||p.add(_[t],g[t],Array.isArray(y)?y[0]:y);const e=a.indexOf(_[t].name);-1!==e&&(h[e]=g[t])}n||Object(NV.hb)(f)}return p.disposeMasks(),s?h:h[0]}function AW(t){const e={};for(const r in t)e[r]=t[r].size;return e}function CW(t,e){const r=new Set,i=[],n={};for(const t of e.names())r.add(t);const s=[],o=[];for(s.push(t);s.length>0;){const t=s[s.length-1];if(r.has(t.name)){s.pop();continue}const e=o[o.length-1]===s.length-1;if(0===t.inputs.length||e)s.pop(),i.push(t),r.add(t.name),e&&o.pop();else{o.push(s.length-1);for(const e of t.inputs)null==n[e.name]&&(n[e.name]=new Set),n[e.name].add(t.name),r.has(e.name)||s.push(e)}}return{sorted:i,recipientMap:n}}function OW(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let r=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const i of t.sourceLayer.inboundNodes[e].outputTensors)if(i.id===t.id){r=e;break}e=t.sourceLayer.getOutputAt(r)}return e}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class RW extends P${constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=v$(t)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],KV(this.inputs).length!==this.inputs.length)throw new LV("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+`${this.inputs.map(t=>t.name)}`);KV(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+`${this.outputs.map(t=>t.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const t of this.outputs){const e=t.sourceLayer,r=t.nodeIndex,i=t.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(r),this.outputLayersTensorIndices.push(i)}for(const t of this.inputs){const e=t.sourceLayer,r=t.nodeIndex,i=t.tensorIndex;jV(0===r,"input layer has >1 nodes"),jV(0===i,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(r),this.inputLayersTensorIndices.push(i)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let e=0;e<this.inputLayers.length;e++){const r=this.inputLayers[e];if(!(r instanceof M$))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+`Received inputs: ${t.inputs}. `+`Input ${e} (0-based) originates `+`from layer type ${r.getClassName()}.`);this.inputNames.push(r.name),this.feedInputShapes.push(r.batchInputShape),this.feedInputNames.push(r.name)}for(const t of this.outputLayers)this.outputNames.push(t.name);this.internalInputShapes=this.inputs.map(t=>t.shape),this.internalOutputShapes=this.outputs.map(t=>t.shape);const e={},r={},i={},n={},s={},o=[],a=(t,e,r,i,n,h)=>{null!=i&&null!=n&&null!=h||(i=t.sourceLayer,n=t.nodeIndex,h=t.tensorIndex);const u=i.inboundNodes[n];if(-1!==r.indexOf(u))throw new FV(`The tensor ${t.name} at layer "${i.name}" `+"is part of a cycle.");if(-1!==e.indexOf(u))return;this.containerNodes.add(RW.nodeKey(i,n)),i.id in s||(s[i.id]=Object.keys(s).length),-1===r.indexOf(u)&&r.push(u);const l=u.inboundLayers.length;for(let t=0;t<l;t++){const i=u.inputTensors[t],n=u.inboundLayers[t],s=u.nodeIndices[t],o=u.tensorIndices[t];a(i,e,r,n,s,o)}for(e.push(u);r.indexOf(u)>=0;)r.splice(r.indexOf(u),1);o.push(u)},h=[],u=[];for(const t of this.outputs)a(t,h,u);const l=o.slice().reverse();for(const t of l){r[t.id]=t,t.id in e||(e[t.id]=0);let s=e[t.id];const o=null==i[t.outboundLayer.id]?0:i[t.outboundLayer.id];s=Math.max(s,o),i[t.outboundLayer.id]=s,n[t.outboundLayer.id]=t.outboundLayer,e[t.id]=s;for(let i=0;i<t.inboundLayers.length;i++){const n=t.inboundLayers[i],o=t.nodeIndices[i],a=n.inboundNodes[o],h=null==e[a.id]?0:e[a.id];e[a.id]=Math.max(s+1,h),r[a.id]=a}}const c={};for(const t in e){const i=e[t];i in c||(c[i]=[]),c[i].push(r[t])}const d={};for(const t in i){const e=i[t];e in d||(d[e]=[]),d[e].push(n[t])}let p=Object.keys(d).map(t=>parseInt(t,10)).sort(qV);this.layers=[];for(const t of p){const e=d[t];e.sort((t,e)=>{const r=s[t.id],i=s[e.id];return r<i?-1:r>i?1:0});for(const t of e)t instanceof RW&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=d,p=Object.keys(c).map(t=>parseInt(t,10)).sort(qV);const f=this.inputs.slice(),m=[];for(const t of p)for(const e of c[t]){const t=e.outboundLayer;if(null!=t){for(const r of e.inputTensors)if(-1===f.indexOf(r))throw new FV(`Graph disconnected: cannot obtain value for tensor ${r}`+` at layer "${t.name}". `+"The following previous layers were accessed without "+`issue: ${m}`);for(const t of e.outputTensors)f.push(t);m.push(t.name)}}this.nodesByDepth=c;const g=this.layers.map(t=>t.name);for(const t of g){const e=g.filter(e=>e===t).length;if(1!==e)throw new FV(`The name "${t}" is used ${e} times `+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new R$({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(t=>null),outputMasks:this.outputs.map(t=>null),inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs.map(t=>t.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(e=>e.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new LV("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const r={};let i=0;for(const t of this.layers)for(const e of t.weights){if(null!=r[e.originalName])throw new LV(`Duplicate weight name: ${e.originalName}`);r[e.originalName]=e,i++}const n=[];for(const i in t){let s=i;if(null==r[i]){const t=i.split("/");s=t.slice(0,-2).concat([t[t.length-1]]).join("/")}if(null!=r[s])n.push([r[s],t[i]]);else if(e)throw new LV(`Provided weight data has no target variable: ${i}`);delete r[s]}if(e){const t=[];for(const e in r)t.push(e);if(t.length>0)throw new LV(`${t.length} of ${i} weights are not set: `+`${t}`)}I$(n)}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers 2.0.1",e.backend="TensorFlow.js",e}toJSON(t,e=!0){const r=function t(e,r){if(null==e)return null;if("string"==typeof e)return VV(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){const i=[],n=e.length;for(let s=0;s<n;++s){const n=e[s];xW(r,s,n)?i.push(n):i.push(t(n,r))}return i}{const r={};for(const i of Object.keys(e)){const n=e[i],s=VV(i);r[s]="name"!==i&&"className"!==i||"string"!=typeof n?t(n,i):n}return r}}
/** @license See the LICENSE file. */(this.updatedConfig());return e?JSON.stringify(r):r}call(t,e){return Object(NV.ud)(()=>{t=zV(t);const r=new EW;for(let e=0;e<this.inputs.length;++e)r.add(this.inputs[e],t[e]);return IW(this.outputs,r,e)})}computeMask(t,e){return Object(NV.ud)(()=>{let r;return t=zV(t),r=null==e?BV(null,t.length):zV(e),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){const e=b$(t);if(e.length!==this.inputLayers.length)throw new LV(`Invalid inputShape argument ${t}: `+`model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let t=0;t<e.length;t++){const i=this.inputLayers[t],n=e[t];r[i.name+"_0_0"]=n}const i=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(qV);if(i.length>1)for(const t of i){const e=this.nodesByDepth[t];for(const t of e){const e=t.outboundLayer;if(-1!==this.inputLayers.map(t=>t.id).indexOf(e.id))continue;const i=[];for(let e=0;e<t.inboundLayers.length;e++){const n=t.inboundLayers[e],s=t.nodeIndices[e],o=t.tensorIndices[e],a=r[`${n.name}_${s}_${o}`];i.push(a)}const n=b$(e.computeOutputShape(GV(i))),s=e.inboundNodes.indexOf(t);for(let t=0;t<n.length;t++){r[`${e.name}_${s}_${t}`]=n[t]}}}const n=[],s=[];for(let t=0;t<this.outputLayers.length;t++){const e=this.outputLayers[t],r=this.outputLayersNodeIndices[t],i=this.outputLayersTensorIndices[t],n=`${e.name}_${r}_${i}`;s.push(n)}for(let t=0;t<s.length;t++){const e=s[t];jV(e in r),n.push(r[e])}return GV(n)}runInternalGraph(t,e){null==e&&(e=BV(null,t.length));const r={};for(let i=0;i<this.inputs.length;++i){const n=this.inputs[i],s=t[i],o=e[i];r[n.id]=[s,o]}const i=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(qV);for(const t of i){const e=this.nodesByDepth[t];for(const t of e){const e=t.outboundLayer,i=t.inputTensors,n=t.outputTensors,s=new Array;for(const t of i)t.id in r&&s.push(r[t.id]);if(s.length===i.length){let i,o,a,h,u={};if(null!=t.callArgs&&(u=t.callArgs),1===s.length){const[t,r]=s[0];null==u.mask&&(u.mask=r),a=zV(e.call(t,u)),h=zV(e.computeMask(t,r)),i=[t],o=[r]}else i=s.map(t=>t[0]),o=s.map(t=>t[1]),null==u.mask&&(u.mask=o),a=zV(e.call(i,u)),h=zV(e.computeMask(i,o));if(e.activityRegularizer)throw new kV("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<n.length;++t){const e=n[t],i=a[t],s=h[t];r[e.id]=[i,s]}}}}const n=[],s=[],o=[];for(const t of this.outputs){jV(t.id in r,`Could not compute output ${t.name} : ${t.id}`);const[e,i]=r[t.id];o.push(e.shape),n.push(e),s.push(i)}return[n,s,o]}buildNodeConversionMap(t){const e={};let r;for(const t of this.layers){r=t instanceof RW?1:0;for(let i=0;i<t.inboundNodes.length;i++){const n=RW.nodeKey(t,i);this.containerNodes.has(n)&&(e[n]=r,r+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new LV(`Was asked to retrieve layer at index ${e}, but model only `+`has ${this.layers.length} layer(s).`);return this.layers[e]}if(null==t)throw new LV("Provide either a layer name or layer index");for(const e of this.layers)if(e.name===t)return e;throw new LV(`No such layer: ${t}`)}calculateLosses(){return Object(NV.ud)(()=>{const t=[];for(const e of this.layers)for(let r=0;r<e.inboundNodes.length;++r){const i=RW.nodeKey(e,r);this.containerNodes.has(i)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),r=[];for(const t of this.layers){const i=t.getClassName(),n=t.getConfig(),s=[];for(let r=0;r<t.inboundNodes.length;r++){const i=t.inboundNodes[r],n=RW.nodeKey(t,r);let o={};if(this.containerNodes.has(n)){if(i.callArgs)try{JSON.stringify(i.callArgs),o=i.callArgs}catch(e){console.warn(`Layer ${t.name} was passed `+"non-serializable keyword arguments: "+`${i.callArgs}. They will not be included `+"in the serialized model (and thus will be missing at deserialization time)."),o={}}if(i.inboundLayers.length>0){const t=[];for(let r=0;r<i.inboundLayers.length;r++){const n=i.inboundLayers[r],s=i.nodeIndices[r],a=i.tensorIndices[r];let h=e[RW.nodeKey(n,s)];null==h&&(h=0),t.push([n.name,h,a,o])}s.push(t)}}}const o={};o.name=t.name,o.className=i,o.config=n,o.inboundNodes=s,r.push(o)}t.layers=r;const i=[];for(let t=0;t<this.inputLayers.length;t++){const r=this.inputLayers[t],n=this.inputLayersNodeIndices[t],s=RW.nodeKey(r,n);if(!this.containerNodes.has(s))continue;let o=e[s];null==o&&(o=0);const a=this.inputLayersTensorIndices[t];i.push([r.name,o,a])}t.inputLayers=i;const n=[];for(let t=0;t<this.outputLayers.length;t++){const r=this.outputLayers[t],i=this.outputLayersNodeIndices[t],s=RW.nodeKey(r,i);if(!this.containerNodes.has(s))continue;let o=e[s];null==o&&(o=0);const a=this.outputLayersTensorIndices[t];n.push([r.name,o,a])}return t.outputLayers=n,t}static fromConfig(t,e,r={},i=!1){const n={},s={};function o(t,e){t.name in s?s[t.name].push(e):s[t.name]=[e]}function a(t,e){const r=[];let i;for(const s of e){const a=s[0],h=s[1],u=s[2];if(i=null==s[3]?{}:s[3],!(a in n))return void o(t,e);const l=n[a];if(l.inboundNodes.length<=h)return void o(t,e);const c=l.inboundNodes[h];r.push(c.outputTensors[u])}r.length>0&&t.apply(GV(r),i)}function h(t){const r=t.name,s=$$(t,null!=e.customObjects?e.customObjects:{});s.setFastWeightInitDuringBuild(i),n[r]=s,t.inboundNodes.forEach(t=>{if(!(t instanceof Array))throw new LV(`Corrupted configuration, expected array for nodeData: ${t}`);o(s,t)})}const u=e.name,l=e.layers;for(const t of l)h(t);for(;!ZV(s);)for(const t of l){const e=n[t.name];if(e.name in s){const t=s[e.name];delete s[e.name];for(const r of t)a(e,r)}}const c=[],d=[],p=e.inputLayers;for(const t of p){const e=t[0],r=t[1],i=t[2];jV(e in n);const s=n[e].inboundNodes[r].outputTensors;c.push(s[i])}const f=e.outputLayers;for(const t of f){const e=t[0],r=t[1],i=t[2];jV(e in n);const s=n[e].inboundNodes[r].outputTensors;d.push(s[i])}return new t({inputs:c,outputs:d,name:u})}get stateful(){if(this._stateful)throw new LV("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Object(NV.ud)(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function NW(t,e,r){const i=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>null);if(1===i)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==i)throw new Error(`Provided ${r} is an array of ${t.length} `+`element(s), but the model has ${i} outputs. `+"Make sure a set of weights is provided for each model output.");return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){const r=[];return e.forEach(e=>{e in t?r.push(t[e]):r.push(null)}),r}throw new Error(`The model has multiple (${i}) outputs, `+`so ${r} must be either an array with `+`${i} elements or an object with ${e} keys. `+`Provided ${r} not understood: ${JSON.stringify(t)}`)}function PW(t,e){return NW(t,e,"classWeight")}async function MW(t,e,r,i){if(null!=e||null!=i)throw new Error("Support sampleWeight is not implemented yet");if(null!=r){const e=Object(NV.ud)(()=>{if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1){const e=1;return t.argMax(e)}if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) `+"during handling of class weights. The size is expected to be >= 1.")}throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during `+"handling of class weights. The rank is expected to be 1 or 2.")}),i=Array.from(await e.data());Object(NV.hb)(e);const n=[];return i.forEach(t=>{if(null==r[t])throw new Error("classWeight must contain all classes in the training data. "+`The class ${t} exists in the data but not in `+"classWeight");n.push(r[t])}),Object(NV.pd)(n,"float32")}return null}function DW(t,e){return Object(NV.ic)(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function FW(t,e){let r,i;const n=e;r=n.xs,i=n.ys,NV.Cd.assert(null!=r&&null!=i,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+`${e}`);const s=LW("input",t.inputNames,r),o=LW("output",t.outputNames,i),a=s[0].shape[0];NV.Cd.assert(s.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset `+`provides ${s.length} inputs.  (Expected input keys: `+`${JSON.stringify(t.inputNames)})`),NV.Cd.assert(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset `+`provides ${o.length} outputs.  (Expected output keys: `+`${JSON.stringify(t.outputNames)})`);for(let e=0;e<s.length;e++)NV.Cd.assert(s[e].shape[0]===a,()=>"Batch size mismatch: input "+`${t.inputNames[e]} has ${s[e].shape[0]}; `+`expected  ${a} based on input ${t.inputNames[0]}.`);for(let e=0;e<o.length;e++)NV.Cd.assert(o[e].shape[0]===a,()=>"Batch size mismatch: output "+`${t.outputNames[e]} has ${o[e].shape[0]}; `+`expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:s,ys:o}}function LW(t,e,r){if(r instanceof NV.l)return[r];if(Array.isArray(r))return NV.Cd.assert(r.length===e.length,()=>`Received an array of ${r.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),r;{const i=[];for(const n of e){if(null==r[n])throw new LV("The feature data generated by the dataset lacks the required "+`${t} key '${n}'.`);i.push(r[n])}return i}}async function kW(t,e,r){const i=null!=r.batchesPerEpoch;if(NV.Cd.assert(null!=t.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),NV.Cd.assert(null!=r,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),NV.Cd.assert(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive "+`integer, but got ${r.epochs}`),NV.Cd.assert(!i||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+`positive integer if specified, but got ${r.batchesPerEpoch}`),NV.Cd.assert(null==r.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const n=null!=r.validationData;let s,o;if(n)if(UW(r.validationData))NV.Cd.assert(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+`but got ${r.validationBatches}`);else{const t=function(t){if(3===t.length)throw new kV("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(r.validationData);s=t.xs,o=t.ys}const a=t.makeTrainFunction(),h=t.getDedupedMetricsNames();let u;u=n?h.slice().concat(h.map(t=>"val_"+t)):h.slice();const l=z$(r.callbacks,r.yieldEvery),c=null==r.verbose?1:r.verbose,{callbackList:d,history:p}=H$(l,c,r.epochs,null,null,function(t,e){let r=null;null!=e.batchesPerEpoch?r=e.batchesPerEpoch:Number.isFinite(t.size)&&(r=t.size);return r}(e,r),null,n,u);d.setModel(t),t.history=p,await d.onTrainBegin(),t.stopTraining_=!1;let f=null==r.initialEpoch?0:r.initialEpoch,m=await e.iterator();for(;f<r.epochs;){const u={};await d.onEpochBegin(f);let l=0,c=0;for(i||(m=await e.iterator());!i||l<r.batchesPerEpoch;){const e=await m.next();if(i&&e.done){console.warn("You provided `batchesPerEpoch` as "+`${r.batchesPerEpoch}, `+"but your dataset iterator ran out of data after "+`${l} batches; `+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+`${r.batchesPerEpoch*r.epochs} batches). `+"You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:i,ys:n}=FW(t,e.value),s={};s.batch=c,s.size=i[0].shape[0],await d.onBatchBegin(c,s);const o=[];if(null!=r.classWeight){const e=PW(r.classWeight,t.outputNames);for(let t=0;t<e.length;++t)o.push(await MW(n[t],null,e[t]))}const u=i.concat(n).concat(o),p=a(u);NV.hb(u);for(let t=0;t<h.length;++t){const e=h[t],r=p[t];s[e]=r,NV.Ib(r)}await d.onBatchEnd(c,s),L$(s),c++,l++}if(i?l>=r.batchesPerEpoch:e.done){if(n){let e;e=UW(r.validationData)?zV(await t.evaluateDataset(r.validationData,{batches:r.validationBatches})):zV(t.evaluate(s,o,{batchSize:null==r.validationBatchSize?32:r.validationBatchSize,verbose:0}));for(let r=0;r<t.metricsNames.length;++r)u[`val_${t.metricsNames[r]}`]=e[r]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(f,u),f++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function UW(t){return"function"==typeof t.iterator}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function BW(t){NV.Cd.assert(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function jW(t,e,r){return null==t?[null]:Array.isArray(t)?t.map(t=>MH(t,e,r-e)):MH(t,e,r-e)}function XW(t,e){return NV.ud(()=>null==t?null:Array.isArray(t)?t.map(t=>XW(t,e)):XH(t,"int32"===e.dtype?e:e.toInt()))}function GW(t,e){const r=[];let i=0,n=null;for(;i<t;)n=i+e,n>=t&&(n=t),r.push([i,n]),i=n;return r}async function zW(t,e,r,i={}){if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let n,s,o,a,h,u,l;t.isTraining=!0;try{const c=null==i.batchSize?32:i.batchSize;BW(c);const d=!1,p=await t.standardizeUserData(e,r,i.sampleWeight,i.classWeight,d,c);n=p[0],s=p[1],l=p[2];let f,m=!1;if(null!=i.validationData&&i.validationData.length>0){if(m=!0,2!==i.validationData.length)throw 3===i.validationData.length?new kV("validationData including sample weights is not supported yet."):new LV("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+`${i.validationData} is invalid.`);o=i.validationData[0],a=i.validationData[1];const e=!0,r=await t.standardizeUserData(o,a,null,null,e,c);h=r[0],u=r[1],f=h.concat(u)}else if(null!=i.validationSplit&&i.validationSplit>0&&i.validationSplit<1){m=!0;const t=Math.floor(n[0].shape[0]*(1-i.validationSplit)),e=n[0].shape[0];h=jW(n,t,e),n=jW(n,0,t),u=jW(s,t,e),s=jW(s,0,t),f=h.concat(u)}else null!=i.validationSteps&&(m=!0);const g=n.concat(s).concat(l);t.checkTrainableWeightsConsistency();const y=t.makeTrainFunction(),v=t.getDedupedMetricsNames();let _,b;m?(t.makeTestFunction(),_=t.testFunction,b=v.slice().concat(v.map(t=>"val_"+t))):(_=null,f=[],b=v.slice());const x=z$(i.callbacks,i.yieldEvery);return await async function(t,e,r,i,n,s,o,a,h,u,l,c,d,p,f){null==n&&(n=32),null==s&&(s=1),null==l&&(l=!0),null==d&&(d=0);let m=!1;if(null!=h&&null!=u&&(m=!0),null!=f&&(m=!0,null==p))throw new LV("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=t.checkNumSamples(r,n,p,"steps_per_epoch");let y;null!=g&&(y=RH(0,g)),null==o&&(o=1);const{callbackList:v,history:_}=H$(a,o,s,d,g,p,n,m,c);v.setModel(t),t.history=_,await v.onTrainBegin(),t.stopTraining_=!1;for(let o=d;o<s;++o){await v.onEpochBegin(o);const s={};if(null!=p)throw new kV("stepsPerEpoch mode is not implemented yet.");{if("batch"===l)throw new kV("batch shuffling is not implemneted yet");l&&NV.Cd.shuffle(y);const o=Object(NV.pd)(y),a=GW(g,n);for(let l=0;l<a.length;++l){const c={};if(await v.onBatchBegin(l,c),NV.ud(()=>{const d=a[l][0],p=a[l][1],f=MH(o,d,p-d);c.batch=l,c.size=p-d;const g=XW(r,f),y=e(g);for(let t=0;t<i.length;++t){const e=i[t],r=y[t];c[e]=r,NV.Ib(r)}if(l===a.length-1&&m){const e=t.testLoop(h,u,n);for(let t=0;t<i.length;++t){const r=i[t],n=e[t];NV.Ib(n),s["val_"+r]=n}}}),await v.onBatchEnd(l,c),L$(c),t.stopTraining_)break}o.dispose()}if(await v.onEpochEnd(o,s),t.stopTraining_)break}return await v.onTrainEnd(),await t.history.syncData(),t.history}(t,y,g,v,c,i.epochs,i.verbose,x,_,f,i.shuffle,b,i.initialEpoch,null,null)}finally{t.isTraining=!1,HW(n,e),HW(s,r),HW(h,o),HW(u,a),null!=l&&NV.hb(l)}}function VW(t){const e=[];t instanceof NV.l&&(t=[t]);for(let r=0;r<t.length;++r){const i=t[r];if(1===i.rank)e.push(PH(i,1));else{if(0===i.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(i)}}return e}function HW(t,e){if(null==t)return;const r=[];if(e instanceof NV.l)r.push(e.id);else if(Array.isArray(e))e.forEach(t=>r.push(t.id));else if(null!=e)for(const t in e){const i=e[t];r.push(i.id)}const i=[];if(t instanceof NV.l)-1===r.indexOf(t.id)&&i.push(t);else if(Array.isArray(t))t.forEach(t=>{-1===r.indexOf(t.id)&&i.push(t)});else if(null!=t)for(const e in t){const n=t[e];-1===r.indexOf(n.id)&&i.push(n)}i.forEach(t=>{t.isDisposed||t.dispose()})}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $W(t){return Array.isArray(t)}function WW(t){return!function(t){return t instanceof NV.l}(t)&&!$W(t)}function YW(t,e,r,i=!0,n=""){if(null==e||0===e.length){if(null!=t){let e=!1;if($W(t)&&t.length>0)e=!0;else if(WW(t)){for(const r in t)if(t.hasOwnProperty(r)){e=!0;break}}else e=!0;if(e)throw new LV(`Error when checking model ${n} expected no data, `+`but got ${t}`)}return[]}if(null==t)return e.map(t=>null);let s;if(WW(t)){t=t,s=[];for(const r of e){if(null==t[r])throw new LV(`No data provided for "${r}". Need data for each key in: `+`${e}`);s.push(t[r])}}else if($W(t)){if((t=t).length!==e.length)throw new LV(`Error when checking model ${n}: the Array of `+"Tensors that you are passing to your model is not the size the "+`model expected. Expected to see ${e.length} Tensor(s), but `+`instead got the following list of Tensor(s): ${t}`);s=t}else{if(t=t,e.length>1)throw new LV(`The model ${n} expects ${e.length} Tensor(s), `+`but only received one Tensor. Found: Tensor with shape ${t.shape}`);s=[t]}if(s=VW(s),null!=r)for(let t=0;t<e.length;++t){if(null==r[t])continue;const o=s[t];if(o.shape.length!==r[t].length)throw new LV(`Error when checking ${n}: expected ${e[t]} `+`to have ${r[t].length} dimension(s). but got array with `+`shape ${o.shape}`);for(let s=0;s<r[t].length;++s){if(0===s&&!i)continue;const a=o.shape[s],h=r[t][s];if(null!=h&&h>=0&&a!==h)throw new LV(`Error when checking ${n}: expected ${e[t]} `+`to have shape [${r[t]}], but got array with shape `+`[${o.shape}].`)}}return s}function qW(t,e,r,i=!0,n=""){let s;if(Array.isArray(t)){if(t.length!==e.length)throw new LV(`Error when checking model ${n}: the Array of `+"Tensors that you are passing to your model is not the size the "+`the model expected. Expected to see ${e.length} Tensor(s),`+` but instead got ${t.length} Tensors(s).`);s=t}else{if(e.length>1)throw new LV(`The model expects ${e.length} ${n} Tensors, `+"but only received one Tensor. Found: array with shape "+`${JSON.stringify(t.shape)}.`);s=[t]}if(null!=r)for(let t=0;t<e.length;++t){if(null==r[t])continue;const o=s[t];if(o.shape.length!==r[t].length)throw new LV(`Error when checking ${n}: expected ${e[t]} `+`to have ${r[t].length} dimension(s), but got array with `+`shape ${JSON.stringify(o.shape)}`);for(let s=0;s<r[t].length;++s){if(0===s&&!i)continue;const a=o.shape[s],h=r[t][s];if(null!=h&&h!==a)throw new LV(`Error when checking ${n}: expected `+`${e[t]} to have shape ${JSON.stringify(r[t])} but `+`got array with shape ${JSON.stringify(o.shape)}.`)}}}class KW extends RW{constructor(t){super(t),this.isTraining=!1}summary(t,e,r=console.log){if(!this.built)throw new LV("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");yW(this,t,e,r)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){const e={Adagrad:()=>NV.xd.adagrad(.01),Adadelta:()=>NV.xd.adadelta(1,.95,MV()),Adam:()=>NV.xd.adam(.001,.9,.999,MV()),Adamax:()=>NV.xd.adamax(.002,.9,.999,MV(),0),RMSProp:()=>NV.xd.rmsprop(.001,.9,0,MV()),SGD:()=>NV.xd.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new LV(`Unknown Optimizer ${t}`)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof NV.i))throw new LV("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new LV("When passing an Array as loss, it should have one entry per "+`model output. The model has ${this.outputs.length} output(s), `+`but you passed loss=${t.loss}.`);const r=t.loss;e=r.map(t=>nW(t))}else{const r=nW(t.loss);this.outputs.forEach(t=>{e.push(r)})}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new LV(`Unknown entry in loss dictionary: "${e}". `+`Only expected the following keys: ${this.outputNames}`);for(const r of this.outputNames)null==t.loss[r]&&console.warn(`Output "${r}" is missing from loss dictionary. We assume `+"this was done on purpose, and we will not be expecting data "+`to be passed to ${r} during training`),e.push(nW(t.loss[r]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let t=0;t<this.outputs.length;++t){const e=this.internalOutputShapes[t],r=this.outputNames[t];this.feedOutputNames.push(r),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[t])}const r=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],xH("loss",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==r.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}});const i=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>[]);let r;if("string"==typeof t||"function"==typeof t)r=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,"+`function, Array, or Object, found: ${t}`);r=t}if(Array.isArray(r))return e.map(t=>r);{const t=[];for(const i of e){let e=r.hasOwnProperty(i)?r[i]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),n=(t,e,r)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([r,t])};xH("metric",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==r.indexOf(t))continue;(e=>{let r,i,s;for(const o of e){if("string"==typeof o&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(o)){const e=this.internalOutputShapes[t];let n;1===e[e.length-1]||this.lossFunctions[t]===tW?-1!==["accuracy","acc"].indexOf(o)?i=sW:-1!==["crossentropy","ce"].indexOf(o)&&(i=uW):this.lossFunctions[t]===Q$?-1!==["accuracy","acc"].indexOf(o)?i=lW:-1!==["crossentropy","ce"].indexOf(o)&&(i=dW):-1!==["accuracy","acc"].indexOf(o)?i=oW:-1!==["crossentropy","ce"].indexOf(o)&&(i=cW),-1!==["accuracy","acc"].indexOf(o)?n="acc":-1!==["crossentropy","ce"].indexOf(o)&&(n="ce"),s=i,r=""+n}else{const t=fW(o);s=t,r=""+mW(o)}let e;xH(r,()=>{e=s}),n(t,r,e)}})(i[t])}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,r={}){const i=null==r.batchSize?32:r.batchSize;BW(i);const n=this.standardizeUserDataXY(t,e,!0,i);try{const s=n[0].concat(n[1]);this.makeTestFunction();const o=this.testFunction;return GV(this.testLoop(o,s,i,r.verbose,r.steps))}finally{HW(n[0],t),HW(n[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),async function(t,e,r){const i=null!=(r=r||{}).batches,n=t.testFunction;let s=[];if(r.verbose>0)throw new kV("Verbose mode is not implemented yet.");NV.Cd.assert(!i||r.batches>0&&Number.isInteger(r.batches),()=>"Test loop expects `batches` to be a positive integer, but "+`received ${JSON.stringify(r.batches)}`);const o="function"==typeof e.next?e:await e.iterator();let a=0,h=0;for(;!i||h<r.batches;){const e=await o.next();if(s=NV.ud(()=>{if(e.value){const{xs:r,ys:i}=FW(t,e.value),o=r.concat(i),u=NV.ud(()=>n(o));if(NV.hb(o),0===h)for(let t=0;t<u.length;++t)s.push(Object(NV.Hc)(0));const l=o[0].shape[0];for(let t=0;t<u.length;++t){const e=u[t],r=s[t];s[t]=NV.ud(()=>NV.r(s[t],NV.ic(l,e))),h>0&&NV.hb(r)}NV.hb(u),a+=l,++h}return s}),e.done){i&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+`batches (in this case, ${r.batches} batches). `+"You may need to use the repeat() function when building your dataset.");break}}for(let t=0;t<s.length;++t){const e=s[t];s[t]=NV.ib(s[t],a),NV.hb(e)}return GV(s)}(this,t,e)}checkNumSamples(t,e,r,i="steps"){let n;if(null!=r){if(n=null,null!=e)throw new LV(`If ${i} is set, batchSize must be null or undefined.`+`Got batchSize = ${e}`)}else{if(null==t)throw new LV("Either the input data should have a defined shape, or "+`${i} shoud be specified.`);n=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return n}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new LV("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(e),i=r?e:[e],n=this.retrieveSymbolicTensors(i),s=new EW;if(t instanceof NV.l&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new LV(`The number of inputs provided (${t.length}) `+"does not match the number of inputs of this model "+`(${this.inputs.length}).`);for(let e=0;e<this.inputs.length;++e)s.add(this.inputs[e],t[e])}else for(const e of this.inputs){const r=t[e.name];if(null==r)throw new LV(`No value is provided for the model's input ${e.name}`);s.add(e,r)}const o=IW(n,s);return r?o:o[0]}retrieveSymbolicTensors(t){const e=BV(null,t.length);let r=t.length;for(const i of this.layers){const n=Array.isArray(i.output)?i.output:[i.output],s=n.map(t=>t.name);for(let i=0;i<t.length;++i){const o=s.indexOf(t[i]);if(-1!==o&&(e[i]=n[o],r--),0===r)break}if(0===r)break}if(r>0){const r=[];throw e.forEach((e,i)=>{null==e&&r.push(t[i])}),new LV("Cannot find SymbolicTensors for output name(s): "+`${JSON.stringify(r)}`)}return e}predictLoop(t,e=32,r=!1){return NV.ud(()=>{const i=this.checkNumSamples(t);if(r)throw new kV("Verbose predictLoop() is not implemented yet.");const n=GW(i,e),s=this.outputs.map(t=>[]);for(let e=0;e<n.length;++e){NV.ud(()=>{const r=n[e][0],i=n[e][1],s=jW(t,r,i),o=[];if(Array.isArray(s))for(let t=0;t<s.length;++t)o.push({key:this.inputs[t],value:s[t]});else o.push({key:this.inputs[0],value:s});const a=new EW(o);return IW(this.outputs,a)}).forEach((t,e)=>s[e].push(t))}return GV(s.map(t=>NV.S(t,0)))})}predict(t,e={}){const r=VW(t);qW(r,this.inputNames,this.feedInputShapes,!1);try{const i=null==e.batchSize?32:e.batchSize;return BW(i),this.predictLoop(r,i)}finally{HW(r,t)}}predictOnBatch(t){qW(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,r=!0,i){if(null==this.optimizer_)throw new FV("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const n=[];for(let t=0;t<this.feedOutputShapes.length;++t){const e=this.feedOutputShapes[t];this.feedLossFns[t]===Q$?n.push(e.slice(0,e.length-1).concat([1])):n.push(e)}if(function(t,e,r){const i=KV(t.map(t=>t.shape[0]));i.sort();const n=KV(e.map(t=>t.shape[0]));if(n.sort(),i.length>1)throw new LV("All input Tensors (x) should have the same number of samples. Got array shapes: "+`${JSON.stringify(t.map(t=>t.shape))}`);if(n.length>1)throw new LV("All target Tensors (y) should have the same number of samples. Got array shapes: "+`${JSON.stringify(e.map(t=>t.shape))}`);if(i.length>0&&n.length>0&&!NV.Cd.arraysEqual(i,n))throw new LV("Input Tensors should have the same number of samples as target "+`Tensors. Found ${i[0]} input sample(s) and ${n[0]} target `+"sample(s).")}(t=YW(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=YW(e,this.feedOutputNames,n,!1,"target")),function(t,e,r){const i=[Y$,tW,J$];for(let n=0;n<t.length;++n){const s=t[n],o=e[n],a=r[n];if(null!=o){if(o===J$&&1===s.shape[s.shape.length-1])throw new LV(`You are passing a target array of shape ${s.shape} while using `+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==i.indexOf(o)){const t=s.shape.slice(1),e=a.slice(1);for(let r=0;r<t.length;++r){const i=t[r],n=e[r];if(null!=n&&i!==n)throw new LV(`A target Tensor with shape ${s.shape} was passed for an `+`output of shape ${a}, while using a loss function that `+"expects targets to have the same shape as the output.")}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=i&&i>0&&t[0].shape[0]%i!=0)throw new LV("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+`${i}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,r,i,n=!0,s){const[o,a]=this.standardizeUserDataXY(t,e,n,s);if(null!=r)throw new Error("sample weight is not supported yet.");let h=null;if(null!=i){const t=PW(i,this.outputNames);h=[];for(let e=0;e<t.length;++e)h.push(await MW(a[e],null,t[e]))}return[o,a,h]}testLoop(t,e,r,i=0,n){return NV.ud(()=>{const s=this.checkNumSamples(e,r,n,"steps"),o=[];if(i>0)throw new kV("Verbose mode is not implemented yet.");if(null!=n)throw new kV("steps mode in testLoop() is not implemented yet");{const i=GW(s,r),n=Object(NV.pd)(RH(0,s));for(let r=0;r<i.length;++r){const s=i[r][0],a=i[r][1],h=MH(n,s,a-s),u=XW(e,h),l=t(u);if(0===r)for(let t=0;t<l.length;++t)o.push(Object(NV.Hc)(0));for(let t=0;t<l.length;++t){const e=l[t];o[t]=NV.r(o[t],NV.ic(a-s,e))}}for(let t=0;t<o.length;++t)o[t]=NV.ib(o[t],s)}return o})}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let r=0;r<t.length;++r){const i=t[r];let n=i;if(XV(t,i)>1){n+=`_${XV(t.slice(0,r),i)}`}e.push(n)}return e}makeTrainFunction(){return t=>{const e=[],r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),n=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),s=[],o=this.collectedTrainableWeights.map(t=>t.read());return[this.optimizer_.minimize(()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:r[e]});const o=new EW(t),a=IW(this.outputs,o,{training:!0});let h;for(let t=0;t<this.lossFunctions.length;++t){let r=(0,this.lossFunctions[t])(i[t],a[t]);null!=n[t]&&(r=DW(r,n[t]));const s=NV.cc(r);e.push(s),h=0===t?r:NV.r(h,r)}for(let t=0;t<this.metricsTensors.length;++t){let r;if(this.outputs.length>1&&t<this.outputs.length)r=e[t];else{const e=this.metricsTensors[t][0],n=this.metricsTensors[t][1];r=NV.cc(e(i[n],a[n]))}NV.Ib(r),s.push(r)}return h=NV.cc(h),this.calculateLosses().forEach(t=>{h=NV.r(h,t)}),h},!0,o)].concat(s)}}makeTestFunction(){this.testFunction=t=>NV.ud(()=>{const e=[];let r;const i=t.slice(0,this.inputs.length),n=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=[];for(let t=0;t<this.inputs.length;++t)s.push({key:this.inputs[t],value:i[t]});const o=new EW(s),a=IW(this.outputs,o);for(let t=0;t<this.lossFunctions.length;++t){const i=this.lossFunctions[t],s=NV.cc(i(n[t],a[t]));r=0===t?s:NV.r(r,s),e.push(r)}for(let t=0;t<this.metricsTensors.length;++t){const r=this.metricsTensors[t][0],i=this.metricsTensors[t][1],s=NV.cc(r(n[i],a[i]));e.push(s)}return e})}async fit(t,e,r={}){return zW(this,t,e,r)}async fitDataset(t,e){return kW(this,t,e)}async trainOnBatch(t,e){const r=await this.standardizeUserData(t,e),i=r[0],n=r[1],s=this.makeTrainFunction()(i.concat(n)),o=[];for(const t of s){const e=await t.data();o.push(e[0])}return NV.hb(s),GV(o)}getNamedWeights(t){const e=[],r=null!=t&&t.trainableOnly,i=r?this.trainableWeights:this.weights,n=this.getWeights(r);for(let t=0;t<i.length;++t)r&&!i[t].trainable||e.push({name:i[t].originalName,tensor:n[t]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=NV.dc().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-NV.dc().numTensors}return t}getLossIdentifiers(){let t;if("string"==typeof this.loss)t=VV(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!=typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(t=>VV(t))}else{const e=Object.keys(this.loss);t={};const r=this.loss;for(const i of e){if("string"!=typeof r[i])throw new Error("Serialization of non-string loss is not supported.");t[i]=VV(r[i])}}return t}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[VV(mW(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>VV(mW(t)));{const t={};for(const e in this.metrics)t[e]=VV(mW(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=$$(TW(t.optimizer_config));let r,i;if("string"==typeof t.loss)r=HV(t.loss);else if(Array.isArray(t.loss))r=t.loss.map(t=>HV(t));else if(null!=t.loss){r={};for(const e in t.loss)r[e]=HV(t.loss[e])}if(Array.isArray(t.metrics))i=t.metrics.map(t=>HV(t));else if(null!=t.metrics){i={};for(const e in t.metrics)i[e]=HV(t.metrics[e])}this.compile({loss:r,metrics:i,optimizer:e})}async save(t,e){if("string"==typeof t){const e=NV.Gb.getSaveHandlers(t);if(0===e.length)throw new LV(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new LV(`Found more than one (${e.length}) save handlers for `+`URL '${t}'`);t=e[0]}if(null==t.save)throw new LV("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await NV.Gb.encodeWeights(this.getNamedWeights(e)),i={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v2.0.1",convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){i.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:n}=await NV.Gb.encodeWeights(await this.optimizer.getWeights(),t);r.specs.push(...n),r.data=NV.Gb.concatenateArrayBuffers([r.data,e])}if(null!=this.userDefinedMetadata){const t=!0;gW(this.userDefinedMetadata,this.name,t),i.userDefinedMetadata=this.userDefinedMetadata}return i.weightData=r.data,i.weightSpecs=r.specs,t.save(i)}setUserDefinedMetadata(t){gW(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}async function ZW(t,e){if(null==e&&(e={}),"string"==typeof t){const r=NV.Gb.getLoadHandlers(t,e);if(0===r.length)r.push(NV.Gb.browserHTTPRequest(t,e));else if(r.length>1)throw new LV(`Found more than one (${r.length}) load handlers for `+`URL '${t}'`);t=r[0]}return async function(t,e,r){null==r&&(r={});if(null==t.load)throw new LV("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const i=await t.load();let n=i.modelTopology;null!=n.model_config&&(n=n.model_config);const s=null==r.strict||r.strict,o=null!=i.weightData&&null!=i.weightSpecs&&s,a=$$(TW(n),e,o),h=i.trainingConfig;null!=h&&a.loadTrainingConfig(h);null!=i.userDefinedMetadata&&a.setUserDefinedMetadata(i.userDefinedMetadata);if(null!=i.weightData){if(null==i.weightSpecs)throw new LV("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:t,optimizerWeights:e}=function(t,e){const r=NV.Gb.decodeWeights(t,e),i={},n=[];return e.forEach(t=>{"optimizer"===t.group?n.push({name:t.name,tensor:r[t.name]}):i[t.name]=r[t.name]}),{modelWeights:i,optimizerWeights:n}}(i.weightData,i.weightSpecs);a.loadWeights(t,s),null!=a.optimizer&&e.length>0&&await a.optimizer.setWeights(e),Object(NV.hb)(t),Object(NV.hb)(e.map(t=>t.tensor))}return a}(t,void 0,e)}KW.className="Model",NV.Lc.registerClass(KW);class JW extends KW{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:v$("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(t=>t<0))throw new LV("Negative dimension size caused by adding layer "+`${t.name} with input shape [`+`${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const e=t instanceof JW||t instanceof KW;let r;if(e){if(r=t,1!==r.outputs.length)throw new LV("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==r.inputs.length)throw new LV("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new LV("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=D$({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=r.outputs,this.inputs=r.inputs;else{if(1!==t.inboundNodes.length)throw new LV("A layer added to a Sequential model must not already be "+`connected somewhere else. LayersModel received layer ${t.name} `+`which has ${t.inboundNodes.length} pre-existing inbound `+"connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new LV("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=function t(e,r,i){if((null==r||null!=i&&i>0)&&(r=e.sourceLayer,i=e.nodeIndex),0===r.inboundNodes.length)return[e];{const e=r.inboundNodes[i];if(0===e.inboundLayers.length)return e.inputTensors;{const r=[];for(let i=0;i<e.inboundLayers.length;i++){const n=t(e.inputTensors[i],e.inboundLayers[i],e.nodeIndices[i]);for(const t of n)-1===r.indexOf(t)&&r.push(t)}return r}}}(this.outputs[0])}this.inboundNodes=[],new R$({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:BV(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(T$(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new KW({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,r=console.log){this.built||this.build(),super.summary(t,e,r)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e,r={}){if(!this.built)throw new FV("The model needs to be compiled before being used.");return this.model.evaluate(t,e,r)}async evaluateDataset(t,e){if(!this.built)throw new FV("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,r={}){if(!this.built)throw new FV("The model needs to be compiled before being used.");return this.model.fit(t,e,r)}async fitDataset(t,e){if(!this.built)throw new FV("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,r={},i=!1){let n,s={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new LV("Legacy serialization format not supported yet.");n=e}else NV.Cd.assert(null!=e.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),n=e.layers,delete e.layers,s=e;const o=new t(s);if(!(o instanceof JW))throw new kV(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const t of n){const e=$$(t,void 0,i);i&&e.setFastWeightInitDuringBuild(!0),o.add(e)}return o}set stopTraining(t){if(null==this.model)throw new LV("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new LV("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const r={};r.className=e.getClassName(),r.config=e.getConfig(),t.push(r)}return{name:this.name,layers:t}}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function QW(t){return new KW(t)}function tY(t,e){return null==e&&(e={}),ZW(t,e)}function eY(t){return D$(t)}JW.className="Sequential",NV.Lc.registerClass(JW);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class rY extends NV.Lc.Serializable{getConfig(){return{}}}class iY extends rY{apply(t,e=1){return function(t,e=1){if(1!==e)throw new kV(`Support for alpha values other than 1 (${e}) is not implemented `+"yet.");return NV.lb(t)}(t,e)}}iY.className="elu",NV.Lc.registerClass(iY);class nY extends rY{apply(t){return NV.Jc(t)}}nY.className="selu",NV.Lc.registerClass(nY);class sY extends rY{apply(t){return NV.Bc(t)}}sY.className="relu",NV.Lc.registerClass(sY);class oY extends rY{apply(t){return Object(NV.ud)(()=>NV.fc(6,NV.Bc(t)))}}oY.className="relu6",NV.Lc.registerClass(oY);class aY extends rY{apply(t){return t}}aY.className="linear",NV.Lc.registerClass(aY);class hY extends rY{apply(t){return NV.Oc(t)}}hY.className="sigmoid",NV.Lc.registerClass(hY);class uY extends rY{apply(t){return function(t){return Object(NV.ud)(()=>{const e=NV.r(.5,NV.ic(.2,t));return NV.Q(e,0,1)})}(t)}}uY.className="hardSigmoid",NV.Lc.registerClass(uY);class lY extends rY{apply(t){return NV.Zc(t)}}lY.className="softplus",NV.Lc.registerClass(lY);class cY extends rY{apply(t){return function(t){return Object(NV.ud)(()=>NV.ib(t,NV.o(t).add(1)))}(t)}}cY.className="softsign",NV.Lc.registerClass(cY);class dY extends rY{apply(t){return NV.nd(t)}}dY.className="tanh",NV.Lc.registerClass(dY);class pY extends rY{apply(t,e=-1){return NV.Yc(t,e)}}pY.className="softmax",NV.Lc.registerClass(pY);class fY extends rY{apply(t,e=-1){return NV.Sb(t,e)}}function mY(t){return t.getClassName()}function gY(t,e={}){return YV(t,NV.Lc.SerializationMap.getMap().classNameMap,e,"activation")}function yY(t){if(null==t){const t={className:"linear",config:{}};return gY(t)}if("string"==typeof t){const e={};return e.className=t,e.config={},gY(e)}return t instanceof rY?t:gY(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vY(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+`object, but received: ${t}`)}fY.className="logSoftmax",NV.Lc.registerClass(fY);class _Y extends NV.Lc.Serializable{}class bY extends _Y{constructor(t){super(),vY(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return Object(NV.ud)(()=>{let e=Object(NV.Id)([1]);return this.hasL1&&(e=Object(NV.r)(e,Object(NV.kd)(NV.ic(this.l1,Object(NV.o)(t))))),this.hasL2&&(e=Object(NV.r)(e,Object(NV.kd)(NV.ic(this.l2,GH(t))))),e.asScalar()})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}bY.className="L1L2",NV.Lc.registerClass(bY);const xY={l1l2:"L1L2"};function TY(t){return WV(t)}function EY(t,e={}){return YV(t,NV.Lc.SerializationMap.getMap().classNameMap,e,"regularizer")}function wY(t){if(null==t)return null;if("string"==typeof t){return EY({className:t in xY?xY[t]:t,config:{}})}return t instanceof _Y?t:EY(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class SY extends P${constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=x$(t);let r=Object(NV.Bc)(t);return null!=this.maxValue&&(r=Object(NV.Q)(r,0,this.maxValue)),r}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}SY.className="ReLU",NV.Lc.registerClass(SY);class IY extends P${constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const r=x$(t);return Object(NV.Kb)(r,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}IY.className="LeakyReLU",NV.Lc.registerClass(IY);class AY extends P${constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=f$(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=wY(t.alphaRegularizer),this.alphaConstraint=cH(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!=typeof t.sharedAxes)throw new LV("Expected sharedAxes to be a number or an array of numbers, "+`but got ${t.sharedAxes}`);this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=T$(t)).slice(1);if(null!=this.sharedAxes)for(const t of this.sharedAxes)e[t-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(null!=this.sharedAxes)for(let e=1;e<t.length;++e)r[e]=t[e];this.inputSpec=[new A$({ndim:t.length,axes:r})],this.built=!0}call(t,e){return t=x$(t),Object(NV.sc)(t,this.alpha.read())}getConfig(){const t={alphaInitializer:p$(this.alphaInitializer),alphaRegularizer:TY(this.alphaRegularizer),alphaConstraint:uH(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}AY.className="PReLU",NV.Lc.registerClass(AY);class CY extends P${constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new kV(`Non-default alpha value (${t.alpha}) is not supported by the `+"ELU layer yet.");this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const r=x$(t);return Object(NV.lb)(r)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}CY.className="ELU",NV.Lc.registerClass(CY);class OY extends P${constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const r=x$(t);return r.mul(NH(r.greater(this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}OY.className="ThresholdedReLU",NV.Lc.registerClass(OY);class RY extends P${constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new pY).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){const r=x$(t);return this.softmax(r,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function NY(t,e,r){if("number"==typeof t)return BV(t,e);if(t.length!==e)throw new LV(`The ${r} argument must be an integer or tuple of ${e} integers.`+` Received: ${t.length} elements.`);for(let n=0;n<e;++n){const s=t[n];if((i=s)!==parseInt(i.toString(),10))throw new LV(`The ${r} argument must be an integer or tuple of ${e}`+` integers. Received: ${JSON.stringify(t)} including a`+` non-integer number ${s}`)}return t;var i}function PY(t,e,r,i,n=1){if(null==t)return t;let s;return s="same"===r?t:t-(e+(e-1)*(n-1))+1,Math.floor((s+i-1)/i)}function MY(t,e,r,i){if(null==t)return null;if("valid"===i)t=t*e+OH([r-e,0]);else{if("same"!==i)throw new LV(`Unsupport padding mode: ${i}.`);t*=e}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DY(t,e){return Object(NV.ud)(()=>(yH(e),"channelsFirst"===e?NV.yd(t,[0,2,3,1]):t))}function FY(t,e){return Object(NV.ud)(()=>(yH(e),"channelsFirst"===e?NV.yd(t,[0,2,3,4,1]):t))}function LY(t,e,r,i=1,n="valid",s,o=1){return Object(NV.ud)(()=>{if(null==s&&(s="channelsLast"),yH(s),3!==t.shape.length)throw new LV("The input of a conv1dWithBias operation should be 3, but is "+`${t.shape.length} instead.`);if(3!==e.shape.length)throw new LV("The kernel for a conv1dWithBias operation should be 3, but is "+`${e.shape.length} instead`);if(null!=r&&1!==r.shape.length)throw new LV("The bias for a conv1dWithBias operation should be 1, but is "+`${e.shape.length} instead`);if("channelsFirst"===s&&(t=NV.yd(t,[0,2,1])),"causal"===n)throw new kV("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=NV.X(t,e,i,"same"===n?"same":"valid","NWC",o);return null!=r&&(a=VH(a,r)),a})}function kY(t,e,r,i=[1,1],n="valid",s,o,a=null){return Object(NV.ud)(()=>{if(null==s&&(s="channelsLast"),yH(s),3!==t.rank&&4!==t.rank)throw new LV("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+`but received ${t.rank}.`);if(3!==e.rank&&4!==e.rank)throw new LV("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+`but received ${t.rank}.`);let h=DY(t,s);if("causal"===n)throw new kV("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return h=NV.yb.conv2d({x:h,filter:e,strides:i,pad:"same"===n?"same":"valid",dilations:o,dataFormat:"NHWC",bias:r,activation:a}),"channelsFirst"===s&&(h=NV.yd(h,[0,3,1,2])),h})}function UY(t,e,r,i=[1,1,1],n="valid",s,o){return Object(NV.ud)(()=>{if(null==s&&(s="channelsLast"),yH(s),4!==t.rank&&5!==t.rank)throw new LV("conv3dWithBias expects input to be of rank 4 or 5, but received "+`${t.rank}.`);if(4!==e.rank&&5!==e.rank)throw new LV("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+`${t.rank}.`);let a=FY(t,s);if("causal"===n)throw new kV("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=NV.ab(a,e,i,"same"===n?"same":"valid","NDHWC",o),null!=r&&(a=VH(a,r)),"channelsFirst"===s&&(a=NV.yd(a,[0,4,1,2,3])),a})}RY.className="Softmax",NV.Lc.registerClass(RY);class BY extends P${constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",BY.verifyArgs(e),this.rank=t,tH(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new kV(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is `+"not implemented yet.");if(this.kernelSize=NY(e.kernelSize,t,"kernelSize"),this.strides=NY(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,vH(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,yH(this.dataFormat),this.activation=yY(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=f$(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=cH(e.biasConstraint),this.biasRegularizer=wY(e.biasRegularizer),this.activityRegularizer=wY(e.activityRegularizer),this.dilationRate=NY(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new LV("dilationRate must be a number or an array of a single number for 1D convolution, but received "+`${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new LV("dilationRate must be a number or array of two numbers for 2D "+`convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new LV("dilationRate must be a number or array of three numbers for 3D "+`convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(t){if(jV("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!QV(t.kernelSize,"number",1,3))throw new LV("BaseConv expects config.kernelSize to be number or number[] with "+`length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:mY(this.activation),useBias:this.useBias,biasInitializer:p$(this.biasInitializer),biasRegularizer:TY(this.biasRegularizer),activityRegularizer:TY(this.activityRegularizer),biasConstraint:uH(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class jY extends BY{constructor(t,e){super(t,e),this.kernel=null,jY.verifyArgs(e),this.filters=e.filters,tH(this.filters,"filters"),this.kernelInitializer=f$(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=cH(e.kernelConstraint),this.kernelRegularizer=wY(e.kernelRegularizer)}build(t){t=T$(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new LV("The channel dimension of the input should be defined. "+`Found ${t[e]}`);const r=t[e],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:r}}],this.built=!0}call(t,e){return Object(NV.ud)(()=>{let e;t=x$(t);const r=null==this.bias?null:this.bias.read(),i=eH(this.activation.getClassName());if(null!=i&&2===this.rank)e=kY(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(1===this.rank)e=LY(t,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=kY(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new kV("convolutions greater than 3D are not implemented yet.");e=UY(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e})}computeOutputShape(t){t=T$(t);const e=[],r="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let t=0;t<r.length;++t){const i=PY(r[t],this.kernelSize[t],this.padding,this.strides[t],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[t]);e.push(i)}let i=[t[0]];return"channelsLast"===this.dataFormat?(i=i.concat(e),i.push(this.filters)):(i.push(this.filters),i=i.concat(e)),i}getConfig(){const t={filters:this.filters,kernelInitializer:p$(this.kernelInitializer),kernelRegularizer:TY(this.kernelRegularizer),kernelConstraint:uH(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new LV("Convolution layer expected config.filters to be a 'number' > 0 "+`but got ${JSON.stringify(t.filters)}`)}}class XY extends jY{constructor(t){super(2,t),XY.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!QV(t.kernelSize,"number",1,2))throw new LV("Conv2D expects config.kernelSize to be number or number[] with "+`length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}XY.className="Conv2D",NV.Lc.registerClass(XY);class GY extends jY{constructor(t){super(3,t),GY.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new LV("Conv3D expects config.kernelSize to be number or"+` [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}GY.className="Conv3D",NV.Lc.registerClass(GY);class zY extends XY{constructor(t){if(super(t),this.inputSpec=[new A$({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new LV("Conv2DTranspose currently supports only padding modes 'same' "+`and 'valid', but received padding mode ${this.padding}`)}build(t){if(4!==(t=T$(t)).length)throw new LV("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new LV("The channel dimension of the inputs should be defined. Found `None`.");const r=t[e],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new A$({ndim:4,axes:{[e]:r}})],this.built=!0}call(t,e){return NV.ud(()=>{let e=x$(t);if(4!==e.shape.length)throw new LV("Conv2DTranspose.call() expects input tensor to be rank-4, but "+`received a tensor of rank-${e.shape.length}`);const r=e.shape,i=r[0];let n,s;"channelsFirst"===this.dataFormat?(n=2,s=3):(n=1,s=2);const o=r[n],a=r[s],h=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1],d=[i,MY(o,l,h,this.padding),MY(a,c,u,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=NV.yd(e,[0,2,3,1]));let p=NV.Z(e,this.kernel.read(),d,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=NV.yd(p,[0,3,1,2])),null!=this.bias&&(p=VH(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p})}computeOutputShape(t){const e=(t=T$(t)).slice();let r,i,n;"channelsFirst"===this.dataFormat?(r=1,i=2,n=3):(r=3,i=1,n=2);const s=this.kernelSize[0],o=this.kernelSize[1],a=this.strides[0],h=this.strides[1];return e[r]=this.filters,e[i]=MY(e[i],a,s,this.padding),e[n]=MY(e[n],h,o,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}zY.className="Conv2DTranspose",NV.Lc.registerClass(zY);class VY extends jY{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new LV("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new LV("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new LV(`SeparableConv${this.rank}D supports only padding modes: `+`'same' and 'valid', but received ${JSON.stringify(e.padding)}`);this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=f$(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=wY(e.depthwiseRegularizer),this.depthwiseConstraint=cH(e.depthwiseConstraint),this.pointwiseInitializer=f$(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=wY(e.pointwiseRegularizer),this.pointwiseConstraint=cH(e.pointwiseConstraint)}build(t){if((t=T$(t)).length<this.rank+2)throw new LV(`Inputs to SeparableConv${this.rank}D should have rank `+`${this.rank+2}, but received input shape: `+`${JSON.stringify(t)}`);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new LV("The channel dimension of the inputs should be defined, "+`but found ${JSON.stringify(t[e])}`);const r=t[e],i=this.kernelSize.concat([r,this.depthMultiplier]),n=[];for(let t=0;t<this.rank;++t)n.push(1);n.push(r*this.depthMultiplier,this.filters);this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",n,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new A$({ndim:this.rank+2,axes:{[e]:r}})],this.built=!0}call(t,e){return Object(NV.ud)(()=>{let e;if(t=x$(t),1===this.rank)throw new kV("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=NV.yd(t,[0,2,3,1])),e=NV.Kc(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=VH(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=NV.yd(e,[0,3,1,2])),e})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=p$(this.depthwiseInitializer),t.pointwiseInitializer=p$(this.pointwiseInitializer),t.depthwiseRegularizer=TY(this.depthwiseRegularizer),t.pointwiseRegularizer=TY(this.pointwiseRegularizer),t.depthwiseConstraint=uH(this.depthwiseConstraint),t.pointwiseConstraint=uH(this.pointwiseConstraint),t}}VY.className="SeparableConv";class HY extends VY{constructor(t){super(2,t)}}HY.className="SeparableConv2D",NV.Lc.registerClass(HY);class $Y extends jY{constructor(t){super(1,t),$Y.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!QV(t.kernelSize,"number",1,1))throw new LV("Conv1D expects config.kernelSize to be number or number[] with "+`length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}$Y.className="Conv1D",NV.Lc.registerClass($Y);class WY extends P${constructor(t){super(t),"number"==typeof t.cropping?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"==typeof t.cropping[0]?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return Object(NV.ud)(()=>{if(t=x$(t),"channelsLast"===this.dataFormat){const e=FH(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return FH(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=FH(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return FH(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}WY.className="Cropping2D",NV.Lc.registerClass(WY);class YY extends P${constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat}computeOutputShape(t){if("channelsFirst"===this.dataFormat){const e=null==t[2]?null:this.size[0]*t[2],r=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,r]}{const e=null==t[1]?null:this.size[0]*t[1],r=null==t[2]?null:this.size[1]*t[2];return[t[0],e,r,t[3]]}}call(t,e){return NV.ud(()=>{let e=x$(t);const r=e.shape;if("channelsFirst"===this.dataFormat){e=NV.yd(e,[0,2,3,1]);const t=this.size[0]*r[2],i=this.size[1]*r[3],n=e.resizeNearestNeighbor([t,i]);return NV.yd(n,[0,3,1,2])}{const t=this.size[0]*r[1],i=this.size[1]*r[2];return e.resizeNearestNeighbor([t,i])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}YY.className="UpSampling2D",NV.Lc.registerClass(YY);class qY extends BY{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=f$(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=cH(t.depthwiseConstraint),this.depthwiseRegularizer=wY(t.depthwiseRegularizer)}build(t){if((t=T$(t)).length<4)throw new LV("Inputs to DepthwiseConv2D should have rank 4. "+`Received input shape: ${JSON.stringify(t)}.`);const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new LV("The channel dimension of the inputs to DepthwiseConv2D should "+`be defined, but is not (${t[e]}).`);const r=t[e],i=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Object(NV.ud)(()=>{let e=
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function(t,e,r=[1,1],i="valid",n,s){return Object(NV.ud)(()=>{null==n&&(n="channelsLast"),yH(n);let o=DY(t,n);if(4!==t.rank)throw new LV("Input for depthwiseConv2d is required to be 4-D, but is instead "+`${t.rank}-D`);if(4!==e.rank)throw new LV("depthwiseKernel is required to be 4-D, but is instead "+`${e.rank}-D`);return o=NV.fb(o,e,r,"same"===i?"same":"valid","NHWC",s),"channelsFirst"===n&&(o=NV.yd(o,[0,3,1,2])),o})}(t=x$(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=VH(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e})}computeOutputShape(t){t=T$(t);const e="channelsFirst"===this.dataFormat?t[2]:t[1],r="channelsFirst"===this.dataFormat?t[3]:t[2],i="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,n=PY(e,this.kernelSize[0],this.padding,this.strides[0]),s=PY(r,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],i,n,s]:[t[0],n,s,i]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=p$(this.depthwiseInitializer),t.depthwiseRegularizer=TY(this.depthwiseRegularizer),t.depthwiseConstraint=uH(this.depthwiseRegularizer),t}}qY.className="DepthwiseConv2D",NV.Lc.registerClass(qY);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class KY extends P${constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,r=[];for(let t=0;t<this.noiseShape.length;++t)r.push(null==this.noiseShape[t]?e[t]:this.noiseShape[t]);return r}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e);const r=x$(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,i=this.getNoiseShape(r);return $H(()=>HH(r,this.rate,i,this.seed),()=>r,t)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}KY.className="Dropout",NV.Lc.registerClass(KY);class ZY extends KY{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}ZY.className="SpatialDropout1D",NV.Lc.registerClass(ZY);class JY extends P${constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,tH(this.units,"units"),this.activation=yY(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=f$(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=f$(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=cH(t.kernelConstraint),this.biasConstraint=cH(t.biasConstraint),this.kernelRegularizer=wY(t.kernelRegularizer),this.biasRegularizer=wY(t.biasRegularizer),this.activityRegularizer=wY(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=T$(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=T$(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e);const r=x$(t),i=eH(this.activation.getClassName());let n;return null!=i?n=jH(r,this.kernel.read(),i,this.bias?this.bias.read():null):(n=jH(r,this.kernel.read()),null!=this.bias&&(n=VH(n,this.bias.read())),null!=this.activation&&(n=this.activation.apply(n))),n})}getConfig(){const t={units:this.units,activation:mY(this.activation),useBias:this.useBias,kernelInitializer:p$(this.kernelInitializer),biasInitializer:p$(this.biasInitializer),kernelRegularizer:TY(this.kernelRegularizer),biasRegularizer:TY(this.biasRegularizer),activityRegularizer:TY(this.activityRegularizer),kernelConstraint:uH(this.kernelConstraint),biasConstraint:uH(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}JY.className="Dense",NV.Lc.registerClass(JY);class QY extends P${constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=T$(t);for(const e of t.slice(1))if(null==e)throw new LV('The shape of the input to "Flatten" is not fully defined '+`(got ${t.slice(1)}). Make sure to pass a complete `+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],IH(t,1)]}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e);let r=x$(t);if("channelsFirst"===this.dataFormat&&r.rank>1){const t=[0];for(let e=2;e<r.rank;++e)t.push(e);t.push(1),r=r.transpose(t)}return function(t){if(t.rank<=1)throw new LV(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],IH(t.shape,1)];return t.reshape(e)}(r)})}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}QY.className="Flatten",NV.Lc.registerClass(QY);class tq extends P${constructor(t){super(t),this.supportsMasking=!0,this.activation=yY(t.activation)}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e);const r=x$(t);return this.activation.apply(r)})}getConfig(){const t={activation:mY(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}tq.className="Activation",NV.Lc.registerClass(tq);class eq extends P${constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return Object(NV.ud)(()=>{return t=x$(t),e=t,r=this.n,Object(NV.ud)(()=>{if(2!==e.shape.length)throw new LV("repeat() expects a rank-2 tensor, but received a "+`rank-${e.shape.length} tensor.`);return UH(PH(e,1),[1,r,1])});var e,r})}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}eq.className="RepeatVector",NV.Lc.registerClass(eq);class rq extends P${constructor(t){super(t),this.targetShape=t.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const r="Total size of new array must be unchanged.",i=e.slice();let n=1,s=null;for(let t=0;t<i.length;++t){const e=i[t];if(this.isUnknown(e)){if(null!==s)throw new LV("Can only specifiy one unknown dimension.");s=t}else n*=e}const o=IH(t);if(null!==s){if(0===n||o%n!=0)throw new LV(r);i[s]=o/n}else if(o!==n)throw new LV(r);return i}computeOutputShape(t){let e=!1;for(let r=0;r<t.length;++r)if(this.isUnknown(t[r])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e);const r=x$(t),i=r.shape,n=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return r.reshape(n)})}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}rq.className="Reshape",NV.Lc.registerClass(rq);class iq extends P${constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+`${t.dims} instead.`);const e=RH(1,t.dims.length+1);if(!NV.Cd.arraysEqual(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new A$({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=T$(t)).slice();return this.dims.forEach((r,i)=>{e[i+1]=t[r]}),e}call(t,e){return Object(NV.yd)(x$(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}iq.className="Permute",NV.Lc.registerClass(iq);class nq extends P${constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const r=x$(t);return Object(NV.u)(Object(NV.mc)(r,this.maskValue),-1)}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e);const r=x$(t),i=Object(NV.u)(Object(NV.mc)(r,this.maskValue),-1,!0);return r.mul(i.asType(r.dtype))})}}nq.className="Masking",NV.Lc.registerClass(nq);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class sq extends P${constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),null==t.inputLength?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(zV(t.inputLength))}this.inputDim=t.inputDim,tH(this.inputDim,"inputDim"),this.outputDim=t.outputDim,tH(this.outputDim,"outputDim"),this.embeddingsInitializer=f$(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=wY(t.embeddingsRegularizer),this.activityRegularizer=wY(t.activityRegularizer),this.embeddingsConstraint=cH(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return Object(NV.ud)(()=>this.maskZero?(t=x$(t),Object(NV.mc)(t,Object(NV.Jd)(t))):null)}computeOutputShape(t){if(t=T$(t),null==this.inputLength)return[...t,this.outputDim];const e=zV(this.inputLength);if(e.length!==t.length-1)throw new LV(`"inputLength" is ${this.inputLength}, but received `+`input shape has shape ${t}`);{let r=0;for(let i=0;i<e.length;++i){const n=e[i],s=t[i+1];if(null!=n&&null!=s&&n!==s)throw new LV(`"inputLength" is ${this.inputLength}, but received `+`input shape has shape ${t}`);null==n&&(e[r]=s),r++}}return[t[0],...e,this.outputDim]}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e);let r=x$(t);return"int32"!==r.dtype&&(r=NH(r,"int32")),XH(this.embeddings.read(),r.as1D()).reshape(T$(this.computeOutputShape(r.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:p$(this.embeddingsInitializer),embeddingsRegularizer:TY(this.embeddingsRegularizer),activityRegularizer:TY(this.activityRegularizer),embeddingsConstraint:uH(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}sq.className="Embedding",NV.Lc.registerClass(sq);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class oq extends P${constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new kV}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const r=t.slice(0,t.length-e.length);for(let i=0;i<e.length;++i){const n=t[t.length-e.length+i],s=e[i];if(null==n||null==s||n<0||s<0)r.push(null);else if(1===n)r.push(s);else if(1===s)r.push(n);else{if(n!==s)throw new LV("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));r.push(n)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[T$(t)]),(t=t).length<2)throw new LV("A merge layer should be called on an Array of at least 2 inputs."+` Got ${t.length} input(s).`);let e=[];for(const r of t)null!=r&&null!==r[0]&&e.push(r[0]);if(e=KV(e),e.length>1)throw new LV("Can not merge tensors with different batch sizes. "+`Got tensors with shapes: ${JSON.stringify(t)}.`);let r=null==t[0]?null:t[0].slice(1);for(let e=1;e<t.length;++e){const i=null==t[e]?null:t[e].slice(1);r=this.computeElementwiseOpOutputShape(r,i)}const i=t.map(t=>t.length);-1===t.indexOf(null)&&1===KV(i).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return Object(NV.ud)(()=>{if(t=t,this.reshapeRequired){const e=[],r=t.map(t=>t.rank);if(-1===r.indexOf(null)){const i=OH(r);for(let r of t){const t=r.rank;for(let e=0;e<i-t;++e)r=PH(r,1);e.push(r)}return this.mergeFunction(e)}{let r=!1;for(const i of t){const t=i.rank;if(null==t){const t=i.shape,n=t[0],s=t.slice(1).concat([n]);let o=i.reshape([n].concat(IH(t.slice(1))));o=NV.yd(o,[1,0]),o=o.reshape(s),e.push(o),r=!0}else if(t>1){const n=RH(1,t).concat([0]);e.push(NV.yd(i,n)),r=!0}else e.push(i)}let i=this.mergeFunction(e);const n=i.rank;if(r)if(null==n){const t=i.shape,e=t[t.length-1],r=[e].concat(t.slice(0,t.length-1));i=NV.yd(i.reshape([-1,e]),[1,0]).reshape(r)}else if(n>1){const t=[n-1].concat(RH(0,n-1));i=NV.yd(i,t)}return i}}return this.mergeFunction(t)})}computeOutputShape(t){let e;e=null==(t=t)[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const i=null==t[r]?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,i)}let r=[];for(const e of t)null!=e&&null!==e[0]&&r.push(e[0]);return r=KV(r),e=1===r.length?r.concat(e):[null].concat(e),e}computeMask(t,e){return NV.ud(()=>{if(null==e)return null;if(!Array.isArray(e))throw new LV("`mask` should be an Array");if(!Array.isArray(t))throw new LV("`inputs` should be an Array");if(e.length!==t.length)throw new LV("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+`(${t.length} vs ${e.length})`);if(e.every(t=>null==t))return null;let r=(e=e.map(t=>null==t?t:NV.rb(t,0)))[0];for(let t=1;t<e.length-1;++t)r=NV.Tb(r,e[t]);return r})}}class aq extends oq{constructor(t){super(t)}mergeFunction(t){return Object(NV.ud)(()=>{let e=t[0].clone();for(let r=1;r<t.length;++r)e=NV.r(e,t[r]);return e})}}aq.className="Add",NV.Lc.registerClass(aq);class hq extends oq{constructor(t){super(t)}mergeFunction(t){return Object(NV.ud)(()=>{let e=t[0].clone();for(let r=1;r<t.length;++r)e=NV.ic(e,t[r]);return e})}}hq.className="Multiply",NV.Lc.registerClass(hq);class uq extends oq{constructor(t){super(t)}mergeFunction(t){return Object(NV.ud)(()=>{let e=t[0].clone();for(let r=1;r<t.length;++r)e=NV.r(e,t[r]);return NV.ic(1/t.length,e)})}}uq.className="Average",NV.Lc.registerClass(uq);class lq extends oq{constructor(t){super(t)}mergeFunction(t){return Object(NV.ud)(()=>{let e=t[0];for(let r=1;r<t.length;++r)e=NV.bc(e,t[r]);return e})}}lq.className="Maximum",NV.Lc.registerClass(lq);class cq extends oq{constructor(t){super(t)}mergeFunction(t){return Object(NV.ud)(()=>{let e=t[0];for(let r=1;r<t.length;++r)e=NV.fc(e,t[r]);return e})}}cq.className="Minimum",NV.Lc.registerClass(cq);class dq extends oq{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new LV("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let e=!0;for(const r of t)if(null!=r){e=!1;break}if(e)return;const r=[];for(let e=0;e<t.length;++e){const i=t[e].slice();i.splice(this.axis,1);let n=!1;for(const t of r)if(NV.Cd.arraysEqual(t,i)){n=!0;break}n||r.push(i)}if(r.length>1)throw new LV("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return Object(NV.ud)(()=>LH(t,this.axis))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new LV("A `Concatenate` layer should be called on a list of inputs.");const e=t,r=e[0].slice(),i=this.axis<0?r.length+this.axis:this.axis;for(const t of e.slice(1)){if(null==r[i]||null==t[i]){r[i]=null;break}r[i]+=t[i]}return r}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new LV("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new LV("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new LV(`Mismatch in the length of mask (${e.length}) `+`and the legnth of inputs (${t.length})`);return NV.ud(()=>{let r=!0;if(e.forEach(t=>{null==t||(r=!1)}),r)return null;const i=[];for(let r=0;r<t.length;++r)null==e[r]?i.push(NV.pc(t[r]).asType("bool")):e[r].rank<t[r].rank?i.push(NV.rb(e[r],-1)):i.push(e[r]);const n=NV.S(i,this.axis);return NV.t(n,-1,!1)})}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function pq(t,e){for(;t<0;)t+=e;return t}dq.className="Concatenate",NV.Lc.registerClass(dq);class fq extends oq{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){NV.Cd.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0],r=t[1];if(e.length>3||r.length>3)throw new kV("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,r);if(e[i[0]]!==r[i[1]])throw new LV("Dimension incompatibility: "+`${e[i[0]]} !== ${r[i[1]]}`)}mergeFunction(t){if(2!==t.length)throw new LV("A `Dot` layer must be called on exactly 2 inputs, "+`but received ${t.length} input(s).`);let e,r=t[0],i=t[1];return e=Array.isArray(this.axes)?this.axes.map((e,r)=>pq(e,t[r].shape.length)):[pq(this.axes,r.shape.length),pq(this.axes,i.shape.length)],this.normalize&&(r=W$(r,e[0]),i=W$(i,e[1])),function(t,e,r){if(t.shape.length>3||e.shape.length>3)throw new kV("batchDot is not implemented for tensors of 4D or higher rank yet");if(NV.Cd.assert(t.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, "+`but got ${t.shape.length}`),NV.Cd.assert(t.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, "+`but got ${e.shape.length}`),"number"==typeof r&&(r=[r,r]),"complex64"===t.dtype||"complex64"===e.dtype)throw new kV("batchDot is not implemented for complex64-type Tensors yet.");const i=t.shape.length,n=e.shape.length;null==r&&(r=[i-1,n-2]);const s=r;return NV.ud(()=>{let r,o;if(i>n){r=i-n;const t=[];for(let e=0;e<r;++e)t.push(1);e=e.reshape(e.shape.concat(t))}else if(n>i){r=n-i;const e=[];for(let t=0;t<r;++t)e.push(1);t=t.reshape(t.shape.concat(e))}else r=0;if(2===t.shape.length&&2===e.shape.length)o=s[0]===s[1]?t.mul(e).sum(s[0]):t.transpose([1,0]).mul(e).sum(s[1]);else{const r=s[0]!==t.shape.length-1,i=s[1]===e.shape.length-1;o=t.matMul(e,r,i)}if(r>0){let t;t=i>n?i+n-3:i-1;const e=[];for(let i=t;i<t+r;++i)e.push(i);o=o.squeeze(e)}return 1===o.shape.length&&(o=o.expandDims(1)),o})}(r,i,e)}interpretAxes(t,e){let r;return r=Array.isArray(this.axes)?this.axes:[pq(this.axes,t.length),pq(this.axes,e.length)],r}computeOutputShape(t){NV.Cd.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0].slice(),r=t[1].slice();if(e.length>3||r.length>3)throw new kV("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,r);e.splice(i[0],1),r.splice(i[1],1),r.splice(0,1);const n=e.concat(r);return 1===n.length&&n.push(1),n}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}fq.className="Dot",NV.Lc.registerClass(fq);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class mq extends P${constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e);const r=x$(t);return $H(()=>BH(r.shape,0,this.stddev).add(r),()=>r,e.training||!1)})}}mq.className="GaussianNoise",NV.Lc.registerClass(mq);class gq extends P${constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e);const r=x$(t);if(this.rate>0&&this.rate<1){return $H(()=>{const t=Math.sqrt(this.rate/(1-this.rate));return r.mul(BH(r.shape,1,t))},()=>r,e.training||!1)}return r})}}gq.className="GaussianDropout",NV.Lc.registerClass(gq);class yq extends P${constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||x$(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Object(NV.ud)(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(t);return $H(()=>{const e=x$(t),i=-1.7580993408473766;let n=Object(NV.Cb)(Object(NV.vc)(r),this.rate);n=NH(n,"float32");const s=((1-this.rate)*(1+this.rate*i**2))**-.5,o=-s*i*this.rate;return e.mul(n).add(n.add(-1).mul(i)).mul(s).add(o)},()=>x$(t),e.training||!1)}return t})}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function vq(t,e,r,i,n,s=.001){let o;if(2===t.rank)o=NV.H(t,e,r,i,n,s);else if(3===t.rank)o=NV.I(t,e,r,i,n,s);else{if(4!==t.rank)throw new kV(`batchNormalization is not implemented for array of rank ${t.rank} `+"yet");o=NV.J(t,e,r,i,n,s)}return o}function _q(t,e,r,i,n=.001){return NV.Cd.arraysEqual(i.slice().sort(),RH(0,t.rank-1))?function(t,e,r,i,n=.001){return Object(NV.ud)(()=>{const s=NV.hc(t,i),o=s.mean,a=s.variance;return[vq(t,o,a,r,e,n),o,a]})}(t,e,r,i,n):function(t,e,r,i,n=.001){return Object(NV.ud)(()=>{const s=NV.hc(t,i),o=s.mean,a=s.variance,h=[];for(const e of RH(0,t.rank))-1!==i.indexOf(e)?h.push(1):h.push(t.shape[e]);const u=o.reshape(h),l=a.reshape(h),c=null==e?null:e.reshape(h),d=null==r?null:r.reshape(h);return[vq(t,u,l,d,c,n),o,a]})}(t,e,r,i,n)}yq.className="AlphaDropout",NV.Lc.registerClass(yq);class bq extends P${constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=f$(t.betaInitializer||"zeros"),this.gammaInitializer=f$(t.gammaInitializer||"ones"),this.movingMeanInitializer=f$(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=f$(t.movingVarianceInitializer||"ones"),this.betaConstraint=cH(t.betaConstraint),this.gammaConstraint=cH(t.gammaConstraint),this.betaRegularizer=wY(t.betaRegularizer),this.gammaRegularizer=wY(t.gammaRegularizer)}build(t){t=T$(t);const e=this.axis>=0?this.axis:this.axis+t.length,r=t[e];if(null==r)throw new LV(`Axis ${e} of input tensor should have a defined dimension but `+"the layer received an input with shape "+`${JSON.stringify(t)}.`);this.inputSpec=[new A$({ndim:t.length,axes:{[e]:r}})];const i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return Object(NV.ud)(()=>{const r=null!=e.training&&e.training,i=x$(t),n=i.shape,s=n.length,o=RH(0,s),a=this.axis>=0?this.axis:this.axis+s;o.splice(a,1);const h=BV(1,s);h[a]=n[a];const u=o.slice();u.sort();const l=!NV.Cd.arraysEqual(u,RH(0,s).slice(0,s-1));if(!r)return(()=>{if(l){const t=this.movingMean.read().reshape(h),e=this.movingVariance.read().reshape(h),r=this.center?this.beta.read().reshape(h):null,n=this.scale?this.gamma.read().reshape(h):null;return vq(i,t,e,r,n,this.epsilon)}return vq(i,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[c,d,p]=_q(i,this.gamma.read(),this.beta.read(),o,this.epsilon),f=(t,e,r)=>{NV.ud(()=>{const i=1-r,n=t.read(),s=n.sub(e).mul(i);t.write(n.sub(s))})};return(()=>{f(this.movingMean,d,this.momentum),f(this.movingVariance,p,this.momentum)})(),c})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:p$(this.betaInitializer),gammaInitializer:p$(this.gammaInitializer),movingMeanInitializer:p$(this.movingMeanInitializer),movingVarianceInitializer:p$(this.movingVarianceInitializer),betaRegularizer:TY(this.betaRegularizer),gammaRegularizer:TY(this.gammaRegularizer),betaConstraint:uH(this.betaConstraint),gammaConstraint:uH(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}bq.className="BatchNormalization",NV.Lc.registerClass(bq);class xq extends P${constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+`but received ${JSON.stringify(this.axis)}`);for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, "+`but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=f$(t.betaInitializer||"zeros"),this.gammaInitializer=f$(t.gammaInitializer||"ones"),this.betaRegularizer=wY(t.betaRegularizer),this.gammaRegularizer=wY(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=T$(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let t=0;t<this.axis.length;++t)this.axis[t]<0&&(this.axis[t]+=e);for(const t of this.axis)if(t<0||t>=e)throw new Error(`Invalid axis: ${t}`);if(this.axis.length!==KV(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(e=>t[e]);this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0}call(t,e){const r=x$(t),i=r.shape,n=i.length;return Object(NV.ud)(()=>{let{mean:t,variance:e}=Object(NV.hc)(r,this.axis,!0);const s=BV(1,n);for(const t of this.axis)s[t]=i[t];const o=t=>null!=t&&t.shape.length!==n&&this.axis!==[n-1]?t.reshape(s):t;let a=o(this.gamma.read()),h=o(this.beta.read());const u=[],l=[];for(let t=0;t<n;++t)-1!==this.axis.indexOf(t)?(u.push(i[t]),l.push(1)):(u.push(1),l.push(i[t]));return t=t.tile(u),e=e.tile(u),a=a.tile(l),h=h.tile(l),vq(r,t,e,h,a,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:p$(this.betaInitializer),gammaInitializer:p$(this.gammaInitializer),betaRegularizer:TY(this.betaRegularizer),gammaRegularizer:TY(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}xq.className="LayerNormalization",NV.Lc.registerClass(xq);class Tq extends P${constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new LV("ZeroPadding2D expects padding to be a length-2 array, but "+`received a length-${t.padding.length} array.`);let e,r;if("number"==typeof t.padding[0])e=[t.padding[0],t.padding[0]],r=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new LV("ZeroPadding2D expects height padding to be a length-2 array, "+`but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],2!==t.padding[1].length)throw new LV("ZeroPadding2D expects width padding to be a length-2 array, "+`but received a length-${t.padding[1].length} array.`);r=t.padding[1]}this.padding=[e,r]}this.inputSpec=[new A$({ndim:4})]}computeOutputShape(t){let e,r;return t=T$(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,r=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,r]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,r=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,r,t[3]])}call(t,e){return Object(NV.ud)(()=>{return e=x$(t),r=this.padding,i=this.dataFormat,Object(NV.ud)(()=>{if(4!==e.rank)throw new LV("temporalPadding expects input tensor to be 4-D, but received a "+`${e.rank}-D tensor.`);if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new LV("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==i&&(i="channelsLast"),"channelsLast"!==i&&"channelsFirst"!==i)throw new LV(`Unknown data format: ${i}. `+"Supported data formats are 'channelsLast' and 'channelsFirst.");let t;return t="channelsFirst"===i?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],NV.qc(e,t)});var e,r,i})}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Eq(t,e,r,i,n,s){return Object(NV.ud)(()=>{let o;yH(n),_H(s),vH(i),null==r&&(r=[1,1]),null==i&&(i="valid"),null==n&&(n="channelsLast"),null==s&&(s="max"),t=DY(t,n);const a="same"===i?"same":"valid";return o="max"===s?NV.Yb(t,e,r,a):NV.C(t,e,r,a),"channelsFirst"===n&&(o=NV.yd(o,[0,3,1,2])),o})}function wq(t,e,r,i,n,s){return Object(NV.ud)(()=>{let o;yH(n),_H(s),vH(i),null==r&&(r=[1,1,1]),null==i&&(i="valid"),null==n&&(n="channelsLast"),null==s&&(s="max"),t=FY(t,n);const a="same"===i?"same":"valid";return o="max"===s?NV.Zb(t,e,r,a):NV.D(t,e,r,a),"channelsFirst"===n&&(o=NV.yd(o,[0,4,1,2,3])),o})}Tq.className="ZeroPadding2D",NV.Lc.registerClass(Tq);class Sq extends P${constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"==typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new LV("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+`${JSON.stringify(t.poolSize)}`);this.poolSize=t.poolSize}if(tH(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"==typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new LV("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+`${JSON.stringify(t.strides)}`);this.strides=t.strides}tH(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,vH(this.padding),this.inputSpec=[new A$({ndim:3})]}computeOutputShape(t){const e=PY((t=T$(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return Object(NV.ud)(()=>{this.invokeCallHook(t,e),t=PH(x$(t),2);const r=this.poolingFunction(x$(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return NV.gd(r,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class Iq extends Sq{constructor(t){super(t)}poolingFunction(t,e,r,i,n){return yH(n),vH(i),Eq(t,e,r,i,n,"max")}}Iq.className="MaxPooling1D",NV.Lc.registerClass(Iq);class Aq extends Sq{constructor(t){super(t)}poolingFunction(t,e,r,i,n){return yH(n),vH(i),Eq(t,e,r,i,n,"avg")}}Aq.className="AveragePooling1D",NV.Lc.registerClass(Aq);class Cq extends P${constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new LV("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+`${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];tH(this.poolSize,"poolSize"),tH(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,yH(this.dataFormat),vH(this.padding),this.inputSpec=[new A$({ndim:4})]}computeOutputShape(t){t=T$(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],r="channelsFirst"===this.dataFormat?t[3]:t[2];return e=PY(e,this.poolSize[0],this.padding,this.strides[0]),r=PY(r,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,r]:[t[0],e,r,t[3]]}call(t,e){return Object(NV.ud)(()=>(this.invokeCallHook(t,e),this.poolingFunction(x$(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Oq extends Cq{constructor(t){super(t)}poolingFunction(t,e,r,i,n){return yH(n),vH(i),Eq(t,e,r,i,n,"max")}}Oq.className="MaxPooling2D",NV.Lc.registerClass(Oq);class Rq extends Cq{constructor(t){super(t)}poolingFunction(t,e,r,i,n){return yH(n),vH(i),Eq(t,e,r,i,n,"avg")}}Rq.className="AveragePooling2D",NV.Lc.registerClass(Rq);class Nq extends P${constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new LV("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+`${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];tH(this.poolSize,"poolSize"),tH(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,yH(this.dataFormat),vH(this.padding),this.inputSpec=[new A$({ndim:5})]}computeOutputShape(t){t=T$(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],r="channelsFirst"===this.dataFormat?t[3]:t[2],i="channelsFirst"===this.dataFormat?t[4]:t[3];return e=PY(e,this.poolSize[0],this.padding,this.strides[0]),r=PY(r,this.poolSize[1],this.padding,this.strides[1]),i=PY(i,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,r,i]:[t[0],e,r,i,t[4]]}call(t,e){return Object(NV.ud)(()=>(this.invokeCallHook(t,e),this.poolingFunction(x$(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Pq extends Nq{constructor(t){super(t)}poolingFunction(t,e,r,i,n){return yH(n),vH(i),wq(t,e,r,i,n,"max")}}Pq.className="MaxPooling3D",NV.Lc.registerClass(Pq);class Mq extends Nq{constructor(t){super(t)}poolingFunction(t,e,r,i,n){return yH(n),vH(i),wq(t,e,r,i,n,"avg")}}Mq.className="AveragePooling3D",NV.Lc.registerClass(Mq);class Dq extends P${constructor(t){super(t),this.inputSpec=[new A$({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new kV}}class Fq extends Dq{constructor(t){super(t||{})}call(t,e){return Object(NV.ud)(()=>{const e=x$(t);return NV.cc(e,1)})}}Fq.className="GlobalAveragePooling1D",NV.Lc.registerClass(Fq);class Lq extends Dq{constructor(t){super(t||{})}call(t,e){return Object(NV.ud)(()=>{const e=x$(t);return NV.Xb(e,1)})}}Lq.className="GlobalMaxPooling1D",NV.Lc.registerClass(Lq);class kq extends P${constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,yH(this.dataFormat),this.inputSpec=[new A$({ndim:4})]}computeOutputShape(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new kV}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Uq extends kq{call(t,e){return Object(NV.ud)(()=>{const e=x$(t);return"channelsLast"===this.dataFormat?NV.cc(e,[1,2]):NV.cc(e,[2,3])})}}Uq.className="GlobalAveragePooling2D",NV.Lc.registerClass(Uq);class Bq extends kq{call(t,e){return Object(NV.ud)(()=>{const e=x$(t);return"channelsLast"===this.dataFormat?NV.Xb(e,[1,2]):NV.Xb(e,[2,3])})}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function jq(t,e,r,i){if(Array.isArray(t)){if(null!=e||null!=r)throw new LV("When inputs is an array, neither initialState or constants should be provided");null!=i&&(r=t.slice(t.length-i,t.length),t=t.slice(0,t.length-i)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function n(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=n(e),constants:r=n(r)}}function Xq(t,e,r,i=!1,n,s,o=!1,a=!1){return NV.ud(()=>{const h=e.shape.length;if(h<3)throw new LV(`Input should be at least 3D, but is ${h}D.`);const u=[1,0].concat(RH(2,h));if(e=NV.yd(e,u),null!=s)throw new kV("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=n&&((n=n.asType("bool").asType("float32")).rank===h-1&&(n=NV.rb(n,-1)),n=NV.yd(n,u)),i&&(e=NV.Dc(e,0),null!=n&&(n=NV.Dc(n,0)));const l=[];let c,d=r;const p=e.shape[0],f=NV.Ad(e);let m,g;null!=n&&(m=NV.Ad(n));for(let e=0;e<p;++e){const r=f[e],i=NV.ud(()=>t(r,d));if(null==n)c=i[0],d=i[1];else{const t=NV.ud(()=>{const t=m[e],r=NV.pc(t).sub(t);return{output:i[0].mul(t).add(d[0].mul(r)),newStates:d.map((e,n)=>i[1][n].mul(t).add(e.mul(r)))}});c=t.output,d=t.newStates}a&&l.push(c)}if(a){const t=1;g=NV.hd(l,t)}return[c,g,d]})}Bq.className="GlobalMaxPooling2D",NV.Lc.registerClass(Bq);class Gq extends P${constructor(t){let e;if(super(t),null==t.cell)throw new LV("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new Kq({cells:t.cell}):t.cell,null==e.stateSize)throw new LV("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new A$({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return RH(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(t=>null)}return this.states_}setStates(t){this.states_=t}computeOutputShape(t){_$(t)&&(t=t[0]),t=t;let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const r=e[0];let i;if(i=this.returnSequences?[t[0],t[1],r]:[t[0],r],this.returnState){const r=[];for(const i of e)r.push([t[0],i]);return[i].concat(r)}return i}computeMask(t,e){return NV.ud(()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map(t=>null);return[t].concat(e)}return t})}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let r=0;r<t;++r)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new kV("Constants support is not implemented in RNN yet.");_$(t)&&(t=t[0]),t=t;const e=this.stateful?t[0]:null,r=t[t.length-1];this.inputSpec[0]=new A$({shape:[e,null,r]});const i=[t[0]].concat(t.slice(2));let n;if(this.cell.build(i),n=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!NV.Cd.arraysEqual(this.stateSpec.map(t=>t.shape[t.shape.length-1]),n))throw new LV("An initialState was passed that is not compatible with "+`cell.stateSize. Received stateSpec=${this.stateSpec}; `+`However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=n.map(t=>new A$({shape:[null,t]}));this.stateful&&this.resetStates()}resetStates(t,e=!1){Object(NV.ud)(()=>{if(!this.stateful)throw new DV("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(null==r)throw new LV("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>NV.Id([r,t])):this.states_=[NV.Id([r,this.cell.stateSize])];else if(null==t)NV.hb(this.states_),null!=this.keptStates&&(NV.hb(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>NV.Id([r,t])):this.states_[0]=NV.Id([r,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new LV(`Layer ${this.name} expects ${this.states_.length} state(s), `+`but it received ${t.length} state value(s). Input `+`received: ${t}`);!0===e?this.keptStates.push(this.states_.slice()):NV.hb(this.states_);for(let e=0;e<this.states_.length;++e){const i=t[e],n=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,s=[r,n];if(!NV.Cd.arraysEqual(i.shape,s))throw new LV(`State ${e} is incompatible with layer ${this.name}: `+`expected shape=${s}, received shape=${i.shape}`);this.states_[e]=i}}this.states_=this.states_.map(t=>NV.Ib(t.clone()))})}apply(t,e){let r=null==e?null:e.initialState,i=null==e?null:e.constants;null==e&&(e={});const n=jq(t,r,i,this.numConstants);t=n.inputs,r=n.initialState,i=n.constants;let s=[],o=[];if(null!=r){e.initialState=r,s=s.concat(r),this.stateSpec=[];for(const t of r)this.stateSpec.push(new A$({shape:t.shape}));o=o.concat(this.stateSpec)}if(null!=i&&(e.constants=i,s=s.concat(i),this.numConstants=i.length),s[0]instanceof C$){const r=[t].concat(s),i=this.inputSpec.concat(o),n=this.inputSpec;this.inputSpec=i;const a=super.apply(r,e);return this.inputSpec=n,a}return super.apply(t,e)}call(t,e){return Object(NV.ud)(()=>{const r=null==e?null:e.mask,i=null==e?null:e.training;let n=null==e?null:e.initialState;t=x$(t),null==n&&(n=this.stateful?this.states_:this.getInitialState(t));const s=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(n.length!==s)throw new LV(`RNN Layer has ${s} state(s) but was passed `+`${n.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:i},a=Xq((t,e)=>{const r=this.cell.call([t].concat(e),o);return[r[0],r.slice(1)]},t,n,this.goBackwards,r,null,this.unroll,this.returnSequences),h=a[0],u=a[1],l=a[2];this.stateful&&this.resetStates(l,i);const c=this.returnSequences?u:h;return this.returnState?[c].concat(l):c})}getInitialState(t){return Object(NV.ud)(()=>{let e=NV.Id(t.shape);return e=NV.kd(e,[1,2]),e=PH(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>t>1?UH(e,[1,t]):e):this.cell.stateSize>1?[UH(e,[1,this.cell.stateSize])]:[e]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const e=this.cell.getConfig();t.cell={className:this.cell.getClassName(),config:e};const r=super.getConfig();return Object.assign(t,r),t}static fromConfig(t,e,r={}){const i=$$(e.cell,r);return new t(Object.assign(e,{cell:i}))}}Gq.className="RNN",NV.Lc.registerClass(Gq);class zq extends P${}class Vq extends zq{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,tH(this.units,"units"),this.activation=yY(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=f$(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=f$(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=f$(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=wY(t.kernelRegularizer),this.recurrentRegularizer=wY(t.recurrentRegularizer),this.biasRegularizer=wY(t.biasRegularizer),this.kernelConstraint=cH(t.kernelConstraint),this.recurrentConstraint=cH(t.recurrentConstraint),this.biasConstraint=cH(t.biasConstraint),this.dropout=CH([1,OH([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=CH([1,OH([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=T$(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Object(NV.ud)(()=>{if(2!==(t=t).length)throw new LV(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let r=t[1];t=t[0];const i=null!=e.training&&e.training;let n;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Zq(()=>NV.pc(t),this.dropout,i)),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Zq(()=>NV.pc(r),this.recurrentDropout,i));const s=this.dropoutMask,o=this.recurrentDropoutMask;n=jH(null!=s?NV.ic(t,s):t,this.kernel.read()),null!=this.bias&&(n=VH(n,this.bias.read())),null!=o&&(r=NV.ic(r,o));let a=NV.r(n,jH(r,this.recurrentKernel.read()));return null!=this.activation&&(a=this.activation.apply(a)),[a,a]})}getConfig(){const t={units:this.units,activation:mY(this.activation),useBias:this.useBias,kernelInitializer:p$(this.kernelInitializer),recurrentInitializer:p$(this.recurrentInitializer),biasInitializer:p$(this.biasInitializer),kernelRegularizer:TY(this.kernelRegularizer),recurrentRegularizer:TY(this.recurrentRegularizer),biasRegularizer:TY(this.biasRegularizer),activityRegularizer:TY(this.activityRegularizer),kernelConstraint:uH(this.kernelConstraint),recurrentConstraint:uH(this.recurrentConstraint),biasConstraint:uH(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},e=super.getConfig();return Object.assign(t,e),t}}Vq.className="SimpleRNNCell",NV.Lc.registerClass(Vq);class Hq extends Gq{constructor(t){t.cell=new Vq(t),super(t)}call(t,e){return Object(NV.ud)(()=>{null!=this.cell.dropoutMask&&(NV.hb(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(NV.hb(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=null==e?null:e.mask,i=null==e?null:e.training,n=null==e?null:e.initialState;return super.call(t,{mask:r,training:i,initialState:n})})}get units(){return this.cell.units}get activation(){return this.cell.activation}get useBias(){return this.cell.useBias}get kernelInitializer(){return this.cell.kernelInitializer}get recurrentInitializer(){return this.cell.recurrentInitializer}get biasInitializer(){return this.cell.biasInitializer}get kernelRegularizer(){return this.cell.kernelRegularizer}get recurrentRegularizer(){return this.cell.recurrentRegularizer}get biasRegularizer(){return this.cell.biasRegularizer}get kernelConstraint(){return this.cell.kernelConstraint}get recurrentConstraint(){return this.cell.recurrentConstraint}get biasConstraint(){return this.cell.biasConstraint}get dropout(){return this.cell.dropout}get recurrentDropout(){return this.cell.recurrentDropout}getConfig(){const t={units:this.units,activation:mY(this.activation),useBias:this.useBias,kernelInitializer:p$(this.kernelInitializer),recurrentInitializer:p$(this.recurrentInitializer),biasInitializer:p$(this.biasInitializer),kernelRegularizer:TY(this.kernelRegularizer),recurrentRegularizer:TY(this.recurrentRegularizer),biasRegularizer:TY(this.biasRegularizer),activityRegularizer:TY(this.activityRegularizer),kernelConstraint:uH(this.kernelConstraint),recurrentConstraint:uH(this.recurrentConstraint),biasConstraint:uH(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},e=super.getConfig();return delete e.cell,Object.assign(t,e),t}static fromConfig(t,e){return new t(e)}}Hq.className="SimpleRNN",NV.Lc.registerClass(Hq);class $q extends zq{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new LV("GRUCell does not support reset_after parameter set to true.");this.units=t.units,tH(this.units,"units"),this.activation=yY(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=yY(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=f$(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=f$(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=f$(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=wY(t.kernelRegularizer),this.recurrentRegularizer=wY(t.recurrentRegularizer),this.biasRegularizer=wY(t.biasRegularizer),this.kernelConstraint=cH(t.kernelConstraint),this.recurrentConstraint=cH(t.recurrentConstraint),this.biasConstraint=cH(t.biasConstraint),this.dropout=CH([1,OH([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=CH([1,OH([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){const e=(t=T$(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Object(NV.ud)(()=>{if(2!==(t=t).length)throw new LV("GRUCell expects 2 input Tensors (inputs, h, c), got "+`${t.length}.`);const r=null!=e.training&&e.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Zq(()=>NV.pc(t),this.dropout,r,3)),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Zq(()=>NV.pc(i),this.recurrentDropout,r,3));const n=this.dropoutMask,s=this.recurrentDropoutMask;let o,a,h;0<this.dropout&&this.dropout<1&&(t=NV.ic(t,n[0]));let u=jH(t,this.kernel.read());this.useBias&&(u=VH(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=NV.ic(i,s[0]));const l=this.recurrentKernel.read(),[c,d]=NV.cd(l,[2*this.units,this.units],l.rank-1),p=jH(i,c),[f,m,g]=NV.cd(u,3,u.rank-1),[y,v]=NV.cd(p,2,p.rank-1);o=this.recurrentActivation.apply(NV.r(f,y)),a=this.recurrentActivation.apply(NV.r(m,v));const _=jH(NV.ic(a,i),d);h=this.activation.apply(NV.r(g,_));const b=NV.r(NV.ic(o,i),NV.ic(NV.r(1,NV.kc(o)),h));return[b,b]})}getConfig(){const t={units:this.units,activation:mY(this.activation),recurrentActivation:mY(this.recurrentActivation),useBias:this.useBias,kernelInitializer:p$(this.kernelInitializer),recurrentInitializer:p$(this.recurrentInitializer),biasInitializer:p$(this.biasInitializer),kernelRegularizer:TY(this.kernelRegularizer),recurrentRegularizer:TY(this.recurrentRegularizer),biasRegularizer:TY(this.biasRegularizer),activityRegularizer:TY(this.activityRegularizer),kernelConstraint:uH(this.kernelConstraint),recurrentConstraint:uH(this.recurrentConstraint),biasConstraint:uH(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1},e=super.getConfig();return Object.assign(t,e),t}}$q.className="GRUCell",NV.Lc.registerClass($q);class Wq extends Gq{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new $q(t),super(t)}call(t,e){return Object(NV.ud)(()=>{null!=this.cell.dropoutMask&&(NV.hb(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(NV.hb(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=null==e?null:e.mask,i=null==e?null:e.training,n=null==e?null:e.initialState;return super.call(t,{mask:r,training:i,initialState:n})})}get units(){return this.cell.units}get activation(){return this.cell.activation}get recurrentActivation(){return this.cell.recurrentActivation}get useBias(){return this.cell.useBias}get kernelInitializer(){return this.cell.kernelInitializer}get recurrentInitializer(){return this.cell.recurrentInitializer}get biasInitializer(){return this.cell.biasInitializer}get kernelRegularizer(){return this.cell.kernelRegularizer}get recurrentRegularizer(){return this.cell.recurrentRegularizer}get biasRegularizer(){return this.cell.biasRegularizer}get kernelConstraint(){return this.cell.kernelConstraint}get recurrentConstraint(){return this.cell.recurrentConstraint}get biasConstraint(){return this.cell.biasConstraint}get dropout(){return this.cell.dropout}get recurrentDropout(){return this.cell.recurrentDropout}get implementation(){return this.cell.implementation}getConfig(){const t={units:this.units,activation:mY(this.activation),recurrentActivation:mY(this.recurrentActivation),useBias:this.useBias,kernelInitializer:p$(this.kernelInitializer),recurrentInitializer:p$(this.recurrentInitializer),biasInitializer:p$(this.biasInitializer),kernelRegularizer:TY(this.kernelRegularizer),recurrentRegularizer:TY(this.recurrentRegularizer),biasRegularizer:TY(this.biasRegularizer),activityRegularizer:TY(this.activityRegularizer),kernelConstraint:uH(this.kernelConstraint),recurrentConstraint:uH(this.recurrentConstraint),biasConstraint:uH(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1},e=super.getConfig();return delete e.cell,Object.assign(t,e),t}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}Wq.className="GRU",NV.Lc.registerClass(Wq);class Yq extends zq{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,tH(this.units,"units"),this.activation=yY(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=yY(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=f$(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=f$(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=f$(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=wY(t.kernelRegularizer),this.recurrentRegularizer=wY(t.recurrentRegularizer),this.biasRegularizer=wY(t.biasRegularizer),this.kernelConstraint=cH(t.kernelConstraint),this.recurrentConstraint=cH(t.recurrentConstraint),this.biasConstraint=cH(t.biasConstraint),this.dropout=CH([1,OH([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=CH([1,OH([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;const r=(t=T$(t))[t.length-1];let i;if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,r=this.units;i=new((e=class extends qH{apply(e,i){const n=t.apply([r]),s=(new ZH).apply([r]),o=t.apply([2*r]);return kH(kH(n,s),o)}}).className="CustomInit",e)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return Object(NV.ud)(()=>{const r=null!=e.training&&e.training;if(3!==(t=t).length)throw new LV("LSTMCell expects 3 input Tensors (inputs, h, c), got "+`${t.length}.`);let i=t[1];const n=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Zq(()=>NV.pc(t),this.dropout,r,4)),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Zq(()=>NV.pc(i),this.recurrentDropout,r,4));const s=this.dropoutMask,o=this.recurrentDropoutMask;let a,h,u,l;0<this.dropout&&this.dropout<1&&(t=NV.ic(t,s[0]));let c=jH(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=NV.ic(i,o[0])),c=NV.r(c,jH(i,this.recurrentKernel.read())),this.useBias&&(c=VH(c,this.bias.read()));const[d,p,f,m]=NV.cd(c,4,c.rank-1);a=this.recurrentActivation.apply(d),h=this.recurrentActivation.apply(p),u=NV.r(NV.ic(h,n),NV.ic(a,this.activation.apply(f))),l=this.recurrentActivation.apply(m);const g=NV.ic(l,this.activation.apply(u));return[g,g,u]})}getConfig(){const t={units:this.units,activation:mY(this.activation),recurrentActivation:mY(this.recurrentActivation),useBias:this.useBias,kernelInitializer:p$(this.kernelInitializer),recurrentInitializer:p$(this.recurrentInitializer),biasInitializer:p$(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:TY(this.kernelRegularizer),recurrentRegularizer:TY(this.recurrentRegularizer),biasRegularizer:TY(this.biasRegularizer),activityRegularizer:TY(this.activityRegularizer),kernelConstraint:uH(this.kernelConstraint),recurrentConstraint:uH(this.recurrentConstraint),biasConstraint:uH(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=super.getConfig();return Object.assign(t,e),t}}Yq.className="LSTMCell",NV.Lc.registerClass(Yq);class qq extends Gq{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new Yq(t),super(t)}call(t,e){return Object(NV.ud)(()=>{null!=this.cell.dropoutMask&&(NV.hb(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(NV.hb(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=null==e?null:e.mask,i=null==e?null:e.training,n=null==e?null:e.initialState;return super.call(t,{mask:r,training:i,initialState:n})})}get units(){return this.cell.units}get activation(){return this.cell.activation}get recurrentActivation(){return this.cell.recurrentActivation}get useBias(){return this.cell.useBias}get kernelInitializer(){return this.cell.kernelInitializer}get recurrentInitializer(){return this.cell.recurrentInitializer}get biasInitializer(){return this.cell.biasInitializer}get unitForgetBias(){return this.cell.unitForgetBias}get kernelRegularizer(){return this.cell.kernelRegularizer}get recurrentRegularizer(){return this.cell.recurrentRegularizer}get biasRegularizer(){return this.cell.biasRegularizer}get kernelConstraint(){return this.cell.kernelConstraint}get recurrentConstraint(){return this.cell.recurrentConstraint}get biasConstraint(){return this.cell.biasConstraint}get dropout(){return this.cell.dropout}get recurrentDropout(){return this.cell.recurrentDropout}get implementation(){return this.cell.implementation}getConfig(){const t={units:this.units,activation:mY(this.activation),recurrentActivation:mY(this.recurrentActivation),useBias:this.useBias,kernelInitializer:p$(this.kernelInitializer),recurrentInitializer:p$(this.recurrentInitializer),biasInitializer:p$(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:TY(this.kernelRegularizer),recurrentRegularizer:TY(this.recurrentRegularizer),biasRegularizer:TY(this.biasRegularizer),activityRegularizer:TY(this.activityRegularizer),kernelConstraint:uH(this.kernelConstraint),recurrentConstraint:uH(this.recurrentConstraint),biasConstraint:uH(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=super.getConfig();return delete e.cell,Object.assign(t,e),t}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}qq.className="LSTM",NV.Lc.registerClass(qq);class Kq extends zq{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return Object(NV.ud)(()=>{let r=(t=t).slice(1);const i=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?i.push(r.splice(0,t.stateSize.length)):i.push(r.splice(0,1));i.reverse();const n=[];let s;for(let o=0;o<this.cells.length;++o){const a=this.cells[o];r=i[o],s=0===o?[t[0]].concat(r):[s[0]].concat(r),s=a.call(s,e),n.push(s.slice(1))}r=[];for(const t of n.slice().reverse())r.push(...t);return[s[0]].concat(r)})}build(t){let e;_$(t)&&(t=t[0]),t=t,this.cells.forEach((r,i)=>{xH(`RNNCell_${i}`,()=>{r.build(t),e=Array.isArray(r.stateSize)?r.stateSize[0]:r.stateSize,t=[t[0],e]})}),this.built=!0}getConfig(){const t=[];for(const e of this.cells)t.push({className:e.getClassName(),config:e.getConfig()});const e={cells:t},r=super.getConfig();return Object.assign(e,r),e}static fromConfig(t,e,r={}){const i=[];for(const t of e.cells)i.push($$(t,r));return new t({cells:i})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return S$(t)}setWeights(t){const e=[];for(const r of this.cells){const i=r.weights.length,n=t.splice(i);for(let t=0;t<r.weights.length;++t)e.push([r.weights[t],n[t]])}I$(e)}}function Zq(t,e,r=null,i=1){function n(){return HH(t(),e)}if(i>1){const e=[];for(let s=0;s<i;s++)e.push($H(n,t,r));return e.map(t=>NV.Ib(t.clone()))}return NV.Ib($H(n,t,r).clone())}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */Kq.className="StackedRNNCells",NV.Lc.registerClass(Kq);class Jq extends P${constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,r={}){const i=$$(e.layer,r);delete e.layer;const n={layer:i};return Object.assign(n,e),new t(n)}}class Qq extends Jq{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=T$(t)).length<3)throw new LV("TimeDistributed layer expects an input shape >= 3D, but received "+`input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=T$(t))[0]].concat(t.slice(2)),r=this.layer.computeOutputShape(e),i=t[1];return[r[0],i].concat(r.slice(1))}call(t,e){return Object(NV.ud)(()=>Xq((t,r)=>[x$(this.layer.call(t,e)),[]],t=x$(t),[],!1,null,null,!1,!0)[1])}}Qq.className="TimeDistributed",NV.Lc.registerClass(Qq);class tK extends Jq{constructor(t){super(t);const e=t.layer.getConfig(),r={};r.className=t.layer.getClassName(),r.config=e,this.forwardLayer=$$(r),e.goBackwards=!0!==e.goBackwards;const i={};var n;if(i.className=t.layer.getClassName(),i.config=e,this.backwardLayer=$$(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,n=this.mergeMode,JV(mH,"BidirectionalMergeMode",n),t.weights)throw new kV("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,r=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,r)),this.backwardLayer.setWeights(t.slice(r))}computeOutputShape(t){let e,r,i,n=this.forwardLayer.computeOutputShape(t);return Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n,this.returnState?(i=n.slice(1),e=n[0]):e=n[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,r=[e]):r=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?r.concat(i).concat(i.slice()):[e].concat(i).concat(i.slice()):GV(r)}apply(t,e){let r=null==e?null:e.initialState,i=null==e?null:e.constants;null==e&&(e={});const n=jq(t,r,i,this.numConstants);if(t=n.inputs,r=n.initialState,i=n.constants,Array.isArray(t)&&(r=t.slice(1),t=t[0]),(null==r||0===r.length)&&null==i)return super.apply(t,e);const s=[],o=[];if(null!=r){const t=r.length;if(t%2>0)throw new LV("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=r,s.push(...r);const i=r.map(t=>new A$({shape:t.shape}));this.forwardLayer.stateSpec=i.slice(0,t/2),this.backwardLayer.stateSpec=i.slice(t/2),o.push(...i)}if(null!=i)throw new kV("Support for constants in Bidirectional layers is not implemented yet.");const a=s[0]instanceof C$;for(const t of s)if(t instanceof C$!==a)throw new LV("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(a){const r=[t].concat(s),i=this.inputSpec.concat(o),n=this.inputSpec;this.inputSpec=i;const a=super.apply(r,e);return this.inputSpec=n,a}return super.apply(t,e)}call(t,e){return Object(NV.ud)(()=>{const r=e.initialState;let i,n,s,o;if(null==r)i=this.forwardLayer.call(t,e),n=this.backwardLayer.call(t,e);else{const s=r.slice(0,r.length/2),o=r.slice(r.length/2);i=this.forwardLayer.call(t,Object.assign(e,{initialState:s})),n=this.backwardLayer.call(t,Object.assign(e,{initialState:o}))}return this.returnState&&(Array.isArray(i)&&(s=i.slice(1).concat(n.slice(1))),i=i[0],n=n[0]),this.returnSequences&&(n=NV.Dc(n,1)),"concat"===this.mergeMode?o=LH([i,n]):"sum"===this.mergeMode?o=NV.r(i,n):"ave"===this.mergeMode?o=NV.ic(.5,NV.r(i,n)):"mul"===this.mergeMode?o=NV.ic(i,n):null==this.mergeMode&&(o=[i,n]),this.returnState?null==this.mergeMode?o.concat(s):[o].concat(s):o})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){xH(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),xH(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,e){let r;if(Array.isArray(e)&&(e=e[0]),r=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map(t=>null);return Array.isArray(r)?r.concat(t).concat(t):[r].concat(t).concat(t)}return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const r=$$(e.layer);if(delete e.layer,null!=e.numConstants)throw new kV("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=e;return i.layer=r,new t(i)}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function eK(t){return new M$(t)}function rK(t){return new CY(t)}function iK(t){return new SY(t)}function nK(t){return new IY(t)}function sK(t){return new AY(t)}function oK(t){return new RY(t)}function aK(t){return new OY(t)}function hK(t){return new $Y(t)}function uK(t){return new XY(t)}function lK(t){return new zY(t)}function cK(t){return new GY(t)}function dK(t){return new HY(t)}function pK(t){return new WY(t)}function fK(t){return new YY(t)}function mK(t){return new qY(t)}function gK(t){return new tq(t)}function yK(t){return new JY(t)}function vK(t){return new KY(t)}function _K(t){return new ZY(t)}function bK(t){return new QY(t)}function xK(t){return new eq(t)}function TK(t){return new rq(t)}function EK(t){return new iq(t)}function wK(t){return new sq(t)}function SK(t){return new aq(t)}function IK(t){return new uq(t)}function AK(t){return new dq(t)}function CK(t){return new lq(t)}function OK(t){return new cq(t)}function RK(t){return new hq(t)}function NK(t){return new fq(t)}function PK(t){return new bq(t)}function MK(t){return new xq(t)}function DK(t){return new Tq(t)}function FK(t){return new Aq(t)}function LK(t){return FK(t)}function kK(t){return FK(t)}function UK(t){return new Rq(t)}function BK(t){return UK(t)}function jK(t){return UK(t)}function XK(t){return new Mq(t)}function GK(t){return XK(t)}function zK(t){return XK(t)}function VK(t){return new Fq(t)}function HK(t){return new Uq(t)}function $K(t){return new Lq(t)}function WK(t){return new Bq(t)}function YK(t){return new Iq(t)}function qK(t){return new Oq(t)}function KK(t){return new Pq(t)}function ZK(t){return new Wq(t)}function JK(t){return new $q(t)}function QK(t){return new qq(t)}function tZ(t){return new Yq(t)}function eZ(t){return new Hq(t)}function rZ(t){return new Vq(t)}function iZ(t){return new Gq(t)}function nZ(t){return new Kq(t)}function sZ(t){return new tK(t)}function oZ(t){return new Qq(t)}tK.className="Bidirectional",NV.Lc.registerClass(tK);const aZ=$K,hZ=WK,uZ=YK,lZ=qK;function cZ(t){return new mq(t)}function dZ(t){return new gq(t)}function pZ(t){return new yq(t)}function fZ(t){return new nq(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
r(16),r(2);r(28);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mZ(t,e,r=""){NV.Cd.assert(function(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(-1!==t[r]&&-1!==e[r]&&t[r]!==e[r])return!1;return!0}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t,e),()=>r+` Shapes ${t} and ${e} must match`)}class gZ{constructor(t,e,r,i,n,s,o){this.name=t,this.dtype=e,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=n,this.dynamicSize=s,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.id=gZ.nextId++}get closed(){return this.closed_}clearAndClose(){this.tensors.forEach(t=>t.tensor.dispose()),this.tensors=[],this.closed_=!0}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read `+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(t=>this.read(t))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},\n          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),mZ(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),r&&r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(r&&r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);r.tensor=e,r.written=!0,this.tensors[t]=r}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,`+`because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((t,r)=>this.write(t,e[r]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let e=0;e<this.size();e++)t.push(e)}if(0===t.length)return Object(NV.od)([],[0].concat(this.elementShape));const r=this.readMany(t);return mZ(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Object(NV.hd)(r,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(0===this.size())return Object(NV.od)([],[0].concat(this.elementShape));const e=[];for(let t=0;t<this.size();t++)e.push(t);const r=this.readMany(e);return mZ(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Object(NV.S)(r,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const r=Math.max(...t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(t,Object(NV.Ad)(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let r=0;const i=t.map(t=>(r+=t,r));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), `+"and the TensorArray is not marked as dynamically resizeable");const n=0===r?0:e.size/r,s=[];Object(NV.ud)(()=>{e=e.reshape([1,r,n]);for(let r=0;r<t.length;++r){const o=[0,0===r?0:i[r-1],0],a=[1,t[r],n];s[r]=Object(NV.Sc)(e,o,a).reshape(this.elementShape)}return s});const o=[];for(let e=0;e<t.length;e++)o[e]=e;this.writeMany(o,s)}}gZ.nextId=0;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var yZ=r(21),vZ=r(15),_Z=r(20);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
class bZ{constructor(){this.size=null}batch(t,e=!0){const r=this;let i;return NV.Cd.assert(t>0,()=>`batchSize needs to be positive, but it is\n      ${t}`),i=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),xZ(async()=>(await r.iterator()).columnMajorBatch(t,e,wZ),i)}concatenate(t){const e=this;let r;return r=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,xZ(async()=>(await e.iterator()).concatenate(await t.iterator()),r)}filter(t){const e=this;let r;return r=this.size===1/0?1/0:null,xZ(async()=>(await e.iterator()).filter(e=>NV.ud(()=>t(e))),r)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return xZ(async()=>(await e.iterator()).map(e=>NV.ud(()=>t(e))),this.size)}mapAsync(t){const e=this;return xZ(async()=>(await e.iterator()).mapAsync(t),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return xZ(async()=>(await e.iterator()).prefetch(t),this.size)}repeat(t){const e=this;let r;return r=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,xZ(async()=>{const r=Object(vZ.e)(async()=>({value:await e.iterator(),done:!1}));return Object(vZ.d)(r.take(t))},r)}skip(t){const e=this;let r;return r=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,xZ(async()=>(await e.iterator()).skip(t),r)}shuffle(t,e,r=!0){if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+`bufferSize to the dataset size (${this.size} elements)`);const i=this,n=yZ.alea(e||NV.Cd.now().toString());return xZ(async()=>{let e=n.int32();return r&&(e+=n.int32()),(await i.iterator()).shuffle(t,e.toString())},this.size)}take(t){const e=this;let r;return r=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,xZ(async()=>(await e.iterator()).take(t),r)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function xZ(t,e=null){return new class extends bZ{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function TZ(t){return xZ(async()=>Object(vZ.f)(t),t.length)}function EZ(t){if(!Object(_Z.e)(t))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(t))for(let r=0;r<t.length;r++)e=null==e?t[r].size:Math.min(e,t[r].size);else if(t instanceof Object)for(const r in t)e=null==e?t[r].size:Math.min(e,t[r].size);return xZ(async()=>{const e=await Object(_Z.c)(t,t=>{if(t instanceof bZ)return{value:t.iterator(),recurse:!1};if(Object(_Z.e)(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return Object(vZ.g)(e,vZ.c.SHORTEST)},e)}function wZ(t){if(null===t)return null;const e=t[0];if(Object(_Z.a)(e)){return{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof NV.l?NV.hd(t):NV.od(t)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */(t),recurse:!1}}return{value:null,recurse:!0}}bZ.MAX_BUFFER_SIZE=1e4;class SZ extends bZ{constructor(t){super(),this.input=t}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map(t=>(t.endsWith("\r")&&(t=t.slice(0,-1)),t))}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const IZ=Symbol("out"),AZ=Symbol("field"),CZ=Symbol("quote"),OZ=Symbol("quoteafterquote"),RZ=Symbol("quoteinquote");class NZ extends bZ{constructor(t,e){super(),this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new SZ(t),e||(e={}),this.hasHeader=!1!==e.hasHeader,this.fullColumnNames=e.columnNames,this.columnConfigs=e.columnConfigs,this.configuredColumnsOnly=e.configuredColumnsOnly,e.delimWhitespace?(NV.Cd.assert(null==e.delimiter,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=e.delimiter?e.delimiter:","}async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const t=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&NV.Cd.assert(t.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t);const e=this.fullColumnNames.reduce((t,e)=>(t[e]=t[e]+1||1,t),{}),r=Object.keys(e).filter(t=>e[t]>1);if(NV.Cd.assert(0===r.length,()=>"Duplicate column names found: "+r.toString()),this.columnConfigs)for(const t of Object.keys(this.columnConfigs)){if(-1===this.fullColumnNames.indexOf(t))throw new Error('The key "'+t+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const t=await this.base.iterator(),e=await t.next();if(e.done)throw new Error("No data was found for CSV parsing.");const r=e.value;return this.parseRow(r,!1)}return null}async iterator(){this.columnNamesValidated||await this.setColumnNames();let t=await this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map(t=>this.makeDataElement(t))}makeDataElement(t){const e=this.parseRow(t),r={},i={};for(let n=0;n<this.fullColumnNames.length;n++){const s=this.fullColumnNames[n],o=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||o){const a=e[n];let h=null;if(""===a)if(o&&void 0!==o.default)h=o.default;else{if(o&&(o.required||o.isLabel))throw new Error(`Required column ${s} is empty in this line: ${t}`);h=void 0}else{const t=Number(a);if(isNaN(t))h=o&&"bool"===o.dtype?this.getBoolean(a):a;else if(o&&o.dtype)switch(o.dtype){case"float32":h=t;break;case"int32":h=Math.floor(t);break;case"bool":h=this.getBoolean(a);break;default:h=t}else h=t}o&&o.isLabel?i[s]=h:r[s]=h}}return 0===Object.keys(i).length?r:{xs:r,ys:i}}getBoolean(t){return"1"===t||"true"===t.toLowerCase()?1:0}parseRow(t,e=!0){const r=[];let i=0;const n=t.length;let s=IZ;for(let e=0;e<n;e++)switch(s){case IZ:switch(t.charAt(e)){case'"':i=e+1,s=CZ;break;case this.delimiter:if(i=e+1," "===this.delimiter&&this.delimWhitespace)break;r.push(""),s=IZ;break;default:s=AZ,i=e}break;case AZ:switch(t.charAt(e)){case this.delimiter:r.push(t.substring(i,e)),s=IZ,i=e+1}break;case CZ:switch(t.charAt(e)){case'"':s=OZ}break;case OZ:switch(t.charAt(e)){case this.delimiter:r.push(t.substring(i,e-1)),s=IZ,i=e+1;break;case'"':s=CZ;break;default:s=RZ}break;case RZ:switch(t.charAt(e)){case'"':s=CZ}}if(s===OZ?r.push(t.substring(i,n-1)):r.push(t.substring(i)),e&&r.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${r}`);return r}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class PZ extends vZ.a{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const e=Math.log2(this.fftSize);if(this.fftSize<0||e<4||e>14||!Number.isInteger(e))throw new Error("Invalid fftSize: it must be a power of 2 between "+`2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=!1!==t.includeSpectrogram,this.includeWaveform=!0===t.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(t={}){if(Object(NV.nb)().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");const e=new PZ(t);return await e.start(),e}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(t){throw new Error(`Error thrown while initializing video stream: ${t.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: "+`Expected: ${this.sampleRateHz}; `+`Actual: ${this.audioContext.sampleRate}`)}else this.sampleRateHz=this.audioContext.sampleRate;const e=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,e.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,e;const r=await this.getAudioData();if(this.includeSpectrogram){const e=this.flattenQueue(r.freqDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const t=this.flattenQueue(r.timeDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:e},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const t=[],e=[];let r=0;return new Promise(i=>{const n=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:e}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),e.push(this.timeData.slice())),++r===this.numFrames&&(clearInterval(n),i({freqDataQueue:t,timeDataQueue:e}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const e=t[0].length,r=new Float32Array(t.length*e);return t.forEach((t,i)=>r.set(t,i*e)),r}getTensorFromAudioDataArray(t,e){const r=new Float32Array(NV.Cd.sizeFromShape(e));return r.set(t,r.length-t.length),Object(NV.od)(r,e)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class MZ extends vZ.a{constructor(t,e){if(super(),this.webcamVideoElement=t,this.webcamConfig=e,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Object(NV.pd)([0],"int32"),this.webcamConfig.centerCrop){const t=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,e=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,r=(1-t)/2,i=(1-e)/2,n=r+t,s=e+i;this.cropBox=Object(NV.qd)([i,r,s,n],[1,4])}else this.cropBox=Object(NV.qd)([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t,e={}){if(Object(NV.nb)().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!e.resizeWidth||!e.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=e.resizeWidth,t.height=e.resizeHeight}const r=new MZ(t,e);return await r.start(),r}async start(){this.webcamConfig.facingMode&&NV.Cd.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. `+"Please provide 'user' or 'environment'");try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message=`Error thrown while initializing video stream: ${t.message}`,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=NV.M.fromPixels(this.webcamVideoElement)}catch(t){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(t)}`)}if(!this.resize)return{value:t,done:!1};try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(t){throw new Error(`Error thrown cropping the video: ${t.message}`)}finally{t.dispose()}}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(t){return Object(NV.ud)(()=>{const e=t.toFloat().expandDims(0);let r;r=NV.Fb.cropAndResize(e,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const i=r.shape;return r.reshape(i.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(t=>t.stop());try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class DZ{}var FZ=r(57);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class LZ extends FZ.a{constructor(t,e={}){super(),this.file=t,this.options=e,NV.Cd.assert(t instanceof Uint8Array||!!Object(NV.nb)().get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=e.offset||0,this.chunkSize=e.chunkSize||1048576}summary(){return`FileChunks ${this.file}`}async next(){if(this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size))return{value:null,done:!0};const t=new Promise((t,e)=>{const r=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)t(new Uint8Array(this.file.slice(this.offset,r)));else{const i=new FileReader;i.onload=r=>{let n=i.result;if(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),!(n instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(n)},i.onabort=t=>e(new Error("Aborted")),i.onerror=t=>e(new Error(t.type));const n=this.file.slice(this.offset,r);i.readAsArrayBuffer(n)}this.offset=r});return{value:await t,done:!1}}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const kZ=t=>({method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function UZ(t){return"string"==typeof t&&"file://"===t.substr(0,7)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class BZ extends DZ{constructor(t,e={}){super(),this.input=t,this.options=e}async iterator(){if(UZ(this.input)&&Object(NV.nb)().get("IS_NODE")){const t=r(83);this.input=t.readFileSync(this.input.substr(7))}return new LZ(this.input,this.options)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class jZ extends DZ{constructor(t,e={}){super(),this.url=t,this.fileOptions=e}async iterator(){return UZ(this.url)?new BZ(this.url,this.fileOptions).iterator():async function(t,e={}){let r,i;"string"==typeof t?r=t:(r=t.url,i=kZ(t));const n=await NV.Cd.fetch(r,i);if(n.ok){const t=new Uint8Array(await n.arrayBuffer());return new LZ(t,e)}throw new Error(n.statusText)}(this.url,this.fileOptions)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function XZ(t,e={}){return new NZ(new jZ(t),e)}function GZ(t){const e=Object(vZ.e)(t);return xZ(async()=>e)}function zZ(t){return xZ(async()=>{const e=await t();return Object(vZ.e)(()=>e.next())})}async function VZ(t,e){return MZ.create(t,e)}async function HZ(t){return PZ.create(t)}
/** @license See the LICENSE file. */const $Z="2.0.1";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WZ(t,e,r,i){const n=NV.Cd.getTypedArrayFromDType(i,NV.Cd.sizeFromShape(r));for(let r=0;r<n.length;++r){const i=r*e;let s=t[i];for(let r=0;r<e;++r){const e=t[i+r];e>s&&(s=e)}n[r]=s}return n}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YZ(t,e,r,i,n){const s=e.length,o=NV.Cd.sizeFromShape(e),a=NV.Cd.computeStrides(e),h=NV.Cd.computeStrides(n),u=NV.Cd.getTypedArrayFromDType(r,NV.Cd.sizeFromShape(n));for(let e=0;e<o;++e){const r=NV.Cd.indexToLoc(e,s,a),n=new Array(r.length);for(let t=0;t<n.length;t++)n[t]=r[i[t]];u[NV.Cd.locToIndex(n,s,h)]=t[e]}return u}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qZ(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&NV.Cd.assert("complex64"!==t.dtype,()=>`${e} does not support complex64 tensors in the CPU backend.`)})}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KZ(t,e,r,i,n,s){const o=n.strideHeight,a=n.strideWidth,h=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,d=n.padInfo.top,p=n.padInfo.left,f="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Object(NV.N)(n.outShape,r),g=m.values,y=n.outShape[1]*n.outShape[2]*n.outShape[3],v=n.outShape[2]*n.outShape[3],_=n.outShape[3];for(let e=0;e<n.batchSize;++e){const r=e*y,m=e*i[0];for(let e=0;e<n.inChannels;++e)for(let y=0;y<n.outHeight;++y){const b=y*o-d,x=Math.max(0,b),T=Math.min(n.inHeight,l+b),E=r+y*v;for(let r=0;r<n.outWidth;++r){const o=r*a-p,l=Math.max(0,o),d=Math.min(n.inWidth,c+o);let y=f,v=0,b=0;for(let r=x;r<T;r+=h){const n=m+r*i[1];for(let r=l;r<d;r+=u){const o=t[n+r*i[2]+e];"max"===s&&o>y?y=o:"avg"===s&&(v+=o,b++)}if(isNaN(y))break}g[E+r*_+e]="avg"===s?v/b:y}}}return m}function ZZ(t,e,r,i,n=!1,s=!1){const o=Object(NV.N)(i.outShape,"int32"),a=i.strideHeight,h=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,d=i.effectiveFilterWidth,p=i.padInfo.top,f=i.padInfo.left,m=Object(NV.N)(e,r,t);for(let t=0;t<i.batchSize;++t)for(let e=0;e<i.inChannels;++e)for(let r=0;r<i.outHeight;++r){const g=r*a-p;let y=g;for(;y<0;)y+=u;const v=Math.min(i.inHeight,c+g);for(let a=0;a<i.outWidth;++a){const c=a*h-f;let p=c;for(;p<0;)p+=l;const _=Math.min(i.inWidth,d+c);let b=Number.NEGATIVE_INFINITY,x=-1;for(let r=y;r<v;r+=u){const o=r-g;for(let a=p;a<_;a+=l){const h=a-c,u=m.get(t,r,a,e);u>b&&(b=u,x=n?s?((t*i.inHeight+r)*i.inWidth+a)*i.inChannels+e:(r*i.inWidth+a)*i.inChannels+e:o*d+h)}}o.set(x,t,r,a,e)}}return o}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JZ=NV.Jb.nonMaxSuppressionV3,QZ=NV.Jb.split,tJ=NV.Jb.tile,eJ=NV.Jb.topkImpl,rJ=NV.Jb.whereImpl;function iJ(t,e,r,i){if("linear"===r)return t.linear(e);if("relu"===r)return t.relu(e);if("elu"===r)return t.elu(e);if("relu6"===r)return t.relu6(e);if("prelu"===r)return t.prelu(e,i);throw new Error(`Activation ${r} has not been implemented for the CPU backend.`)}class nJ extends NV.d{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new NV.a(this,Object(NV.mb)())}write(t,e,r){this.firstUse&&(this.firstUse=!1,Object(NV.nb)().get("IS_NODE")&&NV.F.warn("\n============================\nHi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));const i={};return this.data.set(i,{values:t,dtype:r}),i}move(t,e,r,i){this.data.set(t,{values:e,dtype:i})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensors:r}=this.data.get(t);if("complex64"===e){const t=this.readSync(r.real.dataId),e=this.readSync(r.imag.dataId);return NV.F.mergeRealAndImagArrays(t,e)}return this.data.get(t).values}bufferSync(t){const e=this.readSync(t.dataId);let r=e;if("string"===t.dtype)try{r=e.map(t=>NV.Cd.decodeString(t))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return NV.N(t.shape,t.dtype,r)}makeOutput(t,e,r){const i=this.write(t,e,r);return Object(NV.mb)().makeTensorFromDataId(i,e,r,this)}disposeData(t){if(this.data.has(t)){const{complexTensors:e}=this.data.get(t);null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}}async time(t){const e=NV.Cd.now();return t(),{kernelMs:NV.Cd.now()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}complex(t,e){const r=this.makeOutput(null,t.shape,"complex64");return this.data.get(r.dataId).complexTensors={real:Object(NV.mb)().keep(t.clone()),imag:Object(NV.mb)().keep(e.clone())},r}real(t){return this.data.get(t.dataId).complexTensors.real.clone()}imag(t){return this.data.get(t.dataId).complexTensors.imag.clone()}slice(t,e,r){if(qZ(t,"slice"),NV.Xc.isSliceContinous(t.shape,e,r)){const i=NV.Xc.computeFlatOffset(e,t.strides),n=NV.Cd.sizeFromShape(r),s=this.readSync(t.dataId);return NV.od(s.subarray(i,i+n),r,t.dtype)}const i=NV.N(r,t.dtype),n=this.bufferSync(t);for(let t=0;t<i.size;++t){const r=i.indexToLoc(t).map((t,r)=>t+e[r]);i.values[t]=n.get(...r)}return i.toTensor()}stridedSlice(t,e,r,i){qZ(t,"stridedSlice");const n=NV.Xc.computeOutShape(e,r,i);if(n.some(t=>0===t))return NV.od([],n);const s=NV.N(n,t.dtype),o=this.bufferSync(t);for(let t=0;t<s.size;t++){const r=s.indexToLoc(t),n=new Array(r.length);for(let t=0;t<n.length;t++)n[t]=r[t]*i[t]+e[t];s.set(o.get(...n),...r)}return s.toTensor()}diag(t){const e=this.readSync(t.dataId),r=NV.N([t.size,t.size],t.dtype),i=r.values;for(let r=0;r<e.length;r++)i[r*t.size+r]=e[r];return r.toTensor()}unstack(t,e){const r=t.shape[e],i=new Array(t.rank-1);let n=0;for(let r=0;r<t.rank;r++)r!==e&&(i[n++]=t.shape[r]);const s=new Array(t.rank).fill(0),o=t.shape.slice();o[e]=1;const a=new Array(r);for(let r=0;r<a.length;r++)s[e]=r,a[r]=this.slice(t,s,o).reshape(i);return a}reverse(t,e){qZ(t,"reverse");const r=NV.N(t.shape,t.dtype),i=this.bufferSync(t);for(let n=0;n<r.size;n++){const s=r.indexToLoc(n),o=s.slice();e.forEach(e=>o[e]=t.shape[e]-1-o[e]),r.set(i.get(...o),...s)}return r.toTensor()}concat(t,e){if("complex64"===t[0].dtype){const r=t.map(t=>NV.xc(t)),i=t.map(t=>NV.Eb(t));return NV.R(this.concat(r,e),this.concat(i,e))}const r=t.map(t=>{const r=NV.Cd.sizeFromShape(t.shape.slice(e));return t.as2D(-1,r)}),i=NV.F.computeOutShape(r.map(t=>t.shape),1),n=NV.N(i,t[0].dtype).values;if(1===r[0].shape[0]){let t=0;r.forEach(e=>{n.set(this.readSync(e.dataId),t),t+=e.size})}else{let t=0;r.forEach(e=>{const r=this.readSync(e.dataId);let s=0;for(let o=0;o<e.shape[0];++o){const a=o*i[1]+t;for(let t=0;t<e.shape[1];++t)n[a+t]=r[s++]}t+=e.shape[1]})}const s=NV.F.computeOutShape(t.map(t=>t.shape),e);return NV.od(n,s,t[0].dtype)}neg(t){return qZ(t,"neg"),this.multiply(NV.Hc(-1),t)}add(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(t,e,r,i)=>({real:t+r,imag:e+i})):this.broadcastedBinaryOp(t,e,Object(NV.Bd)(t.dtype,e.dtype),(t,e)=>t+e)}addN(t){qZ(t,"addN");const e=t.map(t=>this.readSync(t.dataId)),r=NV.N(t[0].shape,t[0].dtype),i=r.values;for(let r=0;r<t.length;r++){const t=e[r];for(let e=0;e<i.length;e++)i[e]+=t[e]}return r.toTensor()}softmax(t,e){const r=NV.Cd.parseAxisParam([e],t.shape),i=Object(NV.Xb)(t,r),n=NV.F.expandShapeToKeepDim(i.shape,r),s=this.subtract(t,i.reshape(n)),o=this.exp(s),a=this.sum(o,r).reshape(n);return NV.ib(o,a)}subtract(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(t,e,r,i)=>({real:t-r,imag:e-i})):this.broadcastedBinaryOp(t,e,Object(NV.Bd)(t.dtype,e.dtype),(t,e)=>t-e)}pow(t,e){return qZ([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.pow(t,e))}batchMatMul(t,e,r,i){qZ([t,e],"matMul");const n=r?t.shape[1]:t.shape[2],s=r?t.shape[2]:t.shape[1],o=i?e.shape[1]:e.shape[2],a=t.shape[0],h=this.readSync(t.dataId),u=this.readSync(e.dataId),[l,c,d]=r?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],[p,f,m]=i?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],g=s*o,y=NV.N([a,s,o],t.dtype),v=y.values,_=this.blockSize;for(let t=0;t<a;t++)for(let e=0;e<s;e+=_)for(let r=0;r<o;r+=_)for(let i=0;i<n;i+=_){const a=Math.min(e+_,s),y=Math.min(r+_,o),b=Math.min(i+_,n);for(let n=e;n<a;n++)for(let e=r;e<y;e++){let r=0;for(let s=i;s<b;s++)r+=h[t*l+n*c+s*d]*u[s*p+e*f+t*m];v[t*g+(n*o+e)]+=r}}return y.toTensor()}fusedBatchMatMul({a:t,b:e,transposeA:r,transposeB:i,bias:n,activation:s,preluActivationWeights:o}){let a=this.batchMatMul(t,e,r,i);return n&&(a=this.add(a,n)),s&&(a=iJ(this,a,s,o)),a}multiply(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(t,e,r,i)=>({real:t*r-e*i,imag:t*i+e*r})):this.broadcastedBinaryOp(t,e,Object(NV.Bd)(t.dtype,e.dtype),(t,e)=>t*e)}floorDiv(t,e){qZ([t,e],"floorDiv");return this.broadcastedBinaryOp(t,e,"int32",(t,e)=>Math.floor(t/e))}sum(t,e){qZ(t,"sum"),NV.F.assertAxesAreInnerMostDims("sum",e,t.rank);const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=Object(NV.Bd)(t.dtype,"int32"),s=NV.Id(r,n),o=NV.Cd.sizeFromShape(i),a=this.readSync(s.dataId),h=this.readSync(t.dataId);for(let t=0;t<a.length;++t){const e=t*o;let r=0;for(let t=0;t<o;++t)r+=h[e+t];a[t]=r}return s}prod(t,e){qZ(t,"sum");const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=Object(NV.Bd)(t.dtype,"int32"),s=NV.Id(r,n),o=NV.Cd.sizeFromShape(i),a=this.readSync(s.dataId),h=this.readSync(t.dataId);for(let t=0;t<a.length;++t){const e=t*o;let r=1;for(let t=0;t<o;++t)r*=h[e+t];a[t]=r}return s}unsortedSegmentSum(t,e,r){qZ(t,"unsortedSegmentSum");const i=[],n=t.rank-e.rank;for(let t=0;t<n;++t)e=e.expandDims(t+1);for(let n=0;n<r;++n){const r=NV.Hc(n,"int32"),s=NV.ob(r,e).asType("float32").mul(t).sum(0);i.push(s)}return NV.hd(i)}argMin(t,e){qZ(t,"argMin");const r=[e];NV.F.assertAxesAreInnerMostDims("argMin",r,t.rank);const[i,n]=NV.F.computeOutAndReduceShapes(t.shape,r),s=NV.Id(i,"int32"),o=NV.Cd.sizeFromShape(n),a=this.readSync(s.dataId),h=this.readSync(t.dataId);for(let t=0;t<a.length;++t){const e=t*o;let r=h[e],i=0;for(let t=0;t<o;++t){const n=h[e+t];n<r&&(r=n,i=t)}a[t]=i}return s}argMax(t,e){qZ(t,"argMax");const r=[e];NV.F.assertAxesAreInnerMostDims("argMax",r,t.rank);const[i,n]=NV.F.computeOutAndReduceShapes(t.shape,r),s=NV.Id(i,"int32"),o=NV.Cd.sizeFromShape(n),a=this.readSync(s.dataId),h=this.readSync(t.dataId);for(let t=0;t<a.length;++t){const e=t*o;let r=h[e],i=0;for(let t=0;t<o;++t){const n=h[e+t];n>r&&(r=n,i=t)}a[t]=i}return s}cumsum(t,e,r,i){if(qZ(t,"cumsum"),e!==t.rank-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${t.rank-1} `+`but got axis=${e}`);const n=Object(NV.Bd)(t.dtype,"int32"),s=NV.Id(t.shape,n),o=this.readSync(s.dataId),a=this.readSync(t.dataId),h=t.shape[t.rank-1],u=i?(t,e)=>t+h-e-1:(t,e)=>t+e;for(let t=0;t<a.length;t+=h)for(let e=0;e<h;e++){const i=u(t,e);if(0===e)o[i]=r?0:a[i];else{const n=u(t,e-1);o[i]=r?a[n]+o[n]:a[i]+o[n]}}return s}equal(t,e){return qZ([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t===e?1:0)}notEqual(t,e){return qZ([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t!==e?1:0)}less(t,e){return qZ([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t<e?1:0)}lessEqual(t,e){return qZ([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t<=e?1:0)}greater(t,e){return qZ([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t>e?1:0)}greaterEqual(t,e){return qZ([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t>=e?1:0)}logicalNot(t){qZ(t,"logicalNot");const e=this.readSync(t.dataId),r=new Uint8Array(e.length);for(let t=0;t<e.length;++t)r[t]=e[t]?0:1;return this.makeOutput(r,t.shape,"bool")}logicalAnd(t,e){return qZ([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t&&e)}logicalOr(t,e){return qZ([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t||e)}select(t,e,r){qZ([t,e,r],"select");const i=this.readSync(t.dataId),n=this.readSync(e.dataId),s=this.readSync(r.dataId),o=NV.Id(e.shape,Object(NV.Bd)(e.dtype,r.dtype)),a=this.readSync(o.dataId);let h=0;const u=0===t.rank||t.rank>1||1===e.rank?1:NV.Cd.sizeFromShape(e.shape.slice(1));for(let t=0;t<i.length;t++)for(let e=0;e<u;e++)1===i[t]?a[h++]=n[t]:a[h++]=s[t];return o}where(t){qZ([t],"where");const e=this.readSync(t.dataId);return rJ(t.shape,e)}topk(t,e,r){qZ(t,"topk");const i=this.readSync(t.dataId);return eJ(i,t.shape,t.dtype,e,r)}min(t,e){qZ(t,"min"),NV.F.assertAxesAreInnerMostDims("min",e,t.rank);const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=NV.Id(r,t.dtype),s=NV.Cd.sizeFromShape(i),o=this.readSync(n.dataId),a=this.readSync(t.dataId);for(let t=0;t<o.length;++t){const e=t*s;let r=a[e];for(let t=0;t<s;++t){const i=a[e+t];i<r&&(r=i)}o[t]=r}return n}minimum(t,e){return qZ([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.min(t,e))}mod(t,e){return qZ([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>{const r=t%e;return t<0&&e<0||t>=0&&e>=0?r:(r+e)%e})}maximum(t,e){return qZ([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.max(t,e))}all(t,e){qZ(t,"all"),NV.F.assertAxesAreInnerMostDims("all",e,t.rank);const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=NV.Id(r,t.dtype),s=NV.Cd.sizeFromShape(i),o=this.readSync(n.dataId),a=this.readSync(t.dataId);for(let t=0;t<o.length;++t){const e=t*s;let r=a[e];for(let t=0;t<s;++t){const i=a[e+t];r=r&&i}o[t]=r}return n}any(t,e){qZ(t,"any"),NV.F.assertAxesAreInnerMostDims("any",e,t.rank);const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=NV.Id(r,t.dtype),s=NV.Cd.sizeFromShape(i),o=this.readSync(n.dataId),a=this.readSync(t.dataId);for(let t=0;t<o.length;++t){const e=t*s;let r=a[e];for(let t=0;t<s;++t){const i=a[e+t];r=r||i}o[t]=r}return n}squaredDifference(t,e){return qZ([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>{const r=t-e;return r*r})}ceil(t){qZ(t,"ceil");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t)r[t]=Math.ceil(e[t]);return this.makeOutput(r,t.shape,"float32")}floor(t){qZ(t,"floor");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t)r[t]=Math.floor(e[t]);return this.makeOutput(r,t.shape,"float32")}sign(t){qZ(t,"x");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t)e[t]<0?r[t]=-1:e[t]>0?r[t]=1:r[t]=0;return this.makeOutput(r,t.shape,"float32")}isNaN(t){qZ(t,"x");const e=this.readSync(t.dataId),r=new Uint8Array(e.length);for(let t=0;t<e.length;++t)Number.isNaN(e[t])&&(r[t]=1);return this.makeOutput(r,t.shape,"bool")}isInf(t){qZ(t,"x");const e=this.readSync(t.dataId),r=new Uint8Array(e.length);for(let t=0;t<e.length;++t)Math.abs(e[t])===1/0&&(r[t]=1);return this.makeOutput(r,t.shape,"bool")}isFinite(t){qZ(t,"x");const e=this.readSync(t.dataId),r=new Uint8Array(e.length);for(let t=0;t<e.length;++t)Number.isFinite(e[t])&&(r[t]=1);return this.makeOutput(r,t.shape,"bool")}round(t){qZ(t,"round");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t){const i=Math.floor(e[t]);e[t]-i<.5?r[t]=Math.floor(e[t]):e[t]-i>.5?r[t]=Math.ceil(e[t]):r[t]=i%2==0?i:i+1}return this.makeOutput(r,t.shape,"float32")}exp(t){qZ(t,"exp");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t)r[t]=Math.exp(e[t]);return this.makeOutput(r,t.shape,"float32")}expm1(t){qZ(t,"expm1");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t)r[t]=Math.expm1(e[t]);return this.makeOutput(r,t.shape,"float32")}log(t){qZ(t,"log");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t){const i=e[t];r[t]=Math.log(i)}return this.makeOutput(r,t.shape,"float32")}log1p(t){qZ(t,"log1p");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t){const i=e[t];r[t]=Math.log1p(i)}return this.makeOutput(r,t.shape,"float32")}sqrt(t){qZ(t,"sqrt");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t){const i=e[t];r[t]=Math.sqrt(i)}return this.makeOutput(r,t.shape,"float32")}rsqrt(t){qZ(t,"rsqrt");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t){const i=e[t];r[t]=1/Math.sqrt(i)}return this.makeOutput(r,t.shape,"float32")}reciprocal(t){qZ(t,"reciprocal");const e=this.readSync(t.dataId),r=new Float32Array(e.length);for(let t=0;t<e.length;++t)r[t]=1/e[t];return this.makeOutput(r,t.shape,"float32")}linear(t){return t}relu(t){qZ(t,"relu");const e=NV.Id(t.shape,t.dtype),r=this.readSync(e.dataId),i=this.readSync(t.dataId);for(let t=0;t<i.length;++t)r[t]=Math.max(0,i[t]);return e}relu6(t){qZ(t,"relu");const e=NV.Id(t.shape,t.dtype),r=this.readSync(e.dataId),i=this.readSync(t.dataId);for(let t=0;t<i.length;++t)r[t]=Math.min(Math.max(0,i[t]),6);return e}prelu(t,e){return qZ([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>t<0?e*t:t)}elu(t){qZ(t,"elu");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t){const i=r[t];e[t]=i>=0?i:Math.exp(i)-1}return this.makeOutput(e,t.shape,"float32")}eluDer(t,e){qZ([t,e],"eluDer");const r=new Float32Array(e.size),i=this.readSync(e.dataId),n=this.readSync(t.dataId);for(let t=0;t<i.length;++t){const e=i[t];r[t]=e>=1?n[t]:n[t]*(e+1)}return this.makeOutput(r,e.shape,"float32")}selu(t){qZ(t,"selu");const e=NV.F.SELU_SCALEALPHA,r=NV.F.SELU_SCALE,i=new Float32Array(t.size),n=this.readSync(t.dataId);for(let t=0;t<n.length;++t){const s=n[t];i[t]=s>=0?r*s:e*(Math.exp(s)-1)}return this.makeOutput(i,t.shape,"float32")}clip(t,e,r){qZ(t,"clip");const i=new Float32Array(t.size),n=this.readSync(t.dataId);for(let t=0;t<n.length;++t){const s=n[t];i[t]=s>r?r:s<e?e:s}return this.makeOutput(i,t.shape,"float32")}abs(t){const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.abs(r[t]);return this.makeOutput(e,t.shape,"float32")}complexAbs(t){const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let i=0;i<t.size;++i){const t=r[2*i],n=r[2*i+1];e[i]=Math.hypot(t,n)}return this.makeOutput(e,t.shape,"float32")}int(t){qZ(t,"int");const e=new Int32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=r[t];return this.makeOutput(e,t.shape,"int32")}sigmoid(t){qZ(t,"sigmoid");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=1/(1+Math.exp(-r[t]));return this.makeOutput(e,t.shape,"float32")}softplus(t){qZ(t,"softplus");const e=Math.log(1.1920928955078125e-7)+2,r=new Float32Array(t.size),i=this.readSync(t.dataId);for(let t=0;t<i.length;++t){const n=i[t]>-e,s=i[t]<e,o=Math.exp(i[t]);let a;a=s?o:n?i[t]:Math.log(1+o),r[t]=a}return this.makeOutput(r,t.shape,"float32")}sin(t){qZ(t,"sin");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.sin(r[t]);return this.makeOutput(e,t.shape,"float32")}cos(t){qZ(t,"cos");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.cos(r[t]);return this.makeOutput(e,t.shape,"float32")}tan(t){qZ(t,"tan");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.tan(r[t]);return this.makeOutput(e,t.shape,"float32")}asin(t){qZ(t,"asin");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.asin(r[t]);return this.makeOutput(e,t.shape,"float32")}acos(t){qZ(t,"acos");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.acos(r[t]);return this.makeOutput(e,t.shape,"float32")}atan(t){qZ(t,"atan");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.atan(r[t]);return this.makeOutput(e,t.shape,"float32")}atan2(t,e){return qZ([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.atan2(t,e))}sinh(t){qZ(t,"sinh");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.sinh(r[t]);return this.makeOutput(e,t.shape,"float32")}cosh(t){qZ(t,"cosh");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.cosh(r[t]);return this.makeOutput(e,t.shape,"float32")}tanh(t){qZ(t,"tanh");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=NV.Cd.tanh(r[t]);return this.makeOutput(e,t.shape,"float32")}asinh(t){qZ(t,"asinh");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.asinh(r[t]);return this.makeOutput(e,t.shape,"float32")}acosh(t){qZ(t,"acosh");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.acosh(r[t]);return this.makeOutput(e,t.shape,"float32")}atanh(t){qZ(t,"atanh");const e=new Float32Array(t.size),r=this.readSync(t.dataId);for(let t=0;t<r.length;++t)e[t]=Math.atanh(r[t]);return this.makeOutput(e,t.shape,"float32")}erf(t){qZ(t,"erf");const e=new Float32Array(t.size),r=this.readSync(t.dataId),i=NV.F.ERF_P,n=NV.F.ERF_A1,s=NV.F.ERF_A2,o=NV.F.ERF_A3,a=NV.F.ERF_A4,h=NV.F.ERF_A5;for(let t=0;t<r.length;++t){const u=Math.sign(r[t]),l=Math.abs(r[t]),c=1/(1+i*l);e[t]=u*(1-((((h*c+a)*c+o)*c+s)*c+n)*c*Math.exp(-l*l))}return this.makeOutput(e,t.shape,"float32")}step(t,e=0){qZ(t,"step");const r=new Float32Array(t.size),i=this.readSync(t.dataId);for(let t=0;t<i.length;++t){const n=i[t];isNaN(n)?r[t]=NaN:r[t]=n>0?1:e}return this.makeOutput(r,t.shape,"float32")}fusedConv2d({input:t,filter:e,convInfo:r,bias:i,activation:n,preluActivationWeights:s}){let o=this.conv2d(t,e,r);return i&&(o=this.add(o,i)),n&&(o=iJ(this,o,n,s)),o}conv2d(t,e,r){qZ([t,e],"conv2d");const i=r.filterHeight,n=r.filterWidth,s=r.dilationHeight,o=r.dilationWidth,a=r.padInfo.left,h=r.padInfo.top,u="channelsLast"===r.dataFormat,l=NV.N(r.outShape,t.dtype),c=t.strides[0],d=u?t.strides[1]:t.strides[2],p=u?t.strides[2]:1,f=u?1:t.strides[1],m=l.strides[0],g=u?l.strides[1]:l.strides[2],y=u?l.strides[2]:1,v=u?1:l.strides[1],_=this.readSync(t.dataId),b=this.readSync(e.dataId),x=l.values;for(let t=0;t<r.batchSize;++t){const u=t*c,l=t*m;for(let t=0;t<r.outHeight;++t){const c=l+t*g,m=t*r.strideHeight-h;for(let t=0;t<i;t++){const i=m+t*s;if(i<0||i>=r.inHeight)continue;const h=t*e.strides[0],l=u+i*d;for(let t=0;t<r.outWidth;++t){const i=c+t*y,s=t*r.strideWidth-a;for(let t=0;t<n;t++){const n=s+t*o;if(n<0||n>=r.inWidth)continue;const a=l+n*p;let u=h+t*e.strides[1];for(let t=0;t<r.inChannels;++t){const e=_[a+t*f];for(let t=0;t<r.outChannels;++t)x[i+t*v]+=e*b[u+t];u+=r.outChannels}}}}}}return l.toTensor()}conv3d(t,e,r){const i=r.filterDepth,n=r.filterHeight,s=r.filterWidth,o=r.dilationDepth,a=r.dilationHeight,h=r.dilationWidth,u=r.padInfo.front,l=r.padInfo.left,c=r.padInfo.top,d=NV.N(r.outShape,t.dtype),p=this.readSync(t.dataId),f=this.readSync(e.dataId),m=d.values;for(let g=0;g<r.batchSize;++g){const y=g*t.strides[0],v=g*d.strides[0];for(let g=0;g<r.outDepth;++g){const _=v+g*d.strides[1],b=g*r.strideDepth-u;for(let u=0;u<i;u++){const i=b+u*o;if(i<0||i>=r.inDepth)continue;const g=u*e.strides[0],v=y+i*t.strides[1];for(let i=0;i<r.outHeight;++i){const o=_+i*d.strides[2],u=i*r.strideHeight-c;for(let i=0;i<n;i++){const n=u+i*a;if(n<0||n>=r.inHeight)continue;const c=g+i*e.strides[1],d=v+n*t.strides[2];for(let t=0;t<r.outWidth;++t){const i=o+t*r.outChannels,n=t*r.strideWidth-l;for(let t=0;t<s;t++){const s=n+t*h;if(s<0||s>=r.inWidth)continue;const o=c+t*e.strides[2],a=d+s*r.inChannels;let u=o;for(let t=0;t<r.inChannels;++t){const e=p[a+t];for(let t=0;t<r.outChannels;++t)m[i+t]+=e*f[u+t];u+=r.outChannels}}}}}}}}return d.toTensor()}conv2dDerInput(t,e,r){qZ([t,e],"conv2dDerInput");const i=NV.N(r.inShape,"float32"),n=i.values,s=this.readSync(t.dataId),o=this.readSync(e.dataId),[a,h,u]=e.strides,{batchSize:l,filterHeight:c,filterWidth:d,inChannels:p,inHeight:f,inWidth:m,outChannels:g,outHeight:y,outWidth:v,strideHeight:_,strideWidth:b,dataFormat:x}=r,T=c-1-r.padInfo.top,E=d-1-r.padInfo.left,w="channelsLast"===x,S=i.strides[0],I=w?i.strides[1]:i.strides[2],A=w?i.strides[2]:1,C=w?1:i.strides[1],O=t.strides[0],R=w?t.strides[1]:t.strides[2],N=w?t.strides[2]:1,P=w?1:t.strides[1];for(let t=0;t<l;++t)for(let e=0;e<p;++e)for(let r=0;r<f;++r){const i=r-T,l=Math.max(0,Math.ceil(i/_)),p=Math.min(y,(c+i)/_);for(let f=0;f<m;++f){const m=f-E,y=Math.max(0,Math.ceil(m/b)),x=Math.min(v,(d+m)/b);let T=0;for(let r=l;r<p;++r){const n=r*_-i;for(let i=y;i<x;++i){const l=O*t+R*r+N*i,p=a*(c-1-n)+h*(d-1-(i*b-m))+u*e;for(let t=0;t<g;++t){T+=s[l+P*t]*o[p+t]}}}n[S*t+I*r+A*f+C*e]=T}}return i.toTensor()}conv3dDerInput(t,e,r){const i=NV.N(r.inShape,"float32"),n=i.values,[s,o,a,h]=i.strides,u=this.readSync(t.dataId),[l,c,d,p]=t.strides,f=this.readSync(e.dataId),[m,g,y,v]=e.strides,{batchSize:_,filterDepth:b,filterHeight:x,filterWidth:T,inChannels:E,inDepth:w,inHeight:S,inWidth:I,outChannels:A,outDepth:C,outHeight:O,outWidth:R,strideDepth:N,strideHeight:P,strideWidth:M}=r,D=b-1-r.padInfo.front,F=x-1-r.padInfo.top,L=T-1-r.padInfo.left;for(let t=0;t<_;++t)for(let e=0;e<E;++e)for(let r=0;r<w;++r){const i=r-D,_=Math.max(0,Math.ceil(i/N)),E=Math.min(C,(b+i)/N);for(let w=0;w<S;++w){const S=w-F,C=Math.max(0,Math.ceil(S/P)),D=Math.min(O,(x+S)/P);for(let O=0;O<I;++O){const I=O-L,F=Math.max(0,Math.ceil(I/M)),k=Math.min(R,(T+I)/M);let U=0;for(let r=_;r<E;++r){const n=r*N-i;for(let i=C;i<D;++i){const s=i*P-S;for(let o=F;o<k;++o){const a=l*t+c*r+d*i+p*o,h=m*(b-1-n)+g*(x-1-s)+y*(T-1-(o*M-I))+v*e;for(let t=0;t<A;++t){U+=u[a+t]*f[h+t]}}}}n[s*t+o*r+a*w+h*O+e]=U}}}return i.toTensor()}conv2dDerFilter(t,e,r){qZ([t,e],"conv2dDerFilter");const i=r.strideHeight,n=r.strideWidth,s=r.filterHeight,o=r.filterWidth,a="channelsLast"===r.dataFormat,h=NV.N(r.filterShape,"float32"),u=r.padInfo.left,l=r.padInfo.top,c=this.bufferSync(t),d=this.bufferSync(e);for(let t=0;t<s;++t){const e=Math.max(0,Math.ceil((l-t)/i)),s=Math.min(r.outHeight,(r.inHeight+l-t)/i);for(let p=0;p<o;++p){const o=Math.max(0,Math.ceil((u-p)/n)),f=Math.min(r.outWidth,(r.inWidth+u-p)/n);for(let m=0;m<r.inChannels;++m)for(let g=0;g<r.outChannels;++g){let y=0;for(let h=0;h<r.batchSize;++h)for(let r=e;r<s;++r){const e=t+r*i-l;for(let t=o;t<f;++t){const i=p+t*n-u;y+=a?c.get(h,e,i,m)*d.get(h,r,t,g):c.get(h,m,e,i)*d.get(h,g,r,t)}}h.set(y,t,p,m,g)}}}return h.toTensor()}conv3dDerFilter(t,e,r){const i=r.strideDepth,n=r.strideHeight,s=r.strideWidth,o=r.filterDepth,a=r.filterHeight,h=r.filterWidth,u=NV.N(r.filterShape,"float32"),l=u.values,[c,d,p,f]=u.strides,m=this.readSync(e.dataId),[g,y,v,_]=e.strides,b=this.readSync(t.dataId),[x,T,E,w]=t.strides,S=r.padInfo.front,I=r.padInfo.left,A=r.padInfo.top;for(let t=0;t<o;++t){const e=Math.max(0,Math.ceil((S-t)/i)),o=Math.min(r.outDepth,(r.inDepth+S-t)/i),u=t*c;for(let c=0;c<a;++c){const a=Math.max(0,Math.ceil((A-c)/n)),C=Math.min(r.outHeight,(r.inHeight+A-c)/n),O=c*d+u;for(let u=0;u<h;++u){const h=Math.max(0,Math.ceil((I-u)/s)),d=Math.min(r.outWidth,(r.inWidth+I-u)/s),R=u*p+O;for(let p=0;p<r.inChannels;++p){const O=p*f+R;for(let f=0;f<r.outChannels;++f){let R=0;for(let l=0;l<r.batchSize;++l){const r=l*x,O=l*g;for(let l=e;l<o;++l){const e=(t+l*i-S)*T+r,o=l*y+O;for(let t=a;t<C;++t){const r=(c+t*n-A)*E+e,i=t*v+o;for(let t=h;t<d;++t){const e=t*_+i;R+=b[(u+t*s-I)*w+r+p]*m[e+f]}}}}l[O+f]=R}}}}}return u.toTensor()}fusedDepthwiseConv2D({input:t,filter:e,convInfo:r,bias:i,activation:n,preluActivationWeights:s}){let o=this.depthwiseConv2D(t,e,r);return i&&(o=this.add(o,i)),n&&(o=iJ(this,o,n,s)),o}depthwiseConv2D(t,e,r){qZ([t,e],"depthwiseConv2D");const i=r.filterHeight,n=r.filterWidth,s=r.dilationHeight,o=r.dilationWidth,a=r.padInfo.left,h=r.padInfo.top,u=r.outChannels/r.inChannels,l=NV.N(r.outShape,t.dtype),c=this.readSync(t.dataId),d=this.readSync(e.dataId),p=l.values;for(let f=0;f<r.batchSize;++f){const m=f*t.strides[0],g=f*l.strides[0];for(let f=0;f<r.outHeight;++f){const y=g+f*l.strides[1],v=f*r.strideHeight-a;for(let a=0;a<i;++a){const i=v+a*s;if(i<0||i>=r.inHeight)continue;const f=a*e.strides[0],g=m+i*t.strides[1];for(let t=0;t<r.outWidth;++t){const i=y+t*l.strides[2],s=t*r.strideWidth-h;for(let t=0;t<n;++t){const n=s+t*o;if(n<0||n>=r.inWidth)continue;const a=f+t*e.strides[1],h=g+n*r.inChannels;let l=i,m=a;for(let t=0;t<r.inChannels;++t){const e=c[h+t];for(let t=0;t<u;++t)p[l+t]+=e*d[m+t];l+=u,m+=u}}}}}}return l.toTensor()}depthwiseConv2DDerInput(t,e,r){qZ([t,e],"depthwiseConv2DDerInput");const i=NV.N(r.inShape,"float32"),n=i.values,[s,o,a]=i.strides,h=this.readSync(t.dataId),[u,l,c]=t.strides,d=this.readSync(e.dataId),[p,f,m]=e.strides,{batchSize:g,filterHeight:y,filterWidth:v,inChannels:_,inHeight:b,inWidth:x,outChannels:T,outHeight:E,outWidth:w,strideHeight:S,strideWidth:I}=r,A=y-1-r.padInfo.top,C=v-1-r.padInfo.left,O=T/_;for(let t=0;t<g;++t)for(let e=0;e<_;++e)for(let r=0;r<b;++r){const i=r-A,g=Math.max(0,Math.ceil(i/S)),_=Math.min(E,(y+i)/S);for(let b=0;b<x;++b){const x=b-C,T=Math.max(0,Math.ceil(x/I)),E=Math.min(w,(v+x)/I);let A=0;for(let r=g;r<_;++r){const n=r*S-i;for(let i=T;i<E;++i){const s=u*t+l*r+c*i,o=p*(y-1-n)+f*(v-1-(i*I-x))+m*e;for(let t=0;t<O;++t){A+=h[s+(e*O+t)]*d[o+t]}}}n[s*t+o*r+a*b+e]=A}}return i.toTensor()}depthwiseConv2DDerFilter(t,e,r){qZ([t,e],"depthwiseConv2DDerFilter");const i=r.strideHeight,n=r.strideWidth,s=r.filterHeight,o=r.filterWidth,a=NV.N(r.filterShape,"float32"),h=r.padInfo.left,u=r.padInfo.top,l=r.outChannels/r.inChannels,c=this.bufferSync(t),d=this.bufferSync(e);for(let t=0;t<s;++t){const e=Math.max(0,Math.ceil((u-t)/i)),s=Math.min(r.outHeight,(r.inHeight+u-t)/i);for(let p=0;p<o;++p){const o=Math.max(0,Math.ceil((h-p)/n)),f=Math.min(r.outWidth,(r.inWidth+h-p)/n);for(let m=0;m<r.outChannels;++m){const g=Math.trunc(m/l),y=m%l;let v=0;for(let a=0;a<r.batchSize;++a)for(let r=e;r<s;++r){const e=t+r*i-u;for(let t=o;t<f;++t){const i=p+t*n-h;v+=c.get(a,e,i,g)*d.get(a,r,t,m)}}a.set(v,t,p,g,y)}}}return a.toTensor()}tile(t,e){return qZ(t,"tile"),tJ(this.bufferSync(t),e)}pad(t,e,r){qZ(t,"pad");const i=e.map((e,r)=>e[0]+t.shape[r]+e[1]),n=e.map(t=>t[0]),s=this.bufferSync(t),o=NV.N(i,t.dtype);0!==r&&o.values.fill(r);for(let e=0;e<t.size;e++){const t=s.indexToLoc(e),r=t.map((t,e)=>t+n[e]);o.set(s.get(...t),...r)}return o.toTensor()}gather(t,e,r){qZ([t,e],"gather");const i=t.shape.slice(),n=this.readSync(e.dataId);i[r]=n.length;const s=NV.N(i,t.dtype),o=this.bufferSync(t);for(let t=0;t<s.size;++t){const e=s.indexToLoc(t),i=e.slice();i[r]=n[e[r]];const a=o.locToIndex(i);s.values[t]=o.values[a]}return s.toTensor()}batchToSpaceND(t,e,r){qZ([t],"batchToSpaceND");const i=e.reduce((t,e)=>t*e),n=NV.F.getReshaped(t.shape,e,i),s=NV.F.getPermuted(n.length,e.length),o=NV.F.getReshapedPermuted(t.shape,e,i),a=NV.F.getSliceBeginCoords(r,e.length),h=NV.F.getSliceSize(o,r,e.length);return NV.yd(t.reshape(n),s).reshape(o).slice(a,h)}spaceToBatchND(t,e,r){qZ([t],"spaceToBatchND");const i=e.reduce((t,e)=>t*e),n=[[0,0]];n.push(...r);for(let r=1+e.length;r<t.shape.length;++r)n.push([0,0]);const s=t.pad(n),o=NV.F.getReshaped(s.shape,e,i,!1),a=NV.F.getPermuted(o.length,e.length,!1),h=NV.F.getReshapedPermuted(s.shape,e,i,!1);return NV.yd(s.reshape(o),a).reshape(h)}maxPool(t,e){return qZ(t,"maxPool"),KZ(this.readSync(t.dataId),t.shape,t.dtype,t.strides,e,"max").toTensor()}maxPoolBackprop(t,e,r,i){qZ([e,r],"maxPoolBackprop");const n=this.readSync(e.dataId),s=Object(NV.N)(i.outShape,e.dtype,ZZ(n,e.shape,e.dtype,i).values),o=i.strideHeight,a=i.strideWidth,h=i.dilationHeight,u=i.dilationWidth,l=i.effectiveFilterHeight,c=i.effectiveFilterWidth,d=c-1-i.padInfo.left,p=l-1-i.padInfo.top,f=NV.N(e.shape,"float32"),m=this.bufferSync(t);for(let t=0;t<i.batchSize;++t)for(let e=0;e<i.inChannels;++e)for(let r=0;r<i.inHeight;++r)for(let n=0;n<i.inWidth;++n){const g=r-p,y=n-d;let v=0;for(let r=0;r<l;r+=h){const n=(g+r)/o;if(!(n<0||n>=i.outHeight||Math.floor(n)!==n))for(let o=0;o<c;o+=u){const h=(y+o)/a;if(h<0||h>=i.outWidth||Math.floor(h)!==h)continue;const u=l*c-1-s.get(t,n,h,e)===r*c+o?1:0;0!==u&&(v+=m.get(t,n,h,e)*u)}}f.set(v,t,r,n,e)}return f.toTensor()}avgPoolBackprop(t,e,r){qZ([t,e],"avgPoolBackprop");const i=r.strideHeight,n=r.strideWidth,s=r.filterHeight,o=r.filterWidth,a=r.dilationHeight,h=r.dilationWidth,u=r.effectiveFilterHeight,l=r.effectiveFilterWidth,c=l-1-r.padInfo.left,d=u-1-r.padInfo.top,p=NV.N(e.shape,"float32"),f=1/(s*o),m=this.bufferSync(t);for(let t=0;t<r.batchSize;++t)for(let e=0;e<r.inChannels;++e)for(let s=0;s<r.inHeight;++s)for(let o=0;o<r.inWidth;++o){const g=s-d,y=o-c;let v=0;for(let s=0;s<u;s+=a){const o=(g+s)/i;if(!(o<0||o>=r.outHeight||Math.floor(o)!==o))for(let i=0;i<l;i+=h){const s=(y+i)/n;s<0||s>=r.outWidth||Math.floor(s)!==s||(v+=m.get(t,o,s,e))}}p.set(v*f,t,s,o,e)}return p.toTensor()}pool3d(t,e,r){qZ(t,"pool3d");const i=e.strideDepth,n=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,h=e.dilationWidth,u=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left,m="max"===r?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(t.dataId),y=NV.N(e.outShape,t.dtype),v=y.values,_=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],b=e.outShape[2]*e.outShape[3]*e.outShape[4],x=e.outShape[3]*e.outShape[4],T=e.outShape[4];for(let y=0;y<e.batchSize;++y){const E=y*_,w=y*t.strides[0];for(let y=0;y<e.inChannels;++y)for(let _=0;_<e.outDepth;++_){const S=_*i-d;let I=S;for(;I<0;)I+=o;const A=Math.min(e.inDepth,u+S),C=E+_*b;for(let i=0;i<e.outHeight;++i){const u=i*n-p;let d=u;for(;d<0;)d+=a;const _=Math.min(e.inHeight,l+u),b=C+i*x;for(let i=0;i<e.outWidth;++i){const n=i*s-f;let u=n;for(;u<0;)u+=h;const l=Math.min(e.inWidth,c+n),p=b+i*T;let x=m,E=0,S=0;for(let e=I;e<A;e+=o){const i=w+e*t.strides[1];for(let e=d;e<_;e+=a){const n=i+e*t.strides[2];for(let e=u;e<l;e+=h){const i=g[n+e*t.strides[3]+y];if("max"===r&&i>x?x=i:"avg"===r&&(E+=i,S++),isNaN(x))break}if(isNaN(x))break}if(isNaN(x))break}v[p+y]="avg"===r?E/S:x}}}}return y.toTensor()}avgPool3d(t,e){return qZ(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()}avgPool3dBackprop(t,e,r){qZ([t,e],"avgPool3dBackprop");const i=r.strideDepth,n=r.strideHeight,s=r.strideWidth,o=r.filterDepth,a=r.filterHeight,h=r.filterWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,f=r.effectiveFilterWidth,m=d-1-r.padInfo.front,g=f-1-r.padInfo.left,y=p-1-r.padInfo.top,v=NV.N(e.shape,"float32"),_=1/(o*a*h),b=this.bufferSync(t);for(let t=0;t<r.batchSize;++t)for(let e=0;e<r.inChannels;++e)for(let o=0;o<r.inDepth;++o)for(let a=0;a<r.inHeight;++a)for(let h=0;h<r.inWidth;++h){const x=o-m,T=a-y,E=h-g;let w=0;for(let o=0;o<d;o+=u){const a=(x+o)/i;if(!(a<0||a>=r.outDepth||Math.floor(a)!==a))for(let i=0;i<p;i+=l){const o=(T+i)/n;if(!(o<0||o>=r.outHeight||Math.floor(o)!==o))for(let i=0;i<f;i+=c){const n=(E+i)/s;n<0||n>=r.outWidth||Math.floor(n)!==n||(w+=b.get(t,a,o,n,e))}}}v.set(w*_,t,o,a,h,e)}return v.toTensor()}maxPool3d(t,e){return qZ(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()}maxPool3dPositions(t,e){const r=NV.N(e.outShape,"int32"),i=e.strideDepth,n=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,h=e.dilationWidth,u=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left,m=this.bufferSync(t);for(let t=0;t<e.batchSize;++t)for(let g=0;g<e.inChannels;++g)for(let y=0;y<e.outDepth;++y){const v=y*i-d;let _=v;for(;_<0;)_+=o;const b=Math.min(e.inDepth,u+v);for(let i=0;i<e.outHeight;++i){const u=i*n-p;let d=u;for(;d<0;)d+=a;const x=Math.min(e.inHeight,l+u);for(let n=0;n<e.outWidth;++n){const p=n*s-f;let T=p;for(;T<0;)T+=h;const E=Math.min(e.inWidth,c+p);let w=Number.NEGATIVE_INFINITY,S=-1;for(let e=_;e<b;e+=o){const r=e-v;for(let i=d;i<x;i+=a){const n=i-u;for(let s=T;s<E;s+=h){const o=s-p,a=m.get(t,e,i,s,g);a>=w&&(w=a,S=r*l*c+n*l+o)}}}r.set(S,t,y,i,n,g)}}}return r.toTensor()}maxPool3dBackprop(t,e,r,i){qZ([e,r],"maxPool3dBackprop");const n=this.maxPool3dPositions(e,i),s=i.strideDepth,o=i.strideHeight,a=i.strideWidth,h=i.dilationDepth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterDepth,d=i.effectiveFilterHeight,p=i.effectiveFilterWidth,f=c-1-i.padInfo.front,m=p-1-i.padInfo.left,g=d-1-i.padInfo.top,y=NV.N(e.shape,"float32"),v=this.bufferSync(n),_=this.bufferSync(t);for(let t=0;t<i.batchSize;++t)for(let e=0;e<i.inChannels;++e)for(let r=0;r<i.inDepth;++r)for(let n=0;n<i.inHeight;++n)for(let b=0;b<i.inWidth;++b){const x=r-f,T=n-g,E=b-m;let w=0;for(let r=0;r<c;r+=h){const n=(x+r)/s;if(!(n<0||n>=i.outDepth||Math.floor(n)!==n))for(let s=0;s<d;s+=u){const h=(T+s)/o;if(!(h<0||h>=i.outHeight||Math.floor(h)!==h))for(let o=0;o<p;o+=l){const u=(E+o)/a;if(u<0||u>=i.outWidth||Math.floor(u)!==u)continue;const l=c*d*p-1-v.get(t,n,h,u,e)===r*d*p+s*p+o?1:0;0!==l&&(w+=_.get(t,n,h,u,e)*l)}}}y.set(w,t,r,n,b,e)}return y.toTensor()}cast(t,e){return NV.F.castTensor(t,e,this)}reshape(t,e){return NV.F.reshapeTensor(t,e)}avgPool(t,e){return qZ(t,"avgPool"),qZ(t,"maxPool"),KZ(this.readSync(t.dataId),t.shape,t.dtype,t.strides,e,"avg").toTensor().toFloat()}resizeBilinear(t,e,r,i){qZ(t,"resizeBilinear");const[n,s,o,a]=t.shape,h=this.readSync(t.dataId),u=new Float32Array(NV.Cd.sizeFromShape([n,e,r,a])),l=[i&&e>1?s-1:s,i&&r>1?o-1:o],c=[i&&e>1?e-1:e,i&&r>1?r-1:r];let d=0;const p=l[0]/c[0],f=l[1]/c[1];for(let i=0;i<n;i++)for(let n=0;n<e;n++){const e=p*n,l=Math.floor(e),c=e-l,m=Math.min(s-1,Math.ceil(e)),g=i*t.strides[0]+l*t.strides[1],y=i*t.strides[0]+m*t.strides[1];for(let e=0;e<r;e++){const r=f*e,i=Math.floor(r),n=r-i,s=Math.min(o-1,Math.ceil(r)),l=g+i*t.strides[2],p=y+i*t.strides[2],m=g+s*t.strides[2],v=y+s*t.strides[2];for(let t=0;t<a;t++){const e=h[l+t],r=h[p+t],i=e+(h[m+t]-e)*n,s=i+(r+(h[v+t]-r)*n-i)*c;u[d++]=s}}}return NV.od(u,[n,e,r,a])}resizeBilinearBackprop(t,e,r){qZ([t,e],"resizeBilinearBackprop");const[i,n,s,o]=e.shape,[,a,h]=t.shape,u=new Float32Array(i*n*s*o),l=[r&&a>1?n-1:n,r&&h>1?s-1:s],c=[r&&a>1?a-1:a,r&&h>1?h-1:h],d=l[0]/c[0],p=l[1]/c[1],f=this.readSync(t.dataId);let m=0;for(let t=0;t<i;t++){const r=t*e.strides[0];for(let t=0;t<a;t++){const i=t*d,a=Math.floor(i),l=Math.min(Math.ceil(i),n-1),c=r+a*e.strides[1],g=r+l*e.strides[1],y=i-a,v=1-y;for(let t=0;t<h;t++){const r=t*p,i=Math.floor(r),n=Math.min(Math.ceil(r),s-1),a=r-i,h=1-a,l=c+i*e.strides[2],d=c+n*e.strides[2],_=g+i*e.strides[2],b=g+n*e.strides[2],x=v*h,T=v*a,E=y*h,w=y*a;for(let t=0;t<o;t++){const e=f[m++];u[l+t]+=e*x,u[d+t]+=e*T,u[_+t]+=e*E,u[b+t]+=e*w}}}}return NV.sd(u,[i,s,n,o],e.dtype)}resizeNearestNeighbor(t,e,r,i){qZ(t,"resizeNearestNeighbor");const[n,s,o,a]=t.shape,h=this.readSync(t.dataId),u=new Float32Array(n*e*r*a),l=[i&&e>1?s-1:s,i&&r>1?o-1:o],c=[i&&e>1?e-1:e,i&&r>1?r-1:r],d=l[0]/c[0],p=l[1]/c[1];let f=0;for(let l=0;l<n;l++){const n=l*t.strides[0];for(let l=0;l<e;l++){const e=d*l,c=n+Math.min(s-1,i?Math.round(e):Math.floor(e))*t.strides[1];for(let e=0;e<r;e++){const r=p*e,n=c+Math.min(o-1,i?Math.round(r):Math.floor(r))*t.strides[2];for(let t=0;t<a;t++){const e=h[n+t];u[f++]=e}}}}return NV.od(u,[n,e,r,a],t.dtype)}resizeNearestNeighborBackprop(t,e,r){qZ([t,e],"resizeNearestNeighborBackprop");const[i,n,s,o]=e.shape,[,a,h]=t.shape,u=new Float32Array(i*n*s*o),l=this.readSync(t.dataId),c=[r&&a>1?n-1:n,r&&h>1?s-1:s],d=[r&&a>1?a-1:a,r&&h>1?h-1:h],p=c[0]/d[0],f=c[1]/d[1],m=1/p,g=1/f,y=2*Math.ceil(m)+2,v=2*Math.ceil(g)+2;for(let c=0;c<i;c++){const i=c*e.strides[0];for(let c=0;c<n;c++){const d=i+c*e.strides[1],_=Math.floor(c*m),b=Math.floor(_-y/2);for(let m=0;m<s;m++){const _=d+m*e.strides[2],x=Math.floor(m*g),T=Math.floor(x-v/2);for(let e=0;e<o;e++){let o=0;for(let u=0;u<y;u++){const d=u+b;if(d<0||d>=a)continue;const g=i+d*t.strides[1],y=d*p;if(c===Math.min(n-1,r?Math.round(y):Math.floor(y)))for(let i=0;i<v;i++){const n=i+T;if(n<0||n>=h)continue;const a=g+n*t.strides[2],u=n*f;m===Math.min(s-1,r?Math.round(u):Math.floor(u))&&(o+=l[a+e])}}u[_+e]=o}}}}return NV.sd(u,e.shape,e.dtype)}batchNorm(t,e,r,i,n,s){qZ([t,e,r,n,i],"batchNorm");const o=this.readSync(t.dataId),a=this.readSync(e.dataId),h=this.readSync(r.dataId),u=n?this.readSync(n.dataId):new Float32Array([1]),l=i?this.readSync(i.dataId):new Float32Array([0]),c=new Float32Array(o.length),d=l.length,p=u.length,f=h.length,m=a.length;let g=0,y=0,v=0,_=0;for(let t=0;t<o.length;++t)c[t]=l[g++]+(o[t]-a[y++])*u[v++]/Math.sqrt(h[_++]+s),g>=d&&(g=0),y>=m&&(y=0),v>=p&&(v=0),_>=f&&(_=0);return NV.sd(c,t.shape)}localResponseNormalization4D(t,e,r,i,n){qZ(t,"localResponseNormalization4D");const s=t.shape[3],o=s-1,a=this.readSync(t.dataId),h=t.size,u=new Float32Array(h);function l(t){const r=t%s;let i=t-r+Math.max(0,r-e);const n=t-r+Math.min(r+e,o);let h=0;for(;i<=n;i++){const t=a[i];h+=t*t}return h}for(let t=0;t<h;t++){const e=l(t),s=a[t]*Math.pow(r+i*e,-n);u[t]=s}return NV.sd(u,t.shape)}LRNGrad(t,e,r,i,n,s,o){qZ(t,"LRNGrad");const a=t.shape[3],h=this.readSync(t.dataId),u=this.readSync(e.dataId),l=this.readSync(r.dataId),c=new Float32Array(t.size),d=t.size;for(let t=0;t<d;t++){const e=t%a,r=t-e+Math.max(0,e-i),d=t-e+Math.min(a,e+i+1);let p=0;for(let t=r;t<d;t++)p+=Math.pow(u[t],2);p=s*p+n;for(let e=r;e<d;e++){let r=-2*s*o*u[e]*l[t]/p;t===e&&(r+=Math.pow(p,-o)),r*=h[t],c[e]+=r}}return NV.sd(c,t.shape)}multinomial(t,e,r,i){qZ(t,"multinomial");const n=e?t:NV.Yc(t),s=n.shape[0],o=n.shape[1],a=NV.Id([s,r],"int32"),h=this.readSync(a.dataId),u=this.readSync(n.dataId);for(let t=0;t<s;++t){const e=t*o,n=new Float32Array(o-1);n[0]=u[e];for(let t=1;t<n.length;++t)n[t]=n[t-1]+u[e+t];const s=yZ.alea(i.toString()),a=t*r;for(let t=0;t<r;++t){const e=s();h[a+t]=n.length;for(let r=0;r<n.length;r++)if(e<n[r]){h[a+t]=r;break}}}return a}oneHot(t,e,r,i){qZ(t,"oneHot");const n=new Float32Array(t.size*e);n.fill(i);const s=this.readSync(t.dataId);for(let i=0;i<t.size;++i)s[i]>=0&&s[i]<e&&(n[i*e+s[i]]=r);return NV.qd(n,[t.size,e],"int32")}nonMaxSuppression(t,e,r,i,n){qZ(t,"nonMaxSuppression");const s=this.readSync(t.dataId),o=this.readSync(e.dataId);return JZ(s,o,r,i,n)}fft(t){return this.fftBatch(t,!1)}ifft(t){return this.fftBatch(t,!0)}fftBatch(t,e){const r=t.shape[0],i=t.shape[1],n=NV.N(t.shape,"float32"),s=NV.N(t.shape,"float32"),o=NV.xc(t).as2D(r,i),a=NV.Eb(t).as2D(r,i);for(let t=0;t<r;t++){const r=o.slice([t,0],[1,i]),h=a.slice([t,0],[1,i]),u=NV.R(r,h),l=this.readSync(this.fftImpl(u,e).dataId);for(let e=0;e<i;e++){const r=NV.F.getComplexWithIndex(l,e);n.values[t*i+e]=r.real,s.values[t*i+e]=r.imag}}return NV.R(n.toTensor(),s.toTensor()).as2D(r,i)}fftImpl(t,e){const r=t.as1D(),i=r.size;if(this.isExponentOf2(i)){let n=this.fftRadix2(r,i,e).as2D(t.shape[0],t.shape[1]);return e&&(n=NV.R(NV.xc(n).div(NV.Hc(i)),NV.Eb(n).div(NV.Hc(i)))),n}{const r=this.readSync(t.dataId),n=this.fourierTransformByMatmul(r,i,e),s=NV.F.splitRealAndImagArrays(n);return NV.R(s.real,s.imag).as2D(t.shape[0],t.shape[1])}}isExponentOf2(t){return 0==(t&t-1)}fftRadix2(t,e,r){if(1===e)return t;const i=this.readSync(t.dataId),n=e/2,s=NV.F.complexWithEvenIndex(i);let o=NV.R(s.real,s.imag).as1D();const a=NV.F.complexWithOddIndex(i);let h=NV.R(a.real,a.imag).as1D();o=this.fftRadix2(o,n,r),h=this.fftRadix2(h,n,r);const u=NV.F.exponents(e,r),l=NV.R(u.real,u.imag).mul(h),c=o.add(l),d=o.sub(l),p=NV.xc(c).concat(NV.xc(d)),f=NV.Eb(c).concat(NV.Eb(d));return NV.R(p,f).as1D()}fourierTransformByMatmul(t,e,r){const i=new Float32Array(2*e);for(let n=0;n<e;n++){let s=0,o=0;for(let i=0;i<e;i++){const a=NV.F.exponent(n*i,e,r),h=NV.F.getComplexWithIndex(t,i);s+=h.real*a.real-h.imag*a.imag,o+=h.real*a.imag+h.imag*a.real}r&&(s/=e,o/=e),NV.F.assignToTypedArray(i,s,o,n)}return i}depthToSpace(t,e,r){NV.Cd.assert("NHWC"===r,()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${r}`),NV.Cd.assert(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`);const i=t.shape[0],n=t.shape[1],s=t.shape[2],o=t.shape[3],a=n*e,h=s*e,u=o/(e*e),l=this.readSync(t.dataId),c=new Float32Array(i*a*h*u);let d=0;for(let t=0;t<i;++t)for(let r=0;r<a;++r){const i=Math.floor(r/e),a=r%e;for(let r=0;r<h;++r){const h=Math.floor(r/e),p=(a*e+r%e)*u;for(let e=0;e<u;++e){const r=e+p+o*(h+s*(i+n*t));c[d++]=l[r]}}}return NV.sd(c,[i,a,h,u])}broadcastedBinaryOp(t,e,r,i){const n=NV.F.assertAndGetBroadcastShape(t.shape,e.shape),s=NV.N(n,r),o=this.readSync(t.dataId),a=this.readSync(e.dataId),h=NV.F.getBroadcastDims(t.shape,n),u=NV.F.getBroadcastDims(e.shape,n),l=s.values;if(h.length+u.length===0)for(let t=0;t<l.length;++t)l[t]=i(o[t%o.length],a[t%a.length]);else{const r=this.bufferSync(t),n=this.bufferSync(e);for(let c=0;c<l.length;++c){const d=s.indexToLoc(c),p=d.slice(-t.rank);h.forEach(t=>p[t]=0);const f=r.locToIndex(p),m=d.slice(-e.rank);u.forEach(t=>m[t]=0);const g=n.locToIndex(m);l[c]=i(o[f],a[g])}}return s.toTensor()}broadcastedBinaryComplexOp(t,e,r){const i=NV.F.assertAndGetBroadcastShape(t.shape,e.shape),n=NV.N(i,"float32"),s=NV.N(i,"float32"),o=this.readSync(t.dataId),a=this.readSync(e.dataId),h=NV.F.getBroadcastDims(t.shape,i),u=NV.F.getBroadcastDims(e.shape,i),l=n.values,c=s.values;if(h.length+u.length===0)for(let t=0;t<l.length;t++){const e=t%o.length,i=t%a.length,n=r(o[2*e],o[2*e+1],a[2*i],a[2*i+1]);l[t]=n.real,c[t]=n.imag}else{const i=this.bufferSync(this.data.get(t.dataId).complexTensors.real),s=this.bufferSync(this.data.get(e.dataId).complexTensors.real);for(let d=0;d<l.length;d++){const p=n.indexToLoc(d),f=p.slice(-t.rank);h.forEach(t=>f[t]=0);const m=i.locToIndex(f),g=p.slice(-e.rank);u.forEach(t=>g[t]=0);const y=s.locToIndex(g),v=r(o[2*m],o[2*m+1],a[2*y],a[2*y+1]);l[d]=v.real,c[d]=v.imag}}return this.complex(n.toTensor(),s.toTensor())}split(t,e,r){return QZ(t,e,r)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}cropAndResize(t,e,r,i,n,s){const[o,a,h,u]=t.shape,l=e.shape[0],[c,d]=i,p=NV.N([l,c,d,u],"float32"),f=this.readSync(e.dataId),m=this.readSync(r.dataId),g=this.readSync(t.dataId),y=t.strides,v=p.strides;for(let t=0;t<l;t++){const e=4*t,r=f[e],i=f[e+1],l=f[e+2],_=f[e+3],b=m[t];if(b>=o)continue;const x=c>1?(l-r)*(a-1)/(c-1):0,T=d>1?(_-i)*(h-1)/(d-1):0;for(let e=0;e<c;e++){const o=c>1?r*(a-1)+e*x:.5*(r+l)*(a-1);if(o<0||o>a-1)for(let r=0;r<d;r++)for(let i=0;i<u;i++){const n=i+r*v[2]+e*v[1]+t*v[0];p.values[n]=s}else if("bilinear"===n){const r=Math.floor(o),n=Math.ceil(o),a=o-r;for(let o=0;o<d;o++){const l=d>1?i*(h-1)+o*T:.5*(i+_)*(h-1);if(l<0||l>h-1){for(let r=0;r<u;r++){const i=r+o*v[2]+e*v[1]+t*v[0];p.values[i]=s}continue}const c=Math.floor(l),f=Math.ceil(l),m=l-c;for(let i=0;i<u;i++){let s=i+c*y[2]+r*y[1]+b*y[0];const h=g[s];s=i+f*y[2]+r*y[1]+b*y[0];const u=g[s];s=i+c*y[2]+n*y[1]+b*y[0];const l=g[s];s=i+f*y[2]+n*y[1]+b*y[0];const d=h+(u-h)*m,_=l+(g[s]-l)*m;s=i+o*v[2]+e*v[1]+t*v[0],p.values[s]=d+(_-d)*a}}}else for(let r=0;r<d;++r){const n=d>1?i*(h-1)+r*T:.5*(i+_)*(h-1);if(n<0||n>h-1){for(let i=0;i<u;i++){const n=i+r*v[2]+e*v[1]+t*v[0];p.values[n]=s}continue}const a=Math.round(n),l=Math.round(o);for(let i=0;i<u;i++){const n=i+a*y[2]+l*y[1]+b*y[0],s=i+r*v[2]+e*v[1]+t*v[0];p.values[s]=g[n]}}}}return p.toTensor()}sparseToDense(t,e,r,i){const{sliceRank:n,numUpdates:s,sliceSize:o,strides:a,outputSize:h}=NV.F.calculateShapes(e,t,r);return this.scatter(t,e,r,h,o,s,n,a,i,!1)}gatherND(t,e){const r=e.shape,i=r[r.length-1],[n,s,o,a]=NV.F.prepareAndValidate(t,e);if(0===s)return NV.od([],n,t.dtype);const h=new NV.m([s,o],t.dtype),u=this.readSync(e.dataId),l=this.readSync(t.dataId);for(let e=0;e<s;e++){const r=[];let n=0;for(let t=0;t<i;t++){const s=u[e*i+t];n+=s*a[t],r.push(s)}if(n<0||n>=t.size/o)throw new Error(`Invalid indices: ${r} does not index into ${t.shape}`);for(let t=0;t<o;t++)h.values[e*o+t]=l[n*o+t]}return h.toTensor().reshape(n)}scatterND(t,e,r){const{sliceRank:i,numUpdates:n,sliceSize:s,strides:o,outputSize:a}=NV.F.calculateShapes(e,t,r),h=NV.Hc(0);return this.scatter(t,e,r,a,s,n,i,o,h,!0)}fill(t,e,r){r=r||NV.Cd.inferDtype(e);const i=NV.Cd.getArrayFromDType(r,NV.Cd.sizeFromShape(t));return i.fill(e),Object(NV.mb)().makeTensor(i,t,r,this)}onesLike(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)}zerosLike(t){const e=NV.Cd.getArrayFromDType(t.dtype,NV.Cd.sizeFromShape(t.shape));return this.makeOutput(e,t.shape,t.dtype)}linspace(t,e,r){return NV.F.linspaceImpl(t,e,r)}scatter(t,e,r,i,n,s,o,a,h,u){const l=[i/n,n],c=this.readSync(t.dataId),d=this.readSync(e.dataId);if(0===i)return NV.od([],r,e.dtype);const p=new NV.m(l,e.dtype);p.values.fill(this.readSync(h.dataId)[0]);for(let t=0;t<s;t++){const s=[];let h=0;for(let e=0;e<o;e++){const r=c[t*o+e];s.push(r),h+=r*a[e]}if(h<0||h>=i/n)throw new Error(`Invalid indices: ${s} does not index into ${r}`);for(let r=0;r<n;r++)u?p.values[h*n+r]+=d[t*n+r]:p.values[h*n+r]=0===e.rank?d[0]:d[t*n+r]}return p.toTensor().reshape(r)}}
/** @license See the LICENSE file. */
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function sJ(t,e){return{kernelName:t,backendName:"cpu",kernelFunc:({inputs:r,backend:i})=>{const{a:n,b:s}=r,o=i;qZ([n,s],t);const a=o.data.get(n.dataId).values,h=o.data.get(s.dataId).values,[u,l]=e(n.shape,s.shape,a,h,n.dtype);return{dataId:o.write(u,l,n.dtype),shape:l,dtype:n.dtype}}}}function oJ(t){return(e,r,i,n,s)=>{const o=NV.F.assertAndGetBroadcastShape(e,r),a=o.length,h=NV.Cd.computeStrides(o),u=NV.Cd.sizeFromShape(o),l=NV.Cd.getTypedArrayFromDType(s,u),c=e.length,d=r.length,p=NV.Cd.computeStrides(e),f=NV.Cd.computeStrides(r),m=NV.F.getBroadcastDims(e,o),g=NV.F.getBroadcastDims(r,o);if(m.length+g.length===0)for(let e=0;e<l.length;++e)l[e]=t(i[e%i.length],n[e%n.length]);else for(let e=0;e<l.length;++e){const r=NV.Cd.indexToLoc(e,a,h),s=r.slice(-c);m.forEach(t=>s[t]=0);const o=NV.Cd.locToIndex(s,c,p),u=r.slice(-d);g.forEach(t=>u[t]=0);const y=NV.Cd.locToIndex(u,d,f);l[e]=t(i[o],n[y])}return[l,o]}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJ=oJ((t,e)=>t/e),hJ=sJ(NV.b,aJ),uJ={kernelName:NV.e,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:r})=>{const{x:i}=t,{reductionIndices:n}=e,s=r;let o=i.shape;const a=o.length;let h=NV.Cd.parseAxisParam(n,o);const u=NV.F.getAxesPermutation(h,a);let l=s.data.get(i.dataId).values;if(null!=u){const t=new Array(a);for(let e=0;e<t.length;e++)t[e]=o[u[e]];l=YZ(l,o,i.dtype,u,t),h=NV.F.getInnerMostAxes(h.length,a),o=t}qZ(i,"max"),NV.F.assertAxesAreInnerMostDims("max",h,a);const[c,d]=NV.F.computeOutAndReduceShapes(o,h),p=WZ(l,NV.Cd.sizeFromShape(d),c,i.dtype);return{dataId:s.write(p,c,i.dtype),shape:c,dtype:i.dtype}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const lJ={kernelName:NV.f,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:r})=>{const{x:i}=t,{filterSize:n,strides:s,pad:o,includeBatchInIndex:a}=e,h=r;qZ(i,"MaxPoolWithArgmax");const u=h.data.get(i.dataId).values,l=NV.F.computePool2DInfo(i.shape,n,s,[1,1],o),[c,d]=
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r,i,n){const s=KZ(t,0,r,NV.Cd.computeStrides(e),n,"max"),o=ZZ(t,e,r,n,!0,i);return[s.values,o.values]}(u,i.shape,i.dtype,a,l),p=h.write(c,l.outShape,i.dtype),f=h.write(d,l.outShape,i.dtype);return[{dataId:p,shape:l.outShape,dtype:i.dtype},{dataId:f,shape:l.outShape,dtype:"int32"}]}},cJ=NV.Jb.nonMaxSuppressionV5,dJ={kernelName:NV.h,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:r})=>{const{boxes:i,scores:n}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:a,softNmsSigma:h}=r,u=e;qZ(i,"NonMaxSuppressionWithScore");const l=u.data.get(i.dataId).values,c=u.data.get(n.dataId).values,d=s,p=o,f=a,m=h,{selectedIndices:g,selectedScores:y}=cJ(l,c,d,p,f,m);return[g,y]}},pJ={kernelName:NV.j,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:r}=t,i=e;qZ(r,"square");const n=i.data.get(r.dataId).values,s=new Float32Array(n.length);for(let t=0;t<n.length;++t){const e=n[t];s[t]=e*e}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},fJ=oJ((t,e)=>{const r=t-e;return r*r}),mJ=[dJ,pJ,sJ(NV.k,fJ),hJ,{kernelName:NV.n,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:r})=>{const{x:i}=t,{perm:n}=e,s=r;qZ(i,"transpose");const o=i.shape.length,a=new Array(o);for(let t=0;t<a.length;t++)a[t]=i.shape[n[t]];const h=YZ(s.data.get(i.dataId).values,i.shape,i.dtype,n,a);return{dataId:s.write(h,a,i.dtype),shape:a,dtype:i.dtype}}},lJ,uJ];
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */for(const t of mJ)Object(NV.Ac)(t);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object(NV.zc)("cpu",()=>new nJ,1);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const gJ={},yJ={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function vJ(t){t in gJ||(gJ[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);if(e.addEventListener("webglcontextlost",e=>{e.preventDefault(),delete gJ[t]},!1),1===t)return e.getContext("webgl",yJ)||e.getContext("experimental-webgl",yJ);return e.getContext("webgl2",yJ)}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t));const e=gJ[t];return e.isContextLost()?(delete gJ[t],vJ(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),gJ[t])}var _J,bJ,xJ;function TJ(t,e){return[e,t]}function EJ(t){const e=NV.Cd.sizeFromShape(t),r=Math.ceil(e/4);return NV.Cd.sizeToSquarishShape(r)}function wJ(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function SJ(t,e){const r=t;let i,n,s,o,a,h,u,l,c,d;return 2===Object(NV.nb)().getNumber("WEBGL_VERSION")?(i=r.R32F,n=r.R16F,s=r.RGBA16F,o=r.RGBA32F,a=r.RED,u=4,l=1,c=r.HALF_FLOAT,d=r.FLOAT):(i=t.RGBA,n=t.RGBA,s=t.RGBA,o=r.RGBA,a=t.RGBA,u=4,l=4,c=null!=e?e.HALF_FLOAT_OES:null,d=t.FLOAT),h=t.RGBA,{internalFormatFloat:i,internalFormatHalfFloat:n,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:h,downloadUnpackNumChannels:u,defaultNumChannels:l,textureTypeHalfFloat:c,textureTypeFloat:d}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(t,e,r){const i=r();return e&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}(t,e))}(t),i}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(_J||(_J={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(bJ||(bJ={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(xJ||(xJ={}));function AJ(t){return!!(Object(NV.nb)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function CJ(t,e,r){return kJ(t,e,()=>t.getExtension(r),'Extension "'+r+'" not supported on this browser.')}function OJ(t,e,r){const i=kJ(t,e,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(IJ(t,e,()=>t.shaderSource(i,r)),IJ(t,e,()=>t.compileShader(i)),!1===t.getShaderParameter(i,t.COMPILE_STATUS))throw function(t,e){const r=RJ.exec(e);if(null==r)return console.log(`Couldn't parse line number in error: ${e}`),void console.log(t);const i=+r[1],n=t.split("\n"),s=n.length.toString().length+2,o=n.map((t,e)=>NV.Cd.rightPad((e+1).toString(),s)+t);let a=0;for(let t=0;t<o.length;t++)a=Math.max(o[t].length,a);const h=o.slice(0,i-1),u=o.slice(i-1,i),l=o.slice(i);console.log(h.join("\n")),console.log(e.split("\n")[0]),console.log(`%c ${NV.Cd.rightPad(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(l.join("\n"))}(r,t.getShaderInfoLog(i)),new Error("Failed to compile fragment shader.");return i}const RJ=/ERROR: [0-9]+:([0-9]+):/g;function NJ(t,e,r){if(IJ(t,e,()=>t.validateProgram(r)),!1===t.getProgramParameter(r,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(r)),new Error("Shader program validation failed.")}function PJ(t,e,r,i,n,s,o,a){const h=t.getAttribLocation(r,i);return-1!==h&&(IJ(t,e,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),IJ(t,e,()=>t.vertexAttribPointer(h,s,t.FLOAT,!1,o,a)),IJ(t,e,()=>t.enableVertexAttribArray(h)),!0)}function MJ(t,e,r,i,n,s){IJ(t,e,()=>function(t,e,r,i){UJ(t,i),IJ(t,e,()=>t.activeTexture(t.TEXTURE0+i)),IJ(t,e,()=>t.bindTexture(t.TEXTURE_2D,r))}(t,e,i,s)),IJ(t,e,()=>t.uniform1i(n,s))}function DJ(t,e,r,i){IJ(t,e,()=>t.bindFramebuffer(t.FRAMEBUFFER,i)),IJ(t,e,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0))}function FJ(t,e,r){IJ(t,e,()=>t.bindFramebuffer(t.FRAMEBUFFER,r)),IJ(t,e,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function LJ(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}(t,e))}function kJ(t,e,r,i){const n=IJ(t,e,()=>r());if(null==n)throw new Error(i);return n}function UJ(t,e){const r=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,i=e+t.TEXTURE0;if(i<t.TEXTURE0||i>r){throw new Error(`textureUnit must be in ${`[gl.TEXTURE0, gl.TEXTURE${r}]`}.`)}}function BJ(t,e=2){return NV.Cd.sizeFromShape(t.slice(0,t.length-e))}function jJ(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function XJ(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[BJ(t),...jJ(t)]),e}function GJ(t){return t%2==0}function zJ(t,e){if(t=t.slice(-2),e=e.slice(-2),NV.Cd.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const r=t.slice(-1)[0],i=e.slice(-1)[0];if(r===i)return!0;if(GJ(r)&&GJ(i)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&GJ(t[0])&&GJ(e[0])}let VJ,HJ;function $J(t,e){return null!=t.getExtension(e)}function WJ(t){try{if(null!=vJ(t))return!0}catch(t){return!1}return!1}function YJ(t){if(0===t)return!1;const e=vJ(t);if(1!==t){if($J(e,"EXT_color_buffer_float"))return qJ(e);const t="EXT_color_buffer_half_float";if($J(e,t)){const r=e.getExtension(t);return function(t,e){const r=SJ(t,e),i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);t.texImage2D(t.TEXTURE_2D,0,r.internalFormatHalfFloat,1,1,0,r.textureFormatFloat,r.textureTypeHalfFloat,null);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(i),t.deleteFramebuffer(n),s}(e,r)}return!1}return!!$J(e,"OES_texture_float")&&(!!$J(e,"WEBGL_color_buffer_float")&&qJ(e))}function qJ(t){const e=SJ(t),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const n=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),n}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const KJ=Object(NV.nb)();KJ.registerFlag("HAS_WEBGL",()=>KJ.getNumber("WEBGL_VERSION")>0),KJ.registerFlag("WEBGL_VERSION",()=>WJ(2)?2:WJ(1)?1:0),KJ.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===KJ.get("WEBGL_VERSION")),KJ.registerFlag("WEBGL_CPU_FORWARD",()=>!0),KJ.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),KJ.registerFlag("WEBGL_PACK",()=>KJ.getBool("HAS_WEBGL")),KJ.registerFlag("WEBGL_PACK_NORMALIZATION",()=>KJ.getBool("WEBGL_PACK")),KJ.registerFlag("WEBGL_PACK_CLIP",()=>KJ.getBool("WEBGL_PACK")),KJ.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>!1),KJ.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>KJ.getBool("WEBGL_PACK")),KJ.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>KJ.getBool("WEBGL_PACK")),KJ.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>KJ.getBool("WEBGL_PACK")),KJ.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>KJ.getBool("WEBGL_PACK")),KJ.registerFlag("WEBGL_PACK_REDUCE",()=>KJ.getBool("WEBGL_PACK")),KJ.registerFlag("WEBGL_LAZILY_UNPACK",()=>KJ.getBool("WEBGL_PACK")),KJ.registerFlag("WEBGL_CONV_IM2COL",()=>KJ.getBool("WEBGL_PACK")),KJ.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function(t){if(null==VJ){const e=vJ(t);VJ=e.getParameter(e.MAX_TEXTURE_SIZE)}return VJ}(KJ.getNumber("WEBGL_VERSION"))),KJ.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function(t){if(null==HJ){const e=vJ(t);HJ=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,HJ)}(KJ.getNumber("WEBGL_VERSION"))),KJ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=KJ.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;let e;const r=vJ(t);return e=$J(r,"EXT_disjoint_timer_query_webgl2")&&2===t?2:$J(r,"EXT_disjoint_timer_query")?1:0,e}(t)}),KJ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>KJ.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!NV.gb.isMobile()),KJ.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function(t){if(0===t)return!1;const e=vJ(t);if(1===t){if(!$J(e,"OES_texture_float"))return!1}else if(!$J(e,"EXT_color_buffer_float"))return!1;return qJ(e)}(KJ.getNumber("WEBGL_VERSION"))),KJ.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!KJ.getBool("WEBGL_FORCE_F16_TEXTURES")&&KJ.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),KJ.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>YJ(KJ.getNumber("WEBGL_VERSION"))),KJ.registerFlag("WEBGL_FENCE_API_ENABLED",()=>{return 2===(t=KJ.getNumber("WEBGL_VERSION"))&&null!=vJ(t).fenceSync;var t}),KJ.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>KJ.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ZJ{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((t,e)=>`T${e}`);const r=[];this.variableNames.forEach(t=>{r.push(`float v${t} = get${t}AtOutCoords();`)});const i=this.variableNames.map(t=>`v${t}`).join(" + ");this.userCode=`\n      void main() {\n        ${r.join("\n        ")}\n\n        float result = ${i};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JJ{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((t,e)=>`T${e}`);const r=[];this.variableNames.forEach(t=>{r.push(`vec4 v${t} = get${t}AtOutCoords();`)});const i=this.variableNames.map(t=>`v${t}`).join(" + ");this.userCode=`\n      void main() {\n        ${r.join("\n        ")}\n\n        vec4 result = ${i};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QJ{constructor(t,e,r){this.variableNames=["A"];const i=t.windowSize,n=t.batchSize,s=t.inSize,o=Math.ceil(s/i);r||this.variableNames.push("bestIndicesA"),this.outputShape=[n,o];const a="max"===e?">":"<",h=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${i};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${i}; i++) {\n          int inIdx = ${h};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${a} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tQ(t,e){return["x","y","z","w","u","v"].slice(0,e).map(e=>`${t}.${e}`)}function eQ(t,e){return 1===e?[t]:tQ(t,e)}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function rQ(){let t,e,r,i,n,s,o,a,h,u;return 2===Object(NV.nb)().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",r="out",i="in",n="texture",s="outputColor",o="out vec4 outputColor;",a="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",h="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",r="varying",i="varying",n="texture2D",s="gl_FragColor",o="",a="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",h="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:r,varyingFs:i,texture2D:n,output:s,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:h,defineRound:u}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iQ(t,e,r="index"){const i=NV.Cd.computeStrides(e);return i.map((e,n)=>`${`int ${t[n]} = ${r} / ${e}`}; ${n===i.length-1?`int ${t[n+1]} = ${r} - ${t[n]} * ${e}`:`index -= ${t[n]} * ${e}`};`).join("")}function nQ(t){const e=NV.Cd.computeStrides(t).map(t=>t.toString());return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;\n  }\n`}const sQ="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:oQ}=NV.F;
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(t,e,r,i){const n=[];t.forEach(t=>{const e=NV.Cd.sizeFromShape(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?n.push(`uniform float ${t.name}${e>1?`[${e}]`:""};`):(n.push(`uniform sampler2D ${t.name};`),n.push(`uniform int offset${t.name};`))});const s=n.join("\n"),o=t.map(t=>function(t,e,r=!1){let i="";i+=r?uQ(t):hQ(t);const n=t.shapeInfo.logicalShape,s=e.logicalShape;n.length<=s.length&&(i+=r?function(t,e){const r=t.name,i=r.charAt(0).toUpperCase()+r.slice(1),n="get"+i+"AtOutCoords",s=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=oQ(t.shapeInfo.logicalShape,e.logicalShape),h=yQ(o),u=o-s;let l;const c=["x","y","z","w","u","v"];l=0===s?"":o<2&&a.length>=1?"coords = 0;":a.map(t=>`coords.${c[t+u]} = 0;`).join("\n");let d="";d=o<2&&s>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>`coords.${c[e+u]}`).join(", ");let p="return outputValue;";const f=1===NV.Cd.sizeFromShape(t.shapeInfo.logicalShape),m=1===NV.Cd.sizeFromShape(e.logicalShape);if(1!==s||f||m){if(f&&!m)p=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(a.length){const t=s-2,e=s-1;a.indexOf(t)>-1&&a.indexOf(e)>-1?p="return vec4(outputValue.x);":a.indexOf(t)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(e)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${n}() {\n      ${h} coords = getOutputCoords();\n      ${l}\n      vec4 outputValue = get${i}(${d});\n      ${p}\n    }\n  `}(t,e):function(t,e){const r=t.name,i=r.charAt(0).toUpperCase()+r.slice(1),n="get"+i+"AtOutCoords",s=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,h=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===h&&null==t.shapeInfo.flatOffset&&NV.Cd.arraysEqual(o,s))return`\n      float ${n}() {\n        return sampleTexture(${r}, resultUV);\n      }\n    `;const u=yQ(h),l=oQ(t.shapeInfo.logicalShape,e.logicalShape),c=h-a;let d;const p=["x","y","z","w","u","v"];d=0===a?"":h<2&&l.length>=1?"coords = 0;":l.map(t=>`coords.${p[t+c]} = 0;`).join("\n");let f="";f=h<2&&a>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>`coords.${p[e+c]}`).join(", ");return`\n    float ${n}() {\n      ${u} coords = getOutputCoords();\n      ${d}\n      return get${i}(${f});\n    }\n  `}(t,e));return i}(t,e,i)).join("\n"),a=e.texShape,h=rQ(),u=function(t){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${t.texture2D}(textureSampler, uv).r;\n    }\n  `}(h);let l,c,d=function(t){return`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFs} vec2 resultUV;\n    ${t.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${t.defineSpecialNaN}\n    ${t.defineSpecialInf}\n    ${t.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${lQ}\n    ${cQ}\n    ${dQ}\n  `}(h);return e.isPacked?(l=function(t,e){switch(t.length){case 0:return fQ();case 1:return function(t,e){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(1===r[0])return`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `;if(1===r[1])return`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `;return`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}(0,e);case 2:return function(t,e){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(NV.Cd.arraysEqual(t,e))return`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;const i=Math.ceil(t[1]/2);return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),n=i*Math.ceil(t[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${n};\n      index -= b * ${n};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(t,e);default:return function(t,e){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),n=i*Math.ceil(t[t.length-2]/2);let s=n,o="",a="b, r, c";for(let e=2;e<t.length-1;e++)s*=t[t.length-e-1],o=`\n      int b${e} = index / ${s};\n      index -= b${e} * ${s};\n    `+o,a=`b${e}, `+a;return`\n    ivec${t.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${o}\n\n      int b = index / ${n};\n      index -= b * ${n};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec${t.length}(${a});\n    }\n  `}(t,e)}}(e.logicalShape,a),c=function(t){return`\n    void setOutput(vec4 val) {\n      ${t.output} = val;\n    }\n  `}(h)):(l=function(t,e){switch(t.length){case 0:return fQ();case 1:return function(t,e){if(1===e[0])return`\n      int getOutputCoords() {\n        return int(resultUV.x * ${e[1]}.0);\n      }\n    `;if(1===e[1])return`\n      int getOutputCoords() {\n        return int(resultUV.y * ${e[0]}.0);\n      }\n    `;return`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      return resTexRC.x * ${e[1]} + resTexRC.y;\n    }\n  `}(0,e);case 2:return function(t,e){if(NV.Cd.arraysEqual(t,e))return`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));\n      }\n    `;if(1===t[1])return`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `;if(1===t[0])return`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `;return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      int r = index / ${t[1]};\n      int c = index - r * ${t[1]};\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const r=iQ(["r","c","d"],t);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}(t,e);case 4:return function(t,e){const r=iQ(["r","c","d","d2"],t);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}(t,e);case 5:return function(t,e){const r=iQ(["r","c","d","d2","d3"],t);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},\n                             ${e[1]}));\n\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${r}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(t,e);case 6:return function(t,e){const r=iQ(["r","c","d","d2","d3","d4"],t);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${r}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}(e.logicalShape,a),c=function(t){return`\n    void setOutput(float val) {\n      ${t.output} = vec4(val, 0, 0, 0);\n    }\n  `}(h)),i&&(d+=pQ),[d,u,c,s,l,o,r].join("\n")}function hQ(t){const e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){const e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${e};}`;const[i,n]=t.shapeInfo.texShape;if(1===i&&1===n)return`\n      float ${r}() {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const[s,o]=t.shapeInfo.texShape,a=mQ(e);return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${s}, ${o}, ${a});\n      return sampleTexture(${e}, uv);\n    }\n  `}(t);case 1:return function(t){const e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${gQ(t)}\n      }\n    `;const i=t.shapeInfo.texShape,n=i[0],s=i[1];if(1===s&&1===n)return`\n      float ${r}(int index) {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const o=mQ(e);if(1===s)return`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${n}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;if(1===n)return`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${s}.0, 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `;return`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${n}, ${s}, index + ${o});\n      return sampleTexture(${e}, uv);\n    }\n  `}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),n=t.shapeInfo.texShape;if(null!=n&&NV.Cd.arraysEqual(e,n)){const t=n[0],e=n[1];return`\n    float ${i}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${e}.0, ${t}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `}const{newShape:s,keptDims:o}=NV.Cd.squeezeShape(e),a=s;if(a.length<e.length){const e=vQ(t,a),r=["row","col"];return`\n      ${hQ(e)}\n      float ${i}(int row, int col) {\n        return ${i}(${_Q(r,o)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));\n        ${gQ(t)}\n      }\n    `;const h=n[0],u=n[1],l=mQ(r);if(1===u)return`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${l}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${h}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;if(1===h)return`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${l}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `;return`\n  float ${i}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${e[1]} + col + ${l};\n    vec2 uv = uvFromFlat(${h}, ${u}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),n=e[1]*e[2],s=e[2],{newShape:o,keptDims:a}=NV.Cd.squeezeShape(e),h=o;if(h.length<e.length){const e=vQ(t,h),r=["row","col","depth"];return`\n        ${hQ(e)}\n        float ${i}(int row, int col, int depth) {\n          return ${i}(${_Q(r,a)});\n        }\n      `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${n}, ${s}, 1)));\n        ${gQ(t)}\n      }\n    `;const u=t.shapeInfo.texShape,l=u[0],c=u[1],d=t.shapeInfo.flatOffset;if(c===n&&null==d)return`\n        float ${i}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${s}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${c}.0, ${l}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(c===s&&null==d)return`\n    float ${i}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}.0, ${l}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const p=mQ(r);return`\n      float ${i}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${n} + col * ${s} + depth + ${p};\n        vec2 uv = uvFromFlat(${l}, ${c}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}(t);case 4:return function(t){const e=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),n=e[3],s=e[2]*n,o=e[1]*s,{newShape:a,keptDims:h}=NV.Cd.squeezeShape(e);if(a.length<e.length){const e=vQ(t,a),r=["row","col","depth","depth2"];return`\n      ${hQ(e)}\n      float ${i}(int row, int col, int depth, int depth2) {\n        return ${i}(${_Q(r,h)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${o}, ${s}, ${n}, 1)));\n        ${gQ(t)}\n      }\n    `;const u=t.shapeInfo.flatOffset,l=t.shapeInfo.texShape,c=l[0],d=l[1];if(d===o&&null==u)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${s}, ${n}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${d}.0, ${c}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(d===n&&null==u)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${e[1]*e[2]}, ${e[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${d}.0, ${c}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const p=mQ(r);return`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${o} + col * ${s} +\n          depth * ${n} + depth2;\n      vec2 uv = uvFromFlat(${c}, ${d}, index + ${p});\n      return sampleTexture(${r}, uv);\n    }\n  `}(t);case 5:return function(t){const e=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),n=e[4],s=e[3]*n,o=e[2]*s,a=e[1]*o,{newShape:h,keptDims:u}=NV.Cd.squeezeShape(e);if(h.length<e.length){const e=vQ(t,h),r=["row","col","depth","depth2","depth3"];return`\n      ${hQ(e)}\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        return ${i}(${_Q(r,u)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${a}, ${o}, ${s}, ${n})) +\n          depth3;\n        ${gQ(t)}\n      }\n    `;const l=t.shapeInfo.flatOffset,c=t.shapeInfo.texShape,d=c[0],p=c[1];if(p===a&&null==l)return`\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${o}, ${s}, ${n}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${d}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(p===n&&null==l)return`\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]},\n               ${e[2]*e[3]}, ${e[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${d}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const f=mQ(r);return`\n    float ${i}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${o} + depth * ${s} +\n          depth2 * ${n} + depth3 + ${f};\n      vec2 uv = uvFromFlat(${d}, ${p}, index);\n      return sampleTexture(${r}, uv);\n    }\n  `}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),{newShape:n,keptDims:s}=NV.Cd.squeezeShape(e);if(n.length<e.length){const e=vQ(t,n),r=["row","col","depth","depth2","depth3","depth4"];return`\n      ${hQ(e)}\n      float ${i}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${i}(${_Q(r,s)});\n      }\n    `}const o=e[5],a=e[4]*o,h=e[3]*a,u=e[2]*h,l=e[1]*u;if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${l}, ${u}, ${h}, ${a})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${o}, 1)));\n        ${gQ(t)}\n      }\n    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===l&&null==c)return`\n      float ${i}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${u}, ${h}, ${a}, ${o})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(f===o&&null==c)return`\n      float ${i}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]*e[4]},\n               ${e[2]*e[3]*e[4]},\n               ${e[3]*e[4]},\n               ${e[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const m=mQ(r);return`\n    float ${i}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${l} + col * ${u} + depth * ${h} +\n          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};\n      vec2 uv = uvFromFlat(${p}, ${f}, index);\n      return sampleTexture(${r}, uv);\n    }\n  `}(t);default:throw new Error(`${e.length}-D input sampling`+" is not yet supported")}}function uQ(t){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),i=rQ();return`\n    vec4 ${r}() {\n      return ${i.texture2D}(${e}, halfCR);\n    }\n  `}(t);case 1:return function(t){const e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),i=t.shapeInfo.texShape,n=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=rQ();return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${n[0]}, ${n[1]}, index);\n      return ${s.texture2D}(${e}, uv);\n    }\n  `}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),n=t.shapeInfo.texShape,s=n[0],o=n[1],a=rQ();if(null!=n&&NV.Cd.arraysEqual(e,n))return`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${s}.0);\n\n        return ${a.texture2D}(${r}, uv);\n      }\n    `;const h=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)],u=Math.ceil(e[1]/2);return`\n    vec4 ${i}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${u}, ${h[0]}, ${h[1]}, row, col);\n      return ${a.texture2D}(${r}, uv);\n    }\n  `}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),n=t.shapeInfo.texShape,s=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)];if(1===e[0]){const r=e.slice(1),n=[1,2],s=vQ(t,r),o=["b","row","col"];return`\n        ${uQ(s)}\n        vec4 ${i}(int b, int row, int col) {\n          return ${i}(${_Q(o,n)});\n        }\n      `}const o=s[0],a=s[1],h=Math.ceil(e[2]/2),u=h*Math.ceil(e[1]/2),l=rQ();return`\n    vec4 ${i}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${o}, ${a}, ${u}, ${h}, b, row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `}(t);default:return function(t){const e=t.shapeInfo.logicalShape,r=e.length,i=t.name,n="get"+i.charAt(0).toUpperCase()+i.slice(1),s=t.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],a=o[0],h=o[1],u=Math.ceil(e[r-1]/2);let l=u*Math.ceil(e[r-2]/2),c="int b, int row, int col",d=`b * ${l} + (row / 2) * ${u} + (col / 2)`;for(let t=2;t<r-1;t++)c=`int b${t}, `+c,l*=e[r-t-1],d=`b${t} * ${l} + `+d;const p=rQ();return`\n    vec4 ${n}(${c}) {\n      int index = ${d};\n      int texR = index / ${h};\n      int texC = index - texR * ${h};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${a});\n      return ${p.texture2D}(${i}, uv);\n    }\n  `}(t)}}const lQ="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",cQ="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",dQ="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",pQ="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function fQ(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function mQ(t){return`offset${t}`}function gQ(t){const e=t.name,r=NV.Cd.sizeFromShape(t.shapeInfo.logicalShape);return r<2?`return ${e};`:`\n    for (int i = 0; i < ${r}; i++) {\n      if (i == index) {\n        return ${e}[i];\n      }\n    }\n  `}function yQ(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function vQ(t,e){const r=JSON.parse(JSON.stringify(t));return r.shapeInfo.logicalShape=e,r}function _Q(t,e){return e.map(e=>t[e]).join(", ")}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bQ{constructor(t,e,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,NV.Cd.assert(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const n=t[t.length-1],s=Math.ceil(n/e);this.outputShape=t.slice(0,-1),s>1&&this.outputShape.push(s),i||this.variableNames.push("bestIndicesA");const o=this.outputShape,a=o.length,h=yQ(a),u=eQ("coords",a);let l,c;if(1===s){c=a+1;const t=yQ(c);l=`\n        ${t} sourceLocR = ${t}(${u.join()}, 0);\n        ++${u[a-1]};\n        ${t} sourceLocG = ${t}(${u.join()}, 0);\n        ++${u[a-2]};\n        ${t} sourceLocA = ${t}(${u.join()}, 0);\n        --${u[a-1]};\n        ${t} sourceLocB = ${t}(${u.join()}, 0);\n        --${u[a-2]};`}else c=a,l=`\n        ${h} sourceLocR = coords;\n        ++${u[a-1]};\n        ${h} sourceLocG = coords;\n        ++${u[a-2]};\n        ${h} sourceLocA = coords;\n        --${u[a-1]};\n        ${h} sourceLocB = coords;\n        --${u[a-2]};`;const d=["x","y","z","w","u","v"].slice(0,c),p="."+d[c-1],f=d.map(t=>"int "+t),m=eQ("sourceLocR",c-1).concat("inIdx.r"),g=eQ("sourceLocG",c-1).concat("inIdx.g"),y=eQ("sourceLocB",c-1).concat("inIdx.b"),v=eQ("sourceLocA",c-1).concat("inIdx.a"),_="max"===r?"greaterThan":"lessThan",b=i?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${y.join()}),\n                             getBestIndicesAChannel(${v.join()})));`,x=`vec4(\n            getAChannel(${m.join()}),\n            hasNextCol ? getAChannel(${g.join()}) : 0.,\n            hasNextRow ? getAChannel(${y.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,T=i?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${d.join()}),\n                                          vec2(${d.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${d.join()}),\n                               vec2(${d.slice(-2).join()}));\n      }\n      ${T}\n      void main() {\n        ${h} coords = getOutputCoords();\n        bool hasNextCol = ${u[a-1]} < ${o[a-1]-1};\n        bool hasNextRow = ${u[a-2]} < ${o[a-2]-1};\n        ${l}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${x};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${b}\n          vec4 candidate = ${x};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${_}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xQ{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,r=t.filterWidth,i=t.strideHeight,n=t.strideWidth,s=t.dilationHeight,o=t.dilationWidth,a=t.effectiveFilterHeight,h=t.effectiveFilterWidth,u=a-1-t.padInfo.top,l=h-1-t.padInfo.left,c=1/(e*r);this.userCode=`\n      const ivec2 pads = ivec2(${u}, ${l});\n      const float avgMultiplier = float(${c});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${a};\n            wR += ${s}) {\n          float dyR = float(dyRCorner + wR) / ${i}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${h};\n            wC+= ${o}) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class TQ{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,r=t.filterHeight,i=t.filterWidth,n=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,h=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=l-1-t.padInfo.front,f=c-1-t.padInfo.top,m=d-1-t.padInfo.left,g=1/(e*r*i);this.userCode=`\n      const ivec3 pads = ivec3(${p}, ${f}, ${m});\n      const float avgMultiplier = float(${g});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${l};\n            wD += ${a}) {\n          float dyD = float(dyDCorner + wD) / ${n}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${c};\n              wR += ${h}) {\n            float dyR = float(dyRCorner + wR) / ${s}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${d};\n                wC += ${u}) {\n              float dyC = float(dyCCorner + wC) / ${o}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EQ{constructor(t,e,r,i,n,s){this.outputShape=[],this.variableNames=["x","mean","variance"],NV.F.assertAndGetBroadcastShape(t,e),NV.F.assertAndGetBroadcastShape(t,r);let o="0.0";null!=i&&(NV.F.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let a="1.0";null!=n&&(NV.F.assertAndGetBroadcastShape(t,n),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${o};\n        float scale = ${a};\n        float inv = scale * inversesqrt(variance + float(${s}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wQ{constructor(t,e,r,i,n,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],NV.F.assertAndGetBroadcastShape(t,e),NV.F.assertAndGetBroadcastShape(t,r);let o="vec4(0.0)";null!=i&&(NV.F.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let a="vec4(1.0)";null!=n&&(NV.F.assertAndGetBroadcastShape(t,n),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${o};\n        vec4 scale = ${a};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${s}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SQ="return areal * breal - aimag * bimag;",IQ="return areal * bimag + aimag * breal;";class AQ{constructor(t,e,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=NV.F.assertAndGetBroadcastShape(e,r),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CQ="return a + b;",OQ="return a - b;",RQ="return a * b;",NQ="return (a < 0.) ? b * a : a;";class PQ{constructor(t,e,r){this.variableNames=["A","B"],this.outputShape=NV.F.assertAndGetBroadcastShape(e,r),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MQ="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";class DQ{constructor(t,e,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=NV.F.assertAndGetBroadcastShape(e,r);const n=this.outputShape.length;let s="";if(i)if(0===n||1===NV.Cd.sizeFromShape(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{if(s=`\n          ${yQ(n)} coords = getOutputCoords();\n        `,1===n)s+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const t=eQ("coords",n);s+=`\n            bool nextRowOutOfBounds =\n              (${t[n-2]} + 1) >= ${this.outputShape[n-2]};\n            bool nextColOutOfBounds =\n              (${t[n-1]} + 1) >= ${this.outputShape[n-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${s}\n\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FQ{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}getCustomSetupFunc(t,e){return(r,i)=>{null==this.minLoc&&(this.minLoc=r.getUniformLocationNoThrow(i,"minVal"),this.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(this.minLoc,t),r.gl.uniform1f(this.maxLoc,e)}}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LQ{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}getCustomSetupFunc(t,e){return(r,i)=>{null==this.minLoc&&(this.minLoc=r.getUniformLocationNoThrow(i,"minVal"),this.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(this.minLoc,t),r.gl.uniform1f(this.maxLoc,e)}}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kQ{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UQ{constructor(t){this.outputShape=[],this.outputShape=NV.F.computeOutShape(t,1),this.variableNames=t.map((t,e)=>`T${e}`);const e=new Array(t.length-1);e[0]=t[0][1];for(let r=1;r<e.length;r++)e[r]=e[r-1]+t[r][1];const r=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let t=1;t<e.length;t++){const i=e[t-1];r.push(`else if (yC < ${e[t]}) `+`setOutput(getT${t}(yR, yC-${i}));`)}const i=e.length,n=e[e.length-1];r.push(`else setOutput(getT${i}(yR, yC-${n}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${r.join("\n        ")}\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BQ{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=NV.F.computeOutShape(t,e);const r=this.outputShape,i=r.length,n=yQ(i),s=eQ("coords",i),o=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((t,e)=>`T${e}`);const a=new Array(t.length-1);a[0]=t[0][e];for(let r=1;r<a.length;r++)a[r]=a[r-1]+t[r][e];const h=o[e],u=o.slice(-2),l=o.join();let c=`if (${h} < ${a[0]}) {\n        return getChannel(\n            getT0(${l}), vec2(${u.join()}));\n        }`;for(let t=1;t<a.length;t++){const e=a[t-1];c+=`\n        if (${h} < ${a[t]}  && ${h} >= ${a[t-1]}) {\n          return getChannel(\n            getT${t}(${jQ(o,h,e)}),\n            vec2(${jQ(u,h,e)}));\n        }`}const d=a.length,p=a[a.length-1];c+=`\n        return getChannel(\n          getT${d}(${jQ(o,h,p)}),\n          vec2(${jQ(u,h,p)}));`,this.userCode=`\n      float getValue(${o.map(t=>"int "+t)}) {\n        ${c}\n      }\n\n      void main() {\n        ${n} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${s}), 0., 0., 0.);\n\n        ${s[i-1]} = ${s[i-1]} + 1;\n        if (${s[i-1]} < ${r[i-1]}) {\n          result.g = getValue(${s});\n        }\n\n        ${s[i-2]} = ${s[i-2]} + 1;\n        if (${s[i-2]} < ${r[i-2]}) {\n          result.a = getValue(${s});\n        }\n\n        ${s[i-1]} = ${s[i-1]} - 1;\n        if (${s[i-2]} < ${r[i-2]} &&\n            ${s[i-1]} < ${r[i-1]}) {\n          result.b = getValue(${s});\n        }\n        setOutput(result);\n      }\n    `}}function jQ(t,e,r){const i=t.indexOf(e);return t.map((t,e)=>e===i?`${t} - ${r}`:t).join()}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XQ{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,n=t.padInfo.left,s="channelsLast"===t.dataFormat;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${e} - ${i};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${r} - ${n};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              if (${s}) {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class GQ{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,r=t.filterWidth,i=t.strideHeight,n=t.strideWidth,s="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,a=r-1-t.padInfo.left,h=s?1:2,u=s?2:3,l=s?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${l}];\n\n        ivec2 dyCorner = ivec2(coords[${h}], coords[${u}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${i}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${r} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${s}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class zQ{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,r=t.strideHeight,i=t.strideWidth,n=t.padInfo.front,s=t.padInfo.top,o=t.padInfo.left;this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${e} - ${n};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${r} - ${s};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${i} - ${o};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class VQ{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,r=t.filterHeight,i=t.filterWidth,n=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=e-1-t.padInfo.front,h=r-1-t.padInfo.top,u=i-1-t.padInfo.left;this.userCode=`\n      const ivec3 pads = ivec3(${a}, ${h}, ${u});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${n}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${r}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${s}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${r} - 1 - wR;\n\n            for (int wC = 0; wC < ${i}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${o}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${i} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HQ{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,n=t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${s} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${e} - ${i};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${r} - ${n};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class $Q{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,r=t.filterWidth,i=t.strideHeight,n=t.strideWidth,s=e-1-t.padInfo.top,o=r-1-t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${s}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${i}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${r} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${a}; dm++) {\n              int d2 = d1 * ${a} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WQ{constructor(t,e=!1,r=null,i=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.top,s=t.padInfo.left,o=t.strideHeight,a=t.strideWidth,h=t.dilationHeight,u=t.dilationWidth,l=t.filterHeight,c=t.filterWidth,d=4*Math.floor(t.inChannels/4),p=t.inChannels%4,f="channelsLast"===t.dataFormat,m=f?1:2,g=f?2:3,y=f?3:1;let v="",_="";r&&(v=i?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:`\n          float activation(float x) {\n            ${r}\n          }\n        `,_="result = activation(result);");const b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${o}, ${a});\n      const ivec2 pads = ivec2(${n}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${y}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${m}], coords[${g}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${l}; wR++) {\n          int xR = xRCorner + wR * ${h};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${c}; wC++) {\n            int xC = xCCorner + wC * ${u};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${d}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${f}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===p}) {\n\n              if (${f}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${d}) *\n                    getW(wR, wC, ${d}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${d}, xR, xC) *\n                    getW(wR, wC, ${d}, d2);\n              }\n\n            } else if (${2===p}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${d}, d2),\n                getW(wR, wC, ${d} + 1, d2)\n              );\n\n              if (${f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${d}),\n                  getX(batch, xR, xC, ${d} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${d}, xR, xC),\n                  getX(batch, ${d} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===p}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${d}, d2),\n                getW(wR, wC, ${d} + 1, d2),\n                getW(wR, wC, ${d} + 2, d2)\n              );\n\n              if (${f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${d}),\n                  getX(batch, xR, xC, ${d} + 1),\n                  getX(batch, xR, xC, ${d} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${d}, xR, xC),\n                  getX(batch, ${d} + 1, xR, xC),\n                  getX(batch, ${d} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${b}\n        ${_}\n        setOutput(result);\n      }\n    `}}class YQ{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,r=t.padInfo.top,i=t.padInfo.left,n=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,h=t.dilationHeight,u=t.dilationWidth,l=t.filterDepth,c=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${n}, ${s}, ${o});\n      const ivec3 pads = ivec3(${e}, ${r}, ${i});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${l}; wF++) {\n          int xF = xFCorner + wF * ${a};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${c}; wR++) {\n            int xR = xRCorner + wR * ${h};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d}; wC++) {\n              int xC = xCCorner + wC * ${u};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${p}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${p}) *\n                  getW(wF, wR, wC, ${p}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1),\n                  getX(batch, xF, xR, xC, ${p} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2),\n                  getW(wF, wR, wC, ${p} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qQ{constructor(t,e=!1,r=null,i=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.inHeight,s=t.inWidth,o=t.padInfo.top,a=t.padInfo.left,h=t.strideHeight,u=t.strideWidth,l=t.dilationHeight,c=t.dilationWidth,d=t.filterHeight,p=t.filterWidth,f=t.outChannels/t.inChannels;let m="",g="";r&&(m=i?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:`\n          float activation(float x) {\n            ${r}\n          }\n        `,g="result = activation(result);");const y=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${m}\n\n      const ivec2 strides = ivec2(${h}, ${u});\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${f};\n        int q = d2 - d1 * ${f};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${d}; wR++) {\n          int xR = xRCorner + wR * ${l};\n\n          if (xR < 0 || xR >= ${n}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${p}; wC++) {\n            int xC = xCCorner + wC * ${c};\n\n            if (xC < 0 || xC >= ${s}) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${y}\n        ${g}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KQ{constructor(t,e=!1,r=null,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;const n=t.inHeight,s=t.inWidth,o=t.padInfo.top,a=t.padInfo.left,h=t.strideHeight,u=t.strideWidth,l=t.dilationHeight,c=t.dilationWidth,d=t.filterHeight,p=t.filterWidth,f=p;let m="int xR; int xC; int xCOffset;";for(let t=0;t<d;t++)for(let e=0;e<p;e++)m+=`\n          vec4 xTexelR${t}C${2*e} = vec4(0.);\n          vec4 wR${t}C${e} = vec4(0.);\n          vec4 xR${t}C${e} = vec4(0.);`;for(let t=0;t<d;t++)for(let e=0;e<f;e++){const r=2*e;if(m+=`\n          xR = xRCorner + ${t*l};\n          xC = xCCorner + ${r*c};\n        `,1===u){if(r<p&&(m+=a%2==1?`\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ${n} && xCOffset >= 0 && xCOffset < ${s}) {\n                  xTexelR${t}C${r} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${s}) {\n                    xTexelR${t}C${r}.zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR${t}C${r} = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ${n} && xCOffset >= 0 && xCOffset < ${s}) {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${s}) {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR${t}C${r} = vec4(previous.zw, xTexelR${t}C${r}.xy);\n                } else {\n                  xR${t}C${r} = vec4(0, 0, xTexelR${t}C${r}.xy);\n                }\n              `:`\n                if(xR >= 0 && xR < ${n} && xC >= 0 && xC < ${s}) {\n                  xTexelR${t}C${r} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${t}C${r} = vec4(0.);\n                }\n\n                xR${t}C${r} = xTexelR${t}C${r};\n              `,r+1<p)){const e=a%2==0?NV.Cd.nearestLargerEven(c):c;c%2==0&&a%2==1||c%2!=0&&a%2!=1?(m+=`\n                  xCOffset = xC + ${a%2} + ${e};\n\n                  if(xR >= 0 && xR < ${n} &&\n                    xCOffset >= 0 && xCOffset < ${s}) {\n                    xTexelR${t}C${r+2} = getX(batch, xR, xCOffset, d1);\n                  }\n                `,c>1&&(m+=`\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ${n} &&\n                      xCOffset >= 0 && xCOffset < ${s}) {\n                      xTexelR${t}C${r} = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR${t}C${r} = vec4(0.);\n                    }\n                  `),m+=`\n                  xR${t}C${r+1} = vec4(\n                    xTexelR${t}C${r}.zw, xTexelR${t}C${r+2}.xy);\n                `):m+=`\n                  xCOffset = xC + ${e};\n\n                  if(xR >= 0 && xR < ${n} &&\n                    xCOffset >= 0 && xCOffset < ${s}) {\n                    xTexelR${t}C${r+2} = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR${t}C${r+1} = xTexelR${t}C${r+2};\n                `}}else r<p&&(m+=`\n              if(xR >= 0 && xR < ${n}) {\n            `,a%2==1?(m+=`\n                xCOffset = xC + 1 - ${u};\n                if(xCOffset >= 0 && xCOffset < ${s}) {\n                  xTexelR${t}C${r} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${t}C${r} = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ${s}) {\n                  xTexelR${t}C${r+2} = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR${t}C${r+2} = vec4(0.);\n                }\n\n                xR${t}C${r} = vec4(\n                  xTexelR${t}C${r}.zw, xTexelR${t}C${r+2}.zw);\n              `,r+1<p&&(m+=`\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ${u};\n                  if(xCOffset >= 0 && xCOffset < ${s}) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR${t}C${r+1} = vec4(xTexelR${t}C${r+2}.xy, final.xy);\n                `)):(m+=`\n                if(xC >= 0 && xC < ${s}) {\n                  xTexelR${t}C${r} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${t}C${r} = vec4(0.);\n                }\n\n                xCOffset = xC + ${u};\n                if(xCOffset >= 0 && xCOffset < ${s}) {\n                  xTexelR${t}C${r+2} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${t}C${r+2} = vec4(0.);\n                }\n\n                xR${t}C${r} = vec4(\n                  xTexelR${t}C${r}.xy, xTexelR${t}C${r+2}.xy);\n              `,r+1<p&&(m+=`\n                  xR${t}C${r+1} = vec4(\n                    xTexelR${t}C${r}.zw, xTexelR${t}C${r+2}.zw);\n                `)),m+="}");r<p&&(m+=`\n            vec4 wTexelR${t}C${r} = getW(${t}, ${r}, d1, q);\n            wR${t}C${r} = vec4(wTexelR${t}C${r}.xz, wTexelR${t}C${r}.xz);\n          `,r+1<p&&(m+=`\n              vec4 wTexelR${t}C${r+1} = getW(${t}, ${r+1}, d1, q);\n              wR${t}C${r+1} =\n                vec4(wTexelR${t}C${r+1}.xz, wTexelR${t}C${r+1}.xz);`))}for(let t=0;t<d;t++)for(let e=0;e<p;e++)m+=`dotProd += xR${t}C${e} * wR${t}C${e};`;let g="",y="";r&&(g=i?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:`vec4 activation(vec4 x) {\n          ${r}\n        }`,y="result = activation(result);");const v=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${g}\n\n      const ivec2 strides = ivec2(${h}, ${u});\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ${m}\n\n        vec4 result = dotProd;\n        ${v}\n        ${y}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZQ{constructor(t,e,r,i,n){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[s,o,a,h]=t,[u]=e,[l,c]=r;this.outputShape=[u,l,c,h];const d="bilinear"===i?1:0,[p,f]=[`${o-1}.0`,`${a-1}.0`],[m,g,y]=l>1?[`${(o-1)/(l-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,_,b]=c>1?[`${(a-1)/(c-1)}`,"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${v});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${s}) {\n          return;\n        }\n\n        float height_scale = ${g};\n        float width_scale = ${_};\n\n        float in_y = ${y};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${n}));\n          return;\n        }\n        float in_x = ${b};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${n}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${d} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JQ{constructor(t,e,r){this.variableNames=["x"],this.outputShape=t;const i=t.length,n=t[t.length-1],s=r?"<":">";this.userCode=`\n      int getIndex(int i) {\n        ${r?`return ${n} -i - 1;`:"return i;"}\n      }\n\n      void main() {\n        ${yQ(i)} coords = getOutputCoords();\n        int end = ${QQ(i,"coords")};\n        float val = 0.0;\n        for (int i = ${n} - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx ${s} end) {\n            continue;\n          }\n          if (idx == end && ${e}) {\n            continue;\n          }\n          ${QQ(i,"coords")} = idx;\n          val += getX(${function(t,e){if(1===t)return`${e}`;if(2===t)return`${e}.x, ${e}.y`;if(3===t)return`${e}.x, ${e}.y, ${e}.z`;if(4===t)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative sum for rank ${t} is not yet supported`)}(i,"coords")});\n        }\n        setOutput(val);\n      }\n    `}}function QQ(t,e){if(1===t)return`${e}`;if(2===t)return`${e}.y`;if(3===t)return`${e}.z`;if(4===t)return`${e}.w`;throw Error(`Cumulative sum for rank ${t} is not yet supported`)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t0{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=_J.DENSE;const e=EJ(t),r=rQ();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${iQ(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${r.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e0{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=_J.DENSE;const e=EJ(t),r=rQ();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${iQ(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${r.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r0{constructor(t,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=r,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i0{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n0{constructor(t){this.variableNames=["A"],this.outTexUsage=bJ.DOWNLOAD;const e=rQ();this.outputShape=t,this.userCode=`\n      ${sQ}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s0{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=bJ.DOWNLOAD;const e=rQ();this.outputShape=t,this.userCode=`\n      ${sQ}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o0{constructor(t,e,r=!1){this.variableNames=["A"];const i=rQ(),[n,s]=e;this.outputShape=t;let o="result";r&&(o="floor(result * 255. + 0.5)"),this.userCode=`\n      ${nQ(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / ${s};\n        int c = imod(flatIndex, ${s});\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(${s}.0, ${n}.0);\n        vec4 values = ${i.texture2D}(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ${i.output} = vec4(${o}, 0., 0., 0.);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a0{constructor(t,e,r=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const i=rQ(),[n,s]=e;this.outputShape=t;let o="",a="result";r&&(a="floor(result * 255. + 0.5)");for(let e=0;e<=1;e++)for(let r=0;r<=1;r++){const a=2*e+r;o+=`\n          localCoords = coords;\n          if(localCoords[2] + ${r} < ${t[2]}) {\n            localCoords[2] += ${r};\n            if(localCoords[1] + ${e} < ${t[1]}) {\n              localCoords[1] += ${e};\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ${s};\n              c = imod(flatIndex, ${s});\n              uv = (vec2(c, r) + halfCR) / vec2(${s}.0, ${n}.0);\n              values = ${i.texture2D}(A, uv);\n\n              if(offset == 0) {\n                result[${a}] = values[0];\n              } else if(offset == 1) {\n                result[${a}] = values[1];\n              } else if(offset == 2) {\n                result[${a}] = values[2];\n              } else {\n                result[${a}] = values[3];\n              }\n            }\n          }\n        `}this.userCode=`\n      ${nQ(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ${o}\n\n        ${i.output} = ${a};\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h0="return real * expR - imag * expI;",u0="return real * expI + imag * expR;";class l0{constructor(t,e,r){this.variableNames=["real","imag"];const i=e[1];this.outputShape=e;const n=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=r?`${i}.0`:"1.0";this.userCode=`\n      const float exponentMultiplier = ${n};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${t}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${i});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${i}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${s};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c0{constructor(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}getCustomSetupFunc(t){return(e,r)=>{null==this.valueLoc&&(this.valueLoc=e.getUniformLocationNoThrow(r,"value")),e.gl.uniform1f(this.valueLoc,t)}}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d0{constructor(t,e,r){this.variableNames=["A","indices"];const i=t.slice();i[r]=e,this.outputShape=i,this.rank=i.length;const n=yQ(this.rank),s=function(t,e){const r=t.length;if(r>4)throw Error(`Gather for rank ${r} is not yet supported`);if(1===r)return"int(getIndices(resRC))";const i=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<t.length;r++)r===e?n.push(`int(getIndices(${i[r]}))`):n.push(`${i[r]}`);return n.join()}(t,r);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        setOutput(getA(${s}));\n      }\n    `}}class p0{constructor(t,e,r){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=r;const i=yQ(e.length),n=yQ(r.length),s=this.sliceDim>1?"strides[j]":"strides";this.userCode=`\n        ${i} strides = ${i}(${this.strides});\n         void main() {\n          ${n} coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ${this.sliceDim}; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ${s};\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f0(t,e){const r=rQ();return function(t,e,r){const i=kJ(t,e,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(IJ(t,e,()=>t.shaderSource(i,r)),IJ(t,e,()=>t.compileShader(i)),!1===t.getShaderParameter(i,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(i)),new Error("Failed to compile vertex shader.");return i}(t,e,`${r.version}\n    precision highp float;\n    ${r.attribute} vec3 clipSpacePos;\n    ${r.attribute} vec2 uv;\n    ${r.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}function m0(t,e){return function(t,e,r){const i=kJ(t,e,()=>t.createBuffer(),"Unable to create WebGLBuffer");return IJ(t,e,()=>t.bindBuffer(t.ARRAY_BUFFER,i)),IJ(t,e,()=>t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW)),i}(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function g0(t,e){return function(t,e,r){const i=kJ(t,e,()=>t.createBuffer(),"Unable to create WebGLBuffer");return IJ(t,e,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i)),IJ(t,e,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,r,t.STATIC_DRAW)),i}(t,e,new Uint16Array([0,1,2,2,1,3]))}function y0(t,e,r,i,n,s,o){!function(t,e){const r=Object(NV.nb)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){throw new Error("Requested texture size "+`[${t}x${e}]`+" is invalid.")}if(t>r||e>r){throw new Error("Requested texture size "+`[${t}x${e}]`+" greater than WebGL maximum on this browser / GPU "+`[${r}x${r}]`+".")}}(r,i);const a=function(t,e){return kJ(t,e,()=>t.createTexture(),"Unable to create WebGLTexture.")}(t,e),h=t.TEXTURE_2D;return IJ(t,e,()=>t.bindTexture(h,a)),IJ(t,e,()=>t.texParameteri(h,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),IJ(t,e,()=>t.texParameteri(h,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),IJ(t,e,()=>t.texParameteri(h,t.TEXTURE_MIN_FILTER,t.NEAREST)),IJ(t,e,()=>t.texParameteri(h,t.TEXTURE_MAG_FILTER,t.NEAREST)),IJ(t,e,()=>t.texImage2D(h,0,n,r,i,0,s,o,null)),IJ(t,e,()=>t.bindTexture(t.TEXTURE_2D,null)),a}function v0(t,e,r,i,n,s,o,a){const h=t,u=new Float32Array(function(t,e){const[r,i]=wJ(t,e);return r*i*4}(s,o));return h.bindBuffer(h.PIXEL_PACK_BUFFER,e),h.getBufferSubData(h.PIXEL_PACK_BUFFER,0,u),h.bindBuffer(h.PIXEL_PACK_BUFFER,null),u}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class _0{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const e=Object(NV.nb)().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(t,e){gJ[t]=e}(e,t)):this.gl=vJ(e);let r="WEBGL_color_buffer_float";if(1===Object(NV.nb)().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=CJ(this.gl,this.debug,t),$J(this.gl,e))this.textureHalfFloatExtension=CJ(this.gl,this.debug,e);else if(Object(NV.nb)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),$J(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=CJ(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Object(NV.nb)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",$J(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!$J(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=m0(this.gl,this.debug),this.indexBuffer=g0(this.gl,this.debug),this.framebuffer=function(t,e){return kJ(t,e,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl,this.debug),this.textureConfig=SJ(this.gl,this.textureHalfFloatExtension)}get debug(){return Object(NV.nb)().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;IJ(t,this.debug,()=>t.finish()),IJ(t,this.debug,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),IJ(t,this.debug,()=>t.deleteFramebuffer(this.framebuffer)),IJ(t,this.debug,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),IJ(t,this.debug,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),IJ(t,this.debug,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,r,i,n){const[s,o]=TJ(r,i);return y0(t,e,s,o,n.internalFormatFloat,n.textureFormatFloat,t.FLOAT)}(this.gl,this.debug,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,r,i,n){const[s,o]=TJ(r,i);return y0(t,e,s,o,n.internalFormatHalfFloat,n.textureFormatFloat,n.textureTypeHalfFloat)}(this.gl,this.debug,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,r,i,n){const[s,o]=TJ(r,i);return y0(t,e,s,o,t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}(this.gl,this.debug,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function(t,e,r,i){IJ(t,e,()=>t.bindTexture(t.TEXTURE_2D,r)),i.data instanceof Uint8Array?IJ(t,e,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,i.width,i.height,0,t.RGBA,t.UNSIGNED_BYTE,i.data)):IJ(t,e,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i)),IJ(t,e,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,this.debug,t,e)}uploadDenseMatrixToTexture(t,e,r,i){this.throwIfDisposed(),function(t,e,r,i,n,s,o){let a,h,u;IJ(t,e,()=>t.bindTexture(t.TEXTURE_2D,r)),s instanceof Uint8Array?(a=new Uint8Array(i*n*4),h=t.UNSIGNED_BYTE,u=t.RGBA):(a=new Float32Array(i*n*4),h=t.FLOAT,u=o.internalFormatPackedFloat),a.set(s),IJ(t,e,()=>t.texImage2D(t.TEXTURE_2D,0,u,i,n,0,t.RGBA,h,a)),IJ(t,e,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,this.debug,t,e,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,r,i,n){const[s,o]=wJ(r,i);return y0(t,e,s,o,n.internalFormatPackedHalfFloat,t.RGBA,n.textureTypeHalfFloat)}(this.gl,this.debug,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,r,i,n){const[s,o]=wJ(r,i);return y0(t,e,s,o,n.internalFormatPackedFloat,t.RGBA,t.FLOAT)}(this.gl,this.debug,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(FJ(this.gl,this.debug,this.framebuffer),this.outputTexture=null),IJ(this.gl,this.debug,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,r){return this.downloadMatrixDriver(t,()=>function(t,e,r,i,n){const[s,o]=TJ(r,i),a=new Uint8Array(r*i*4);return IJ(t,e,()=>t.readPixels(0,0,s,o,n.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}(this.gl,this.debug,e,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,r,i,n,s){return v0(this.gl,t,0,0,0,n,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return function(t,e,r){const i=t,n=new Float32Array(r);return i.bindBuffer(i.PIXEL_PACK_BUFFER,e),i.getBufferSubData(i.PIXEL_PACK_BUFFER,0,n),i.bindBuffer(i.PIXEL_PACK_BUFFER,null),n}(this.gl,t,e)}createBufferFromTexture(t,e,r){this.bindTextureToFrameBuffer(t);const i=function(t,e,r,i,n){const s=t.createBuffer();IJ(t,e,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const o=16*r*i;return IJ(t,e,()=>t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)),IJ(t,e,()=>t.readPixels(0,0,i,r,t.RGBA,t.FLOAT,0)),IJ(t,e,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}(this.gl,this.debug,e,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,r;if(Object(NV.nb)().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,n=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{const t=i.clientWaitSync(n,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=n}else Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(e,Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:e,isFencePassed:r}}downloadMatrixFromPackedTexture(t,e,r){return this.downloadMatrixDriver(t,()=>function(t,e,r,i){const n=new Float32Array(r*i*4);return IJ(t,e,()=>t.readPixels(0,0,i,r,t.RGBA,t.FLOAT,n)),n}(this.gl,this.debug,e,r))}createProgram(t){this.throwIfDisposed();const e=this.gl,r=OJ(e,this.debug,t),i=f0(e,this.debug),n=function(t,e){return kJ(t,e,()=>t.createProgram(),"Unable to create WebGLProgram.")}(e,this.debug);return IJ(e,this.debug,()=>e.attachShader(n,i)),IJ(e,this.debug,()=>e.attachShader(n,r)),function(t,e,r){if(IJ(t,e,()=>t.linkProgram(r)),!1===t.getProgramParameter(r,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(r)),new Error("Failed to link vertex and fragment shaders.")}(e,this.debug,n),this.debug&&NJ(e,this.debug,n),this.vertexAttrsAreBound||(this.setProgram(n),this.vertexAttrsAreBound=function(t,e,r,i){return IJ(t,e,()=>t.bindBuffer(t.ARRAY_BUFFER,i)),PJ(t,e,r,"clipSpacePos",i,3,20,0)&&PJ(t,e,r,"uv",i,2,20,12)}(e,this.debug,this.program,this.vertexBuffer)),n}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&IJ(this.gl,this.debug,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&NJ(this.gl,this.debug,this.program),IJ(this.gl,this.debug,()=>this.gl.useProgram(t))}getUniformLocation(t,e,r=!0){return this.throwIfDisposed(),r?function(t,e,r,i){return kJ(t,e,()=>t.getUniformLocation(r,i),'uniform "'+i+'" not present in program.')}(this.gl,this.debug,t,e):function(t,e,r){return t.getUniformLocation(e,r)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),IJ(this.gl,this.debug,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),MJ(this.gl,this.debug,this.program,t,e,r)}setOutputMatrixTexture(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)}setOutputPackedMatrixTexture(t,e,r){this.throwIfDisposed();const[i,n]=wJ(e,r);this.setOutputMatrixTextureDriver(t,i,n)}setOutputMatrixWriteRegion(t,e,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,e)}setOutputPackedMatrixWriteRegion(t,e,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&NJ(this.gl,this.debug,this.program),LJ(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),IJ(t,this.debug,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),IJ(this.gl,this.debug,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=CJ(this.gl,this.debug,2===Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,r),r}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await NV.Cd.repeatedTry(()=>this.disposed||this.isQueryAvailable(t,Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),r=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=function(t){let e=0;for(;e<t.length;++e){if(!t[e]())break}return e-1}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(this.itemsToPoll.map(t=>t.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||NV.Cd.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),DJ(this.gl,this.debug,t,this.framebuffer),this.debug&&LJ(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(DJ(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&LJ(this.gl)):FJ(this.gl,this.debug,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const r=e();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,e,r){this.throwIfDisposed();const i=this.gl;DJ(i,this.debug,t,this.framebuffer),this.debug&&LJ(i),this.outputTexture=t,IJ(i,this.debug,()=>i.viewport(0,0,e,r)),IJ(i,this.debug,()=>i.scissor(0,0,e,r))}setOutputMatrixWriteRegionDriver(t,e,r,i){this.throwIfDisposed(),IJ(this.gl,this.debug,()=>this.gl.scissor(t,e,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function b0(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but `+`was executed with ${e.length} inputs`);t.forEach((t,r)=>{const i=t.logicalShape,n=e[r],s=n.shape;if(!NV.Cd.arraysEqual(i,s))throw Error("Binary was compiled with different shapes than "+`the current args. Shapes ${i} and ${s} must match`);if(t.isUniform&&n.isUniform)return;const o=t.texShape,a=n.isUniform?null:n.texData.texShape;if(!NV.Cd.arraysEqual(o,a))throw Error("Binary was compiled with different texture shapes than the"+` current args. Shape ${o} and ${a} must match`)})}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class x0{constructor(t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;const{filterWidth:i,inChannels:n,strideWidth:s,strideHeight:o,padInfo:a,outWidth:h,dilationWidth:u,dilationHeight:l,dataFormat:c}=r,{left:d,top:p}=a,f=n*i,m=rQ(),g="channelsLast"===c,y=g?0:1,v=g?1:2;let _="";for(let r=0;r<=1;r++)for(let i=0;i<=1;i++)_+=`\n          blockIndex = rc.y + ${i};\n          pos = rc.x + ${r};\n\n          if(blockIndex < ${t[1]} && pos < ${t[0]}) {\n            offsetY = int(blockIndex / (${h})) * ${o} - ${p};\n            d0 = offsetY + ${l} * (pos / ${f});\n\n            if(d0 < ${e[y]} && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ${h}.) * ${s}. - ${d}.);\n              d1 = offsetX + ${u} * (int(mod(float(pos), ${f}.) / ${n}.));\n\n              if(d1 < ${e[v]} && d1 >= 0) {\n\n                ch = int(mod(float(pos), ${n}.));\n\n                if (${g}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*r+i}] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*r+i}] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${_}\n\n        ${m.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T0{constructor(t,e,r,i,n){this.variableNames=["x"],this.outputShape=[];const s=e,o=t[3]-1;let a;this.outputShape=t;const h=`float(${r}) + float(${i}) * sum`;a=.5===n?`inversesqrt(${h})`:1===n?`1.0/(${h})`:`exp(log(${h}) * float(-${n}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${s}; j <= ${s}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${o}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${a};\n        setOutput(val);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E0{constructor(t,e,r,i,n){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=r,this.alpha=i,this.beta=n,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${i}) * norm + float(${r});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${i})\n                * float(${n})\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${n});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w0{constructor(t,e,r,i,n){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const s=e,o=t[3]-1;let a;this.outputShape=t;const h=`float(${r}) + float(${i}) * sum`;a=.5===n?`inversesqrt(${h})`:1===n?`1.0/(${h})`:`exp(log(${h}) * float(-${n}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${s};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${s}; j <= ${s}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${a};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S0{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,r=t.strideWidth,i=t.dilationHeight,n=t.effectiveFilterHeight,s=t.effectiveFilterWidth,o=n-1-t.padInfo.top,a=s-1-t.padInfo.left,h=n*s-1;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${n};\n          wR += ${i}) {\n          float dyR = float(dyRCorner + wR) / ${e}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${s}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${r}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${h} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${s} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class I0{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,r=t.strideHeight,i=t.strideWidth,n=t.dilationDepth,s=t.dilationHeight,o=t.dilationWidth,a=t.effectiveFilterDepth,h=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=a-1-t.padInfo.front,c=h-1-t.padInfo.top,d=u-1-t.padInfo.left,p=a*h*u-1;this.userCode=`\n      const ivec3 pads = ivec3(${l}, ${c}, ${d});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${a};\n           wD += ${n}) {\n          float dyD = float(dyDCorner + wD) / ${e}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${h};\n              wR += ${s}) {\n            float dyR = float(dyRCorner + wR) / ${r}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${u};\n                wC += ${o}) {\n              float dyC = float(dyCCorner + wC) / ${i}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${p} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${h} * ${u} +\n                  wR * ${u} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A0{constructor(t,e,r=!1,i=!1,n=!1,s=null,o=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;const a=r?t[1]:t[2],h=Math.ceil(a/2),u=r?"i * 2, rc.y":"rc.y, i * 2",l=i?"rc.z, i * 2":"i * 2, rc.z",c=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let p="",f="";s&&(p=o?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${s}\n        }`:`vec4 activation(vec4 x) {\n          ${s}\n        }`,f="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${p}\n\n      const float sharedDimension = ${h}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ${h}; i++) {\n          vec4 a = getMatrixA(rc.x, ${u});\n          vec4 b = getMatrixB(rc.x, ${l});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${c[0]} * ${d[0]});\n          result += (${c[1]} * ${d[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${m}\n\n        ${f}\n\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C0{constructor(t,e,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}getCustomSetupFunc(t){return(e,r)=>{null==this.seedLoc&&(this.seedLoc=e.getUniformLocation(r,"seed")),e.gl.uniform1f(this.seedLoc,t)}}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O0{constructor(t,e,r,i){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${i}), float(${r}),\n                      float(index == coords.y)));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R0{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;const e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const r=eQ("rc",e),i=yQ(e),n=function(t,e,r){if(1===t)return`rc > ${e[0]}`;let i="";for(let n=t-2;n<t;n++)i+=`${r[n]} >= ${e[n]}`,n<t-1&&(i+="||");return i}(e,t,r),s=function(t,e,r,i){if(1===t)return"";const n=i.slice(-2);return`\n    int r = ${n[0]};\n    int c = ${n[1]};\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ${e};\n    bool rEdge = rp1 >= ${r};\n  `}(e,t[t.length-1],t[t.length-2],r),o=function(t,e){const r=t.length,i=function(t,e){const r=[];for(let i=0;i<=1;i++)for(let n=0;n<=1;n++){let s=`${0===i?"r":"rp1"}, ${0===n?"c":"cp1"}`;for(let r=2;r<t;r++)s=`${e[e.length-1-r]},`+s;r.push(s)}return r}(r,e);if(1===r)return`getA(rc),\n            rc + 1 >= ${t[0]} ? 0. : getA(rc + 1),\n            0, 0`;return`getA(${i[0]}),\n          cEdge ? 0. : getA(${i[1]}),\n          rEdge ? 0. : getA(${i[2]}),\n          rEdge || cEdge ? 0. : getA(${i[3]})`}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t,r);this.userCode=`\n        void main() {\n          ${i} rc = getOutputCoords();\n\n          if(${n}) {\n            setOutput(vec4(0));\n          } else {\n            ${s}\n\n            setOutput(vec4(${o}));\n          }\n        }\n      `}}}class N0{constructor(t,e,r){this.variableNames=["x"],this.outputShape=e.map((e,r)=>e[0]+t[r]+e[1]);const i=t.length,n=yQ(i),s=e.map(t=>t[0]).join(","),o=e.map((e,r)=>e[0]+t[r]).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);this.userCode=1!==i?`\n      ${n} start = ${n}(${s});\n      ${n} end = ${n}(${o});\n\n      void main() {\n        ${n} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(${r}));\n        } else {\n          ${n} coords = outC - start;\n          setOutput(getX(${a}));\n        }\n      }\n    `:`\n        int start = ${s};\n        int end = ${o};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(${r}));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P0{constructor(t,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((e,r)=>e[0]+t[r]+e[1]);const i=t.length,n=yQ(i),s=e.map(t=>t[0]).join(","),o=e.map((e,r)=>e[0]+t[r]).join(","),a=eQ("rc",i),h=eQ("source",i),u=`${a[i-1]} < ${this.outputShape[i-1]}`,l=1===i?"source":`vec2(${h.slice(-2).join()})`,c=[`${n} rc = outputLoc;`,`${a[i-1]} += 1;\n       if(${u}) {\n      `,1===i?"":`}\n       rc = outputLoc;\n       ${a[i-2]} += 1;\n       if(${a[i-2]} < ${this.outputShape[i-2]}) {`,1===i?"":`  ${a[i-1]} += 1;\n         if(${u}) {`],d=1===i?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let t=0,e=1===i?2:4;t<e;t++)p+=`\n        ${c[t]}\n        if (${d}) {\n          result[${t}] = float(${r});\n        } else {\n          ${n} source = rc - start;\n          result[${t}] = getChannel(getX(${h.join()}), ${l});\n        }\n      `;p+=1===i?"} ":"}}",this.userCode=`\n      const ${n} start = ${n}(${s});\n      const ${n} end = ${n}(${o});\n\n      void main() {\n        ${n} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M0{constructor(t,e,r,i=!1,n=!1){if(this.variableNames=["x"],"avg"===e&&r)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideHeight,a=t.strideWidth,h=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const f="avg"===e,m=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,g=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let y="0.0";if(f||(y="-1.0 / 1e-20"),r){const e=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${o}, ${a});\n        const ivec2 pads = ivec2(${d}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${l};\n              wR += ${h}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${c};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${e} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${i?n?m:g:`wR * ${c} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let v=`${e}(${e}(${e}(`+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(v="avgValue / count");const _=4*Math.floor(s/4),b=s%4,x=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${o}, ${a});\n      const ivec2 pads = ivec2(${d}, ${p});\n      const float initializationValue = ${y};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${y});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${l};\n            wR += ${h}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${_}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${x}\n          }\n\n          int xC = xCCorner + ${_};\n          if (${1===b}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${x}\n          } else if (${2===b}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${x}\n          } else if (${3===b}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${x}\n          }\n        }\n        setOutput(${v});\n      }\n    `}}class D0{constructor(t,e,r,i=!1,n=!1){if(this.variableNames=["x"],"avg"===e&&r)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideDepth,a=t.strideHeight,h=t.strideWidth,u=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const v="avg"===e;let _="0.0";if(v||(_="-1.0 / 1e-20"),r){const e=">=";return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${o}, ${a}, ${h});\n        const ivec3 pads = ivec3(${m}, ${g}, ${y});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${d};\n              wD += ${u}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${p};\n                wR += ${l}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${c}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ${e} currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${i?n?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let b=`${e}(${e}(${e}(`+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(b="avgValue / count");const x=4*Math.floor(s/4),T=s%4,E=`\n      if (${v}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${o}, ${a}, ${h});\n      const ivec3 pads = ivec3(${m}, ${g}, ${y});\n      const float initializationValue = ${_};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${_});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${d};\n            wD += ${u}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p};\n            wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${x}; wC += 4) {\n              int xC = xCCorner + wC * ${c};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${c}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${c}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${c}, ch)\n              );\n\n              ${E}\n            }\n\n            int xC = xCCorner + ${x};\n            if (${1===T}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${E}\n            } else if (${2===T}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${c}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${E}\n            } else if (${3===T}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${c}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${c}, ch),\n                initializationValue\n              );\n\n              ${E}\n            }\n          }\n          setOutput(${b});\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F0{constructor(t,e){this.variableNames=["x"];const r=t.windowSize,i=t.batchSize,n=t.inSize,s=Math.ceil(n/r);this.outputShape=[i,s];let o="0.0",a="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",a="min"):"max"===e&&(o="-1.0 / 1e-20",a="max");let h=`${e}(${e}(${e}(`+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?h="sumValue":"prod"===e?h="prodValue":"all"===e?h="allValue":"any"===e&&(h="anyValue");const u=4*Math.floor(r/4),l=r%4;let c=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${a}(values, minMaxValue);\n      }\n    `,d="vec4";"all"===e?(o="1.0",c="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(o="0.0",c="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let p="";n%r>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${n}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${o};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        vec4 minMaxValue = vec4(${o});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${c}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===l}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${c}\n        } else if (${2===l}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${c}\n        } else if (${3===l}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${c}\n        }\n        setOutput(${h});\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L0{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let r="";for(let t=0;t<4;t++){let e="thisRC = rc;";t%2==1&&(e+="thisRC.z += 1;"),t>1&&(e+="thisRC.y += 1;"),r+=`\n        ${e}\n        ${t>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${t}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${t>0?"}":""}\n      `}var i;
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */this.userCode=`\n      ${i=e,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${iQ(["r","c","d"],i)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${nQ(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${t[1]};\n        int cols = ${t[2]};\n\n        ${r}\n\n        setOutput(result);\n      }\n    `}}class k0{constructor(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;const[,i,n]=e.shape,[,s,o]=t.shape,a=[r&&s>1?i-1:i,r&&o>1?n-1:n],h=[r&&s>1?s-1:s,r&&o>1?o-1:o],u=a[0]/h[0],l=a[1]/h[1],c=1/u,d=1/l,p=2*Math.ceil(c)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${l});\n\n        const float invHeightScale = float(${c});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${s}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${n-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U0{constructor(t,e,r,i){this.variableNames=["A"],this.outputShape=[];const[n,s,o,a]=t;this.outputShape=[n,e,r,a];const h=[i&&e>1?s-1:s,i&&r>1?o-1:o],u=[i&&e>1?e-1:e,i&&r>1?r-1:r];this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${h[0]/u[0]},\n          ${h[1]/u[1]});\n      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B0{constructor(t,e,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[n,s,o,a]=t;this.outputShape=[n,e,r,a];const h=[i&&e>1?s-1:s,i&&r>1?o-1:o],u=[i&&e>1?e-1:e,i&&r>1?r-1:r];this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${h[0]/u[0]},\n          ${h[1]/u[1]},\n          ${h[1]/u[1]});\n      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,\n                                     ${o}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${a-1};\n        bool hasNextRow = coords.z < ${r-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j0{constructor(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;const[,i,n]=e.shape,[,s,o]=t.shape,a=[r&&s>1?i-1:i,r&&o>1?n-1:n],h=[r&&s>1?s-1:s,r&&o>1?o-1:o],u=a[0]/h[0],l=a[1]/h[1],c=1/u,d=1/l,p=2*Math.ceil(c)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${l});\n\n        const float invHeightScale = float(${c});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${s}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${a[0]}) *\n                (float(dyR) / float(${h[0]}));\n\n            float sourceFracCol =\n                float(${a[1]}) *\n                  (float(dyC) / float(${h[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${i}) - 1),\n                ${r} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${n}) - 1),\n                ${r} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X0{constructor(t,e,r,i){this.variableNames=["A"],this.outputShape=[];const[n,s,o,a]=t;this.outputShape=[n,e,r,a];const h=[i&&e>1?s-1:s,i&&r>1?o-1:o],u=[i&&e>1?e-1:e,i&&r>1?r-1:r],l=i?"0.5":"0.0";this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${h[0]/u[0]},\n          ${h[1]/u[1]});\n      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${l})));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G0{constructor(t,e){this.variableNames=["x"];const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,1===r)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const i=t.map((r,i)=>(r=>-1!==e.indexOf(r)&&1!==t[r]?`${t[r]} - coords[${r}] - 1`:`coords[${r}]`)(i)).join(","),n=yQ(r);this.userCode=`\n      void main() {\n        ${n} coords = getOutputCoords();\n        setOutput(getX(${i}));\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z0{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;const i=eQ("rc",r),n=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,s=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,o=yQ(r);function a(r){const i=t.map((i,n)=>function(r,i){return-1!==e.indexOf(r)&&1!==t[r]?`${t[r]} - ${i[r]} - 1`:`${i[r]}`}(n,r));return`getChannel(getX(${i.join(",")}), vec2(${i.slice(-2).join(",")}))`}this.userCode=1===r?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${n}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${o} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(t){return a(t)}(i.slice())};\n          if(${n}){\n            result.g = ${function(t){return t[r-1]="("+t[r-1]+" + 1)",a(t)}(i.slice())};\n          }\n          if(${s}) {\n            result.b = ${function(t){return t[r-2]="("+t[r-2]+" + 1)",a(t)}(i.slice())};\n            if(${n}) {\n              result.a = ${function(t){return t[r-1]="("+t[r-1]+" + 1)",t[r-2]="("+t[r-2]+" + 1)",a(t)}(i.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V0{constructor(t,e,r,i,n,s,o=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;const a=yQ(n.length),h=yQ(s.length);let u="";1===r?u="i":2===r&&(u="i, j");const l=`getIndices(${u})`;let c="";1===i?c="i":2===i&&(c="i, coords[1]");const d=`getUpdates(${c})`,p=e>1?"strides[j]":"strides";this.userCode=`\n        ${a} strides = ${a}(${n});\n\n        void main() {\n          ${h} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(${l});\n              flattenedIndex += index * ${p};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${d};\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H0{constructor(t,e){this.variableNames=["x","segmentIds"];const r=t.windowSize,i=t.batchSize,n=t.inSize,s=t.numSegments,o=s*Math.ceil(n/r);this.outputShape=[i,o];const a=4*Math.floor(r/4),h=r%4,u="\n        sumValue += dot(values, segFilter);\n    ";let l="";n%r>0&&(l=`\n        if (inIdx < 0 || inIdx >= ${n}) {\n          return initializationValue;\n        }\n      `);let c="";n%r>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${n}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${l}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${c}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${s})) * float(${r}));\n        int currentSeg = int(mod(float(outIdx), float(${s})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${a}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${a};\n        if (${1===h}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${u}\n        } else if (${2===h}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${u}\n        } else if (${3===h}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $0{constructor(t,e,r){let i,n;if(this.variableNames=["c","a","b"],this.outputShape=e,r>4)throw Error(`Where for rank ${r} is not yet supported`);if(1===r)n="resRC",i="resRC";else{const r=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[];for(let i=0;i<e.length;i++)o.push(`${r[i]}`),i<t&&s.push(`${r[i]}`);i=s.join(),n=o.join()}const s=yQ(r);this.userCode=`\n      void main() {\n        ${s} resRC = getOutputCoords();\n        float cVal = getC(${i});\n        if (cVal >= 1.0) {\n          setOutput(getA(${n}));\n        } else {\n          setOutput(getB(${n}));\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W0{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=yQ(this.rank),r=`uniform int start[${this.rank}];`,i=function(t){if(1===t)return"sourceLoc";if(t<=6)return Y0.slice(0,t).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(this.rank);let n;n=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${t.map((t,e)=>`sourceLoc.${Y0[e]} = start[${e}] + coords.${Y0[e]};`).join("\n")}\n      `,this.userCode=`\n      ${r}\n      void main() {\n        ${n}\n        setOutput(getSource(${i}));\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the `+`length of start (${t.length})`);return(e,r)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(r,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}const Y0=["x","y","z","w","u","v"];class q0{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;const e=yQ(this.rank),r=eQ("coords",this.rank),i=eQ("sourceLoc",this.rank),n=1===this.rank?"sourceLoc":`vec2(${i.slice(-2).join()})`,s=`getChannel(getSource(${i.join()}), ${n})`,o=`\n      result.x = ${s};\n      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${i[this.rank-1]};\n        result.y = ${s};\n        --${i[this.rank-1]};\n      }\n    `,a=1===this.rank?"":`\n      --${r[this.rank-1]};\n      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${i[this.rank-2]};\n        result.z = ${s};\n        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${i[this.rank-1]};\n          result.w = ${s};\n        }\n      }\n    `,h=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map((t,e)=>`start[${e}]`).join()});`:t.map((t,e)=>`${i[e]} = ${r[e]} + start[${e}];`).join("\n");this.userCode=`\n      uniform int start[${this.rank}];\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${h}\n        vec4 result = vec4(0.);\n        ${o}\n        ${a}\n        setOutput(result);\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the `+`length of start (${t.length})`);return(e,r)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(r,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K0{constructor(t,e,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,n=yQ(r.length),s=yQ(r.length);let o="";if(1===i)o="coords * strides + begin";else{let t=0;o=r.map((e,i)=>(t++,1===r.length?`coords * strides[${i}] + begin[${i}]`:`coords[${t-1}] * strides[${i}] + begin[${i}]`)).join(",")}this.userCode=`\n      ${n} begin = ${n}(${t});\n      ${n} strides = ${n}(${e});\n\n      void main() {\n        ${s} coords = getOutputCoords();\n        setOutput(getX(${o}));\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z0{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,r){const i=J0(e,r),n=Q0(t,i,r);if(n in this.freeTextures||(this.freeTextures[n]=[]),n in this.usedTextures||(this.usedTextures[n]=[]),this.freeTextures[n].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();const t=this.freeTextures[n].shift();return this.usedTextures[n].push(t),t}let s;return this.numUsedTextures++,this.log(),i===xJ.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===xJ.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===xJ.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===xJ.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===xJ.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[n].push(s),s}releaseTexture(t,e,r,i){if(null==this.freeTextures)return;const n=Q0(e,J0(r,i),i);n in this.freeTextures||(this.freeTextures[n]=[]),this.freeTextures[n].push(t),this.numFreeTextures++,this.numUsedTextures--;const s=this.usedTextures[n],o=s.indexOf(t);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(o,1),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`)}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});for(const t in this.usedTextures)this.usedTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}}}function J0(t,e){if(t===bJ.UPLOAD)return xJ.PACKED_2X2_FLOAT32;if(t===bJ.RENDER||null==t)return function(t){return Object(NV.nb)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?xJ.PACKED_2X2_FLOAT32:xJ.UNPACKED_FLOAT32:t?xJ.PACKED_2X2_FLOAT16:xJ.UNPACKED_FLOAT16}(e);if(t===bJ.DOWNLOAD||t===bJ.PIXELS)return xJ.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function Q0(t,e,r){return`${t[0]}_${t[1]}_${e}_${r}`}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t1{constructor(t,e){this.variableNames=["A"];const r=new Array(t.length);for(let i=0;i<r.length;i++)r[i]=t[i]*e[i];this.outputShape=r,this.rank=r.length;const i=yQ(this.rank),n=function(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(1===e)return`imod(resRC, ${t[0]})`;const r=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],i=[];for(let e=0;e<t.length;e++)i.push(`imod(${r[e]}, ${t[e]})`);return i.join()}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t);this.userCode=`\n      void main() {\n        ${i} resRC = getOutputCoords();\n        setOutput(getA(${n}));\n      }\n    `}}class e1{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const r1="return abs(x);",i1="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",n1="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",s1=`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${NV.F.SELU_SCALEALPHA};\n  float scale = ${NV.F.SELU_SCALE};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`;const o1="return -x;",a1="return ceil(x);",h1="return floor(x);",u1="return exp(x);",l1="return exp(x) - 1.0;",c1=`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${NV.F.ERF_P};\n  float a1 = ${NV.F.ERF_A1};\n  float a2 = ${NV.F.ERF_A2};\n  float a3 = ${NV.F.ERF_A3};\n  float a4 = ${NV.F.ERF_A4};\n  float a5 = ${NV.F.ERF_A5};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`,d1="return x;",p1="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",f1="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",m1="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n";class g1{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y1{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;const e=t.length,r=eQ("rc",e),i=yQ(e),n=function(t,e){if(1===t)return"rc";let r="";for(let i=0;i<t;i++)r+=e[i],i<t-1&&(r+=",");return r}(e,r),s=r.slice(-2),o=e<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`\n      void main() {\n        ${i} rc = getOutputCoords();\n        vec4 packedInput = getA(${n});\n\n        setOutput(getChannel(packedInput, ${o}));\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{segment_util:v1}=NV.F,_1=NV.Jb.split,b1=NV.Jb.tile,x1=NV.Jb.topkImpl,T1=NV.Jb.whereImpl,E1={};function w1(t,e=!1){if("linear"===t)return"return x;";if("relu"===t)return e?p1:i1;if("elu"===t)return e?m1:"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===t)return e?f1:n1;if("prelu"===t)return e?MQ:NQ;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}class S1 extends NV.d{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Object(NV.nb)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){const t=vJ(Object(NV.nb)().getNumber("WEBGL_VERSION"));this.binaryCache=(e=Object(NV.nb)().getNumber("WEBGL_VERSION"))in E1?E1[e]:(E1[e]={},E1[e]),this.gpgpu=new _0(t),this.canvas=t.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var e;this.textureManager=new Z0(this.gpgpu),this.numMBBeforeWarning=null==Object(NV.nb)().global.screen?1024:Object(NV.nb)().global.screen.height*Object(NV.nb)().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new NV.a(this,Object(NV.mb)())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,e,r){if(Object(NV.nb)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={};return this.texData.set(i,{shape:e,dtype:r,values:t,usage:bJ.UPLOAD}),i}move(t,e,r,i){if(Object(NV.nb)().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:r,dtype:i,values:e,usage:bJ.UPLOAD})}readSync(t){const e=this.texData.get(t),{values:r,dtype:i,complexTensors:n,slice:s,shape:o,isPacked:a}=e;if(null!=s){let e;e=a?new g1(o,d1):new e1(o,d1);const r=this.runWebGLProgram(e,[{dataId:t,shape:o,dtype:i}],i),n=this.readSync(r.dataId);return this.disposeData(r.dataId),n}if(null!=r)return this.convertAndCacheOnCPU(t);if("string"===i)return r;const h=null!=this.activeTimers;let u,l;if(h&&(u=NV.Cd.now()),"complex64"===i){const t=n.real.dataSync(),e=n.imag.dataSync();l=NV.F.mergeRealAndImagArrays(t,e)}else l=this.getValuesFromTexture(t);return h&&(this.downloadWaitMs+=NV.Cd.now()-u),this.convertAndCacheOnCPU(t,l)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise(t=>e.push(t))}const e=this.texData.get(t),{values:r,shape:i,slice:n,dtype:s,complexTensors:o,isPacked:a}=e;if(null!=n){let e;e=a?new g1(i,d1):new e1(i,d1);const r=this.runWebGLProgram(e,[{dataId:t,shape:i,dtype:s}],s),n=this.read(r.dataId);return this.disposeData(r.dataId),n}if(null!=r)return this.convertAndCacheOnCPU(t);if(!Object(NV.nb)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Object(NV.nb)().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let h,u,l=null;if("complex64"!==s&&Object(NV.nb)().get("WEBGL_BUFFER_SUPPORTED")){h=this.decode(t);const e=this.texData.get(h.dataId);l=this.gpgpu.createBufferFromTexture(e.texture,...EJ(i))}if(this.pendingRead.set(t,[]),"complex64"!==s&&await this.gpgpu.createAndWaitForFence(),"complex64"===s){const t=await Promise.all([o.real.data(),o.imag.data()]),e=t[0],r=t[1];u=NV.F.mergeRealAndImagArrays(e,r)}else if(null==l)u=this.getValuesFromTexture(t);else{const t=NV.Cd.sizeFromShape(i);u=this.gpgpu.downloadFloat32MatrixFromBuffer(l,t)}null!=h&&this.disposeData(h.dataId);const c=this.convertAndCacheOnCPU(t,u),d=this.pendingRead.get(t);return this.pendingRead.delete(t),d.forEach(t=>t(c)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),c}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const r=t[e];if(!AJ(r)){if(Object(NV.nb)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${r} cannot be represented with your `+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error(`The value ${r} cannot be represented on this device.`)}}}getValuesFromTexture(t){const{shape:e,dtype:r,isPacked:i}=this.texData.get(t),n=NV.Cd.sizeFromShape(e);if(Object(NV.nb)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const r=this.decode(t),i=this.texData.get(r.dataId),s=this.gpgpu.downloadMatrixFromPackedTexture(i.texture,...EJ(e)).subarray(0,n);return this.disposeData(r.dataId),s}const s=Object(NV.nb)().getBool("WEBGL_PACK")&&!0===i,o=s?XJ(e):e,a=s?new s0(o):new n0(o),h=this.runWebGLProgram(a,[{shape:o,dtype:r,dataId:t}],"float32"),u=this.texData.get(h.dataId),l=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture,u.texShape[0],u.texShape[1]).subarray(0,n);return this.disposeData(h.dataId),l}async time(t){const e=this.activeTimers,r=[];let i=!1;null==this.programTimersStack?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,t();const n=NV.Cd.flatten(this.activeTimers.map(t=>t.query)).filter(t=>null!=t),s=NV.Cd.flatten(this.activeTimers.map(t=>t.name)).filter(t=>null!=t);this.activeTimers=e,i&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(n);o.kernelMs=NV.Cd.sum(t),o.getExtraProfileInfo=()=>t.map((t,e)=>({name:s[e],ms:t})).map(t=>`${t.name}: ${t.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}}startTimer(){return Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:NV.Cd.now(),endMs:null}}endTimer(t){return Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=NV.Cd.now(),t)}async getQueryTime(t){if(Object(NV.nb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(!this.texData.has(t))return;this.releaseGPUData(t);const{complexTensors:e}=this.texData.get(t);null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}releaseGPUData(t){const{texture:e,dtype:r,texShape:i,usage:n,isPacked:s,slice:o}=this.texData.get(t),a=o&&o.origDataId||t,h=this.dataRefCount.get(a);h>1?this.dataRefCount.set(a,h-1):(this.dataRefCount.delete(a),null!=e&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(e,i,n,s)));const u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return Object(NV.nb)().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Object(NV.mb)().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t,e=128){return null!=this.getCPUBackend()&&t.every(t=>null==this.texData.get(t.dataId).texture&&NV.Cd.sizeFromShape(t.shape)<e)}getGPGPUContext(){return this.gpgpu}complex(t,e){const r=this.makeOutput(t.shape,"complex64");return this.texData.get(r.dataId).complexTensors={real:Object(NV.mb)().keep(t.clone()),imag:Object(NV.mb)().keep(e.clone())},r}real(t){return this.texData.get(t.dataId).complexTensors.real.clone()}imag(t){return this.texData.get(t.dataId).complexTensors.imag.clone()}slice(t,e,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,r);if(0===NV.Cd.sizeFromShape(r))return Object(NV.od)([],r,t.dtype);const{isPacked:i}=this.texData.get(t.dataId),n=NV.Xc.isSliceContinous(t.shape,e,r);if(i||!n){const i=Object(NV.nb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new q0(r):new W0(r),n=i.getCustomSetupFunc(e);return this.compileAndRun(i,[t],null,n)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,r)}shallowSlice(t,e,r){const i=this.texData.get(t.dataId),n=this.makeOutput(r,t.dtype),s=this.texData.get(n.dataId);Object.assign(s,i),s.shape=r,s.dtype=t.dtype;let o=NV.Xc.computeFlatOffset(e,t.strides);i.slice&&(o+=i.slice.flatOffset),s.slice={flatOffset:o,origDataId:i.slice&&i.slice.origDataId||t.dataId};const a=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,a+1),n}stridedSlice(t,e,r,i){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,r,i);const n=NV.Xc.computeOutShape(e,r,i);if(n.some(t=>0===t))return Object(NV.od)([],n);const s=new K0(e,i,n);return this.compileAndRun(s,[t])}reverse(t,e){const r=Object(NV.nb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new z0(t.shape,e):new G0(t.shape,e);return this.compileAndRun(r,[t])}concat(t,e){if("complex64"===t[0].dtype){const r=t.map(t=>Object(NV.xc)(t)),i=t.map(t=>Object(NV.Eb)(t));return Object(NV.R)(this.concat(r,e),this.concat(i,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>Object(NV.nb)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const r=Math.floor(t.length/2),i=this.concat(t.slice(0,r),e),n=this.concat(t.slice(r),e);return this.concat([i,n],e)}if(Object(NV.nb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){const r=new BQ(t.map(t=>t.shape),e);return this.compileAndRun(r,t)}const r=NV.F.computeOutShape(t.map(t=>t.shape),e),i=t.map(t=>t.as2D(-1,NV.Cd.sizeFromShape(t.shape.slice(e)))),n=new UQ(i.map(t=>t.shape));return this.compileAndRun(n,i).reshape(r)}neg(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(Object(NV.nb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,o1,t.dtype);const e=new e1(t.shape,o1);return this.compileAndRun(e,[t])}batchMatMul(t,e,r,i){const n=r?t.shape[2]:t.shape[1],s=i?e.shape[1]:e.shape[2],o=r?t.shape[1]:t.shape[2],[a,,]=t.shape;if((1===n||1===s)&&o>1e3){r&&(t=Object(NV.yd)(t,[0,2,1])),i&&(e=Object(NV.yd)(e,[0,2,1]));const n=1===s?t:t.as3D(a,o,1),h=1===s?2:1,u=1===s?e.as3D(a,1,o):e;return this.multiply(n,u).sum(h,!0)}const h=Object(NV.Bd)(t.dtype,e.dtype),u=new A0(t.shape,[a,n,s],r,i);return this.compileAndRun(u,[t,e],h)}fusedBatchMatMul({a:t,b:e,transposeA:r,transposeB:i,bias:n,activation:s,preluActivationWeights:o}){const a=r?t.shape[2]:t.shape[1],h=i?e.shape[1]:e.shape[2],[u,,]=t.shape,l=Object(NV.Bd)(t.dtype,e.dtype),c=null!=n,d=null!=o,p=s?w1(s,!0):null,f=new A0(t.shape,[u,a,h],r,i,c,p,d),m=[t,e];return n&&m.push(n),o&&m.push(o),this.compileAndRun(f,m,l)}multiply(t,e){if("complex64"===t.dtype){const r=this.texData.get(t.dataId),i=this.texData.get(e.dataId),n=new AQ(SQ,t.shape,e.shape),s=new AQ(IQ,t.shape,e.shape),o=[this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag),this.makeComplexComponentTensorInfo(e,i.complexTensors.real),this.makeComplexComponentTensorInfo(e,i.complexTensors.imag)],a=this.compileAndRun(n,o),h=this.compileAndRun(s,o),u=this.complex(a,h);return a.dispose(),h.dispose(),u}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,RQ,t.dtype);const r=new PQ(RQ,t.shape,e.shape);return this.compileAndRun(r,[t,e],t.dtype)}batchNorm(t,e,r,i,n,s){const o=[t,e,r];let a=null;null!=i&&(a=i.shape,o.push(i));let h=null;if(null!=n&&(h=n.shape,o.push(n)),Object(NV.nb)().getBool("WEBGL_PACK_NORMALIZATION")){const i=new wQ(t.shape,e.shape,r.shape,a,h,s);return this.compileAndRun(i,o)}const u=new EQ(t.shape,e.shape,r.shape,a,h,s);return this.compileAndRun(u,o)}localResponseNormalization4D(t,e,r,i,n){const s=Object(NV.nb)().getBool("WEBGL_PACK_NORMALIZATION")?new w0(t.shape,e,r,i,n):new T0(t.shape,e,r,i,n);return this.compileAndRun(s,[t])}LRNGrad(t,e,r,i,n,s,o){const a=new E0(e.shape,i,n,s,o);return this.compileAndRun(a,[e,r,t])}tile(t,e){if("string"===t.dtype){const r=this.readSync(t.dataId).map(t=>NV.Cd.decodeString(t)),i=Object(NV.N)(t.shape,t.dtype,r);return b1(i,e)}const r=new t1(t.shape,e);return this.compileAndRun(r,[t])}pad(t,e,r){const i=Object(NV.nb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new P0(t.shape,e,r):new N0(t.shape,e,r);return this.compileAndRun(i,[t])}gather(t,e,r){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,r);const i=new d0(t.shape,e.size,r);return this.compileAndRun(i,[t,e])}batchToSpaceND(t,e,r){NV.Cd.assert(t.rank<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const i=e.reduce((t,e)=>t*e),n=NV.F.getReshaped(t.shape,e,i),s=NV.F.getPermuted(n.length,e.length),o=NV.F.getReshapedPermuted(t.shape,e,i),a=NV.F.getSliceBeginCoords(r,e.length),h=NV.F.getSliceSize(o,r,e.length);return Object(NV.yd)(t.reshape(n),s).reshape(o).slice(a,h)}spaceToBatchND(t,e,r){NV.Cd.assert(t.rank<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const i=e.reduce((t,e)=>t*e),n=[[0,0]];n.push(...r);for(let r=1+e.length;r<t.shape.length;++r)n.push([0,0]);const s=t.pad(n),o=NV.F.getReshaped(s.shape,e,i,!1),a=NV.F.getPermuted(o.length,e.length,!1),h=NV.F.getReshapedPermuted(s.shape,e,i,!1);return Object(NV.yd)(s.reshape(o),a).reshape(h)}reduce(t,e,r){const i=t.shape[0],n=t.shape[1],s=NV.F.computeOptimalWindowSize(n),o=new F0({windowSize:s,inSize:n,batchSize:i},e),a=this.compileAndRun(o,[t],r);return 1===a.shape[1]?a:this.reduce(a,e,r)}argReduce(t,e,r=null){let i=t.shape[0],n=t.shape[1];null!=r&&(i=r.shape[0],n=r.shape[1]);const s=NV.F.computeOptimalWindowSize(n),o=new QJ({windowSize:s,inSize:n,batchSize:i},e,null==r),a=[t];null!=r&&a.push(r);const h=this.compileAndRun(o,a,"int32");return 1===h.shape[1]?h:this.argReduce(t,e,h)}argReducePacked(t,e,r=null){const i=null!=r?r.shape:t.shape,n=i[i.length-1],s=NV.F.computeOptimalWindowSize(n),o=new bQ(i,s,e,null==r),a=null==r?[t]:[t,r],h=this.compileAndRun(o,a,"int32");return h.rank===t.rank?this.argReducePacked(t,e,h):h}sum(t,e){NV.F.assertAxesAreInnerMostDims("sum",e,t.rank);const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=NV.Cd.sizeFromShape(i),s=t.as2D(-1,n),o=NV.ld(t.dtype);return this.reduce(s,"sum",o).reshape(r)}prod(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=NV.Cd.sizeFromShape(i),s=t.as2D(-1,n),o=NV.ld(t.dtype);return this.reduce(s,"prod",o).reshape(r)}unsortedSegmentSum(t,e,r){let i=0;const n=NV.F.getAxesPermutation([i],t.rank);let s=t;null!=n&&(s=Object(NV.yd)(t,n),i=NV.F.getInnerMostAxes(1,t.rank)[0]);const o=v1.computeOutShape(s.shape,i,r),a=NV.Cd.sizeFromShape([s.shape[i]]),h=s.as2D(-1,a),u=NV.ld(t.dtype);let l=this.segOpCompute(h,"unsortedSegmentSum",e,u,r).reshape(o);return null!=n&&(l=Object(NV.yd)(l,NV.F.getUndoAxesPermutation(n))),l}segOpCompute(t,e,r,i,n){const s=t.shape[0],o=t.shape[1],a=v1.segOpComputeOptimalWindowSize(o,n),h=new H0({windowSize:a,inSize:o,batchSize:s,numSegments:n},e),u=this.compileAndRun(h,[t,r],i);return u.shape[1]===n?u:(r=Object(NV.wc)(0,n).tile([o/a]),this.segOpCompute(u,e,r,i,n))}argMinMaxReduce(t,e,r){const i=[e];if(NV.F.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.rank),!Object(NV.nb)().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){const[e,n]=NV.F.computeOutAndReduceShapes(t.shape,i),s=NV.Cd.sizeFromShape(n),o=t.as2D(-1,s);return this.argReduce(o,r).reshape(e)}return this.argReducePacked(t,r)}argMin(t,e){return this.argMinMaxReduce(t,e,"min")}argMax(t,e){return this.argMinMaxReduce(t,e,"max")}cumsum(t,e,r,i){if(e!==t.rank-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${t.rank-1} `+`but got axis=${e}`);const n=new JQ(t.shape,r,i);return this.compileAndRun(n,[t])}equal(t,e){if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");const r=new PQ("return float(a == b);",t.shape,e.shape);return this.compileAndRun(r,[t,e],"bool")}notEqual(t,e){if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");const r=new PQ("return float(a != b);",t.shape,e.shape);return this.compileAndRun(r,[t,e],"bool")}less(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");const r=new PQ("return float(a < b);",t.shape,e.shape);return this.compileAndRun(r,[t,e],"bool")}lessEqual(t,e){if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");const r=new PQ("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(r,[t,e],"bool")}greater(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");const r=new PQ("return float(a > b);",t.shape,e.shape);return this.compileAndRun(r,[t,e],"bool")}greaterEqual(t,e){if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");const r=new PQ("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(r,[t,e],"bool")}logicalNot(t){const e=new e1(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])}logicalAnd(t,e){if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");const r=new PQ("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(r,[t,e],"bool")}logicalOr(t,e){if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");const r=new PQ("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(r,[t,e],"bool")}select(t,e,r){const i=new $0(t.rank,e.shape,e.rank);return this.compileAndRun(i,[t,e,r],Object(NV.Bd)(e.dtype,r.dtype))}where(t){NV.F.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return T1(t.shape,e)}topk(t,e,r){const i=t.dataSync();return x1(i,t.shape,t.dtype,e,r)}min(t,e){NV.F.assertAxesAreInnerMostDims("min",e,t.rank);const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=NV.Cd.sizeFromShape(i),s=t.as2D(-1,n);return this.reduce(s,"min",s.dtype).reshape(r)}minimum(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);const r=Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new DQ("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new PQ("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(r,[t,e])}mod(t,e){const r=Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new DQ("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new PQ("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(r,[t,e])}maximum(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);const r=Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new DQ("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new PQ("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(r,[t,e])}all(t,e){NV.F.assertAxesAreInnerMostDims("all",e,t.rank);const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=NV.Cd.sizeFromShape(i),s=t.as2D(-1,n);return this.reduce(s,"all",s.dtype).reshape(r)}any(t,e){NV.F.assertAxesAreInnerMostDims("any",e,t.rank);const[r,i]=NV.F.computeOutAndReduceShapes(t.shape,e),n=NV.Cd.sizeFromShape(i),s=t.as2D(-1,n);return this.reduce(s,"any",s.dtype).reshape(r)}floorDiv(t,e){if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");const r=new PQ("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(r,[t,e],"int32")}add(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,CQ);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);const r=Object(NV.Bd)(t.dtype,e.dtype);if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,CQ,r);const i=new PQ(CQ,t.shape,e.shape);return this.compileAndRun(i,[t,e],r)}packedUnaryOp(t,e,r){const i=new g1(t.shape,e);return this.compileAndRun(i,[t],r)}packedBinaryOp(t,e,r,i,n=!1){const s=new DQ(r,t.shape,e.shape,n);return this.compileAndRun(s,[t,e],i)}complexSeparableBinaryOp(t,e,r){const i=this.texData.get(t.dataId),n=this.texData.get(e.dataId),[s,o]=[[i.complexTensors.real,n.complexTensors.real],[i.complexTensors.imag,n.complexTensors.imag]].map(i=>{const[n,s]=i,o=this.makeComplexComponentTensorInfo(t,n),a=this.makeComplexComponentTensorInfo(e,s),h=new PQ(r,t.shape,e.shape);return this.compileAndRun(h,[o,a],Object(NV.Bd)(n.dtype,s.dtype))}),a=this.complex(s,o);return s.dispose(),o.dispose(),a}makeComplexComponentTensorInfo(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}addN(t){if(1===t.length)return t[0];if(t.length>Object(NV.nb)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(t.length/2),r=this.addN(t.slice(0,e)),i=this.addN(t.slice(e));return this.addN([r,i])}const e=t.map(t=>t.dtype).reduce((t,e)=>Object(NV.Bd)(t,e)),r=t.map(t=>t.shape),i=Object(NV.nb)().getBool("WEBGL_PACK")?new JJ(t[0].shape,r):new ZJ(t[0].shape,r);return this.compileAndRun(i,t,e)}subtract(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,OQ);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);const r=Object(NV.Bd)(t.dtype,e.dtype);if(Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,OQ,t.dtype);const i=new PQ(OQ,t.shape,e.shape);return this.compileAndRun(i,[t,e],r)}pow(t,e){const r=Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new DQ("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new PQ("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),i=Object(NV.Bd)(t.dtype,e.dtype);return this.compileAndRun(r,[t,e],i)}ceil(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(Object(NV.nb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,a1,t.dtype);const e=new e1(t.shape,a1);return this.compileAndRun(e,[t])}floor(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(Object(NV.nb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,h1,t.dtype);const e=new e1(t.shape,h1);return this.compileAndRun(e,[t])}sign(t){const e=new e1(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])}isNaN(t){const e=new e1(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")}isInf(t){const e=new e1(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")}isFinite(t){const e=new e1(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")}round(t){const e=new e1(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])}exp(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(Object(NV.nb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,u1,t.dtype);const e=new e1(t.shape,u1);return this.compileAndRun(e,[t])}expm1(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(Object(NV.nb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,l1,t.dtype);const e=new e1(t.shape,l1);return this.compileAndRun(e,[t])}softmax(t,e){const r=NV.Cd.parseAxisParam([e],t.shape),i=Object(NV.Xb)(t,r),n=NV.F.expandShapeToKeepDim(i.shape,r),s=this.subtract(t,i.reshape(n)),o=this.exp(s),a=this.sum(o,r).reshape(n);return Object(NV.ib)(o,a)}log(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(Object(NV.nb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);const e=new e1(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])}log1p(t){const e=new e1(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])}sqrt(t){const e=new e1(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])}rsqrt(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);const e=new e1(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])}reciprocal(t){const e=new e1(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])}relu(t){let e;return e=Object(NV.nb)().getBool("WEBGL_PACK")?new g1(t.shape,p1):new e1(t.shape,i1),this.compileAndRun(e,[t])}relu6(t){let e;return e=Object(NV.nb)().getBool("WEBGL_PACK")?new g1(t.shape,f1):new e1(t.shape,n1),this.compileAndRun(e,[t])}prelu(t,e){const r=Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new DQ(MQ,t.shape,e.shape):new PQ(NQ,t.shape,e.shape);return this.compileAndRun(r,[t,e])}elu(t){if(Object(NV.nb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,m1,t.dtype);const e=new e1(t.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(e,[t])}eluDer(t,e){const r=Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new DQ("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new PQ("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(r,[t,e])}selu(t){const e=new e1(t.shape,s1);return this.compileAndRun(e,[t])}int(t){const e=new e1(t.shape,"return float(int(x));");return this.compileAndRun(e,[t],"int32")}clip(t,e,r){let i;i=Object(NV.nb)().getBool("WEBGL_PACK_CLIP")?new LQ(t.shape):new FQ(t.shape);const n=i.getCustomSetupFunc(e,r);return this.compileAndRun(i,[t],null,n)}abs(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(Object(NV.nb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,r1,t.dtype);const e=new e1(t.shape,r1);return this.compileAndRun(e,[t])}complexAbs(t){const e=this.texData.get(t.dataId),r=new kQ(t.shape),i=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(r,i)}sigmoid(t){const e=new e1(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])}softplus(t){const e=new e1(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])}sin(t){const e=new e1(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])}cos(t){const e=new e1(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])}tan(t){const e=new e1(t.shape,"return tan(x);");return this.compileAndRun(e,[t])}asin(t){const e=new e1(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(e,[t])}acos(t){const e=new e1(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(e,[t])}atan(t){const e=new e1(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])}atan2(t,e){const r=Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new DQ("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new PQ("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(r,[t,e])}sinh(t){const e=new e1(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}cosh(t){const e=new e1(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}tanh(t){const e=new e1(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])}asinh(t){const e=new e1(t.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])}acosh(t){const e=new e1(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])}atanh(t){const e=new e1(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])}erf(t){const e=new e1(t.shape,c1);return this.compileAndRun(e,[t])}step(t,e){const r=new e1(t.shape,function(t=0){return"if (isnan(x)) return x;"+`\n    return x > 0.0 ? 1.0 : float(${t});\n  `}(e));return this.compileAndRun(r,[t])}conv2dByMatMul(t,e,r,i,n,s){const o=t.shape,a=this.texData.get(t.dataId),h=r.inChannels,u=o[0]*o[1]*o[2],l=r.outChannels,c="channelsLast"===r.dataFormat,d=(1===u||1===l)&&h>1e3,p=o[2]%2!=0&&!!a.isPacked;if(d||!Object(NV.nb)().getBool("WEBGL_LAZILY_UNPACK")||!Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!p){const a=c?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],h=this.reshape(t,[1,a,r.inChannels]),u=this.reshape(e,[1,r.inChannels,r.outChannels]);return this.reshape(this.fusedBatchMatMul({a:h,b:u,transposeA:!1,transposeB:!1,bias:i,activation:n,preluActivationWeights:s}),r.outShape)}const f=c?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),m={dataId:t.dataId,shape:[1,f,r.inChannels],dtype:t.dtype},g=a.shape;a.shape=a.shape.slice(),a.shape[a.shape.length-2]++,NV.Cd.assert(zJ(a.shape,m.shape),()=>`packed reshape ${a.shape} to ${m.shape} isn't free`);const y=this.reshape(e,[1,r.inChannels,r.outChannels]),v=this.fusedBatchMatMul({a:m,b:y,transposeA:!1,transposeB:!1,bias:i,activation:n,preluActivationWeights:s}),_=this.texData.get(v.dataId);return NV.Cd.assert(_.isPacked,()=>"batchMatMul result is expected to be packed"),a.shape=g,_.shape=r.outShape,Object(NV.mb)().makeTensorFromDataId(v.dataId,r.outShape,v.dtype)}conv2dWithIm2Row(t,e,r,i,n,s){const{filterWidth:o,filterHeight:a,inChannels:h,outWidth:u,outHeight:l,dataFormat:c}=r,d="channelsLast"===c,p=o*a*h,f=l*u,m=[p,f],g=t.squeeze([0]),y=e.reshape([1,p,-1]),v=new x0(m,g.shape,r),_=this.compileAndRun(v,[g]).reshape([1,m[0],m[1]]),b=null!=i,x=null!=s,T=n?w1(n,!0):null,E=new A0(_.shape,[1,f,r.outChannels],!0,!1,b,T,x),w=[_,y];i&&w.push(i),x&&w.push(s);const S=this.compileAndRun(E,w);return d?S.reshape([1,l,u,r.outChannels]):S.reshape([1,r.outChannels,l,u])}fusedConv2d({input:t,filter:e,convInfo:r,bias:i,activation:n,preluActivationWeights:s}){if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,e,r,i,n,s);if(Object(NV.nb)().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,r,i,n,s);const o=null!=i,a=null!=s,h=n?w1(n,!1):null,u=new WQ(r,o,h,a),l=[t,e];return i&&l.push(i),s&&l.push(s),this.compileAndRun(u,l)}conv2d(t,e,r){if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,e,r);if(Object(NV.nb)().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,r);const i=new WQ(r);return this.compileAndRun(i,[t,e])}conv2dDerInput(t,e,r){const i=new GQ(r);return this.compileAndRun(i,[t,e])}conv2dDerFilter(t,e,r){const i=new XQ(r);return this.compileAndRun(i,[t,e])}fusedDepthwiseConv2D({input:t,filter:e,convInfo:r,bias:i,activation:n,preluActivationWeights:s}){const o=Object(NV.nb)().getBool("WEBGL_PACK_DEPTHWISECONV")&&r.strideWidth<=2&&r.outChannels/r.inChannels==1,a=n?w1(n,o):null,h=[t,e],u=null!=i,l=null!=s;let c;return u&&h.push(i),l&&h.push(s),o?(c=new KQ(r,u,a,l),this.compileAndRun(c,h)):(c=new qQ(r,u,a,l),this.compileAndRun(c,h))}depthwiseConv2D(t,e,r){let i;return Object(NV.nb)().getBool("WEBGL_PACK_DEPTHWISECONV")&&r.strideWidth<=2&&r.outChannels/r.inChannels==1?(i=new KQ(r),this.compileAndRun(i,[t,e])):(i=new qQ(r),this.compileAndRun(i,[t,e]))}depthwiseConv2DDerInput(t,e,r){const i=new $Q(r);return this.compileAndRun(i,[t,e])}depthwiseConv2DDerFilter(t,e,r){const i=new HQ(r);return this.compileAndRun(i,[t,e])}conv3d(t,e,r){const i=new YQ(r);return this.compileAndRun(i,[t,e])}conv3dDerInput(t,e,r){const i=new VQ(r);return this.compileAndRun(i,[t,e])}conv3dDerFilter(t,e,r){const i=new zQ(r);return this.compileAndRun(i,[t,e])}maxPool(t,e){const r=new M0(e,"max",!1);return this.compileAndRun(r,[t])}avgPool(t,e){const r=new M0(e,"avg",!1);return this.compileAndRun(r,[t],"float32")}maxPoolBackprop(t,e,r,i){const n=new M0(i,"max",!0),s=this.compileAndRun(n,[e]),o=new S0(i),a=this.compileAndRun(o,[t,s],e.dtype);return s.dispose(),a}avgPoolBackprop(t,e,r){const i=new xQ(r);return this.compileAndRun(i,[t],e.dtype)}cast(t,e){return NV.F.castTensor(t,e,this)}unstack(t,e){const r=t.shape[e],i=new Array(t.rank-1);let n=0;for(let r=0;r<t.rank;r++)r!==e&&(i[n++]=t.shape[r]);const s=new Array(t.rank).fill(0),o=t.shape.slice();o[e]=1;const a=new Array(r);for(let r=0;r<a.length;r++)s[e]=r,a[r]=this.slice(t,s,o).reshape(i);return a}avgPool3d(t,e){const r=new D0(e,"avg",!1);return this.compileAndRun(r,[t],"float32")}avgPool3dBackprop(t,e,r){const i=new TQ(r);return this.compileAndRun(i,[t],e.dtype)}maxPool3d(t,e){const r=new D0(e,"max",!1);return this.compileAndRun(r,[t],"float32")}maxPool3dBackprop(t,e,r,i){const n=new D0(i,"max",!0),s=this.compileAndRun(n,[e]),o=new I0(i),a=this.compileAndRun(o,[t,s],e.dtype);return s.dispose(),a}reshape(t,e){const r=this.texData.get(t.dataId);if(r.isPacked&&!zJ(t.shape,e)&&(null===r.texture||!zJ(r.shape,e))){const r=this.packedReshape(t,e);return Object(NV.mb)().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return NV.F.reshapeTensor(t,e)}resizeBilinear(t,e,r,i){const n=Object(NV.nb)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new B0(t.shape,e,r,i):new U0(t.shape,e,r,i);return this.compileAndRun(n,[t],"float32")}resizeBilinearBackprop(t,e,r){const i=new k0(t,e,r);return this.compileAndRun(i,[t])}resizeNearestNeighbor(t,e,r,i){const n=new X0(t.shape,e,r,i);return this.compileAndRun(n,[t])}resizeNearestNeighborBackprop(t,e,r){const i=new j0(t,e,r);return this.compileAndRun(i,[t])}multinomial(t,e,r,i){const n=e?t:Object(NV.Yc)(t),s=n.shape[0],o=n.shape[1],a=new C0(s,o,r),h=a.getCustomSetupFunc(i);return this.compileAndRun(a,[n],"int32",h)}oneHot(t,e,r,i){const n=new O0(t.size,e,r,i);return this.compileAndRun(n,[t])}diag(t){const e=new i0(t.size);return this.compileAndRun(e,[t])}cropAndResize(t,e,r,i,n,s){const o=new ZQ(t.shape,e.shape,i,n,s);return this.compileAndRun(o,[t,e,r],"float32")}depthToSpace(t,e,r){NV.Cd.assert(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`);const i=t.shape[0],n="NHWC"===r?t.shape[1]:t.shape[2],s="NHWC"===r?t.shape[2]:t.shape[3],o="NHWC"===r?t.shape[3]:t.shape[1],a=n*e,h=s*e,u=o/(e*e),l=new r0("NHWC"===r?[i,a,h,u]:[i,u,a,h],e,r);return this.compileAndRun(l,[t])}split(t,e,r){return _1(t,e,r)}scatterND(t,e,r){const{sliceRank:i,numUpdates:n,sliceSize:s,strides:o,outputSize:a}=NV.F.calculateShapes(e,t,r),h=[a/s,s],u=t.reshape([n,i]),l=e.reshape([n,s]);if(0===a)return NV.F.reshapeTensor(Object(NV.od)([]),r);const c=Object(NV.Hc)(0),d=new V0(n,i,u.rank,l.rank,o,h);return this.compileAndRun(d,[l,u,c]).reshape(r)}sparseToDense(t,e,r,i){const{sliceRank:n,numUpdates:s,strides:o,outputSize:a}=NV.F.calculateShapes(e,t,r),h=new V0(s,n,t.rank,e.rank,o,[a,1],!1);return this.compileAndRun(h,[e,t,i]).reshape(r)}fft(t){return this.fftImpl(t,!1)}ifft(t){return this.fftImpl(t,!0)}fftImpl(t,e){const r=this.texData.get(t.dataId),i=new l0(h0,t.shape,e),n=new l0(u0,t.shape,e),s=[this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],o=this.compileAndRun(i,s),a=this.compileAndRun(n,s),h=this.complex(o,a).as2D(t.shape[0],t.shape[1]);return o.dispose(),a.dispose(),h}gatherND(t,e){const r=e.shape,i=r[r.length-1],[n,s,o,a]=NV.F.prepareAndValidate(t,e),h=e.reshape([s,i]),u=t.reshape([t.size/o,o]),l=new p0(i,a,[s,o]);return this.compileAndRun(l,[u,h]).reshape(n)}fill(t,e,r){if("string"===(r=r||NV.Cd.inferDtype(e))){const i=NV.Cd.getArrayFromDType(r,NV.Cd.sizeFromShape(t));return i.fill(e),Object(NV.mb)().makeTensor(i,t,r,this)}{const i=new c0(t,e),n=i.getCustomSetupFunc(e);return this.compileAndRun(i,[],r,n)}}onesLike(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)}zerosLike(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)}linspace(t,e,r){return NV.F.linspaceImpl(t,e,r)}makeTensorInfo(t,e){const r=this.write(null,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e){const{dataId:r}=this.makeTensorInfo(t,e);return Object(NV.mb)().makeTensorFromDataId(r,t,e,this)}unpackTensor(t){const e=new y1(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new R0(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const r=[BJ(t.shape),...jJ(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},n=[BJ(e),...jJ(e)],s=new L0(n,r),o=this.runWebGLProgram(s,[i],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}}decode(t){const e=this.texData.get(t),{isPacked:r,shape:i,dtype:n}=e,s=XJ(i);let o;o=r?new e0(s):new t0(s);return{dtype:n,shape:i,dataId:this.runWebGLProgram(o,[{shape:s,dtype:n,dataId:t}],n,null,!0).dataId}}runWebGLProgram(t,e,r,i,n=!1){const s=this.makeTensorInfo(t.outputShape,r),o=this.texData.get(s.dataId);if(t.packedOutput&&(o.isPacked=!0),t.outPackingScheme===_J.DENSE){const e=EJ(t.outputShape);o.texShape=e.map(t=>2*t)}if(null!=t.outTexUsage&&(o.usage=t.outTexUsage),0===NV.Cd.sizeFromShape(s.shape))return o.values=NV.Cd.getTypedArrayFromDType(s.dtype,0),s;const a=[],h=e.map(e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let r=this.texData.get(e.dataId);if(null==r.texture){if(!t.packedInputs&&NV.Cd.sizeFromShape(e.shape)<=Object(NV.nb)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:r.values};t.packedInputs&&(r.isPacked=!0,r.shape=e.shape)}else if(!!r.isPacked!=!!t.packedInputs)e=r.isPacked?this.unpackTensor(e):this.packTensor(e),a.push(e),r=this.texData.get(e.dataId);else if(r.isPacked&&!zJ(r.shape,e.shape)){const t=e,i=e.shape;e.shape=r.shape,e=this.packedReshape(e,i),a.push(e),r=this.texData.get(e.dataId),t.shape=i}return this.uploadToGPU(e.dataId),{shape:e.shape,texData:r,isUniform:!1}});this.uploadToGPU(s.dataId);const u={shape:s.shape,texData:o,isUniform:!1},l=function(t,e,r){let i="";e.concat(r).forEach(t=>{const e=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0,r=t.isUniform?"uniform":t.texData.texShape;i+=`${t.shape}_${r}_${e}`});const n=t.userCode;let s=t.constructor.name;return s+="_"+i+"_"+n,s}(t,h,u),c=this.getAndSaveBinary(l,()=>function(t,e,r,i){const n=e.userCode,s=r.map((t,r)=>{const i={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(i.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[r],shapeInfo:i}}),o=s.map(t=>t.shapeInfo),a={logicalShape:i.shape,texShape:i.texData.texShape,isUniform:!1,isPacked:i.texData.isPacked,flatOffset:null},h=aQ(s,a,n,e.packedInputs),u=t.createProgram(h);let l=null;const c=t.getUniformLocation(u,"NAN",!1);1===Object(NV.nb)().getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(u,"INFINITY",!1));const d={};for(let r=0;r<e.variableNames.length;r++){const i=e.variableNames[r],n=!1;d[i]=t.getUniformLocation(u,i,n),d[`offset${i}`]=t.getUniformLocation(u,`offset${i}`,n)}return{program:e,source:h,webGLProgram:u,uniformLocations:d,inShapeInfos:o,outShapeInfo:a,infLoc:l,nanLoc:c}}(this.gpgpu,t,h,u)),d=null!=this.activeTimers;let p;if(d&&(p=this.startTimer()),function(t,e,r,i,n){b0(e.inShapeInfos,r),b0([e.outShapeInfo],[i]);const s=i.texData.texture,o=i.texData.texShape;i.texData.isPacked?t.setOutputPackedMatrixTexture(s,o[0],o[1]):t.setOutputMatrixTexture(s,o[0],o[1]),t.setProgram(e.webGLProgram),1===Object(NV.nb)().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),r.forEach((r,i)=>{const n=e.program.variableNames[i],s=e.uniformLocations[n],o=e.uniformLocations[`offset${n}`];if(null!=s)if(r.isUniform)if(NV.Cd.sizeFromShape(r.shape)<2)t.gl.uniform1f(s,r.uniformValues[0]);else{let e=r.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(s,e)}else null!=r.texData.slice&&null!=o&&t.gl.uniform1i(o,r.texData.slice.flatOffset),t.setInputMatrixTexture(r.texData.texture,s,i)}),null!=n&&n(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,c,h,u,i),a.forEach(t=>this.disposeData(t.dataId)),d&&(p=this.endTimer(p),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(p)})),!Object(NV.nb)().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===n){const t=this.unpackTensor(s);return this.disposeData(s.dataId),t}return s}compileAndRun(t,e,r,i,n=!1){r=r||e[0].dtype;const s=this.runWebGLProgram(t,e,r,i,n);return Object(NV.mb)().makeTensorFromDataId(s.dataId,s.shape,s.dtype)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!Object(NV.nb)().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]})}this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(NV.ud)(()=>{if(!Object(NV.nb)().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Object(NV.nb)().getBool("DEBUG");Object(NV.nb)().set("DEBUG",!1);const e=this.abs(Object(NV.Hc)(1e-8)).dataSync()[0];if(Object(NV.nb)().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:r,dtype:i,values:n,texture:s,usage:o,isPacked:a}=e;if(null!=s)return;const h=null!=this.activeTimers;let u;h&&(u=NV.Cd.now());let l=e.texShape;if(null==l&&(l=function(t,e=!1){let r=Object(NV.nb)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((e,r)=>r>=t.length-2?NV.Cd.nearestLargerEven(t[r]):t[r])).length&&(t=[2,t[0]])),2!==t.length){const e=NV.Cd.squeezeShape(t);t=e.newShape}let i=NV.Cd.sizeFromShape(t);if(t.length<=1&&i<=r)return[1,i];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){const e=BJ(t);let r=2,n=2;return t.length&&([r,n]=jJ(t)),i=e*(r/2)*(n/2),NV.Cd.sizeToSquarishShape(i).map(t=>2*t)}return NV.Cd.sizeToSquarishShape(i)}(r,a),e.texShape=l),null!=n){const t=XJ(r);let s,o=l[1],c=l[0];const d=n instanceof Uint8Array;a?([o,c]=wJ(l[0],l[1]),s=new a0(t,[c,o],d)):s=new o0(t,[c,o],d);const p=this.makeTensorInfo([c,o],i);this.texData.get(p.dataId).usage=d?bJ.PIXELS:bJ.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(p.dataId),o,c,n);const f=!0,m=this.runWebGLProgram(s,[p],i,null,f),g=this.texData.get(m.dataId);e.texture=g.texture,e.texShape=g.texShape,e.isPacked=g.isPacked,e.usage=g.usage,this.disposeData(p.dataId),this.texData.delete(m.dataId),e.values=null,h&&(this.uploadWaitMs+=NV.Cd.now()-u)}else{const t=this.acquireTexture(l,o,i,a);e.texture=t}}convertAndCacheOnCPU(t,e){const r=this.texData.get(t),{dtype:i}=r;return this.releaseGPUData(t),null!=e&&(r.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const r="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<r.length;++e)r[e]=Math.round(t[e]);return r}throw new Error(`Unknown dtype ${e}`)}
/** @license See the LICENSE file. */(e,i)),r.values}acquireTexture(t,e,r,i){if(this.numBytesInGPU+=this.computeBytes(t,r),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${t} MB, `+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,i)}computeBytes(t,e){return t[0]*t[1]*NV.Cd.bytesPerElement(e)}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const I1={kernelName:NV.b,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{a:r,b:i}=t;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
return function(t,e,r){let i=new PQ("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape);return Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(i=new DQ("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",t.shape,e.shape,!0)),r.runWebGLProgram(i,[t,e],"float32")}(r,i,e)}};
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A1{constructor(t){this.variableNames=["A"];const e=rQ(),[r,i]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C1{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=rQ(),[r,i]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${i}.0, ${r}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O1={kernelName:NV.c,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:r,attrs:i}=t;let{pixels:n}=e;const{numChannels:s}=i,o="undefined"!=typeof HTMLVideoElement&&n instanceof HTMLVideoElement,a="undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement,[h,u]=o?[n.videoWidth,n.videoHeight]:[n.width,n.height],l=[u,h],c=[u,h,s];(a||o)&&(null==R1&&(R1=document.createElement("canvas").getContext("2d")),R1.canvas.width=h,R1.canvas.height=u,R1.drawImage(n,0,0,h,u),n=R1.canvas);const d=r.makeTensorInfo(l,"int32");r.texData.get(d.dataId).usage=bJ.PIXELS,r.gpgpu.uploadPixelDataToTexture(r.getTexture(d.dataId),n);const p=Object(NV.nb)().getBool("WEBGL_PACK")?new C1(c):new A1(c),f=r.runWebGLProgram(p,[d],"int32");return r.disposeData(d.dataId),f}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */};let R1;const{maxImpl:N1,transposeImpl:P1}=l;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1(t,e,r){const i=r.texData.get(t.dataId);return!i.isPacked||zJ(t.shape,e)||null!==i.texture&&zJ(i.shape,e)?{dataId:t.dataId,shape:e,dtype:t.dtype}:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,r){const i=[BJ(t.shape),...jJ(t.shape)],n={dtype:t.dtype,shape:i,dataId:t.dataId},s=[BJ(e),...jJ(e)],o=new L0(s,i),a=r.runWebGLProgram(o,[n],t.dtype,null,!0);return{dataId:a.dataId,shape:e,dtype:a.dtype}}(t,e,r)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1(t,e,r,i){const n=NV.Cd.sizeFromShape(e),s=M1(t,[NV.Cd.sizeFromShape(t.shape)/n,n],i),o=function t(e,r,i,n){const[s,o]=e.shape,a=NV.F.computeOptimalWindowSize(o),h=new F0({windowSize:a,inSize:o,batchSize:s},i),u=n.runWebGLProgram(h,[e],r);return 1===u.shape[1]?u:t(u,r,i,n)}(s,t.dtype,"max",i);return s.dataId!==t.dataId&&i.disposeData(s.dataId),M1(o,r,i)}
/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F1{constructor(t,e){this.variableNames=["A"];const r=new Array(t.length);for(let i=0;i<r.length;i++)r[i]=t[e[i]];this.outputShape=r,this.rank=r.length;const i=yQ(this.rank),n=function(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const r=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],i=new Array(e);for(let e=0;e<t.length;e++)i[t[e]]=r[e];return i.join()}
/**
 * @license
 * Copyright 2019 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(e);this.userCode=`\n    void main() {\n      ${i} resRC = getOutputCoords();\n      setOutput(getA(${n}));\n    }\n    `}}class L1{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(t.length);for(let i=0;i<r.length;i++)r[i]=t[e[i]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=yQ(this.rank),n=tQ("rc",this.rank),s=new Array(this.rank);for(let t=0;t<e.length;t++)s[e[t]]=n[t];const o=`vec2(${s.slice(-2).join()})`,a=`++${n[this.rank-1]} < ${r[this.rank-1]}`,h=`getChannel(getA(${s.join()}), ${o})`;this.userCode=`\n    void main() {\n      ${i} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${h};\n      if(${a}) {\n        result[1] = ${h};\n      }\n      --${n[this.rank-1]};\n      if(++${n[this.rank-2]} < ${r[this.rank-2]}) {\n        result[2] = ${h};\n        if(${a}) {\n          result[3] = ${h};\n        }\n      }\n      setOutput(result);\n    }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1(t,e,r){const i=Object(NV.nb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new L1(t.shape,e):new F1(t.shape,e);return r.runWebGLProgram(i,[t],t.dtype)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U1={kernelName:NV.e,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:r})=>{const{x:i}=t,{reductionIndices:n}=e,s=r,o=i.shape.length;let a=NV.Cd.parseAxisParam(n,i.shape);const h=NV.F.getAxesPermutation(a,o),u=null!=h,l=s.shouldExecuteOnCPU([i]);let c=i;if(u){if(l){const t=s.texData.get(c.dataId).values,e=new Array(o);for(let t=0;t<e.length;t++)e[t]=i.shape[h[t]];const r=P1(t,i.shape,i.dtype,h,e);c=s.makeTensorInfo(e,i.dtype),s.texData.get(c.dataId).values=r}else c=k1(i,h,s);a=NV.F.getInnerMostAxes(a.length,o)}NV.F.assertAxesAreInnerMostDims("max",a,o);const[d,p]=NV.F.computeOutAndReduceShapes(c.shape,a);let f;if(l){const t=s.texData.get(c.dataId).values,e=N1(t,NV.Cd.sizeFromShape(p),d,i.dtype);f=s.makeTensorInfo(d,i.dtype),s.texData.get(f.dataId).values=e}else f=D1(c,p,d,s);return u&&s.disposeData(c.dataId),f}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const B1={kernelName:NV.f,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:r})=>{const{x:i}=t,{filterSize:n,strides:s,pad:o,includeBatchInIndex:a}=e,h=r;NV.Cd.assert(4===i.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${i.shape.length}.`);const u=[1,1];NV.Cd.assert(NV.F.eitherStridesOrDilationsAreOne(s,u),()=>"Error in maxPool: Either strides or dilations must be 1. "+`Got strides ${s} and dilations '${u}'`);const l=NV.F.computePool2DInfo(i.shape,n,s,u,o),[c,d]=function(t,e,r,i){let n=new M0(r,"max",!1);const s=i.runWebGLProgram(n,[t],"float32");return n=new M0(r,"max",!0,!0,e),[s,i.runWebGLProgram(n,[t],"float32")]}(i,a,l,h);return[c,d]}},j1={kernelName:NV.g,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:r})=>{NV.F.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{boxes:i,scores:n}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:a}=r,h=e,u=h.readSync(i.dataId),l=h.readSync(n.dataId),c=s,d=o,p=a;return NV.Jb.nonMaxSuppressionV3(u,l,c,d,p)}},X1=NV.Jb.nonMaxSuppressionV5,G1=[U1,O1,I1,j1,{kernelName:NV.h,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:r})=>{NV.F.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{boxes:i,scores:n}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:a,softNmsSigma:h}=r,u=e,l=u.readSync(i.dataId),c=u.readSync(n.dataId),d=s,p=o,f=a,m=h,{selectedIndices:g,selectedScores:y}=X1(l,c,d,p,f,m);return[g,y]}},{kernelName:NV.j,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{x:r}=t,i=e,n=new e1(r.shape,"return x * x;");return i.runWebGLProgram(n,[r],r.dtype)}},{kernelName:NV.k,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{a:r,b:i}=t,n=e,s=Object(NV.nb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new DQ("return (a - b) * (a - b);",r.shape,i.shape):new PQ("return (a - b) * (a - b);",r.shape,i.shape);return n.compileAndRun(s,[r,i])}},{kernelName:NV.n,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:r})=>{const{x:i}=t,{perm:n}=e,s=r,o=i.shape.length,a=new Array(o);for(let t=0;t<a.length;t++)a[t]=i.shape[n[t]];let h;if(s.shouldExecuteOnCPU([i])){const t=s.texData.get(i.dataId).values,e=P1(t,i.shape,i.dtype,n,a);h=s.makeTensorInfo(a,i.dtype),s.texData.get(h.dataId).values=e}else h=k1(i,n,s);return h}},B1];
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */for(const t of G1)Object(NV.Ac)(t);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
NV.gb.isBrowser()&&Object(NV.zc)("webgl",()=>new S1,2);NV.Fd;
/** @license See the LICENSE file. */var z1=r(59),V1=function(t,e){return(V1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var H1=function(){return(H1=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function $1(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){t.done?n(t.value):new r((function(e){e(t.value)})).then(o,a)}h((i=i.apply(t,e||[])).next())}))}function W1(t,e){var r,i,n,s,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function Y1(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function q1(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o}function K1(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(q1(arguments[e]));return t}function Z1(t){return $1(this,void 0,void 0,(function(){var e,i,n,s,o;return W1(this,(function(a){switch(a.label){case 0:return"http://","https://",e="file://",0!==t.indexOf("http://")&&0!==t.indexOf("https://")?[3,3]:[4,fetch(t)];case 1:return[4,a.sent().json()];case 2:return[2,a.sent()];case 3:return 0!==t.indexOf(e)?[3,5]:(i=r(86),n=Object(z1.promisify)(i.readFile),o=(s=JSON).parse,[4,n(t.slice(e.length),{encoding:"utf-8"})]);case 4:return[2,o.apply(s,[a.sent()])];case 5:throw new Error("Unsupported URL scheme in metadata URL: "+t+". Supported schemes are: http://, https://, and (node.js-only) file://")}}))}))}var J1=null;function Q1(t){return null==J1&&(J1=Object(NV.E)().epsilon()),Object(NV.ud)((function(){var e=Object(NV.hc)(t),r=e.mean,i=e.variance;return t.sub(r).div(i.sqrt().add(J1))}))}function t2(t){return $1(this,void 0,void 0,(function(){return W1(this,(function(e){return[2,navigator.mediaDevices.getUserMedia({audio:null==t||t,video:!1})]}))}))}var e2=function(){function t(t){var e=this;if(null==t)throw new Error("Required configuration object is missing for BrowserFftFeatureExtractor constructor");if(null==t.spectrogramCallback)throw new Error("spectrogramCallback cannot be null or undefined");if(!(t.numFramesPerSpectrogram>0))throw new Error("Invalid value in numFramesPerSpectrogram: "+t.numFramesPerSpectrogram);if(t.suppressionTimeMillis<0)throw new Error("Expected suppressionTimeMillis to be >= 0, but got "+t.suppressionTimeMillis);if(this.suppressionTimeMillis=t.suppressionTimeMillis,this.spectrogramCallback=t.spectrogramCallback,this.numFrames=t.numFramesPerSpectrogram,this.sampleRateHz=t.sampleRateHz||44100,this.fftSize=t.fftSize||1024,this.frameDurationMillis=this.fftSize/this.sampleRateHz*1e3,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.overlapFactor=t.overlapFactor,this.includeRawAudio=t.includeRawAudio,NV.Cd.assert(this.overlapFactor>=0&&this.overlapFactor<1,(function(){return"Expected overlapFactor to be >= 0 and < 1, but got "+e.overlapFactor})),this.columnTruncateLength>this.fftSize)throw new Error("columnTruncateLength "+this.columnTruncateLength+" exceeds fftSize ("+this.fftSize+").");this.audioContextConstructor=window.AudioContext||window.webkitAudioContext}return t.prototype.start=function(t){return $1(this,void 0,void 0,(function(){var e,r,i;return W1(this,(function(n){switch(n.label){case 0:if(null!=this.frameIntervalTask)throw new Error("Cannot start already-started BrowserFftFeatureExtractor");return e=this,[4,t2(t)];case 1:return e.stream=n.sent(),this.audioContext=new this.audioContextConstructor,this.audioContext.sampleRate!==this.sampleRateHz&&console.warn("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate),r=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=0,r.connect(this.analyser),this.freqDataQueue=[],this.freqData=new Float32Array(this.fftSize),this.includeRawAudio&&(this.timeDataQueue=[],this.timeData=new Float32Array(this.fftSize)),i=Math.max(1,Math.round(this.numFrames*(1-this.overlapFactor))),this.tracker=new n2(i,Math.round(this.suppressionTimeMillis/this.frameDurationMillis)),this.frameIntervalTask=setInterval(this.onAudioFrame.bind(this),this.fftSize/this.sampleRateHz*1e3),[2]}}))}))},t.prototype.onAudioFrame=function(){return $1(this,void 0,void 0,(function(){var t,e,r,i;return W1(this,(function(n){switch(n.label){case 0:return this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0?[2]:(this.freqDataQueue.push(this.freqData.slice(0,this.columnTruncateLength)),this.includeRawAudio&&(this.analyser.getFloatTimeDomainData(this.timeData),this.timeDataQueue.push(this.timeData.slice())),this.freqDataQueue.length>this.numFrames&&this.freqDataQueue.shift(),this.tracker.tick()?(t=r2(this.freqDataQueue),e=i2(t,[1,this.numFrames,this.columnTruncateLength,1]),r=void 0,this.includeRawAudio&&(i=r2(this.timeDataQueue),r=i2(i,[1,this.numFrames*this.fftSize])),[4,this.spectrogramCallback(e,r)]):[3,2]);case 1:n.sent()&&this.tracker.suppress(),Object(NV.hb)([e,r]),n.label=2;case 2:return[2]}}))}))},t.prototype.stop=function(){return $1(this,void 0,void 0,(function(){return W1(this,(function(t){if(null==this.frameIntervalTask)throw new Error("Cannot stop because there is no ongoing streaming activity.");return clearInterval(this.frameIntervalTask),this.frameIntervalTask=null,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop(),[2]}))}))},t.prototype.setConfig=function(t){throw new Error("setConfig() is not implemented for BrowserFftFeatureExtractor.")},t.prototype.getFeatures=function(){throw new Error("getFeatures() is not implemented for BrowserFftFeatureExtractor. Use the spectrogramCallback field of the constructor config instead.")},t}();function r2(t){var e=t[0].length,r=new Float32Array(t.length*e);return t.forEach((function(t,i){return r.set(t,i*e)})),r}function i2(t,e){var r=new Float32Array(NV.Cd.sizeFromShape(e));return r.set(t,r.length-t.length),Object(NV.od)(r,e)}var n2=function(){function t(t,e){var r=this;this.period=t,this.suppressionTime=null==e?0:e,this.counter=0,NV.Cd.assert(this.period>0,(function(){return"Expected period to be positive, but got "+r.period}))}return t.prototype.tick=function(){return this.counter++,this.counter%this.period==0&&(null==this.suppressionOnset||this.counter-this.suppressionOnset>this.suppressionTime)},t.prototype.suppress=function(){this.suppressionOnset=this.counter},t}();function s2(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var r=new Uint8Array(e),i=0;return t.forEach((function(t){r.set(new Uint8Array(t),i),i+=t.byteLength})),r.buffer}function o2(t){var e=0;t.forEach((function(t){return e+=t.length}));var r=new Float32Array(e),i=0;return t.forEach((function(t){r.set(t,i),i+=t.length})),r}function a2(t){if(null==t)throw new Error("Received null or undefind string");for(var e=unescape(encodeURIComponent(t)),r=new Uint8Array(e.length),i=0;i<e.length;++i)r[i]=e.charCodeAt(i);return r.buffer}function h2(t){if(null==t)throw new Error("Received null or undefind buffer");var e=new Uint8Array(t);return decodeURIComponent(escape(String.fromCharCode.apply(String,K1(e))))}var u2=function(){function t(t){if(this.examples={},this.label2Ids={},null!=t)for(var e=function(t){NV.Cd.assert(null!=t,(function(){return"Received null or undefined buffer"}));var e=0,r=h2(t.slice(e,"TFJSSCDS".length));NV.Cd.assert("TFJSSCDS"===r,(function(){return"Deserialization error: Invalid descriptor"})),e+="TFJSSCDS".length,e+=4;var i=new Uint32Array(t,e,1),n=e+=4;e=n+i[0];var s=h2(t.slice(n,e));return{manifest:JSON.parse(s),data:t.slice(e)}}(t),r=0,i=0;i<e.manifest.length;++i){var n=e.manifest[i],s=n.spectrogramNumFrames*n.spectrogramFrameSize;null!=n.rawAudioNumSamples&&(s+=n.rawAudioNumSamples),s*=4,this.addExample(c2({spec:n,data:e.data.slice(r,r+s)})),r+=s}}return t.prototype.addExample=function(t){NV.Cd.assert(null!=t,(function(){return"Got null or undefined example"})),NV.Cd.assert(null!=t.label&&t.label.length>0,(function(){return"Expected label to be a non-empty string, but got "+JSON.stringify(t.label)}));var e=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}();return this.examples[e]=t,t.label in this.label2Ids||(this.label2Ids[t.label]=[]),this.label2Ids[t.label].push(e),e},t.prototype.merge=function(t){var e,r,i,n;NV.Cd.assert(t!==this,(function(){return"Cannot merge a dataset into itself"}));var s=t.getVocabulary();try{for(var o=Y1(s),a=o.next();!a.done;a=o.next()){var h=a.value,u=t.getExamples(h);try{for(var l=(i=void 0,Y1(u)),c=l.next();!c.done;c=l.next()){var d=c.value;this.addExample(d.example)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},t.prototype.getExampleCounts=function(){var t={};for(var e in this.examples){var r=this.examples[e];r.label in t||(t[r.label]=0),t[r.label]++}return t},t.prototype.getExamples=function(t){var e=this;NV.Cd.assert(null!=t,(function(){return"Expected label to be a string, but got "+JSON.stringify(t)})),NV.Cd.assert(t in this.label2Ids,(function(){return'No example of label "'+t+'" exists in dataset'}));var r=[];return this.label2Ids[t].forEach((function(t){r.push({uid:t,example:e.examples[t]})})),r},t.prototype.getData=function(t,e){var r=this;NV.Cd.assert(this.size()>0,(function(){return"Cannot get spectrograms as tensors because the dataset is empty"}));var i=this.getVocabulary();null!=t?NV.Cd.assert(-1!==i.indexOf(t),(function(){return"Label "+t+" is not in the vocabulary ("+JSON.stringify(i)+")"})):NV.Cd.assert(i.length>1,(function(){return"One-hot encoding of labels requires the vocabulary to have at least two words, but it has only "+i.length+" word."})),null==e&&(e={});var n,s,o=this.getSortedUniqueNumFrames();1===o.length?(n=null==e.numFrames?o[0]:e.numFrames,s=null==e.hopFrames?1:e.hopFrames):(n=e.numFrames,NV.Cd.assert(null!=n&&Number.isInteger(n)&&n>0,(function(){return"There are "+o.length+" unique lengths among the "+r.size()+" examples of this Dataset, hence numFrames is required. But it is not provided."})),NV.Cd.assert(n<=o[0],(function(){return"numFrames ("+n+") exceeds the minimum numFrames ("+o[0]+") among the examples of the Dataset."})),s=e.hopFrames,NV.Cd.assert(null!=s&&Number.isInteger(s)&&s>0,(function(){return"There are "+o.length+" unique lengths among the "+r.size()+" examples of this Dataset, hence hopFrames is required. But it is not provided."})));var a=null==e.normalize||e.normalize;return Object(NV.ud)((function(){for(var o,h,l,c=[],d=[],p=[],f=0;f<i.length;++f){var m=i[f];if(null==t||m===t){var g=r.label2Ids[m],y=function(i){var o,h,u=r.examples[i].spectrogram,g=u.frameSize;null==l?l=g:NV.Cd.assert(g===l,(function(){return"Mismatch in frameSize  ("+g+" vs "+l+")"}));var y=u.data.length/g,v=null;"_background_noise_"!==m&&(v=null==u.keyFrameIndex?p2(u).dataSync()[0]:u.keyFrameIndex);var _=Object(NV.rd)(u.data,[y,g,1]),b=d2(y,v,n,s),x=function(r){var i=Object(NV.ud)((function(){var t=_.slice([r[0],0,0],[r[1]-r[0],-1,-1]);return a?Q1(t):t}));e.getDataset?d.push(i.dataSync()):c.push(i),null==t&&p.push(f)};try{for(var T=(o=void 0,Y1(b)),E=T.next();!E.done;E=T.next())x(E.value)}catch(t){o={error:t}}finally{try{E&&!E.done&&(h=T.return)&&h.call(T)}finally{if(o)throw o.error}}Object(NV.hb)(_)};try{for(var v=(o=void 0,Y1(g)),_=v.next();!_.done;_=v.next())y(_.value)}catch(t){o={error:t}}finally{try{_&&!_.done&&(h=v.return)&&h.call(v)}finally{if(o)throw o.error}}}}null!=e.augmentByMixingNoiseRatio&&r.augmentByMixingNoise(e.getDataset?d:c,p,e.augmentByMixingNoiseRatio);var b=null==e.shuffle||e.shuffle;if(e.getDataset){var x=null==e.datasetBatchSize?32:e.datasetBatchSize,T=null==e.datasetValidationSplit?.15:e.datasetValidationSplit;NV.Cd.assert(T>0&&T<1,(function(){return"Invalid dataset validation split: "+T}));var E=d.map((function(t,e){return[t,p[e]]}));NV.Cd.shuffle(E),d=E.map((function(t){return t[0]}));var w=E.map((function(t){return t[1]})),S=function(t,e,r){var i,n,s,o,a,h,u,l;NV.Cd.assert(r>0&&r<1,(function(){return"validationSplit is expected to be >0 and <1, but got "+r}));for(var c=!Array.isArray(t[0]),d=e,p=[],f=0;f<d.length;++f){var m=d[f];null==p[m]&&(p[m]=[]),p[m].push(f)}var g=p.length,y=[],v=[];for(p.map((function(t){return NV.Cd.shuffle(t)})),f=0;f<g;++f)for(var _=p[f],b=Math.round(_.length*(1-r)),x=0;x<_.length;++x)x<b?y.push(_[x]):v.push(_[x]);if(c){var T=[],E=[],w=[],S=[];try{for(var I=Y1(y),A=I.next();!A.done;A=I.next()){var C=A.value;T.push(t[C]),E.push(e[C])}}catch(t){i={error:t}}finally{try{A&&!A.done&&(n=I.return)&&n.call(I)}finally{if(i)throw i.error}}try{for(var O=Y1(v),R=O.next();!R.done;R=O.next())C=R.value,w.push(t[C]),S.push(e[C])}catch(t){s={error:t}}finally{try{R&&!R.done&&(o=O.return)&&o.call(O)}finally{if(s)throw s.error}}return{trainXs:T,trainYs:E,valXs:w,valYs:S}}T=[],E=[],w=[],S=[];try{for(var N=Y1(y),P=N.next();!P.done;P=N.next())C=P.value,T.push(t[C]),E.push(e[C])}catch(t){a={error:t}}finally{try{P&&!P.done&&(h=N.return)&&h.call(N)}finally{if(a)throw a.error}}try{for(var M=Y1(v),D=M.next();!D.done;D=M.next())C=D.value,w.push(t[C]),S.push(e[C])}catch(t){u={error:t}}finally{try{D&&!D.done&&(l=M.return)&&l.call(M)}finally{if(u)throw u.error}}return{trainXs:T,trainYs:E,valXs:w,valYs:S}}(d,w,T),I=S.trainXs,A=S.trainYs,C=S.valXs,O=S.valYs,R=u.array(I).map((function(t){return Object(NV.rd)(t,[n,l,1])})),N=u.array(A).map((function(t){return Object(NV.nc)([t],i.length).squeeze([0])})),P=u.zip({xs:R,ys:N});b&&(P=P.shuffle(d.length)),P=P.batch(x).prefetch(4);var M=u.array(C).map((function(t){return Object(NV.rd)(t,[n,l,1])})),D=u.array(O).map((function(t){return Object(NV.nc)([t],i.length).squeeze([0])})),F=u.zip({xs:M,ys:D});return[P,F=F.batch(x).prefetch(4)]}if(b){var L=[];c.forEach((function(t,e){L.push({x:t,y:p[e]})})),NV.Cd.shuffle(L),c=L.map((function(t){return t.x})),p=L.map((function(t){return t.y}))}var k=null==t?Object(NV.nc)(Object(NV.pd)(p,"int32"),i.length).asType("float32"):void 0;return{xs:Object(NV.hd)(c),ys:k}}))},t.prototype.augmentByMixingNoise=function(t,e,r){var i,n;if(null==t||0===t.length)throw new Error("Cannot perform augmentation because data is null or empty");for(var s=t[0]instanceof Float32Array,o=this.getVocabulary(),a=[],h=[],u=0;u<e.length;++u)"_background_noise_"===o[e[u]]?a.push(u):h.push(u);if(0===a.length)throw new Error("Cannot perform augmentation by mixing with noise when there is no example with label _background_noise_");var l=[],c=[],d=function(i){var n=a[function(t,e){return Math.floor((e-t)*Math.random())+t}(0,a.length)],o=s?Object(NV.pd)(t[i]):t[i],h=s?Object(NV.pd)(t[n]):t[n],u=Object(NV.ud)((function(){return Q1(o.add(h.mul(r)))}));s?l.push(u.dataSync()):l.push(u),c.push(e[i])};try{for(var p=Y1(h),f=p.next();!f.done;f=p.next())d(f.value)}catch(t){i={error:t}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(i)throw i.error}}console.log("Data augmentation: mixing noise: added "+l.length+" examples"),l.forEach((function(e){return t.push(e)})),e.push.apply(e,K1(c))},t.prototype.getSortedUniqueNumFrames=function(){for(var t,e,r=new Set,i=this.getVocabulary(),n=0;n<i.length;++n){var s=i[n],o=this.label2Ids[s];try{for(var a=(t=void 0,Y1(o)),h=a.next();!h.done;h=a.next()){var u=h.value,l=this.examples[u].spectrogram,c=l.data.length/l.frameSize;r.add(c)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}}var d=K1(r);return d.sort(),d},t.prototype.removeExample=function(t){if(!(t in this.examples))throw new Error("Nonexistent example UID: "+t);var e=this.examples[t].label;delete this.examples[t];var r=this.label2Ids[e].indexOf(t);this.label2Ids[e].splice(r,1),0===this.label2Ids[e].length&&delete this.label2Ids[e]},t.prototype.setExampleKeyFrameIndex=function(t,e){if(!(t in this.examples))throw new Error("Nonexistent example UID: "+t);var r=this.examples[t].spectrogram,i=r.data.length/r.frameSize;NV.Cd.assert(e>=0&&e<i&&Number.isInteger(e),(function(){return"Invalid keyFrameIndex: "+e+". Must be >= 0, < "+i+", and an integer."})),r.keyFrameIndex=e},t.prototype.size=function(){return Object.keys(this.examples).length},t.prototype.durationMillis=function(){var t=0;for(var e in this.examples){var r=this.examples[e].spectrogram,i=23.22|r.frameDurationMillis;t+=r.data.length/r.frameSize*i}return t},t.prototype.empty=function(){return 0===this.size()},t.prototype.clear=function(){this.examples={}},t.prototype.getVocabulary=function(){var t=new Set;for(var e in this.examples){var r=this.examples[e];t.add(r.label)}var i=K1(t);return i.sort(),i},t.prototype.serialize=function(t){var e,r,i,n,s=this.getVocabulary();NV.Cd.assert(!this.empty(),(function(){return"Cannot serialize empty Dataset"})),null!=t&&(Array.isArray(t)||(t=[t]),t.forEach((function(t){if(-1===s.indexOf(t))throw new Error('Word label "'+t+'" does not exist in the vocabulary of this dataset. The vocabulary is: '+JSON.stringify(s)+".")})));var o=[],a=[];try{for(var h=Y1(s),u=h.next();!u.done;u=h.next()){var l=u.value;if(null==t||-1!==t.indexOf(l)){var c=this.label2Ids[l];try{for(var d=(i=void 0,Y1(c)),p=d.next();!p.done;p=d.next()){var f=p.value,m=l2(this.examples[f]);o.push(m.spec),a.push(m.data)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(i)throw i.error}}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}return function(t){var e=a2(JSON.stringify(t.manifest)),r=a2("TFJSSCDS"),i=new Uint32Array([1]),n=new Uint32Array([e.byteLength]);return s2([s2([r,i.buffer,n.buffer]),e,t.data])}({manifest:o,data:s2(a)})},t}();function l2(t){var e=null!=t.rawAudio,r={label:t.label,spectrogramNumFrames:t.spectrogram.data.length/t.spectrogram.frameSize,spectrogramFrameSize:t.spectrogram.frameSize};null!=t.spectrogram.keyFrameIndex&&(r.spectrogramKeyFrameIndex=t.spectrogram.keyFrameIndex);var i=t.spectrogram.data.buffer.slice(0);return e&&(r.rawAudioNumSamples=t.rawAudio.data.length,r.rawAudioSampleRateHz=t.rawAudio.sampleRateHz,i=s2([i,t.rawAudio.data.buffer])),{spec:r,data:i}}function c2(t){var e={frameSize:t.spec.spectrogramFrameSize,data:new Float32Array(t.data.slice(0,4*t.spec.spectrogramFrameSize*t.spec.spectrogramNumFrames))};null!=t.spec.spectrogramKeyFrameIndex&&(e.keyFrameIndex=t.spec.spectrogramKeyFrameIndex);var r={label:t.spec.label,spectrogram:e};return null!=t.spec.rawAudioNumSamples&&(r.rawAudio={sampleRateHz:t.spec.rawAudioSampleRateHz,data:new Float32Array(t.data.slice(4*t.spec.spectrogramFrameSize*t.spec.spectrogramNumFrames))}),r}function d2(t,e,r,i){if(NV.Cd.assert(Number.isInteger(t)&&t>0,(function(){return"snippetLength must be a positive integer, but got "+t})),null!=e&&NV.Cd.assert(Number.isInteger(e)&&e>=0,(function(){return"focusIndex must be a non-negative integer, but got "+e})),NV.Cd.assert(Number.isInteger(r)&&r>0,(function(){return"windowLength must be a positive integer, but got "+r})),NV.Cd.assert(Number.isInteger(i)&&i>0,(function(){return"windowHop must be a positive integer, but got "+i})),NV.Cd.assert(r<=t,(function(){return"windowLength ("+r+") exceeds snippetLength ("+t+")"})),NV.Cd.assert(e<t,(function(){return"focusIndex ("+e+") equals or exceeds snippetLength ("+t+")"})),r===t)return[[0,t]];var n=[];if(null==e){for(var s=0;s+r<=t;)n.push([s,s+r]),s+=i;return n}var o=Math.floor(r/2),a=e-o;for(a<0?a=0:a+r>t&&(a=t-r);!(a-i<0||e>=a-i+r);)a-=i;for(;a+r<=t&&!(e<a);)n.push([a,a+r]),a+=i;return n}function p2(t){return Object(NV.ud)((function(){return function(t){return Object(NV.ud)((function(){var e=t.data.length/t.frameSize;return Object(NV.qd)(t.data,[e,t.frameSize]).mean(-1)}))}(t).argMax()}))}var f2="tfjs-speech-commands-saved-model-metadata",m2="indexeddb://tfjs-speech-commands-model/",g2={localStorage:"undefined"==typeof window?null:window.localStorage};var y2=function(){function t(e,r,i){this.MODEL_URL_PREFIX="https://storage.googleapis.com/tfjs-models/tfjs/speech-commands/v"+function(t){return t.split(".").slice(0,2).join(".")}("0.4.2")+"/browser_fft",this.SAMPLE_RATE_HZ=44100,this.FFT_SIZE=1024,this.DEFAULT_SUPPRESSION_TIME_MILLIS=0,this.streaming=!1,this.transferRecognizers={},NV.Cd.assert(null==r&&null==i||null!=r&&null!=i,(function(){return"modelURL and metadataURL must be both provided or both not provided."})),null==r?(null==e?e=t.DEFAULT_VOCABULARY_NAME:NV.Cd.assert(-1!==t.VALID_VOCABULARY_NAMES.indexOf(e),(function(){return"Invalid vocabulary name: '"+e+"'"})),this.vocabulary=e,this.modelArtifactsOrURL=this.MODEL_URL_PREFIX+"/"+this.vocabulary+"/model.json",this.metadataOrURL=this.MODEL_URL_PREFIX+"/"+this.vocabulary+"/metadata.json"):(NV.Cd.assert(null==e,(function(){return"vocabulary name must be null or undefined when modelURL is provided"})),this.modelArtifactsOrURL=r,this.metadataOrURL=i),this.parameters={sampleRateHz:this.SAMPLE_RATE_HZ,fftSize:this.FFT_SIZE}}return t.prototype.listen=function(t,e){return $1(this,void 0,void 0,(function(){var r,i,n,s,o,a=this;return W1(this,(function(h){switch(h.label){case 0:if(this.streaming)throw new Error("Cannot start streaming again when streaming is ongoing.");return[4,this.ensureModelLoaded()];case 1:if(h.sent(),null==e&&(e={}),r=null==e.probabilityThreshold?0:e.probabilityThreshold,e.includeEmbedding&&(r=0),NV.Cd.assert(r>=0&&r<=1,(function(){return"Invalid probabilityThreshold value: "+r})),i=null!=e.invokeCallbackOnNoiseAndUnknown&&e.invokeCallbackOnNoiseAndUnknown,e.includeEmbedding&&(i=!0),e.suppressionTimeMillis<0)throw new Error("suppressionTimeMillis is expected to be >= 0, but got "+e.suppressionTimeMillis);return n=null==e.overlapFactor?.5:e.overlapFactor,NV.Cd.assert(n>=0&&n<1,(function(){return"Expected overlapFactor to be >= 0 and < 1, but got "+n})),s=function(n,s){return $1(a,void 0,void 0,(function(){var s,o,a,h,u,l,c,d,p,f,m;return W1(this,(function(g){switch(g.label){case 0:return s=Q1(n),e.includeEmbedding?[4,this.ensureModelWithEmbeddingOutputCreated()]:[3,2];case 1:return g.sent(),m=q1(this.modelWithEmbeddingOutput.predict(s),2),o=m[0],a=m[1],[3,3];case 2:o=this.model.predict(s),g.label=3;case 3:return[4,o.data()];case 4:return h=g.sent(),[4,(u=o.argMax(-1)).data()];case 5:return l=g.sent()[0],c=Math.max.apply(Math,K1(h)),Object(NV.hb)([o,u,s]),c<r?[2,!1]:[3,6];case 6:return d=void 0,e.includeSpectrogram?(p={},[4,n.data()]):[3,8];case 7:p.data=g.sent(),p.frameSize=this.nonBatchInputShape[1],d=p,g.label=8;case 8:return f=!0,i||"_background_noise_"!==this.words[l]&&"_unknown_"!==this.words[l]||(f=!1),f&&t({scores:h,spectrogram:d,embedding:a}),[2,f]}}))}))},o=null==e.suppressionTimeMillis?this.DEFAULT_SUPPRESSION_TIME_MILLIS:e.suppressionTimeMillis,this.audioDataExtractor=new e2({sampleRateHz:this.parameters.sampleRateHz,numFramesPerSpectrogram:this.nonBatchInputShape[0],columnTruncateLength:this.nonBatchInputShape[1],suppressionTimeMillis:o,spectrogramCallback:s,overlapFactor:n}),[4,this.audioDataExtractor.start(e.audioTrackConstraints)];case 2:return h.sent(),this.streaming=!0,[2]}}))}))},t.prototype.ensureModelLoaded=function(){return $1(this,void 0,void 0,(function(){var t,e,r,i,n=this;return W1(this,(function(s){switch(s.label){case 0:return null!=this.model?[2]:[4,this.ensureMetadataLoaded()];case 1:return s.sent(),"string"!=typeof this.modelArtifactsOrURL?[3,3]:[4,tY(this.modelArtifactsOrURL)];case 2:return t=s.sent(),[3,5];case 3:return[4,tY(NV.Gb.fromMemory(this.modelArtifactsOrURL.modelTopology,this.modelArtifactsOrURL.weightSpecs,this.modelArtifactsOrURL.weightData))];case 4:t=s.sent(),s.label=5;case 5:if(1!==t.inputs.length)throw new Error("Expected model to have 1 input, but got a model with "+t.inputs.length+" inputs");if(4!==t.inputs[0].shape.length)throw new Error("Expected model to have an input shape of rank 4, but got an input shape of rank "+t.inputs[0].shape.length);if(1!==t.inputs[0].shape[3])throw new Error("Expected model to have an input shape with 1 as the last dimension, but got input shape"+JSON.stringify(t.inputs[0].shape[3])+"}");if(2!==(e=t.outputShape).length)throw new Error("Expected loaded model to have an output shape of rank 2,but received shape "+JSON.stringify(e));if(e[1]!==this.words.length)throw new Error("Mismatch between the last dimension of model's output shape ("+e[1]+") and number of words ("+this.words.length+").");return this.model=t,this.freezeModel(),this.nonBatchInputShape=t.inputs[0].shape.slice(1),this.elementsPerExample=1,t.inputs[0].shape.slice(1).forEach((function(t){return n.elementsPerExample*=t})),this.warmUpModel(),r=this.parameters.fftSize/this.parameters.sampleRateHz*1e3,i=t.inputs[0].shape[1],this.parameters.spectrogramDurationMillis=i*r,[2]}}))}))},t.prototype.ensureModelWithEmbeddingOutputCreated=function(){return $1(this,void 0,void 0,(function(){var t,e;return W1(this,(function(r){switch(r.label){case 0:return null!=this.modelWithEmbeddingOutput?[2]:[4,this.ensureModelLoaded()];case 1:for(r.sent(),e=this.model.layers.length-2;e>=0;--e)if("Dense"===this.model.layers[e].getClassName()){t=this.model.layers[e];break}if(null==t)throw new Error("Failed to find second last dense layer in the original model.");return this.modelWithEmbeddingOutput=QW({inputs:this.model.inputs,outputs:[this.model.outputs[0],t.output]}),[2]}}))}))},t.prototype.warmUpModel=function(){var t=this;Object(NV.ud)((function(){for(var e=Object(NV.Id)([1].concat(t.nonBatchInputShape)),r=0;r<3;++r)t.model.predict(e)}))},t.prototype.ensureMetadataLoaded=function(){return $1(this,void 0,void 0,(function(){var t,e,r;return W1(this,(function(i){switch(i.label){case 0:return null!=this.words?[2]:"string"!=typeof this.metadataOrURL?[3,2]:[4,Z1(this.metadataOrURL)];case 1:return e=i.sent(),[3,3];case 2:e=this.metadataOrURL,i.label=3;case 3:if(null==(t=e).wordLabels){if(null==(r=t.words))throw new Error('Cannot find field "words" or "wordLabels" in metadata JSON file');this.words=r}else this.words=t.wordLabels;return[2]}}))}))},t.prototype.stopListening=function(){return $1(this,void 0,void 0,(function(){return W1(this,(function(t){switch(t.label){case 0:if(!this.streaming)throw new Error("Cannot stop streaming when streaming is not ongoing.");return[4,this.audioDataExtractor.stop()];case 1:return t.sent(),this.streaming=!1,[2]}}))}))},t.prototype.isListening=function(){return this.streaming},t.prototype.wordLabels=function(){return this.words},t.prototype.params=function(){return this.parameters},t.prototype.modelInputShape=function(){if(null==this.model)throw new Error("Model has not been loaded yet. Load model by calling ensureModelLoaded(), recognize(), or listen().");return this.model.inputs[0].shape},t.prototype.recognize=function(t,e){return $1(this,void 0,void 0,(function(){var r,i,n,s,o,a,h,u,l,c,d,p,f;return W1(this,(function(m){switch(m.label){case 0:return null==e&&(e={}),[4,this.ensureModelLoaded()];case 1:return m.sent(),null!=t?[3,3]:[4,this.recognizeOnline()];case 2:r=m.sent(),t=r.data,m.label=3;case 3:if(t instanceof NV.l)this.checkInputTensorShape(t),n=t,i=t.shape[0];else{if(t.length%this.elementsPerExample)throw new Error("The length of the input Float32Array "+t.length+" is not divisible by the number of tensor elements per per example expected by the model "+this.elementsPerExample+".");i=t.length/this.elementsPerExample,n=Object(NV.sd)(t,[i].concat(this.nonBatchInputShape))}return o={scores:null},e.includeEmbedding?[4,this.ensureModelWithEmbeddingOutputCreated()]:[3,5];case 4:return m.sent(),a=this.modelWithEmbeddingOutput.predict(n),s=a[0],o.embedding=a[1],[3,6];case 5:s=this.model.predict(n),m.label=6;case 6:return 1!==i?[3,8]:(h=o,[4,s.data()]);case 7:return h.scores=m.sent(),[3,10];case 8:return u=Object(NV.Ad)(s),l=u.map((function(t){return t.data()})),c=o,[4,Promise.all(l)];case 9:c.scores=m.sent(),Object(NV.hb)(u),m.label=10;case 10:return e.includeSpectrogram?(d=o,p={},t instanceof NV.l?[4,t.data()]:[3,12]):[3,14];case 11:return f=m.sent(),[3,13];case 12:f=t,m.label=13;case 13:d.spectrogram=(p.data=f,p.frameSize=this.nonBatchInputShape[1],p),m.label=14;case 14:return Object(NV.hb)(s),[2,o]}}))}))},t.prototype.recognizeOnline=function(){return $1(this,void 0,void 0,(function(){var t=this;return W1(this,(function(e){return[2,new Promise((function(e,r){t.audioDataExtractor=new e2({sampleRateHz:t.parameters.sampleRateHz,numFramesPerSpectrogram:t.nonBatchInputShape[0],columnTruncateLength:t.nonBatchInputShape[1],suppressionTimeMillis:0,spectrogramCallback:function(r){return $1(t,void 0,void 0,(function(){var t,i,n;return W1(this,(function(s){switch(s.label){case 0:return t=Q1(r),[4,this.audioDataExtractor.stop()];case 1:return s.sent(),i=e,n={},[4,t.data()];case 2:return i.apply(void 0,[(n.data=s.sent(),n.frameSize=this.nonBatchInputShape[1],n)]),t.dispose(),[2,!1]}}))}))},overlapFactor:0}),t.audioDataExtractor.start()}))]}))}))},t.prototype.createTransfer=function(t){if(null==this.model)throw new Error("Model has not been loaded yet. Load model by calling ensureModelLoaded(), recognizer(), or listen().");NV.Cd.assert(null!=t&&"string"==typeof t&&t.length>1,(function(){return"Expected the name for a transfer-learning recognized to be a non-empty string, but got "+JSON.stringify(t)})),NV.Cd.assert(null==this.transferRecognizers[t],(function(){return"There is already a transfer-learning model named '"+t+"'"}));var e=new v2(t,this.parameters,this.model);return this.transferRecognizers[t]=e,e},t.prototype.freezeModel=function(){var t,e;try{for(var r=Y1(this.model.layers),i=r.next();!i.done;i=r.next())i.value.trainable=!1}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.checkInputTensorShape=function(t){var e=this.model.inputs[0].shape.length;if(t.shape.length!==e)throw new Error("Expected input Tensor to have rank "+e+", but got rank "+t.shape.length+" that differs ");var r=t.shape.slice(1),i=this.model.inputs[0].shape.slice(1);if(!NV.Cd.arraysEqual(r,i))throw new Error("Expected input to have shape [null,"+i+"], but got shape [null,"+r+"]")},t.VALID_VOCABULARY_NAMES=["18w","directional4w"],t.DEFAULT_VOCABULARY_NAME="18w",t}(),v2=function(t){function e(e,r,i){var n=t.call(this)||this;return n.name=e,n.parameters=r,n.baseModel=i,NV.Cd.assert(null!=e&&"string"==typeof e&&e.length>0,(function(){return"The name of a transfer model must be a non-empty string, but got "+JSON.stringify(e)})),n.nonBatchInputShape=n.baseModel.inputs[0].shape.slice(1),n.words=null,n.dataset=new u2,n}return function(t,e){function r(){this.constructor=t}V1(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.collectExample=function(t,e){return $1(this,void 0,void 0,(function(){var r,i,n,s,o=this;return W1(this,(function(a){if(NV.Cd.assert(!this.streaming,(function(){return"Cannot start collection of transfer-learning example because a streaming recognition or transfer-learning example collection is ongoing"})),NV.Cd.assert(null!=t&&"string"==typeof t&&t.length>0,(function(){return"Must provide a non-empty string when collecting transfer-learning example"})),null==e&&(e={}),null!=e.durationMultiplier&&null!=e.durationSec)throw new Error("durationMultiplier and durationSec are mutually exclusive, but are both specified.");return null!=e.durationSec?(NV.Cd.assert(e.durationSec>0,(function(){return"Expected durationSec to be > 0, but got "+e.durationSec})),i=this.parameters.fftSize/this.parameters.sampleRateHz,r=Math.ceil(e.durationSec/i)):null!=e.durationMultiplier?(NV.Cd.assert(e.durationMultiplier>=1,(function(){return"Expected duration multiplier to be >= 1, but got "+e.durationMultiplier})),r=Math.round(this.nonBatchInputShape[0]*e.durationMultiplier)):r=this.nonBatchInputShape[0],null!=e.snippetDurationSec&&(NV.Cd.assert(e.snippetDurationSec>0,(function(){return"snippetDurationSec is expected to be > 0, but got "+e.snippetDurationSec})),NV.Cd.assert(null!=e.onSnippet,(function(){return"onSnippet must be provided if snippetDurationSec is provided."}))),null!=e.onSnippet&&NV.Cd.assert(null!=e.snippetDurationSec,(function(){return"snippetDurationSec must be provided if onSnippet is provided."})),n=this.parameters.fftSize/this.parameters.sampleRateHz,s=n*r,this.streaming=!0,[2,new Promise((function(i){var n=null==e.snippetDurationSec?1:e.snippetDurationSec/s,a=1-n,h=Math.round(1/n),u=0,l=-1,c=[];o.audioDataExtractor=new e2({sampleRateHz:o.parameters.sampleRateHz,numFramesPerSpectrogram:r,columnTruncateLength:o.nonBatchInputShape[1],suppressionTimeMillis:0,spectrogramCallback:function(r,n){return $1(o,void 0,void 0,(function(){var s,o,a,d,p,f,m,g,y,v,_,b,x,T,E,w,S,I,A,C;return W1(this,(function(O){switch(O.label){case 0:return null!=e.onSnippet?[3,7]:(s=Q1(r),a=(o=this.dataset).addExample,d={label:t},p={},[4,s.data()]);case 1:return d.spectrogram=(p.data=O.sent(),p.frameSize=this.nonBatchInputShape[1],p),e.includeRawAudio?(m={},[4,n.data()]):[3,3];case 2:return m.data=O.sent(),m.sampleRateHz=this.audioDataExtractor.sampleRateHz,f=m,[3,4];case 3:f=void 0,O.label=4;case 4:return a.apply(o,[(d.rawAudio=f,d)]),s.dispose(),[4,this.audioDataExtractor.stop()];case 5:return O.sent(),this.streaming=!1,this.collateTransferWords(),g=i,y={},[4,r.data()];case 6:return g.apply(void 0,[(y.data=O.sent(),y.frameSize=this.nonBatchInputShape[1],y)]),[3,13];case 7:return[4,r.data()];case 8:for(v=O.sent(),-1===l&&(l=v.length),_=l-1;0!==v[_]&&_>=0;)_--;return b=l-_-1,l=_+1,x=v.slice(v.length-b,v.length),c.push(x),null!=e.onSnippet&&e.onSnippet({data:x,frameSize:this.nonBatchInputShape[1]}),u++!==h?[3,13]:[4,this.audioDataExtractor.stop()];case 9:return O.sent(),this.streaming=!1,this.collateTransferWords(),T=function(t){if(t.length<2)throw new Error("Cannot normalize a Float32Array with fewer than 2 elements.");return null==J1&&(J1=Object(NV.E)().epsilon()),Object(NV.ud)((function(){var e=Object(NV.hc)(Object(NV.pd)(t)),r=e.mean,i=e.variance,n=r.arraySync(),s=Math.sqrt(i.arraySync()),o=Array.from(t).map((function(t){return(t-n)/(s+J1)}));return new Float32Array(o)}))}(o2(c)),E={data:T,frameSize:this.nonBatchInputShape[1]},S=(w=this.dataset).addExample,I={label:t,spectrogram:E},e.includeRawAudio?(C={},[4,n.data()]):[3,11];case 10:return C.data=O.sent(),C.sampleRateHz=this.audioDataExtractor.sampleRateHz,A=C,[3,12];case 11:A=void 0,O.label=12;case 12:S.apply(w,[(I.rawAudio=A,I)]),i(E),O.label=13;case 13:return[2,!1]}}))}))},overlapFactor:a,includeRawAudio:e.includeRawAudio}),o.audioDataExtractor.start(e.audioTrackConstraints)}))]}))}))},e.prototype.clearExamples=function(){var t=this;NV.Cd.assert(null!=this.words&&this.words.length>0&&!this.dataset.empty(),(function(){return"No transfer learning examples exist for model name "+t.name})),this.dataset.clear(),this.words=null},e.prototype.countExamples=function(){if(this.dataset.empty())throw new Error("No examples have been collected for transfer-learning model named '"+this.name+"' yet.");return this.dataset.getExampleCounts()},e.prototype.getExamples=function(t){return this.dataset.getExamples(t)},e.prototype.setExampleKeyFrameIndex=function(t,e){this.dataset.setExampleKeyFrameIndex(t,e)},e.prototype.removeExample=function(t){this.dataset.removeExample(t),this.collateTransferWords()},e.prototype.isDatasetEmpty=function(){return this.dataset.empty()},e.prototype.loadExamples=function(t,e){var r,i,n,s;void 0===e&&(e=!1);var o=new u2(t);e&&this.clearExamples();var a=o.getVocabulary();try{for(var h=Y1(a),u=h.next();!u.done;u=h.next()){var l=u.value,c=o.getExamples(l);try{for(var d=(n=void 0,Y1(c)),p=d.next();!p.done;p=d.next()){var f=p.value;this.dataset.addExample(f.example)}}catch(t){n={error:t}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(n)throw n.error}}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}this.collateTransferWords()},e.prototype.serializeExamples=function(t){return this.dataset.serialize(t)},e.prototype.collateTransferWords=function(){this.words=this.dataset.getVocabulary()},e.prototype.collectTransferDataAsTensors=function(t,e){var r=this.nonBatchInputShape[0];t=t||.25;var i=Math.round(t*r),n=this.dataset.getData(null,H1({numFrames:r,hopFrames:i},e));return{xs:n.xs,ys:n.ys}},e.prototype.collectTransferDataAsTfDataset=function(t,e,r,i){void 0===e&&(e=.15),void 0===r&&(r=32);var n=this.nonBatchInputShape[0];t=t||.25;var s=Math.round(t*n);return this.dataset.getData(null,H1({numFrames:n,hopFrames:s,getDataset:!0,datasetBatchSize:r,datasetValidationSplit:e},i))},e.prototype.train=function(t){return $1(this,void 0,void 0,(function(){var e,r=this;return W1(this,(function(i){return NV.Cd.assert(null!=this.words&&this.words.length>0,(function(){return"Cannot train transfer-learning model '"+r.name+"' because no transfer learning example has been collected."})),NV.Cd.assert(this.words.length>1,(function(){return"Cannot train transfer-learning model '"+r.name+"' because only 1 word label ('"+JSON.stringify(r.words)+"') has been collected for transfer learning. Requires at least 2."})),null!=t.fineTuningEpochs&&NV.Cd.assert(t.fineTuningEpochs>=0&&Number.isInteger(t.fineTuningEpochs),(function(){return"If specified, fineTuningEpochs must be a non-negative integer, but received "+t.fineTuningEpochs})),null==t&&(t={}),null==this.model&&this.createTransferModelFromBaseModel(),this.secondLastBaseDenseLayer.trainable=!1,this.model.compile({loss:"categoricalCrossentropy",optimizer:t.optimizer||"sgd",metrics:["acc"]}),e=null==t.fitDatasetDurationMillisThreshold?6e4:t.fitDatasetDurationMillisThreshold,this.dataset.durationMillis()>e?(console.log("Detected large dataset: total duration = "+this.dataset.durationMillis()+" ms > "+e+" ms. Training transfer model using fitDataset() instead of fit()"),[2,this.trainOnDataset(t)]):[2,this.trainOnTensors(t)]}))}))},e.prototype.trainOnDataset=function(t){return $1(this,void 0,void 0,(function(){var e,r,i,n,s,o,a,h,u;return W1(this,(function(l){switch(l.label){case 0:return NV.Cd.assert(t.epochs>0,(function(){return"Invalid config.epochs"})),e=null==t.batchSize?32:t.batchSize,r=t.windowHopRatio||.25,i=q1(this.collectTransferDataAsTfDataset(r,t.validationSplit,e,{augmentByMixingNoiseRatio:t.augmentByMixingNoiseRatio}),2),n=i[0],s=i[1],o=NV.Cd.now(),[4,this.model.fitDataset(n,{epochs:t.epochs,validationData:t.validationSplit>0?s:null,callbacks:null==t.callback?null:[t.callback]})];case 1:return a=l.sent(),console.log("fitDataset() took "+(NV.Cd.now()-o).toFixed(2)+" ms"),null!=t.fineTuningEpochs&&t.fineTuningEpochs>0?(h=NV.Cd.now(),[4,this.fineTuningUsingTfDatasets(t,n,s)]):[3,3];case 2:return u=l.sent(),console.log("fitDataset() (fine-tuning) took "+(NV.Cd.now()-h).toFixed(2)+" ms"),[2,[a,u]];case 3:return[2,a]}}))}))},e.prototype.trainOnTensors=function(t){return $1(this,void 0,void 0,(function(){var e,r,i,n,s,o,a,h,u,l;return W1(this,(function(c){switch(c.label){case 0:e=t.windowHopRatio||.25,r=this.collectTransferDataAsTensors(e,{augmentByMixingNoiseRatio:t.augmentByMixingNoiseRatio}),i=r.xs,n=r.ys,console.log("Training data: xs.shape = "+i.shape+", ys.shape = "+n.shape),c.label=1;case 1:return c.trys.push([1,,6,7]),null!=t.validationSplit?(h=function(t,e,r){return NV.Cd.assert(r>0&&r<1,(function(){return"validationSplit is expected to be >0 and <1, but got "+r})),Object(NV.ud)((function(){for(var i=e.argMax(-1).dataSync(),n=[],s=0;s<i.length;++s){var o=i[s];null==n[o]&&(n[o]=[]),n[o].push(s)}var a=n.length,h=[],u=[];for(n.map((function(t){return NV.Cd.shuffle(t)})),s=0;s<a;++s)for(var l=n[s],c=Math.round(l.length*(1-r)),d=0;d<l.length;++d)d<c?h.push(l[d]):u.push(l[d]);return{trainXs:Object(NV.zb)(t,h),trainYs:Object(NV.zb)(e,h),valXs:Object(NV.zb)(t,u),valYs:Object(NV.zb)(e,u)}}))}(i,n,t.validationSplit),s=h.trainXs,o=h.trainYs,a=[h.valXs,h.valYs]):(s=i,o=n),[4,this.model.fit(s,o,{epochs:null==t.epochs?20:t.epochs,validationData:a,batchSize:t.batchSize,callbacks:null==t.callback?null:[t.callback]})];case 2:return u=c.sent(),null!=t.fineTuningEpochs&&t.fineTuningEpochs>0?[4,this.fineTuningUsingTensors(t,s,o,a)]:[3,4];case 3:return l=c.sent(),[2,[u,l]];case 4:return[2,u];case 5:return[3,7];case 6:return Object(NV.hb)([i,n,s,o,a]),[7];case 7:return[2]}}))}))},e.prototype.fineTuningUsingTfDatasets=function(t,e,r){return $1(this,void 0,void 0,(function(){var i,n,s;return W1(this,(function(o){switch(o.label){case 0:return i=this.secondLastBaseDenseLayer.trainable,this.secondLastBaseDenseLayer.trainable=!0,n=null==t.fineTuningOptimizer?"sgd":t.fineTuningOptimizer,this.model.compile({loss:"categoricalCrossentropy",optimizer:n,metrics:["acc"]}),[4,this.model.fitDataset(e,{epochs:t.fineTuningEpochs,validationData:r,callbacks:null==t.callback?null:[t.callback]})];case 1:return s=o.sent(),this.secondLastBaseDenseLayer.trainable=i,[2,s]}}))}))},e.prototype.fineTuningUsingTensors=function(t,e,r,i){return $1(this,void 0,void 0,(function(){var n,s,o;return W1(this,(function(a){switch(a.label){case 0:return n=this.secondLastBaseDenseLayer.trainable,this.secondLastBaseDenseLayer.trainable=!0,s=null==t.fineTuningOptimizer?"sgd":t.fineTuningOptimizer,this.model.compile({loss:"categoricalCrossentropy",optimizer:s,metrics:["acc"]}),[4,this.model.fit(e,r,{epochs:t.fineTuningEpochs,validationData:i,batchSize:t.batchSize,callbacks:null==t.fineTuningCallback?null:[t.fineTuningCallback]})];case 1:return o=a.sent(),this.secondLastBaseDenseLayer.trainable=n,[2,o]}}))}))},e.prototype.evaluate=function(t){return $1(this,void 0,void 0,(function(){var e=this;return W1(this,(function(r){return NV.Cd.assert(null!=t.wordProbThresholds&&t.wordProbThresholds.length>0,(function(){return"Received null or empty wordProbThresholds"})),0,NV.Cd.assert("_background_noise_"===this.words[0],(function(){return"Cannot perform evaluation when the first tag is not _background_noise_"})),[2,Object(NV.ud)((function(){for(var r=[],i=0,n=e.collectTransferDataAsTensors(t.windowHopRatio),s=n.xs,o=n.ys.argMax(-1).dataSync(),a=e.model.predict(s),h=a.slice([0,1],[a.shape[0],a.shape[1]-1]).max(-1),u=a.shape[0],l=0;l<t.wordProbThresholds.length;++l){for(var c=t.wordProbThresholds[l],d=h.greater(Object(NV.Hc)(c)).dataSync(),p=0,f=0,m=0,g=0,y=0;y<u;++y)0===o[y]?(p++,d[y]&&m++):(f++,d[y]&&g++);var v=m/p,_=g/f;r.push({probThreshold:c,fpr:v,tpr:_}),console.log("ROC thresh="+c+": fpr="+v.toFixed(4)+", tpr="+_.toFixed(4)),l>0&&(i+=Math.abs(r[l-1].fpr-r[l].fpr)*(r[l-1].tpr+r[l].tpr)/2)}return{rocCurve:r,auc:i}}))]}))}))},e.prototype.createTransferModelFromBaseModel=function(){var t=this;NV.Cd.assert(null!=this.words,(function(){return"No word example is available for tranfer-learning model of name "+t.name}));for(var e=this.baseModel.layers,r=e.length-2;r>=0&&"dense"!==e[r].getClassName().toLowerCase();)r--;if(r<0)throw new Error("Cannot find a hidden dense layer in the base model.");this.secondLastBaseDenseLayer=e[r];var i,n=this.secondLastBaseDenseLayer.output;this.transferHead=new JW(i),this.transferHead.add(h.dense({units:this.words.length,activation:"softmax",inputShape:n.shape.slice(1),name:"NewHeadDense"}));var s=this.transferHead.apply(n);this.model=QW({inputs:this.baseModel.inputs,outputs:s})},e.prototype.modelInputShape=function(){return this.baseModel.inputs[0].shape},e.prototype.getMetadata=function(){return{tfjsSpeechCommandsVersion:"0.4.2",modelName:this.name,timeStamp:(new Date).toISOString(),wordLabels:this.wordLabels()}},e.prototype.save=function(t){return $1(this,void 0,void 0,(function(){var e,r,i;return W1(this,(function(n){return e=null!=t,t=t||_2(this.name),e||(r=g2.localStorage.getItem(f2),(i=null==r?{}:JSON.parse(r))[this.name]=this.getMetadata(),g2.localStorage.setItem(f2,JSON.stringify(i))),console.log("Saving model to "+t),[2,this.model.save(t)]}))}))},e.prototype.load=function(t){return $1(this,void 0,void 0,(function(){var e,r,i;return W1(this,(function(n){switch(n.label){case 0:if(e=null!=t,t=t||_2(this.name),!e){if(null==(r=JSON.parse(g2.localStorage.getItem(f2)))||null==r[this.name])throw new Error("Cannot find metadata for transfer model named "+this.name+'"');this.words=r[this.name].wordLabels,console.log("Loaded word list for model named "+this.name+": "+this.words)}return i=this,[4,tY(t)];case 1:return i.model=n.sent(),console.log("Loaded model from "+t+":"),this.model.summary(),[2]}}))}))},e.prototype.createTransfer=function(t){throw new Error("Creating transfer-learned recognizer from a transfer-learned recognizer is not supported.")},e}(y2);function _2(t){return""+m2+t}function b2(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x2(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var T2=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.snake=e,this.gameStatus=r}var e,r,i;return e=t,(r=[{key:"create",value:function(){var t=this,e=function(){t.gameStatus.status===OV?t.gameStatus.setPaused():t.gameStatus.setRunning()};document.addEventListener("keydown",(function(r){38!==r.keyCode&&87!==r.keyCode&&90!==r.keyCode||t.snake.up(),39!==r.keyCode&&68!==r.keyCode||t.snake.right(),40!==r.keyCode&&83!==r.keyCode||t.snake.down(),37!==r.keyCode&&65!==r.keyCode&&81!==r.keyCode||t.snake.left(),32===r.keyCode&&e()}));var r=function(){e()};document.addEventListener("webkitvisibilitychange",r),document.addEventListener("visibilitychange",r);var i=function(t,e,r,i){if(NV.Cd.assert(null==r&&null==i||null!=r&&null!=i,(function(){return"customModelURL and customMetadataURL must be both provided or both not provided."})),null!=r&&NV.Cd.assert(null==e,(function(){return"vocabulary name must be null or undefined when modelURL is provided."})),"BROWSER_FFT"===t)return new y2(e,r,i);throw"SOFT_FFT"===t?new Error("SOFT_FFT SpeechCommandRecognizer has not been implemented yet."):new Error("Invalid fftType: '"+t+"'")}("BROWSER_FFT");return i.ensureModelLoaded().then((function(){var e=i.wordLabels();return i.listen((function(r){for(var i=r.scores,n=Math.max.apply(Math,b2(i)),s=0;s<e.length;s++)if(n.toFixed(2)===r.scores[s].toFixed(2))switch(e[s]){case"up":t.snake.up();break;case"right":t.snake.right();break;case"down":t.snake.down();break;case"left":t.snake.left()}}),{includeSpectrogram:!0,probabilityThreshold:.75})}))}}])&&x2(e.prototype,r),i&&x2(e,i),t}();function E2(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var w2=function(){function t(e,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._text=new PIXI.Text(i,{fill:"white",fontSize:"14px",fontWeight:"100"}),this._text.position.x=e,this._text.position.y=r}var e,r,i;return e=t,(r=[{key:"text",get:function(){return this._text}}])&&E2(e.prototype,r),i&&E2(e,i),t}();function S2(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var I2=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,i;return e=t,i=[{key:"hasCollided",value:function(t,e){return t.x===e.x&&t.y===e.y}}],(r=null)&&S2(e.prototype,r),i&&S2(e,i),t}();function A2(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var C2=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxWidth=e,this.maxHeight=r}var e,r,i;return e=t,(r=[{key:"hasCollided",value:function(t,e){return e.length?e.filter((function(e){return I2.hasCollided(t,e)})).length>0:I2.hasCollided(t,e)}},{key:"hasGoneOutOfBounds",value:function(t){return t.x<0||11*t.x>this.maxWidth||t.y<0||11*t.y>this.maxHeight}}])&&A2(e.prototype,r),i&&A2(e,i),t}();function O2(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var R2=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.app=new window.PIXI.Application({width:e,height:r,antialias:!0,transparent:!0,resolution:1,forceCanvas:!0}),this.app.ticker.maxFPS=1}var e,r,i;return e=t,(r=[{key:"ticker",get:function(){return this.app.ticker}},{key:"stage",get:function(){return this.app.stage}},{key:"view",get:function(){return this.app.view}}])&&O2(e.prototype,r),i&&O2(e,i),t}();window.PIXI=o,window.PIXISound=a,window.window.PIXI.sound=hV;var N2=window.innerWidth,P2=window.innerHeight,M2=N2/11,D2=P2/11,F2=window.PIXI.sound.Sound.from("./resources/sounds/died.mp3"),L2=window.PIXI.sound.Sound.from("./resources/sounds/eat.mp3"),k2=new C2(N2,P2),U2=new bV(new window.PIXI.Graphics,k2),B2=new IV(20,20,new window.PIXI.Graphics),j2=new RV(new window.PIXI.Graphics,new w2("",P2-30,20));new T2(U2,j2).create().then((function(){var t=new R2(N2,P2);t.ticker.add((function(){if(j2.status===OV){if(U2.hasCollidedWithSelf()||U2.hasGoneOutOfBounds())return F2.play(),U2.flash(),void j2.setLost();k2.hasCollided(U2.getHead(),B2)&&(L2.play(),U2.grow(),B2.randomlyReposition(M2,D2)),U2.move(),[U2,B2,j2].forEach((function(t){return t.draw()}))}})),t.stage.addChild(U2.graphics),t.stage.addChild(B2.graphics),t.stage.addChild(j2.graphics),document.getElementById("snake__game").appendChild(t.view)}))}]);